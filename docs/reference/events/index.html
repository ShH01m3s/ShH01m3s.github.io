<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sending Events - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/reference/"> 👈🏼 Back to </br> 📚 Technical Reference </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#long-polling">Long-Polling</a></li>
    <li><a href="#websockets">WebSockets</a></li>
    <li><a href="#server-sent-events">Server-Sent Events</a></li>
    <li><a href="#webhook">WebHook</a></li>
    <li><a href="#backpressure">Backpressure</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Sending Events</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 28.07.2022
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p><em>This is about &hellip; .</em></p>
<h2 id="long-polling">Long-Polling</h2>
<h2 id="websockets">WebSockets</h2>
<h2 id="server-sent-events">Server-Sent Events</h2>
<h2 id="webhook">WebHook</h2>
<p>A webhook is an HTTP request, triggered by an event in a source system and sent to a destination system, often with a payload of data. Webhooks are automated, in other words they are automatically sent out when their event is fired in the source system.</p>
<p>Let’s build an analogy.</p>
<p>Imagine a fisher 🎣 has cast a fishing line and now is waitng for a fish to bite. How does the fisher know that this <em>event</em> has occured? Well, he feels the fishing line to get strained and the float to move across the surface. Now, once our fisher has received those signals, he can act upon them. That&rsquo;s pretty much it.</p>
<p>I would like to show an example more technical than the above 😂. One of the usages could be to send logs or notifications to a remote machine.</p>
<p>For example, you have a Incident Management service (OpsGenie, for example) and you&rsquo;d like to connect it to Elastic SIEM, meaning that you&rsquo;d like any alerts coming from SIEM go directly to OpsGenie. Who&rsquo;s the fisher here? Well, OpsGenie is the fisher, SIEM is the pond and each event is a fish 🐟 &hellip; or not a fish.</p>
<p><img src="https://media.giphy.com/media/7kJ926qjkxFx6/giphy.gif" alt="img"></p>
<p>The easiest way, of course, is when there are available pre-built integrations that would ease the process. For example, for Elastic SIEM there is X-Pack Alerting (in OpsGenie go to <code>Settings -&gt; Integrations -&gt; X-Pack Alerting</code>). There are lot of complicated fields but there are just a few essential ones. First and foremost copy the code snippet at the beginning, in the Settings section:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;opsgenie&#34;</span> <span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;webhook&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;scheme&#34;</span> <span class="p">:</span> <span class="s2">&#34;https&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;method&#34;</span> <span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;host&#34;</span> <span class="p">:</span> <span class="s2">&#34;api.opsgenie.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;port&#34;</span> <span class="p">:</span> <span class="mi">443</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;path&#34;</span> <span class="p">:</span> <span class="s2">&#34;/v1/json/eswatcher&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;headers&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;Content-Type&#34;</span> <span class="p">:</span> <span class="s2">&#34;application/json&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;params&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;apiKey&#34;</span><span class="p">:</span> <span class="s2">&#34;🔑&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;body&#34;</span> <span class="p">:</span> <span class="s2">&#34;{{#toJson}}ctx{{/toJson}}&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>API key 🔑 is generated by the integration. You can&rsquo;t generate the key 🔑 yourself in API management section. It won&rsquo;t work with the integration and besides, you can&rsquo;t paste anything in this field. You can only regenerate the 🔑.</p>
<p>Now, time to go to Elastic now. There are two ways to make this work.</p>
<ul>
<li><strong>Option 1</strong>. X-Pack API key + Elastic WebHook Connector + Rules
<ul>
<li>🧞 Get OpsGenie API key and turn X-Pack on (fisher sits at the pond)</li>
<li>🏋🏼‍♂️ Configure the Connector in Elastic (set up a fishing line)</li>
<li>🏋🏼‍♂️ Configure Elastic Rules (get the appropriate bait for the fish)</li>
</ul>
</li>
<li><strong>Option 2</strong>. X-Pack (OpsGenie) + Watcher (Elastic)
<ul>
<li>🧞 Get OpsGenie API key and turn X-Pack on (fisher sits at the pond)</li>
<li>🏋🏼‍♂️ Configure Watcher in Elastic (set up a fishing line and get the appropriate bait for the fish)</li>
<li>🧞 Set-up X-Pack in OpsGenie</li>
</ul>
</li>
</ul>
<p>Message. You obviously need to deine what message would look like. The default one is: <code>[X-Pack Alerting] {{watchId}} is triggered. Total Hits: {{totalHits}}</code>. Optionally, you can configure the filter if you don&rsquo;t want to receive all the events.</p>
<p>When all the settings are done, click <code>Enabled</code> to set all up and running.</p>
<p>Another example to see would be some open-source k8s cluster watcher <a href="https://gist.github.com/coffeesn0b/df8da51aefc04e25de896a598723cf5d">here</a>.</p>
<h2 id="backpressure">Backpressure</h2>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
