<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Windows Shadow Copies - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.9d91cbb32c96c334ae7b38c3d99d30727e0836e1182125cc5f007d215f0b9e59.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/reference/windows/"> Back to ğŸ“š Windows Analysis Reference Section ğŸ‘ˆğŸ¼ </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#collection">Collection</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Windows Shadow Copies</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-search"></i>
              
          <a class="category-link" href="/domain/forensics">forensics</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      
      <div class="article-category">
          
            
            
            
            
            
          <a class="platform-link" href="/platforms/win">win</a>
          
      </div> <br />
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p><em>Shadow Copies are exactly those pieces of data that get saved on disk when system restore option is enabled. Once it&rsquo;s actually triggered, these files are used to restore the system to the previous state. It&rsquo;s very useful when you are not an expert in PC and something weird is going on. However, not only ordinary people find this feature useful. Some bad guys might try cover their tracks which can sometimes be undone with this feature.</em></p>
<blockquote>
<p>âš ï¸ This option is turned on by default! However, in case of my Windows 10 VM on Parallels (Windows Insider program for ARM) this option was disabled resulting in the following line: <code>No items found that satisfy the query. </code> For my Dell notebook running Windows 10, build 18362 (value from registry, <code>SOFTWARE\Microsoft\Windows NT\CurrentVersion</code>, value <code>CurrentBuild</code>). I had to create the point of restore myself as well, since I didn&rsquo;t find where I could make it happen on a regular basis.</p>
<p>ğŸ§ª May be it&rsquo;s something else?</p>
<p>âœï¸ After the above steps were followed, PowerShell relaunched, I could finally see the valid output from <code>vssadmin.exe /for=c:</code>.</p>
</blockquote>
<p>For Windows 7 (3-5%) and for Vista - 15%. For Windows 10 you can adjust this space when turning this feature on. To turn on: <code>Control Panel -&gt; All Control Panel Items -&gt; Recovery</code> or simply type Recovery in the Start menu search box.</p>
<p>User can set the regularity with which these copies are made: daily/weekly, on every new hardware attached, new installations, manual. There is rollover process for these files to save space. Sometimes these files are kept for years and sometimes deleted soon, first in, first out priority. Some OS versions don&rsquo;t allow to access previously created points, but still keeps them. Once you have an OS that allow access to these files, you can view them.</p>
<p>From a forensic point of view, these files allow to view the previous versions of OS, recover files (find remnant metadata that can&rsquo;t be recovered), examine user activity in different time points. Since shadow copies are system files, these are not accessed by wiping software.</p>
<p><strong>Tools</strong> ğŸ› : <a href="https://coptr.digipres.org/index.php/Forensic_Acquisition_Utilities">https://coptr.digipres.org/index.php/Forensic_Acquisition_Utilities</a></p>
<h2 id="collection">Collection</h2>
<p><a href="http://www.chrysocome.net/downloads/ddrelease64.exe">dd.exe</a> for Windows. There used to be some FAU (Forensic Acquisition Utilities) package, containing <code>dd</code>, but I could not find it, so I downloaded <code>dd.exe</code> separately.</p>
<p>To get the list of shadow copies from a PC, run the following built-in utility:</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="n">vssadmin</span> <span class="n">list</span> <span class="n">shadows</span> <span class="p">/</span><span class="k">for</span><span class="p">=&lt;</span><span class="n">path_to_drive</span><span class="p">&gt;</span> <span class="c"># /for=c: for a logial drive</span>
</code></pre></div><p>Now, to collect the image with a <code>dd</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="n">dd</span><span class="p">.</span><span class="n">exe</span> <span class="k">if</span><span class="p">=\\.\</span><span class="n">HardDiskVolumeShadowCopy1</span> <span class="n">of</span><span class="p">=</span><span class="n">g:</span><span class="p">\</span><span class="n">shadow</span><span class="p">.</span><span class="n">img</span> <span class="c"># for Windows, using the above mentioned version of dd, we type `if` and `of` instead of `-if` and `-of`.</span>
<span class="c"># what&#39;s --localwrt</span>
</code></pre></div><p>Better go and have a cup of coffee â˜•ï¸ since it takes decent amount of time ğŸ•°, tick-tock!</p>
<h2 id="references">References</h2>
<p>[<a href="https://www.udemy.com/course/surviving-digital-forensics-volume-shadow-copy/learn/lecture/998738?start=15#overview">1</a>] SDF: Volume Shadow Copies (Udemy course)</p>
<p>Suhanov&rsquo;s blog: [<a href="https://dfir.ru/2021/06/28/shadow-copies-become-less-visible/">2</a>] Shadow copies become less visible, [<a href="https://dfir.ru/2020/07/14/offline-shadow-copies/">3</a>] Offline shadow copies, [<a href="https://dfir.ru/2020/06/21/extracting-unallocated-clusters-from-a-shadow-copy/">4</a>] Extracting unallocated clusters from a shadow copy, [<a href="https://dfir.ru/2020/02/29/scoped-shadow-copies/">5</a>] Scoped shadow copies, [<a href="https://dfir.ru/2019/07/29/things-you-probably-didnt-know-about-shadow-copies/">6</a>] Things you probably didnâ€™t know about shadow copies</p>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
