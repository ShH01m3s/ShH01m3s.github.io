<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⏱️ Timelines And Timestamps - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-ttp 🔍">
      <a href="/docs/ttp">
        <span>TTP 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db 🏺">
      <a href="/docs/tools">
        <span>Artefacts DB 🏺</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db ⚔️">
      <a href="/docs/tools">
        <span>Attacks DB ⚔️</span>
      </a>
    </li>
    
    <li class="menu-item-tools db 🛠️">
      <a href="/docs/tools">
        <span>Tools DB 🛠️</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-ttp 🔍">
      <a href="/docs/ttp">
        <span>TTP 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db 🏺">
      <a href="/docs/tools">
        <span>Artefacts DB 🏺</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db ⚔️">
      <a href="/docs/tools">
        <span>Attacks DB ⚔️</span>
      </a>
    </li>
    
    <li class="menu-item-tools db 🛠️">
      <a href="/docs/tools">
        <span>Tools DB 🛠️</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/ttp/"> 👈🏼 Back to </br> 🔎 Investigation Tactics Techniques and Procedures </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#tampering">Tampering</a></li>
    <li><a href="#time-formats-and-standards">Time Formats and Standards</a></li>
    <li><a href="#the-importance-of-timestamps">The Importance Of Timestamps</a></li>
    <li><a href="#file-systems-timestamps">File Systems Timestamps</a>
      <ul>
        <li><a href="#ntfs-vs-apfs">NTFS vs APFS</a></li>
      </ul>
    </li>
    <li><a href="#application-specific-timestamps">Application Specific Timestamps</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">⏱️ Timelines And Timestamps</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      <div class="article-category">
          
            
            
            
            
            
              <i class="fab fa-linux"></i>&nbsp;<i class="fab fa-apple"></i>&nbsp;<i class="fab fa-windows"></i>&nbsp;<i class="fas fa-mobile"></i>
            
            
          
          
      </div> <br />
      

      
      <div class="article-category">
        <i class="fas fa-tools"></i>
          
          
          <a class="platform-link" href="/tools/timeline-explorer">Timeline Explorer</a> 
          
           , 
          <a class="platform-link" href="/tools/kubectl">kubectl</a> 
          
           , 
          <a class="platform-link" href="/tools/filelist">FileList</a> 
          
           , 
          <a class="platform-link" href="/tools/sleuth-kit">Sleuth Kit</a> 
          
           , 
          <a class="platform-link" href="/tools/autopsy">Autopsy</a> 
          
      </div> <br />
      
      

      
    </div>
    
    <b>Created:</b> 12.10.2020
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p><em>As if investigations were not already complicated enough, we also have to contend with various timestamp formats. There is a wide range of time formats available, and it is crucial to understand the differences in order to create an accurate timeline.</em></p>
<h2 id="tampering">Tampering</h2>
<p>It&rsquo;s possible to tamper with some timestamps.</p>
<blockquote>
<p>🗒️ TODO: How? On Windows, some API call. Which one?</p>
</blockquote>
<p><strong>Time Zone Changes or Daylight Saving Time</strong>: If a file is created and then modified in a different time zone, or if the time zone setting on the computer is changed, the modification time could appear to be earlier than the creation time. Similarly, switching between standard time and daylight saving time could cause a similar discrepancy.</p>
<p><strong>Restoring Files</strong>: If a file is restored from a backup, the creation time might be the restoration time, but the modification time would be the last modification before the backup.</p>
<p><strong>Files copied</strong>. Sometimes, if you copy a file to a different location, the new copy may have a new creation time (the time when the copy was made), but still retain the original file&rsquo;s earlier modification time.</p>
<h2 id="time-formats-and-standards">Time Formats and Standards</h2>
<p>GMT and UTC are the same and usually are used interchangeably. Although, there is some difference: <a href="https://www.timeanddate.com/time/gmt-utc-time.html">https://www.timeanddate.com/time/gmt-utc-time.html</a>.</p>
<blockquote>
<p>❗️But GMT is a time zone, and UTC is a time standard. So, UTC+0 = GMT</p>
</blockquote>
<p>Here is a UTC timestamp <code>2022-09-27T10:42:41.947Z</code> in ISO 8601 format, note there is no timezone offset, only <code>Z</code> at the end. If you see <code>2022-09-27T10:42:41.947</code> (no Z at the end), it&rsquo;s a local timestamp. In that case you often have to know the configs for the server to convert the timestamp to UTC. However, if you see something like <code>2022-09-27T10:42:41.947+0000</code>, it&rsquo;s a local timestamp in ISO 8601 with the timezone offset showing the time zone: <code>+0000</code> tells it&rsquo;s GMT/UTC +0.</p>
<blockquote>
<p>🛠️ Convert from UTC to local time <a href="https://support.microsoft.com/en-us/topic/how-to-convert-utc-time-to-local-time-0569c45d-5fb8-a516-814c-75374b44830a">here</a>.</p>
</blockquote>
<p>Since then, GMT is no longer a time standard. Today, Greenwich Mean Time (GMT) is only the name of a time zone used by a few countries in Africa and Western Europe, including the UK during winter and all year in Iceland.</p>
<p>⚔️</p>
<blockquote>
<p>🧐 Let&rsquo;s consider a local timestamp with a timezone like this: <code>2023-11-05T08:15:30-05:00</code>. The <code>-5:00</code> at the end represents the offset, indicating the number of hours the timezone is ahead or behind UTC. Regardless of the specific timezone, our example is 5 hours behind UTC. Therefore, to obtain the UTC timestamp, we subtract 5 hours from it. Consequently, we would have <code>2023-11-05T13:15:30 UTC</code>.</p>
</blockquote>
<blockquote>
<p>🧐 Let&rsquo;s take a look at another example. Imagine, if you will, it&rsquo;s a frosty morning on January 27th, 2020 at precisely 6:00 AM, and we find ourselves in the heart of London. Since the UK uses GMT during winter, the timestamp is the same as in UTC. But what of distant México City and bustling Beijing? México City is 6 hours behind UTC, so we must subtract 6 hours from our UTC timestamp, and we will get <code>2020–01–27T00:00:00</code> in Mexico City. On the other hand, to leap forward to Beijing, which is 8 hours ahead, we add 8 hours to the UTC timestamp and get <code>2020–01–27T14:00:00</code> the local timestamp.</p>
<p>❗️So, when converting from local to UTC, we look at the offset and reverse the operation. If it shows <code>-5:00</code>, we add 5 hours; if it shows <code>+5:00</code> we subtract. However, when we convert from UTC to local timestamp, we do vice versa: subtract when it&rsquo;s <code>-5:00</code> and add when it&rsquo;s <code>+5:00</code>.</p>
</blockquote>
<h2 id="the-importance-of-timestamps">The Importance Of Timestamps</h2>
<p>If something was downloaded and accessed over several days, the suspect knew about this file. Otherwise, they might prove they didn&rsquo;t. There also might be a pattern that tells a lot about possible motives. If the files were deleted, it also might prove that the user knew about them and wanted to hide them and not keeping for themselves but for distribution only (if they, say, emailed those files before deleting them).</p>
<p>There are several timestamps: timestamps the file systems keep in their metadata, timestamps of the files controlled by the OS and FS, and timestamps in the files&rsquo; metadata. More?</p>
<p><strong>Tools</strong> 🛠:</p>
<ul>
<li><strong>FileList</strong>. <code>file list &lt;directory_to_process&gt; /s /md5 /sha256 /owners /fullpath &gt; evidence.csv</code>. <code>/s</code> - recursive search, <code>/owners</code> - identify the user, <code>fullpath</code> - full directory path. Open this .csv in Excel as a delimited file, start the processing from the third row (skip the headers) and use the tab and comma as delimiters. Filters and pivot tables in Excel can be of use.</li>
<li><strong>Autopsy</strong>. Has a dedicated feature for timeline creation. Better use Hash lookup with NSRL, Recent Activity and EXIF data modules. Based on Sleuth Kit, you can use the below commands to manually get the same info in the command line.</li>
<li><strong>Sleuth Kit</strong>. <code>fls -r -m &quot;/&quot; -o &lt;offset&gt; &lt;image/disk&gt; &gt; bodyfile.txt</code> and afterwards: <code>mactime.pl -b bodyfile.txt -d &gt; timeline.csv</code>. For timezone - <code>-z</code>.</li>
</ul>
<p>Timelines are created based on the following sources:</p>
<ul>
<li>MAC data</li>
<li>System logs</li>
<li>Event logs</li>
<li>E-mails</li>
<li>Internet history</li>
<li>File metadata</li>
</ul>
<h2 id="file-systems-timestamps">File Systems Timestamps</h2>
<h3 id="ntfs-vs-apfs">NTFS vs APFS</h3>
<p>Mind that APFS <a href="/docs/dfir/host/apple/mac-artifacts">timestamps</a> and NTFS <a href="/docs/dfir/host/windows/win-artifacts">timestamps</a> are different! When you add a file to the system (for example, copy it from a USB drive), the MAC times are changed with NTFS. However, the APFS Added attribute is added, providing you with more information.</p>
<blockquote>
<p>⚠️ Both for APFS and NTFS, the last accessed times might not be updated. Refer to the artefacts page mentioned above for more information.</p>
</blockquote>
<p>NTFS has an additional MAC attribute - EM (entry modified). That&rsquo;s the time when <code>$MFT</code> is modified.</p>
<p>NTFS Last Accessed Update (Win10+) -</p>
<p>80000000 (hex) = User Managed, Last Access Updates Enabled
80000001 (hex) = User Managed, Last Access Updates Disabled
80000002 (hex) = System Managed, Last Access Updates Enabled - default for Windows 11 (in my case).
80000003 (hex) = System Managed, Last Access Updates Disabled</p>
<h2 id="application-specific-timestamps">Application Specific Timestamps</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl describe pod podname <span class="c1"># to see the pod description, MAC times and settings</span>
</span></span></code></pre></div><h2 id="references">References</h2>
<p>[<a href="https://learning.oreilly.com/videos/digital-archaeology-livelessons/9780132853835/9780132853835-09_01/">1</a>] Digital Archaeology LiveLessons (Video Training), Safari by [Michael W Graves](<a href="https://learning.oreilly.com/search?query=author%3A%22Michael">https://learning.oreilly.com/search?query=author%3A&quot;Michael</a> W Graves&quot;&amp;sort=relevance&amp;highlight=true)</p>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
