<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤” How Do I Audit Management Tools? - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/tools">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/tools">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/tools">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/tools">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/ttp/cheatsheets/"> ğŸ‘ˆğŸ¼ Back to </br> Artefacts CheatSheet </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#windows">Windows</a>
      <ul>
        <li><a href="#services">Services</a></li>
        <li><a href="#tasks">Tasks</a></li>
        <li><a href="#wmi">WMI</a></li>
        <li><a href="#powershell-remote">PowerShell Remote</a></li>
        <li><a href="#registry">Registry</a></li>
        <li><a href="#winrs">winrs</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">ğŸ¤” How Do I Audit Management Tools?</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 26.06.2023
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p><em>Admins on payroll and those &ldquo;magnanimous volunteers&rdquo; often tread the very same path, albeit guided by different compasses of motivation. Once our cunning adversary ascends to the lofty heights of respect usually reserved for the admin on payroll, the misuse of these management tools becomes bound only by the limits of their mischievous imagination.</em></p>
<h2 id="windows">Windows</h2>
<h3 id="services">Services</h3>
<blockquote>
<p>â—ï¸Doesn&rsquo;t require admin privileges to pull off.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="nb">sc </span><span class="p">\\</span><span class="n">host</span> <span class="n">create</span> <span class="n">service_name</span> <span class="n">binpath</span><span class="p">=</span><span class="s2">&#34;path/to/service&#34;</span>
</span></span></code></pre></div><table>
<thead>
<tr>
<th>ğŸº Artefact</th>
<th>ğŸš° Source</th>
<th>ğŸ¯ Target</th>
</tr>
</thead>
<tbody>
<tr>
<td>ğŸ—„ï¸ Registry</td>
<td>ShimCache, BAM/DAM and AmCache for <code>sc.exe</code> traces</td>
<td>ğŸ”‘ <code>CurrentControlSet\Services</code><!-- raw HTML omitted -->ShimCache and AmCache</td>
</tr>
<tr>
<td>ğŸ“‘ File system</td>
<td>Prefetch</td>
<td>Image file of the exe<!-- raw HTML omitted -->Prefetch</td>
</tr>
<tr>
<td>ğŸªµ Event logs</td>
<td></td>
<td>ğŸ›¡ï¸ <code>4624</code> type <code>3</code> (sIP, sname), <code>4697</code> (service installed) <!-- raw HTML omitted -->âš™ï¸ <code>7034</code> (service terminated unexpectedly), <code>7035</code> (start/stop request sent), <code>7036</code> (service started/stopped), <code>7040</code> (start type changed), <code>7045</code> (service installed)</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="tasks">Tasks</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="n">at</span> <span class="p">\\</span><span class="n">host</span> <span class="n">time</span> <span class="s2">&#34;path\to\exe&#34;</span>
</span></span><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="n">schtasks</span> <span class="p">/</span><span class="n">CREATE</span> <span class="p">/</span><span class="n">TN</span> <span class="n">taskname</span> <span class="p">/</span><span class="n">TR</span> <span class="n">C:</span><span class="p">\</span><span class="n">path</span><span class="p">\</span><span class="n">to</span><span class="p">\</span><span class="n">evil</span><span class="p">.</span><span class="n">exe</span> <span class="p">/</span><span class="nb">SC </span><span class="n">once</span> <span class="p">/</span><span class="n">RU</span> <span class="s2">&#34;SYSTEM&#34;</span> <span class="p">/</span><span class="n">ST</span> <span class="n">15</span><span class="err">:</span><span class="n">00</span> <span class="p">/</span><span class="n">S</span> <span class="n">host</span> <span class="p">/</span><span class="n">u</span> <span class="n">uname</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># RU - run as user</span>
</span></span><span class="line"><span class="cl"><span class="c"># TR - what to do</span>
</span></span><span class="line"><span class="cl"><span class="c"># S - remote system to connect to</span>
</span></span></code></pre></div><p>For the below artefacts watch out for <code>at.exe</code> and <code>schtasks.exe</code>.</p>
<p>ğŸ›¡ï¸Security and ğŸ¥€ Task logs</p>
<table>
<thead>
<tr>
<th>ğŸº Artefact</th>
<th>ğŸš° Source</th>
<th>ğŸ¯ Target</th>
</tr>
</thead>
<tbody>
<tr>
<td>ğŸªµ Event logs</td>
<td>4648 (alternate creds)</td>
<td>ğŸ›¡ï¸ <code>4698</code> (created), <code>4702</code> (updated), <code>4699</code> (deleted), <code>4700</code> (enabled), <code>4701</code> (disabled), <!-- raw HTML omitted -->ğŸ¥€ <code>106</code> (created), <code>140</code> (updated), <code>141</code> (deleted), <code>200</code> (executed), <code>201</code> (completed)</td>
</tr>
<tr>
<td>ğŸ—„ï¸ Registry</td>
<td>ShimCache, BAM/DAM</td>
<td>ğŸ”‘ <code>Microsoft\Windows NT\CurrentVersion\Schedule\TasksCache\Tasks</code><!-- raw HTML omitted -->ShimCache, AmCache</td>
</tr>
<tr>
<td>ğŸ“‘ File System</td>
<td>Prefetch</td>
<td>Prefetch<!-- raw HTML omitted -->ğŸ“‚ <code>C:\Windows\System32\Tasks</code> (newer) and ğŸ“‚ <code>C:\Windows\Tasks</code> containing <code>.job</code> (binary) or <code>.xml</code> files</td>
</tr>
</tbody>
</table>
<h3 id="wmi">WMI</h3>
<blockquote>
<p>âœğŸ» T1047 MITRE ATTACK</p>
<p>âœğŸ» Whitelisted Event Consumers: SCM Event Log, RmAssistEventFilter  , WSCEAA.exe, BVTFilter, TsLogonEvent.vbs, TsLogonFilter, RAevent.vbs, RmAssistEventFilter, NTEventLogConsumer and KernCap.vbs (?)</p>
</blockquote>
<p>This tool&rsquo;s artefacts usually reside mostly in RAM. Also, it uses WBEM protocol, and thus, it&rsquo;s tricky to eavesdrop on this connection. If no WinRM - network forensics is an option.</p>
<blockquote>
<p>âœğŸ» CIM - common info model, shows object-relationships information.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="n">wmic</span> <span class="p">/</span><span class="n">node</span><span class="err">:</span><span class="n">host</span> <span class="p">/</span><span class="n">user</span> <span class="n">uname</span> <span class="k">process</span> <span class="n">call</span> <span class="n">create</span> <span class="s2">&#34;path\to\exe&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Reconnaissance with WMI</span>
</span></span><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="n">wmic</span> <span class="n">useraccount</span> <span class="n">list</span> <span class="n">full</span>
</span></span><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="n">wmic</span> <span class="nb">group </span><span class="n">list</span> <span class="n">full</span>
</span></span><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="n">wmic</span> <span class="n">netuse</span> <span class="n">list</span> <span class="n">full</span>
</span></span><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="n">wmic</span> <span class="n">qfe</span> <span class="n">get</span> <span class="n">Caption</span><span class="p">,</span> <span class="n">Description</span><span class="p">,</span> <span class="n">HotFixID</span><span class="p">,</span> <span class="n">InstalledOn</span>
</span></span><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="n">wmic</span> <span class="n">startup</span> <span class="n">get</span> <span class="n">Caption</span><span class="p">,</span> <span class="n">Command</span><span class="p">,</span> <span class="n">Location</span><span class="p">,</span> <span class="n">User</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Escalation with WMI</span>
</span></span><span class="line"><span class="cl"><span class="c"># Show services that are set to autostart, have no quotes in the path and are NOT in Windows folder</span>
</span></span><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="n">wmic</span> <span class="n">service</span> <span class="n">get</span> <span class="n">name</span><span class="p">,</span> <span class="n">displayname</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">startmode</span> <span class="p">|</span> <span class="n">findstr</span> <span class="p">/</span><span class="err">:</span><span class="s2">&#34;Auto&#34;</span> <span class="p">|</span> <span class="n">findstr</span> <span class="p">/</span><span class="n">i</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&#34;C:\Windows\\&#34;</span> <span class="p">|</span> <span class="n">findstr</span> <span class="p">/</span><span class="n">i</span> <span class="p">/</span><span class="n">v</span> <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2"># get the owners of the processes running in order to spot a high privileged user
</span></span></span><span class="line"><span class="cl"><span class="s2">ğŸ“• $Owners = @{}
</span></span></span><span class="line"><span class="cl"><span class="s2">Get-WmiObject -Class Win32_Process | Where-Object {$_} | For-Each {&amp;Owners[$_.handle] = $_.getowner().user}
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">ğŸ“• $VulnerableServives = Get-WmiObject -Class Win32_service | Where-Object {$_} | Where-Object {($_.pathname -ne $null) -and ($_.pathname.trim() -ne &#34;</span> <span class="s2">&#34;)} | Where-Object {-not $_.pathname.StartsWith(&#34;</span><span class="p">`&#34;)}</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span><span class="o">-not</span> <span class="nv">$_</span><span class="p">.</span><span class="n">pathmname</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="s2">&#34; &#34;</span><span class="p">)}</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Lateral Movement</span>
</span></span><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="n">wmic</span> <span class="k">process</span> <span class="n">call</span> <span class="n">create</span> <span class="s2">&#34;path\to\rundll32.exe path\to\dll, #opcode&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c"># Alternative to wmic is good old PowerShell, Invoke-WmiMethod and Get-WmiObject</span>
</span></span><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="nb">Invoke-WmiMethod</span> <span class="n">-Computer</span> <span class="n">host</span> <span class="n">-Class</span> <span class="n">Win32_Process</span> <span class="n">-Name</span> <span class="n">create</span> <span class="n">-Argument</span> <span class="s2">&#34;better\be\a\good\argument.exe&#34;</span>
</span></span></code></pre></div><p>Look out for the following executables <code>wmic</code> being invoked (on the source), along with <code>srccons</code>, <code>mofcomp</code>, <code>wmiprvse</code> and some custom names limited to the attacker&rsquo;s quirky whims (on the target).</p>
<p>ğŸ›¡ï¸<code>Security</code>, ğŸ‰ <code>Microsoft-Windows-WMI-Activity%4Operational</code> (Win10+ enabled by default), ğŸ‡ <code>Sysmon</code> (ğŸ“‘ <code>Microsoft-Windows-Sysmon/Operational</code>)</p>
<table>
<thead>
<tr>
<th>ğŸº Artefact</th>
<th>ğŸš° Source</th>
<th>ğŸ¯ Target</th>
</tr>
</thead>
<tbody>
<tr>
<td>ğŸªµ Event logs</td>
<td>ğŸ›¡ï¸ <code>4648</code> (alternate creds)</td>
<td>ğŸ›¡ï¸<code>4624</code> type <code>3</code>, <code>4672</code> (admin), 4688, Sysmon and EDR can help track the processes created, ğŸ‰ <code>5857</code> (start or stop, path to provider DLL), <code>5860</code>/<code>5861</code> (temp/permanent Event Consumer created), <code>5857</code>-<code>5861</code> (filter and consumer), <code>5858</code> - query error or insufficient permissions (host and uname), 5859 -find corresponding filter. <!-- raw HTML omitted --><!-- raw HTML omitted -->ğŸ‡ <code>1</code> - <code>mof</code> compiled, <code>20</code> - Consumer added</td>
</tr>
<tr>
<td>ğŸ—„ï¸ Registry</td>
<td>ShimCache, BAM/DAM, AmCache</td>
<td>ShimCache, AmCache</td>
</tr>
<tr>
<td>ğŸ“‘ File System</td>
<td>Prefetch</td>
<td>Prefetch<!-- raw HTML omitted --><code>mof</code> files, unauthorised changes to <code>C:\Windows\System32\wbem\Repository</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>âœï¸ Suspicious strings: ps1, eval, vbs, ActiveXObject (when screens process is run)</p>
</blockquote>
<h3 id="powershell-remote">PowerShell Remote</h3>
<blockquote>
<p>âœï¸ Close to SSH, traffic is also encrypted.</p>
<p>âœï¸ WSMan stands for &ldquo;Web Services for Management.&rdquo; It&rsquo;s a term used in the context of Microsoft&rsquo;s implementation of the WS-Management protocol, which is a standard Simple Object Access Protocol (SOAP)-based, firewall-friendly protocol that allows hardware and operating systems from different vendors to interoperate. WSMan provides a common way for systems to access and exchange management information across an IT infrastructure. It allows IT administrators to remotely manage the system settings of devices that support the WS-Management protocol, which can include desktops, servers, or any other devices that have embedded systems. In the context of PowerShell, the WS-Management service is used by the &ldquo;WinRM&rdquo; (Windows Remote Management) service to provide remote management capabilities. PowerShell uses WinRM and WS-Management to enable administrators to run management shell commands and scripts on remote computers. For example, you might use the <code>Enter-PSSession</code> cmdlet in PowerShell to start an interactive session with a remote computer, and this would be facilitated by WinRM and WS-Management. Or you might use the <code>Invoke-Command</code> cmdlet to run a command on a remote computer, and this would also be facilitated by WinRM and WS-Management. Remember, like any remote management tool, WinRM and WS-Management should be used securely to prevent unauthorized access or other security risks. Always follow best practices for authentication and encryption when using these tools.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="nb">Enter-PSSession</span> <span class="n">-ComputerName</span> <span class="n">host</span> <span class="n">-Credential</span> <span class="n">uname</span>
</span></span><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="nb">Invoke-Command</span> <span class="n">-ComputerName</span> <span class="n">host</span> <span class="n">-ScriptBlock</span> <span class="p">{</span> <span class="nb">Start-Process</span> <span class="p">\</span><span class="n">path</span><span class="p">\</span><span class="n">to</span><span class="p">\</span><span class="k">process</span><span class="p">}</span>
</span></span></code></pre></div><p>ğŸªµ Logs: ğŸ›¡ï¸ <code>Security</code>, ğŸŒ <code>Microsoft-Windows-PowerShell%4Operational</code>, ğŸ’ <code>Windows-PowerShell.evtx</code> and ğŸ¥ <code>Microsoft-Windows-WinRM</code>.</p>
<p>âš™ï¸ Processes: <code>powershell.exe</code> (source, dest), <code>wsmprovhost.exe</code> (dest)</p>
<table>
<thead>
<tr>
<th>ğŸº Artefact</th>
<th>ğŸš° Source</th>
<th>ğŸ¯ Target</th>
</tr>
</thead>
<tbody>
<tr>
<td>ğŸªµ Event logs</td>
<td>ğŸ›¡ï¸ <code>4648</code><!-- raw HTML omitted -->ğŸ¥ <code>6</code> -WSMan Session init (dhost, dIP, c_user, timestamp), <code>8</code>, <code>15</code>, <code>16</code>, <code>33</code> - deinit<!-- raw HTML omitted --> ğŸŒ <code>40691</code>, <code>40692</code> (Records the local initiation of powershell.exe and associated user account), <code>8193</code>, <code>8194</code> (session created), <code>8197</code> (session closed)</td>
<td>ğŸ›¡ï¸ 4624 type 3, 4672 | ğŸŒ 4103 &amp; 4104 (script block logging, suspicious or all), 53504 (the auth-ing user) | ğŸ’ 400/403 (start/end of remote session), 800 (contains partial script) | ğŸ¥ 91 (session created), 168 (auth-ing user)</td>
</tr>
<tr>
<td>ğŸ—„ï¸ Registry</td>
<td>ShimCache, BAM/DAM, AmCache</td>
<td>ShimCache, <code>SOFTWARE</code> (ğŸ”‘ <code>Microsoft\ PowerShell\1 \ShellIds\Microsoft. PowerShell \ExecutionPolicy</code> set to Bypass or less permissive)</td>
</tr>
<tr>
<td>ğŸ“‘ File System</td>
<td>Prefetch (will also show <code>*.ps1</code> files accessed during the first 10 seconds)<!-- raw HTML omitted -->Command history at <code>C:\Users\uname\AppData\Roaming\Microsoft\&lt;br /&gt;Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</code><!-- raw HTML omitted --></td>
<td>- files moved<!-- raw HTML omitted -->- Prefetch<!-- raw HTML omitted -->- User profile</td>
</tr>
</tbody>
</table>
<blockquote>
<p>â“EID 4096 is referenced in the poster, but no information on the Internet.</p>
</blockquote>
<h3 id="registry">Registry</h3>
<blockquote>
<p>â—ï¸ Requires authentication.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="n">reg</span> <span class="n">add</span> <span class="p">\</span><span class="n">some</span><span class="p">\</span><span class="n">reg</span><span class="p">\</span><span class="n">key</span> <span class="p">/</span><span class="n">v</span> <span class="n">data</span> <span class="p">/</span><span class="n">t</span> <span class="n">REG_SZ</span> <span class="p">/</span><span class="n">d</span> <span class="s2">&#34;path\to\whatever&#34;</span>
</span></span></code></pre></div><h3 id="winrs">winrs</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="err">ğŸ“•</span> <span class="n">winrs</span> <span class="n">-r</span><span class="err">:</span><span class="n">host</span> <span class="n">-u</span><span class="err">:</span><span class="n">user</span> <span class="n">command_to_run</span>
</span></span></code></pre></div><table>
<thead>
<tr>
<th>ğŸº Artefact</th>
<th>ğŸš° Source</th>
<th>ğŸ¯ Target</th>
</tr>
</thead>
<tbody>
<tr>
<td>ğŸ’­ RAM</td>
<td></td>
<td><code>winrshost.exe</code></td>
</tr>
</tbody>
</table>
<h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    <a href="https://share.ialab.dsu.edu/CAE_Workshops/2019/Incident%20Response/Supplementary%20Material/SANS_Poster_2018_Hunt_Evil_FINAL.pdf">https://share.ialab.dsu.edu/CAE_Workshops/2019/Incident%20Response/Supplementary%20Material/SANS_Poster_2018_Hunt_Evil_FINAL.pdf</a>
</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
