<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Malware Indicators - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/reverse/malware-analysis/tips/"> 👈🏼 Back to </br> Analysis Tips and Tricks </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#runtime-linking">Runtime linking</a></li>
    <li><a href="#imports">Imports</a></li>
    <li><a href="#strings">Strings</a></li>
    <li><a href="#32bit-code">32bit Code</a></li>
    <li><a href="#signed-code">Signed Code</a></li>
    <li><a href="#packed-executables">Packed Executables</a></li>
    <li><a href="#pe-sections">PE Sections</a></li>
    <li><a href="#virtual-vs-physical-addresses">Virtual vs Physical Addresses</a></li>
  </ul>

  <ul>
    <li><a href="#librariries-and-methods">Librariries and Methods</a></li>
    <li><a href="#throubleshooting-malware">Throubleshooting malware</a></li>
    <li><a href="#interesting-places-to-check">Interesting places to check</a></li>
    <li><a href="#naming-conventions">Naming conventions</a></li>
    <li><a href="#how-to-find-out-">How to find out &hellip;</a></li>
    <li><a href="#tools">Tools</a></li>
    <li><a href="#malware-databases">Malware Databases</a></li>
    <li><a href="#tools-1">Tools</a>
      <ul>
        <li><a href="#repos">Repos</a></li>
        <li><a href="#info">Info</a></li>
        <li><a href="#network">Network</a></li>
      </ul>
    </li>
    <li><a href="#general-guidelines">General Guidelines</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Malware Indicators</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 28.07.2022
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p><em>These characteristics MIGHT be of a malware, but not neccessarilly. These are just some clues and advices.</em></p>
<h2 id="runtime-linking">Runtime linking</h2>
<p>Since static linking is rare (it increases the body of a program) and dynamicly linked functions can be inspected in different ways, runtime linking might be a choice for malware authors to hide the functionality. How to determine if the runtime linking is used?</p>
<blockquote>
<p>❓Windows, Mac, Linux?</p>
</blockquote>
<h2 id="imports">Imports</h2>
<p><strong>Importing</strong> and using <code>GetProcessAddress</code>/<code>LdrGetProcessAddress</code> or/and <code>LoadLibrary</code>/<code>LdrLoadDll</code>.</p>
<blockquote>
<p>❓ For Mac and Linux?</p>
</blockquote>
<h2 id="strings">Strings</h2>
<p>Check <strong>strings</strong> in <code>Image</code> and in <code>Memory</code> using the corresponding radio button on the <code>Strings</code> tab of a selected process info in Process Explorer. If they differ - process replacement tool place.</p>
<h2 id="32bit-code">32bit Code</h2>
<p>Since malware authors usually want their software to work on as many machines as possible, they often compile <strong>32bit code</strong>. That&rsquo;s not a decent indicator by itself, but it&rsquo;s a good additional score.</p>
<h2 id="signed-code">Signed Code</h2>
<p>Around 3% of malware is <strong>signed</strong>. It&rsquo;s due to the fact that some systems require executables to be signed. But this technique is not very good for malware authors since when at least one &ldquo;product&rdquo; is marked as malicious, all code that was signed with the same certificate will be identified as well. 🛠 Use <code>sigcheck</code> to check signatures and hashes against Virus Total.</p>
<h2 id="packed-executables">Packed Executables</h2>
<p><strong>Packed executables</strong> are almoust 100% indicator that the author didn&rsquo;t want his treasure to be reverse engineered. Why could this be? Because it&rsquo;s some software with a portion of client-side code that performs sensitive operations. One example of a legitimate software is a program that generates OTP codes. There are several ways to determine that a file is packed. The first one - using enthropy analysis against the file. Consider, that most program epilogues start with <code>55 8B EC</code> (<code>push ebp mov ebp, esp</code>) and end with <code>c3</code> (<code>ret</code>).  That means that the number of both in one executable should be relatively the same. Compressed files don&rsquo;t compress well. Another example is to pack the file and determine, how efficiently was it packed. If it wasn&rsquo;t possible to pack the file too much, it&rsquo;s probable that the file is already packed. 🛠 Use the first method with <a href="https://www.aldeid.com/wiki/PEiD">PEiD</a> (GUI Windows tool), use the second method with <code>pescan</code> (commercial cross-platform tool).</p>
<h2 id="pe-sections">PE Sections</h2>
<p>Weired names for <strong>PE sections</strong>. PE sections (for Windows) are usually <code>text</code>, <code>bss</code>, <code>data</code> etc. If you some gibberish that&rsquo;s not usually seen here, most likely the executable is packed.</p>
<h2 id="virtual-vs-physical-addresses">Virtual vs Physical Addresses</h2>
<p><strong>VA vs PA</strong>. Empty Physical addresses for sections (while VA are not empty).</p>
<h1 id="-updated-upstreamcontentdocsreversemalware-analysistipsindicatorsmd">&laquo;&laquo;&laquo;&lt; Updated upstream:content/docs/reverse/malware-analysis/tips/indicators.md</h1>
<h2 id="librariries-and-methods">Librariries and Methods</h2>
<table>
<thead>
<tr>
<th>Library</th>
<th>common use</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>kernell32.dll</code>, <code>advapi.dll</code>, <code>ntdll.dll</code></td>
<td>These three libraries are used for communicating with the kernel and basic functions, like openinng files, creating proccessing, manipulating hardware etc. <code>advapi.dll</code> is for advanced functionality like registry and service manager. <code>ntdll.dll</code> is pretty much the same as <code>kernell32.dll</code> (since the latter used the former in its imports) but more low-level and advanced. It&rsquo;s rarely imported directly, usually, <code>kernell32.dll</code> imports it. Its direct import might be an indicator of hiding functionality.</td>
</tr>
<tr>
<td><code>user32.dll</code>, <code>gdi32.dll</code></td>
<td>These are for GUI. <code>user32.dll</code> is for buttons and stuff, while <code>gdi32.dll</code> is for general graphics settings.</td>
</tr>
<tr>
<td><code>WSock32.dll</code>, <code>ws2_32.dll</code>, <code>wininet.dll</code></td>
<td><code>WSock32.dll</code> and <code>ws2_32.dll</code> are for general networing functionality like opening sockets, while <code>wininet.dll</code> is more high-level (FTP, HTTP, NTP protocols etc).</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Function imported</th>
<th>Usual usage in malware</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="throubleshooting-malware">Throubleshooting malware</h2>
<ul>
<li>If it&rsquo;s a dll, it can be still ran independently.  Though there are no guaratees, there are two ways to acomplish that (either can work for you):
<ul>
<li>use <code>rundll32</code> (<code>rundll32 [dllname].dll, [function name or ordeal]</code>). Example, a <code>malware.dll</code> that has a function <code>InstallService</code> which requires an argument service name. We want to launch it, call this function to create a service with name &ldquo;MaliciousService&rdquo;: <code>rundll32 malware.dll, MaliciousService</code>. In Dependency Walker we can peek the function&rsquo;s ordeal and run this command like this (if the ordeal is, say, 5): <code>rundll32 malware.dll, #5</code>.</li>
<li>patch PE header of the dll + changing its extension. <code>IMAGE_FILE_HEADER</code> -&gt; <code>CHARACTERISTICS</code> &ndash;&gt; <code>IMAGE_FILE_DLL</code> flag <code>0x2000</code> set to <code>0x0000</code>.</li>
</ul>
</li>
<li><code>ServiceMain</code> without any <code>Install</code> function.
<ul>
<li>Use <code>sc</code> command</li>
<li><code>HKLM/SYSTEM/CurrentControlSet\Services</code> - modify the registry</li>
</ul>
</li>
</ul>
<h2 id="interesting-places-to-check">Interesting places to check</h2>
<ul>
<li><code>.rsrc</code> section usually contains such resources as icons, pictires etc. However, some malicious programs (as well as legitimate ones) can store a driver or other code there which gets extracted and executed by the main progam flow.</li>
</ul>
<h2 id="naming-conventions">Naming conventions</h2>
<ul>
<li>On Windows systems some functions have a suffix <code>A</code> or <code>W</code>. These indicate that this function accepting ASCII or wide character string as an argument respectively.</li>
<li>On Windows systems some functions have a suffix <code>Ex</code> or even <code>ExEx</code>. These indicate that Windows has released a new version of a function which is not compatible with older ones, since older ones must be supported.</li>
</ul>
<h2 id="how-to-find-out-">How to find out &hellip;</h2>
<ul>
<li>&hellip; which processes used a certain dll ❓ In <a href="/docs/toolkit/general/reverse-toolkit/#process-explorer">Process Explorer</a> choose <code>Find Handle or DLL</code>.</li>
<li>&hellip; if a DLL is loaded into a process after load time ❓ Compare the DLL list in <a href="/docs/toolkit/general/reverse-toolkit/#process-explorer">Process Explorer</a> to the imports shown in <a href="/docs/toolkit/general/reverse-toolkit/#dependency-walker">Dependency Walker</a>.</li>
<li>&hellip; if a <code>.doc</code> or <code>.pdf</code> or another document is malicious ❓ Open <a href="/docs/toolkit/general/reverse-toolkit/#process-explorer">Process Explorer</a>, launch the suspicios doc in sandboxed environment and check whether it has spawned any processes. Open this process&rsquo;s <code>Properties</code> window, <code>Image</code> tab to check the location of the malware file.</li>
<li>If there is an open socket, you can open <code>nc -nv &lt;IP&gt; &lt;port&gt;</code> to see what it wants to get.</li>
<li>If the malware is looking for a DNS record and iNetSim doesn&rsquo;t work (because it&rsquo;s something very custom), try adding <code>127.0.0.1  &lt;DNS name&gt;</code> and observing the activity with a tool like ProcMon. Then, do <code>ncat -nvlp &lt;port&gt;</code>. Try <code>ipconfig /flushdns</code> (Windows) if this doesn&rsquo;t help.</li>
<li>If process injection took place, find the victim in Process Hacker (or some analogue) and open Properties -&gt; Memory. Sort by Protection and find all that have RWX permissions (that&rsquo;s usually what a shellcode will require to run). No name in the Use column usually indicates.</li>
</ul>
<h2 id="tools">Tools</h2>
<ul>
<li>ProcMon (Sysinternals) for Windows and Glances for macOS <a href="https://nicolargo.github.io/glances/">https://nicolargo.github.io/glances/</a>, osquery, Instruments, vtop. Also try <code>opensnoop</code>, but with SIP off.</li>
</ul>
<h2 id="malware-databases">Malware Databases</h2>
<h2 id="tools-1">Tools</h2>
<p>A great resource with code snippets and techniques - <a href="https://unprotect.it/technique/vmprotect/">https://unprotect.it/technique/vmprotect/</a>.</p>
<h3 id="repos">Repos</h3>
<ul>
<li>theZoo: <a href="https://github.com/ytisf/theZoo">https://github.com/ytisf/theZoo</a></li>
<li>VXUnderground GitHub repo: <a href="https://github.com/vxunderground/MalwareSourceCode">https://github.com/vxunderground/MalwareSourceCode</a></li>
<li>Zeltser Resources: <a href="https://zeltser.com/malware-sample-sources/">https://zeltser.com/malware-sample-sources/</a></li>
<li></li>
</ul>
<p><a href="https://app.any.run/submissions/">https://app.any.run/submissions/</a>
<a href="https://github.com/Endermanch/MalwareDatabase">https://github.com/Endermanch/MalwareDatabase</a>
<a href="https://bazaar.abuse.ch/browse.php?search=tag%3AMami">https://bazaar.abuse.ch/browse.php?search=tag%3AMami</a>
<a href="https://success.trendmicro.com/dcx/s/solution/TP000091942-ThreatDV-Malware-Filter-Package-1429?language=en_US">https://success.trendmicro.com/dcx/s/solution/TP000091942-ThreatDV-Malware-Filter-Package-1429?language=en_US</a>
<a href="https://thezoo.morirt.com/">https://thezoo.morirt.com/</a>
<a href="https://zeltser.com/malware-sample-sources/">https://zeltser.com/malware-sample-sources/</a></p>
<h3 id="info">Info</h3>
<p>Try MISP API - <a href="https://www.misp-project.org/openapi/#tag/Attributes/operation/restSearchAttributes">https://www.misp-project.org/openapi/#tag/Attributes/operation/restSearchAttributes</a>.</p>
<p><a href="https://www.hybrid-analysis.com/sample/9fe55c51af6230c8640e140104645b32ba83ac868bf0f1571733f14761701247">https://www.hybrid-analysis.com/sample/9fe55c51af6230c8640e140104645b32ba83ac868bf0f1571733f14761701247</a>
<a href="https://www.f-secure.com/v-descs/trojan-spy_w32_finspy_a.shtml">https://www.f-secure.com/v-descs/trojan-spy_w32_finspy_a.shtml</a>
<a href="https://malshare.com/">https://malshare.com/</a></p>
<p>Malicious websites: <a href="https://zeltser.com/lookup-malicious-websites/">https://zeltser.com/lookup-malicious-websites/</a></p>
<p><a href="https://mail.google.com/mail/u/0/#inbox">https://mail.google.com/mail/u/0/#inbox</a></p>
<p>My <a href="https://peat-chameleon-e41.notion.site/Malware-DB-25248c9f91bd49b8ba0e869f465f626a">own</a> is maintained in Notion for now. Planning to turn this into a SQL DB + CLI.</p>
<h3 id="network">Network</h3>
<p><a href="https://malware-traffic-analysis.net">https://malware-traffic-analysis.net</a>
<a href="https://packettotal.com/malware-archive.html">https://packettotal.com/malware-archive.html</a></p>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>Stashed changes:content/docs/reverse/malware-analysis/tips.md</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<h2 id="general-guidelines">General Guidelines</h2>
<p><strong>Signed executable</strong>. It&rsquo;s a rare case, but it exists. Around 3% of malware is <strong>signed</strong>. It&rsquo;s due to the fact that some systems require executables to be signed. But this technique is not very good for malware authors since when at least one &ldquo;product&rdquo; is marked as malicious, all code that was signed with the same certificate will be identified as well. 🛠 Use <code>sigcheck</code> to check signatures and hashes against Virus Total.</p>
<p>Check with a <code>spctl</code> if the given application (not yet installed) is notarized by Apple.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">spctl -a -vvv -t install /Volumes/BurpSuitePro/Burp<span class="se">\ </span>Suite<span class="se">\ </span>Professional.app 
</span></span><span class="line"><span class="cl">/Volumes/BurpSuitePro/Burp Suite Professional.app: accepted
</span></span><span class="line"><span class="cl"><span class="nv">source</span><span class="o">=</span>Notarized Developer ID
</span></span><span class="line"><span class="cl"><span class="nv">origin</span><span class="o">=</span>Developer ID Application: PortSwigger Ltd <span class="o">(</span>N82YM897DZ<span class="o">)</span>
</span></span></code></pre></div><p><strong>Strings</strong>. Check <strong>strings</strong> in <code>Image</code> and in <code>Memory</code> using the corresponding radio button on the <code>Strings</code> tab of a selected process info in Process Explorer. If they differ - process replacement tool place. Use 🛠 <code>strings</code> or <code>floss</code> (decodes them as well)</p>
<p>Interesting strings:</p>
<ul>
<li><code>pdb</code> files (often contain username and can also give a hint on the malware writer&rsquo;s country of origin)</li>
<li>URLs</li>
<li>Something that looks like a password</li>
<li>emails</li>
<li>Base64 encoded things</li>
<li>library names</li>
</ul>
<p><strong>32 bit application.</strong> For backward compatibility for older machines, malware authors prefer compiling 32bit applications. Since malware authors usually want their software to work on as many machines as possible, they often compile <strong>32bit code</strong>. That&rsquo;s not a decent indicator by itself, but it&rsquo;s a good additional score.</p>
<p><strong>Location</strong>. It might be atypical location for <code>svchost.exe</code> in Documents forlder. You&rsquo;ll need to know what&rsquo;s ok and good for the given system. May user SANS poster <em>Find Evil</em>. Common locations for malware: <code>Windows\System32</code> is a very important location since it allows running with elevated privileges? ❓❓❓Also <code>Temp</code> folder and <code>Temp Internet Files</code>. <code>Windows</code>, <code>Windows SxS</code>. Recycle bin also may contain some files or remnants. <code>Program files</code> is the most usual for programs and malware may reside there as well.<code>System Volume Information</code>. That doesn&rsquo;t mean, however, that malware can&rsquo;t be elsewhere. Some core Windows executables don&rsquo;t even have an image file on disk (System, IDLE, for example).</p>
<p><strong>Suspicious time</strong>. Created at suspicious time? Launch time suspicious?</p>
<p><strong>Suspicious name</strong>. For example, name exactly like or very similar to some core system process? Strange name similar to leg one? <code>svchosts</code>, for example. Present in <code>psscan</code> but absent in <code>pslist</code> (for running processes)? Read more about RAM forensics in the corresponding section. It&rsquo;s usual for malware to mistype the names if common wincore processes or use the same names in weird locations. Name mangling is a common technique.</p>
<p><strong>Signs of reconnaissance stage</strong>.</p>
<p><strong>Runtime linking</strong>. Since static linking is rare (it increases the body of a program) and dynamicly linked functions can be inspected in different ways, runtime linking might be a choice for malware authors to hide the functionality. How to determine if the runtime linking is used?<em>❓Windows, Mac, Linux?</em> <strong>Importing</strong> and using <code>GetProcessAddress</code>/<code>LdrGetProcessAddress</code> or/and <code>LoadLibrary</code>/<code>LdrLoadDll</code>.</p>
<p><strong>Packed executables</strong>. Almoust 100% indicator that the author didn&rsquo;t want his treasure to be reverse engineered. Why could this be? Because it&rsquo;s some software with a portion of client-side code that performs sensitive operations. One example of a legitimate software is a program that generates OTP codes. There are several ways to determine that a file is packed. The first one - using enthropy analysis against the file. Consider, that most program epilogues start with <code>55 8B EC</code> (<code>push ebp mov ebp, esp</code>) and end with <code>c3</code> (<code>ret</code>).  That means that the number of both in one executable should be relatively the same. Compressed files don&rsquo;t compress well. Another example is to pack the file and determine, how efficiently was it packed. If it wasn&rsquo;t possible to pack the file too much, it&rsquo;s probable that the file is already packed. 🛠 Use the first method with <a href="https://www.aldeid.com/wiki/PEiD">PEiD</a> (GUI Windows tool), use the second method with <code>densityscan</code> (commercial cross-platform tool). Below are some common preliminary indicators of packed executables:</p>
<ul>
<li><input disabled="" type="checkbox"> <strong>VA vs PA</strong>. Empty Physical addresses for sections (while VA are not empty). More about virtual and physical addresses in the reverse engineering section.</li>
<li><input disabled="" type="checkbox"> Weired names for <strong>PE sections</strong>. PE sections (for Windows) are usually <code>text</code>, <code>bss</code>, <code>data</code> etc. If you some gibberish that&rsquo;s not usually seen here, most likely the executable is packed.</li>
</ul>
<p><strong>Hash</strong>. The first and dummiest way, but highly suggested is to check the file hash against VirusTotal database. This way you&rsquo;ll eliminate <strong>known good</strong> files, since it&rsquo;s highly unlikely that a legitimate software like Windows files have never been checked so far. Also, this way you can find <strong>known bad</strong>.</p>
<p><strong>Byte-level signatures.</strong> May be you have some signatures left from previous malware.</p>
<p><strong>Name</strong>. In order to spot deviations at that point you need to have a firm understanding of what&rsquo;s normal for that particular system. There are some common &ldquo;normalities&rdquo; for different OSes, of course, as well. You can refer to SANS poster &ldquo;Find Evil&rdquo; which is often updated, SDF Podcast of Michael Leclair about Windows Core Processes, or find the corresponding article about core processes and system supernova in the Technical Reference section of this website.</p>
<p><strong>Unexpected owners</strong>. Check the account it being run from. The most commonly used are: local system account, network service account, local service account. If any of the core processes is run from a user account, it&rsquo;s a possible sign of compromise. 👣 <strong>For Windows</strong>:</p>
<p><strong>Unexpected parent</strong>. Each executable is run by some other executable. For core processes there is only one legitimate parent. 👣 <strong>For Windows</strong>: <code>wininit</code> doesn&rsquo;t have a parent, while <code>sms.exe</code> is the child of System. Read more about core processes for each specific OS in a separate section.</p>
<p><strong>Hidden by WinAPI</strong>.</p>
<p><strong>Process taken over</strong>. <a href="https://www.linkedin.com/pulse/process-injection-detection-malfind-britton-manahan/">https://www.linkedin.com/pulse/process-injection-detection-malfind-britton-manahan/</a></p>
<p><strong>On-disk and in-memory contents don&rsquo;t match</strong>.</p>
<p><strong>Unusual behaviour and resources</strong>. Suspicious files opened, netwrk ports and connections, OS resources (mutexes, hooks etc), significant amount of CPU or RAM? <code>.rsrc</code> section usually contains such resources as icons, pictires etc. However, some malicious programs (as well as legitimate ones) can store a driver or other code there which gets extracted and executed by the main progam flow. If you suspect that a dinamically linked library was loaded into a process after load time, compare the import list in <a href="/docs/toolkit/general/reverse-toolkit/#process-explorer">Process Explorer</a> to the imports shown in <a href="/docs/toolkit/general/reverse-toolkit/#dependency-walker">Dependency Walker</a> (Windows, for other OS use analogous tools). <code>radare2</code> and <code>IDA</code> can also show imports.</p>
<p>One of the usefull resources (Windows API docs, of course) and also <a href="https://malapi.io/">https://malapi.io/</a> (from the malware perspective).</p>
<table>
<thead>
<tr>
<th>Function imported</th>
<th>Usual usage in malware</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Network triage</strong>. Check network activity for malicious stuuff.</p>
<p><strong>Singleton</strong>. One instance running only. 👣 <strong>For Windows</strong>: One instance <code>lsass</code>, <code>services</code>, <code>System</code>, <code>winint</code>, <code>lsm.exe</code> ❓. If any of these having more than 1 process should be the object of further investigation.</p>
<p><strong>Boot time</strong>.  Core processes boot at certain time after boot. Anomalies here might be a good indicator of compromise. 👣 <strong>For Windows</strong>: <code>sms</code> starts at boot, for example.</p>
<p><strong>PID</strong>. Some core processes might have a predefined PID. 👣 <strong>For Windows</strong>: System usually has PID 4.</p>
<p><strong>Injections</strong>. <a href="https://www.linkedin.com/pulse/process-injection-detection-malfind-britton-manahan/">https://www.linkedin.com/pulse/process-injection-detection-malfind-britton-manahan/</a></p>
<h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    Something here
</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
