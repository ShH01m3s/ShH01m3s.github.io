<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analysis Tricks - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/reverse/malware-analysis/tips/"> ğŸ‘ˆğŸ¼ Back to </br> Analysis Tips and Tricks </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#windows">Windows</a>
      <ul>
        <li><a href="#how-to-find-out-">How to find out &hellip;</a></li>
        <li><a href="#delphi">Delphi</a></li>
        <li><a href="#go">Go</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Analysis Tricks</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 28.07.2022
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p><em>This is about &hellip; .</em></p>
<h2 id="windows">Windows</h2>
<h3 id="how-to-find-out-">How to find out &hellip;</h3>
<ul>
<li>&hellip; which processes used a certain dll â“ In <a href="/docs/toolkit/general/reverse-toolkit/#process-explorer">Process Explorer</a> choose <code>Find Handle or DLL</code>.</li>
<li>&hellip; if a DLL is loaded into a process after load time â“ Compare the DLL list in <a href="/docs/toolkit/general/reverse-toolkit/#process-explorer">Process Explorer</a> to the imports shown in <a href="/docs/toolkit/general/reverse-toolkit/#dependency-walker">Dependency Walker</a>.</li>
<li>&hellip; if a <code>.doc</code> or <code>.pdf</code> or another document is malicious â“ Open <a href="/docs/toolkit/general/reverse-toolkit/#process-explorer">Process Explorer</a>, launch the suspicios doc in sandboxed environment and check whether it has spawned any processes. Open this process&rsquo;s <code>Properties</code> window, <code>Image</code> tab to check the location of the malware file.</li>
<li>If there is an open socket, you can open <code>nc -nv &lt;IP&gt; &lt;port&gt;</code> to see what it wants to get.</li>
<li>If the malware is looking for a DNS record and iNetSim doesn&rsquo;t work (because it&rsquo;s something very custom), try adding <code>127.0.0.1  &lt;DNS name&gt;</code> and observing the activity with a tool like ProcMon. Then, do <code>ncat -nvlp &lt;port&gt;</code>. Try <code>ipconfig /flushdns</code> (Windows) if this doesn&rsquo;t help.</li>
<li>If process injection took place, find the victim in Process Hacker (or some analogue) and open Properties -&gt; Memory. Sort by Protection and find all that have RWX permissions (that&rsquo;s usually what a shellcode will require to run). No name in the Use column usually indicates.</li>
</ul>
<h3 id="delphi">Delphi</h3>
<p>This one is particularily tiresome to reverse. Some advice:</p>
<ul>
<li>Set calling convention for fastcall if it&rsquo;s not set properly (IDA Pro doesn&rsquo;t, not sure about radare2)</li>
<li>Delphi programs have a lot of structures.</li>
</ul>
<h3 id="go">Go</h3>
<ul>
<li>When compiled are huge in size.</li>
<li></li>
</ul>
<h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    <p>[<a href="">1</a>] Practical Malware Analysis, M. Silkorski, A. Honig</p>
<p>[<a href="https://www.sans.org/posters/malware-analysis-and-reverse-engineering-cheat-sheet/">2</a>] SANS cheatsheet on malware analysis</p>
<p>[<a href="https://www.sans.org/posters/tips-for-reverse-engineering-malicious-code/">3</a>] SANS tips on malware analysis</p>
<p>Automating the Process. Use Jupyter Notebooks and malware sandboxes to automate the analysis process.
Tell the World! Write YARA rules to aid in the detection of malware samples and learn how to write effective analysis reports to publish findings.</p>
<p>Wardle, Patrick. The Art of Mac Malware (p. xxii). No Starch Press. Kindle Edition.
<a href="https://www.magnetforensics.com/resources/investigate-malware-ransomware-with-speed-and-efficiency/">https://www.magnetforensics.com/resources/investigate-malware-ransomware-with-speed-and-efficiency/</a></p>
<p>[1] Practical Malware Analysis, M. Silkorski, A. Honig</p>
<p>[2] <a href="https://www.sans.org/posters/malware-analysis-and-reverse-engineering-cheat-sheet/">SANS cheatsheet on malware analysis</a></p>
<p>[<a href="https://www.sans.org/posters/tips-for-reverse-engineering-malicious-code/">3</a>] SANS tips on malware analysis</p>

</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
