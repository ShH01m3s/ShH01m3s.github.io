<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Exploit Development - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/reverse/exploits/"> 👈🏼 Back to </br> ⚙️ Exploits </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#process">Process</a>
      <ul>
        <li><a href="#steps-overview">Steps Overview</a></li>
        <li><a href="#heading"></a></li>
        <li><a href="#bad-characters">Bad Characters</a></li>
      </ul>
    </li>
    <li><a href="#-rtfm">📕 RTFM</a>
      <ul>
        <li><a href="#scanning-for-samba-shares">Scanning for SAMBA shares</a></li>
        <li><a href="#rpc">RPC</a></li>
      </ul>
    </li>
    <li><a href="#-toolkit">🧰 Toolkit</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Exploit Development</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      <div class="article-category">
          
            
            
            
            
            
              <i class="fab fa-linux"></i>&nbsp;<i class="fab fa-apple"></i>&nbsp;<i class="fab fa-windows"></i>&nbsp;<i class="fas fa-mobile"></i>
            
            
          
          
      </div> <br />
      

      
      

      
      <div class="article-tag">
          <i class="fas fa-tag"></i>
          
          
          <a class="tag-link" href="/tags/reverse" rel="tag">reverse</a>
          
      </div> 
      
    </div>
    
    <b>Created:</b> 27.09.2020
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <h2 id="process">Process</h2>
<h3 id="steps-overview">Steps Overview</h3>
<ol>
<li>Fuzz and fins unusual behaviour</li>
<li>Detect any possibility to overwrite crucial parts:
<ol>
<li>EIP</li>
<li>SEH</li>
<li>Acces violations/invalid memory addresses</li>
<li>etc</li>
</ol>
</li>
<li>Hijack Execution</li>
<li>Eliminate bad characters</li>
<li>Write PoC, spawning a reverse or bind shell, RAT or move to other systems.</li>
</ol>
<h3 id="heading"></h3>
<h3 id="bad-characters">Bad Characters</h3>
<p>All characters from 0 to 255 (decimal) represented in a hex format like this: <code>/0x00/0x01...</code>.</p>
<h2 id="-rtfm">📕 RTFM</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msf-pattern_create -l <span class="m">1400</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;POST&#34;</span><span class="k">$(</span>mapstr<span class="k">)</span> <span class="p">|</span> nc -nv 127.0.0.1:8080
</span></span><span class="line"><span class="cl">msf-pattern_offset -q &lt;part of mapstr in EIP&gt;
</span></span></code></pre></div><p><a href="http://docs.pwntools.com/en/stable/index.html">http://docs.pwntools.com/en/stable/index.html</a> and an example of use - <a href="https://www.megabeets.net/a-journey-into-radare-2-part-2/">https://www.megabeets.net/a-journey-into-radare-2-part-2/</a>.</p>
<blockquote>
<p>⛔️ I was getting the following error when trying to install the framework on my workstation: <code>Error: Failure while executing; /bin/ln -h -f -s -- /opt/metasploit-framework/bin/msfvenom /opt/homebrew/bin/msfvenom was terminated by uncaught signal KILL.</code>. I could not understand what I was doing wrong, but it turned out that this is CS Falcon&rsquo;s handiwork.</p>
</blockquote>
<h3 id="scanning-for-samba-shares">Scanning for SAMBA shares</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmap -p <span class="m">445</span> --script<span class="o">=</span>smb-enum-shares.nse,smb-enum-users.nse 10.10.3.97
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># access the share</span>
</span></span><span class="line"><span class="cl">smbclient //&lt;ip&gt;/&lt;sharesname&gt;
</span></span><span class="line"><span class="cl"><span class="c1"># when prompted for a password, try hitting Enter (in case there is no password)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># download all the files recursevely</span>
</span></span><span class="line"><span class="cl">smbget -R smb://&lt;ip&gt;/anonymous
</span></span></code></pre></div><h3 id="rpc">RPC</h3>
<blockquote>
<p>This is just a server that converts remote procedure call (RPC) program number into universal addresses. When an RPC service is started, it tells rpcbind the address at which it is listening and the RPC program number its prepared to serve.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmap -p <span class="m">111</span> --script<span class="o">=</span>nfs-ls,nfs-statfs,nfs-showmount 10.10.3.97
</span></span></code></pre></div><h2 id="-toolkit">🧰 Toolkit</h2>
<ul>
<li>peda - python module for gdb for exploit development (Linux).</li>
<li><a href="">radare2</a>, <a href="https://reverseengineering.stackexchange.com/questions/16428/debugging-with-radare2-using-two-terminals/16430#16430">debugging in two terminals</a></li>
<li>gdb, gdb-peda (<a href="https://github.com/cs01/gdbgui/issues/55">certificate</a>)</li>
<li><a href="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06c-reverse-engineering-and-tampering#angr">Angr</a></li>
</ul>
<h2 id="references">References</h2>
<p>Hacking: the Art of Exploitation</p>
<p><a href="https://www.udemy.com/course/introduction-to-exploitzero-day-discovery-and-development/learn/lecture/17856092#overview">https://www.udemy.com/course/introduction-to-exploitzero-day-discovery-and-development/learn/lecture/17856092#overview</a></p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
