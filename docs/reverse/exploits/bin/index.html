<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Binary Vulnerabilities And Exploits - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/reverse/exploits/"> ğŸ‘ˆğŸ¼ Back to </br> Exploits </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#type-safety">Type Safety</a></li>
    <li><a href="#integer-overflow">Integer Overflow</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Binary Vulnerabilities And Exploits</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
              <i class="fas fa-microchip"></i>
              
          <a class="category-link" href="/domain/reverse">reverse</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p><em>In this article I will collect common binary vulnerability (expept for the bufferoverflow which has its own dedicated article) &hellip; .</em></p>
<h2 id="type-safety">Type Safety</h2>
<p>There are programming languages which are type safe and which are not. Ruby and Python are type-safe because there is only 1 type - dynamic. All operations are permitted, but no all are implemented. In case of analogous code, there still will be an error, but that does not lead to a vulnerability.</p>
<p>What does that mean really? Consider the code snippet below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="kt">int</span><span class="p">(</span><span class="o">*</span><span class="n">cmp</span><span class="p">)(</span><span class="kt">char</span><span class="o">*</span><span class="p">,</span><span class="kt">char</span><span class="o">*</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="o">*</span><span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span> <span class="c1">//allocate memory on heap and assign p to the this address
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">*</span><span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="c1">// overwrite the address with number 1, i.e. invalid address
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">cmp</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="kt">char</span><span class="o">*</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span><span class="p">))</span><span class="n">p</span><span class="p">;</span> <span class="c1">//cast pointer to function pointer and assign to cmp variable
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">cmp</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#34;hello&#34;</span><span class="p">,</span> <span class="s">&#34;bye&#34;</span><span class="p">);</span> <span class="c1">// error, since p doesn&#39;t point to a valid address
</span></span></span></code></pre></div><p>What languages are not type-safe, you might ask? Well, guess. A little hint: almost all serious binary vulnerabilities are C++/C concern and any other language that manipulates memory manually, for that matter.</p>
<h2 id="integer-overflow">Integer Overflow</h2>
<p>On its own its rather benign and useless, so, it&rsquo;s usually comes with something more naughty (over/undersize a buffer, index beyond bounds).</p>
<p>Consider the snippet below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">copy</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">buffer_arg</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="n">buff_var</span><span class="p">[</span><span class="mi">800</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&gt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buff_var</span><span class="p">))</span> <span class="n">ret</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">memcpy</span><span class="p">(</span><span class="n">buff_var</span><span class="p">,</span> <span class="n">buffer_arg</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span><span class="p">;</span>	
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Variable <code>int</code> is unsigned integer, which means that it can&rsquo;t be <code>-1</code>. However, if you try assigning <code>-1</code> to it, it will be turned into <code>255</code> (2s compliment). It&rsquo;s a different topic, how exactly numbers get their lovely little minus, out of scope of this article, but in scope of another (<a href="/docs/reverse/basics/positive-and-negative-numbers/">see</a>).</p>
<p>When a computer sees a signed integer compared to an unsigned, it will interpret <code>int</code> as <code>uint</code> instead and thus will turn it into a positive number. Believe me, it will find a way to look at it in a <em>positive</em> light (computers all but pessimists ğŸ˜‚). So, <code>-1</code> will magically turn into <code>255</code> like a pumpkin ğŸƒ into a carriage ğŸš”.</p>
<p><img src="images/signed-to-unsigned.png" alt="img"></p>
<p>You can try yourself <a href="https://onlinetoolz.net/unsigned-signed#base=10&amp;value=-1&amp;bits=8">here</a>.</p>
<p>Say, some program flow led to <code>int len=-1</code> somehow. And let&rsquo;s say that <code>sizeof(buff_var)</code> equals <code>800</code>. What will a computer see when executing <code>len &gt; sizeof(buff_var)</code>? Since <code>sizeof()</code> returns <code>uint</code>, it will see roughly the following: <code>â—ï¸uint len &gt; uint sizeof(buff_var)</code>, or <code>255 &gt; 800</code>. Since <code>255</code> is not greater that <code>800</code>, the code following the <code>if</code> statement will get executed.</p>
<p>Let&rsquo;s ee enother example. Let&rsquo;s say there is a woman with a ğŸ‘œ bag wants to put a lot of purely lady stuff inside: ğŸ—, ğŸ’·, ğŸ’„, ğŸ©¹, ğŸ“™, ğŸ–Œ, ğŸª“, so, 7 items.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">ushort</span> <span class="n">items_to_stash</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">bag_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="err">ğŸ‘œ</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// a simple check that we have the required amount of arguments (irrelevant for this discussion)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">bag_size</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="n">items_to_stash</span> <span class="o">=</span> <span class="n">bag_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// this bag is limited to 7 items, it can&#39;t have more. Can it?
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="n">items_to_stash</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// items_to_stash is ushort, i.e. it&#39;s unsigned and can be less than 0. However, bag_size (which was the original value, is int). So, we use it as an unsigned when comparing and then we will use the int (signed) version of it when performing the actual copy process.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;Hey! This bag is not the one Hermione had!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">printf</span><span class="p">(</span><span class="s">&#34;That&#39;s the way, well done. Put the axe back :) Ladies don&#39;t carry them at leisure.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">memcpy</span><span class="p">(</span><span class="err">ğŸ‘œ</span><span class="p">,[</span><span class="err">ğŸ—</span><span class="p">,</span><span class="err">ğŸ’·</span><span class="p">,</span><span class="err">ğŸ’„</span><span class="p">,</span><span class="err">ğŸ©¹</span><span class="p">,</span><span class="err">ğŸ“™</span><span class="p">,</span><span class="err">ğŸ–Œ</span><span class="p">,</span><span class="err">ğŸª“</span><span class="p">],</span><span class="n">bag_size</span><span class="p">);</span> <span class="c1">// here is the copying itself
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span></code></pre></div><p>With <code>atoi(arg[1])</code> we get the second argument passed to our program (which would be the bag&rsquo;s ğŸ‘œ capacity). This value is saved to <code>int bag_size</code> variable that can get less than <code>0</code>. Then, for some unknown and reason that eludes me totally, this gets copied into a <code>ushort</code> (unsigned) <code>items_to_stash</code> variable which is then used to perform comparisson. Since <code>7</code> is considered to be signed, <code>ushort items_to_stash</code> temporarily transforms into <code>short items_to_stash</code> (invisible to us, but still).</p>
<p>The same problem outlined above would happen here should <code>bag_size</code> get below <code>0</code> ğŸ¥¶ for some reason â„ï¸.</p>
<h2 id="references">References</h2>
<details>
    <summary>Expand &hellip;</summary>
    Something here
</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
