<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Interview Prep - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-dfir üîç">
      <a href="/docs/dfir">
        <span>DFIR üîç</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-reverse üîß">
      <a href="/docs/reverse">
        <span>Reverse üîß</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit üß∞">
      <a href="/docs/toolkit">
        <span>Toolkit üß∞</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ü™§">
      <a href="/docs/thunting">
        <span>Threat Hunting ü™§</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference üìö">
      <a href="/docs/reference">
        <span>Tech Reference üìö</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-dfir üîç">
      <a href="/docs/dfir">
        <span>DFIR üîç</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-reverse üîß">
      <a href="/docs/reverse">
        <span>Reverse üîß</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit üß∞">
      <a href="/docs/toolkit">
        <span>Toolkit üß∞</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ü™§">
      <a href="/docs/thunting">
        <span>Threat Hunting ü™§</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference üìö">
      <a href="/docs/reference">
        <span>Tech Reference üìö</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/notes/"> üëàüèº Back to </br> Notes </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#resources">Resources</a></li>
    <li><a href="#coding">Coding</a>
      <ul>
        <li><a href="#strings">Strings</a>
          <ul>
            <li><a href="#unique-strings">Unique strings</a></li>
            <li><a href="#permutations">Permutations</a></li>
            <li><a href="#replace-urlify">Replace (URLify)</a></li>
            <li><a href="#compressor">Compressor</a></li>
            <li><a href="#permutations-palindrome">Permutations Palindrome</a></li>
            <li><a href="#similar-strings">Similar Strings</a></li>
          </ul>
        </li>
        <li><a href="#web-scraper">Web Scraper</a>
          <ul>
            <li><a href="#port-scanner">Port Scanner</a></li>
          </ul>
        </li>
        <li><a href="#security-themed-coding-challenges">Security Themed Coding Challenges</a></li>
      </ul>
    </li>
    <li><a href="#theory">Theory</a>
      <ul>
        <li><a href="#networking">Networking</a></li>
        <li><a href="#web-application">Web Application</a></li>
        <li><a href="#infrastructure-prod--cloud-virtualisation">Infrastructure (Prod / Cloud) Virtualisation</a></li>
        <li><a href="#os-implementation-and-systems">OS Implementation and Systems</a></li>
        <li><a href="#mitigations">Mitigations</a></li>
        <li><a href="#cryptography-authentication-identity">Cryptography, Authentication, Identity</a></li>
        <li><a href="#malware--reversing">Malware &amp; Reversing</a></li>
        <li><a href="#exploits">Exploits</a></li>
        <li><a href="#attack-structure">Attack Structure</a></li>
        <li><a href="#threat-modeling">Threat Modeling</a></li>
        <li><a href="#detection">Detection</a></li>
        <li><a href="#digital-forensics">Digital Forensics</a></li>
        <li><a href="#incident-management">Incident Management</a></li>
        <li><a href="#heading"></a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Google Interview Prep</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p><em>This is about &hellip; .</em></p>
<h2 id="resources">Resources</h2>
<ol>
<li><a href="https://www.coursera.org/professional-certificates/google-cloud-security?action=enroll#courses">https://www.coursera.org/professional-certificates/google-cloud-security?action=enroll#courses</a></li>
<li><a href="https://www.educative.io/courses/grokking-coding-interview-patterns-python/qZnwmQO8ADp">https://www.educative.io/courses/grokking-coding-interview-patterns-python/qZnwmQO8ADp</a></li>
<li><a href="https://github.com/gracenolan/Notes/blob/master/interview-study-notes-for-security-engineering.md">https://github.com/gracenolan/Notes/blob/master/interview-study-notes-for-security-engineering.md</a></li>
</ol>
<h2 id="coding">Coding</h2>
<h3 id="strings">Strings</h3>
<p>I am mostly using Python, so, I need to understand how Python implements string and what&rsquo;s the time and space complexity for string operations. I know that strings are immutable.</p>
<blockquote>
<p>Keep in mind that string.replace() creates a new string, as strings are immutable in Python. So, if you need to make several replacements in a string, consider using a mutable data structure like a list or a StringBuilder (from the io module) to avoid creating multiple new strings and improve performance.</p>
</blockquote>
<blockquote>
<p>üí° A very interesting approach to use bitwise operations to store a set of boolean values with just two bool operations: <code>bit_vector &amp; (1 &lt;&lt; char_code)</code> to check and <code>bit_vector |= (1 &lt;&lt; char_code)</code> to set the bit. I have moved the detailed explanation to the reverse section (reverse -&gt; basics -&gt; assembly)</p>
</blockquote>
<h4 id="unique-strings">Unique strings</h4>
<p>I have come up with several solutions and additionally, I&rsquo;ve worked through one more which is a significant improvement time ans space wise:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># The solution using a hashtable is the most straightforward and simple. Hashtables are the best option when it comes to efficiently searching for duplicates in terms of time complexity. However, hashtables require additional space, which might be an issue in some cases. In this particular situation, it&#39;s not a concern because we only have at most 256 characters to consider, which essentially amounts to O(1) space complexity.</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_if_all_char_unique_1</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">register</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">register</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span> <span class="n">register</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Time complexity: O(n * 1). We move through the string (n) and for each character we do the insert and check operation which requires constant time O(n * 1).</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Space complexity: O(n). We keep an additional structure with the values. In case of a string, with ASCII characters, that would be O(1), constant, since there is a limited number of characters out there. However, in case of, say, numbers, it becomes O(n).</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The same solution but using collections.Counter </span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_if_all_char_unique_counter</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="n">char_count</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="c1"># populate the hashtable, the same as the loop in the previous code snippet.</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">char_count</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="c1"># returns True if all values (`count`) are equal to 1.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># O(n + m) We need to iterate through the whole string which is, of course, O(n) and then iterate through the dictionary on the last line, which is O(m). The total TC thus becomes O(n+m).</span>
</span></span><span class="line"><span class="cl"><span class="c1"># O(n)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_if_all_char_unique_2</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">characters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">characters</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span> 
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">characters</span><span class="p">[</span><span class="n">char_index</span><span class="p">]</span> <span class="o">==</span> <span class="n">characters</span><span class="p">[</span><span class="n">char_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># O(2n + n*log n)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># O(n)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_if_all_char_unique_3</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">:]:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># O(n * m)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># O(1)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># In this solution we still need to iterate over the whole string, that&#39;s why it&#39;s O(n), but the &lt;&lt; &amp; and |= operations are performed in constant time, so, it can be neglected.  The space complexity is O(1) since we do not use any additional data structures to keep track of our results. The bitmap is of constant length and it&#39;s size is so small that it can be neglected as well.</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_if_all_char_unique_4</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">bitmap</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">bitmap</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        <span class="n">bitmap</span> <span class="o">|=</span> <span class="n">mask</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># O(n + 1)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># O(1)</span>
</span></span></code></pre></div><h4 id="permutations">Permutations</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Time Complexity: O(2n + m)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Space Complexity: O(n)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_if_perm_hash_table</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">characters</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">s2</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">characters</span><span class="p">:</span> <span class="n">characters</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">counter</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">counter</span> <span class="ow">in</span> <span class="n">characters</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># O(2n * log n + n) + whatever it takes to get the length of a string O(1) because it&#39;s basically an array. Why is it immutable then? </span>
</span></span><span class="line"><span class="cl"><span class="c1"># O(2n), although, if the string only contains ASCII or Unicode characters, the space complexity is O(1).</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_if_perm_sort</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">s_1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s_2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s_1</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">s_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">s_2</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span>
</span></span></code></pre></div><h4 id="replace-urlify">Replace (URLify)</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># TC: O(n)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># SC: O(n)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">urlfy</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s2">&#34; &#34;</span><span class="p">:</span> <span class="n">result</span> <span class="o">+=</span> <span class="s2">&#34;%20&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span> <span class="n">result</span> <span class="o">+=</span> <span class="n">char</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># This is an improvement only if we are given an array in the first place since </span>
</span></span><span class="line"><span class="cl"><span class="c1"># strings in Python are immutable.</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">urlfy_list</span><span class="p">(</span><span class="n">s_list</span><span class="p">,</span> <span class="n">trueLength</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">l</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">s_list</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">space_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">index</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trueLength</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">:</span> <span class="n">space_count</span> <span class="o">+=</span> <span class="mi">1</span> 
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">index</span> <span class="o">=</span> <span class="n">trueLength</span> <span class="o">+</span> <span class="n">space_count</span> <span class="o">*</span> <span class="mi">2</span> <span class="c1"># the first pointer starts from the end of data structure, including all the additional spaces</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">trueLength</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">):</span> 
</span></span><span class="line"><span class="cl">        <span class="n">l</span><span class="p">[</span><span class="n">trueLength</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="se">\0</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trueLength</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># the second pointer starts from the end of THE ACTUAL string</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">            <span class="n">l</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="n">l</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;2&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="n">l</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;%&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">-</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">            <span class="n">l</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">index</span> <span class="o">-=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> 
</span></span></code></pre></div><h4 id="compressor">Compressor</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">compress</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span> <span class="k">return</span> <span class="n">s</span>
</span></span><span class="line"><span class="cl">    <span class="n">p_1</span><span class="p">,</span> <span class="n">p_2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">p_2</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">s</span><span class="p">[</span><span class="n">p_1</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span><span class="p">[</span><span class="n">p_2</span><span class="p">]:</span> 
</span></span><span class="line"><span class="cl">            <span class="n">p_2</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">p_2</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span> <span class="k">break</span> <span class="c1"># this line is important. Without it I will get overflow error or the wrong number of the characters at the end.</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">p_1</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p_2</span> <span class="o">-</span> <span class="n">p_1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">p_1</span> <span class="o">=</span> <span class="n">p_2</span>
</span></span><span class="line"><span class="cl">        <span class="n">p_2</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span> <span class="k">return</span> <span class="n">s</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="s2">&#34;asdasdasd&#34;</span><span class="p">))</span>
</span></span></code></pre></div><p>I need to use list instead of a string, because the string concatenation might increase the time complexity of the function which is going to be noticable for larger strings.</p>
<h4 id="permutations-palindrome">Permutations Palindrome</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_if_perm_hash_table</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">characters</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">s2</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">characters</span><span class="p">:</span> <span class="n">characters</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">counter</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">counter</span> <span class="ow">in</span> <span class="n">characters</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Time Complexity: O(2n + m)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Space Complexity: O(n)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_if_perm_sort</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">s_1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s_2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s_1</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">s_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">s_2</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="c1"># O(2(n * log n) + n) + whatever it takes to get the length of a string O(1) because it&#39;s basically an array. Why is it immutable then? </span>
</span></span><span class="line"><span class="cl"><span class="c1"># O(2n)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">check_if_perm_sort</span><span class="p">(</span><span class="s2">&#34;asdff&#34;</span><span class="p">,</span> <span class="s2">&#34;fdsaa&#34;</span><span class="p">))</span>
</span></span></code></pre></div><h4 id="similar-strings">Similar Strings</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">is_similar</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">insert_one</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">insert_one</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">replace_one</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">replace_one</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">strike</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">strike</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">            <span class="n">strike</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">insert_one</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">s1_p</span><span class="p">,</span> <span class="n">s2_p</span><span class="p">,</span> <span class="n">strike</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">s1_p</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s2_p</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">s1</span><span class="p">[</span><span class="n">s1_p</span><span class="p">]</span> <span class="o">==</span> <span class="n">s2</span><span class="p">[</span><span class="n">s2_p</span><span class="p">]:</span> 
</span></span><span class="line"><span class="cl">            <span class="n">s1_p</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="n">s2_p</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">strike</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">            <span class="n">strike</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">            <span class="n">s2_p</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">is_similar</span><span class="p">(</span><span class="s2">&#34;abbba&#34;</span><span class="p">,</span> <span class="s2">&#34;abbbb&#34;</span><span class="p">))</span>
</span></span></code></pre></div><h3 id="web-scraper">Web Scraper</h3>
<p>Write a script to scrape information from a website.</p>
<p>The <code>networker.py</code> helper function:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">asyncio</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">aiohttp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">semaphore</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Semaphore</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Process some of the possible errors </span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">process_status_code</span><span class="p">(</span><span class="n">status</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">429</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Trying again...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Something wrong with the session&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Something wrong with the session&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># probably unneccassary for the webscraper</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">process_response_type_async</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s2">&#34;json&#34;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">content_type</span><span class="p">:</span> <span class="k">return</span> <span class="k">await</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="k">await</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">handle_errors</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">response</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">process_status_code</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">429</span><span class="p">:</span> <span class="k">continue</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">response</span><span class="p">,</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Oops! Something went wrong: </span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">wrapper</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@handle_errors</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">send_get_request_async</span><span class="p">(</span><span class="n">endpoint_url</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>  
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">with</span> <span class="n">semaphore</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">        <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">process_response_type_async</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">response</span><span class="p">,</span> <span class="n">data</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@handle_errors</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">send_post_request_async</span><span class="p">(</span><span class="n">endpoint_url</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">json</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>  
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">with</span> <span class="n">semaphore</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">        <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">json</span><span class="p">:</span> <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">endpoint_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span> <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">endpoint_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">process_response_type_async</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">response</span><span class="p">,</span> <span class="n">data</span>
</span></span></code></pre></div><p>The <code>scraper.py</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">networker</span> <span class="k">as</span> <span class="nn">net</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">asyncio</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">get_headers</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">net</span><span class="o">.</span><span class="n">send_get_request_async</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">headings</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">([</span><span class="s1">&#39;h1&#39;</span><span class="p">,</span> <span class="s1">&#39;h2&#39;</span><span class="p">,</span> <span class="s1">&#39;h3&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">heading</span> <span class="ow">in</span> <span class="n">headings</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">heading</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">scrape_all_urls</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">tasks</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;https://bakerst221b.com&#34;</span><span class="p">,</span> <span class="s2">&#34;https://bakerst221b.com/docs/toolkit/&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">get_headers</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="p">{})))</span>
</span></span><span class="line"><span class="cl">    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">scrape_all_urls</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="port-scanner">Port Scanner</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="n">sizeof</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">errno</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">socket</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">closing</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">open_ports</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">scan_ports_sync</span><span class="p">(</span><span class="n">ports</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">ports</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">closing</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">))</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">s</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">connect_ex</span><span class="p">((</span><span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">open_ports</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">open_ports</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="security-themed-coding-challenges">Security Themed Coding Challenges</h3>
<p>These security engineering challenges focus on text parsing and manipulation, basic data structures, and simple logic flows. Give the challenges a go, no need to finish them to completion because all practice helps.</p>
<ul>
<li><input disabled="" type="checkbox"> Cyphers / encryption algorithms
<ul>
<li><input disabled="" type="checkbox"> Implement a cypher which converts text to emoji or something.</li>
<li><input disabled="" type="checkbox"> Be able to implement basic cyphers.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Collect logs (of any kind) and write a parser which pulls out specific details:
<ul>
<li><input disabled="" type="checkbox"> domains - <code>pattern = r'\b((?:(?:[a-zA-Z0-9]+[.])+[a-zA-Z]{2,}))+\b'</code></li>
<li><input disabled="" type="checkbox"> executable names</li>
<li><input disabled="" type="checkbox"> timestamps</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Web scrapers. Write a script to scrape information from a website.</li>
<li><input disabled="" type="checkbox"> Port scanners.
<ul>
<li><input checked="" disabled="" type="checkbox"> Write a port scanner</li>
<li><input disabled="" type="checkbox"> Detect port scanning</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Botnets
<ul>
<li><input disabled="" type="checkbox"> How would you build ssh botnet?</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Password bruteforcer
<ul>
<li><input disabled="" type="checkbox"> Generate credentials and store successful logins.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Scrape metadata from PDFs
<ul>
<li><input disabled="" type="checkbox"> Write a mini forensics tool to collect identifying information from PDF metadata.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Recover deleted items
<ul>
<li><input disabled="" type="checkbox"> Most software will keep deleted items for ~30 days for recovery. Find out where these are stored.</li>
<li><input disabled="" type="checkbox"> Write a script to pull these items from local databases.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Malware signatures
<ul>
<li><input disabled="" type="checkbox"> A program that looks for malware signatures in binaries and code samples.</li>
<li><input disabled="" type="checkbox"> Look at Yara rules for examples.</li>
</ul>
</li>
</ul>
<p>Put your work-in-progress scripts on GitHub and link to them on your resume/CV. Resist the urge to make your scripts perfect or complete before doing this.</p>
<h2 id="theory">Theory</h2>
<h3 id="networking">Networking</h3>
<ul>
<li><input disabled="" type="checkbox"> OSI Model
<ul>
<li><input disabled="" type="checkbox"> Application; layer 7 (and basically layers 5 &amp; 6) (includes API, HTTP, etc).</li>
<li><input disabled="" type="checkbox"> Transport; layer 4 (TCP/UDP).</li>
<li><input disabled="" type="checkbox"> Network; layer 3 (Routing).</li>
<li><input disabled="" type="checkbox"> Datalink; layer 2 (Error checking and frame synchronisation).</li>
<li><input disabled="" type="checkbox"> Physical; layer 1 (Bits over fibre).</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Firewalls
<ul>
<li><input disabled="" type="checkbox"> Rules to prevent incoming and outgoing connections.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> NAT
<ul>
<li><input disabled="" type="checkbox"> Useful to understand IPv4 vs IPv6.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> DNS
<ul>
<li><input disabled="" type="checkbox"> (53)</li>
<li><input disabled="" type="checkbox"> Requests to DNS are usually UDP, unless the server gives a redirect notice asking for a TCP connection. Look up in cache happens first. DNS exfiltration. Using raw IP addresses means no DNS logs, but there are HTTP logs. DNS sinkholes.</li>
<li><input disabled="" type="checkbox"> In a reverse DNS lookup, PTR might contain- 2.152.80.208.in-addr.arpa, which will map to 208.80.152.2. DNS lookups start at the end of the string and work backwards, which is why the IP address is backwards in PTR.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> DNS exfiltration
<ul>
<li><input disabled="" type="checkbox"> Sending data as subdomains.</li>
<li><input disabled="" type="checkbox"> 26856485f6476a567567c6576e678.badguy.com</li>
<li><input disabled="" type="checkbox"> Doesn‚Äôt show up in http logs.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> DNS configs
<ul>
<li><input disabled="" type="checkbox"> Start of Authority (SOA).</li>
<li><input disabled="" type="checkbox"> IP addresses (A and AAAA).</li>
<li><input disabled="" type="checkbox"> SMTP mail exchangers (MX).</li>
<li><input disabled="" type="checkbox"> Name servers (NS).</li>
<li><input disabled="" type="checkbox"> Pointers for reverse DNS lookups (PTR).</li>
<li><input disabled="" type="checkbox"> Domain name aliases (CNAME).</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> ARP
<ul>
<li><input disabled="" type="checkbox"> Pair MAC address with IP Address for IP connections.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> DHCP
<ul>
<li><input disabled="" type="checkbox"> UDP (67 - Server, 68 - Client)</li>
<li><input disabled="" type="checkbox"> Dynamic address allocation (allocated by router).</li>
<li><input disabled="" type="checkbox"> <code>DHCPDISCOVER</code>¬†-&gt;¬†<code>DHCPOFFER</code>¬†-&gt;¬†<code>DHCPREQUEST</code>¬†-&gt;¬†<code>DHCPACK</code></li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Multiplex
<ul>
<li><input disabled="" type="checkbox"> Timeshare, statistical share, just useful to know it exists.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Traceroute
<ul>
<li><input disabled="" type="checkbox"> Usually uses UDP, but might also use ICMP Echo Request or TCP SYN. TTL, or hop-limit.</li>
<li><input disabled="" type="checkbox"> Initial hop-limit is 128 for windows and 64 for *nix. Destination returns ICMP Echo Reply.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Nmap
<ul>
<li><input disabled="" type="checkbox"> Network scanning tool.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Intercepts (PitM - Person in the middle)
<ul>
<li><input disabled="" type="checkbox"> Understand PKI (public key infrastructure in relation to this).</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> ‚ùóÔ∏è VPN
<ul>
<li><input disabled="" type="checkbox"> Hide traffic from ISP but expose traffic to VPN provider.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Tor
<ul>
<li><input disabled="" type="checkbox"> Traffic is obvious on a network.</li>
<li><input disabled="" type="checkbox"> How do organised crime investigators find people on tor networks.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Proxy
<ul>
<li><input disabled="" type="checkbox"> Why 7 proxies won‚Äôt help you.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> BGP
<ul>
<li><input disabled="" type="checkbox"> Border Gateway Protocol.</li>
<li><input disabled="" type="checkbox"> Holds the internet together.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Network traffic tools
<ul>
<li><input disabled="" type="checkbox"> Wireshark</li>
<li><input disabled="" type="checkbox"> Tcpdump</li>
<li><input disabled="" type="checkbox"> Burp suite</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> HTTP/S
<ul>
<li><input disabled="" type="checkbox"> (80, 443)</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> SSL/TLS
<ul>
<li><input disabled="" type="checkbox"> (443)</li>
<li><input disabled="" type="checkbox"> Super important to learn this, includes learning about handshakes, encryption, signing, certificate authorities, trust systems. A good¬†<a href="https://english.ncsc.nl/publications/publications/2021/january/19/it-security-guidelines-for-transport-layer-security-2.1">primer</a>¬†on all these concepts and algorithms is made available by the Dutch cybersecurity center.</li>
<li><input disabled="" type="checkbox"> POODLE, BEAST, CRIME, BREACH, HEARTBLEED.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> TCP/UDP
<ul>
<li><input disabled="" type="checkbox"> Web traffic, chat, voip, traceroute.</li>
<li><input disabled="" type="checkbox"> TCP will throttle back if packets are lost but UDP doesn&rsquo;t.</li>
<li><input disabled="" type="checkbox"> Streaming can slow network TCP connections sharing the same network.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> ICMP
<ul>
<li><input disabled="" type="checkbox"> Ping and traceroute.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Mail
<ul>
<li><input disabled="" type="checkbox"> SMTP (25, 587, 465)</li>
<li><input disabled="" type="checkbox"> IMAP (143, 993)</li>
<li><input disabled="" type="checkbox"> POP3 (110, 995)</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> SSH
<ul>
<li><input disabled="" type="checkbox"> (22)</li>
<li><input disabled="" type="checkbox"> Handshake uses asymmetric encryption to exchange symmetric key.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Telnet
<ul>
<li><input disabled="" type="checkbox"> (23, 992)</li>
<li><input disabled="" type="checkbox"> Allows remote communication with hosts.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> ARP
<ul>
<li><input disabled="" type="checkbox"> Who is 0.0.0.0? Tell 0.0.0.1.</li>
<li><input disabled="" type="checkbox"> Linking IP address to MAC, Looks at cache first.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> DHCP
<ul>
<li><input disabled="" type="checkbox"> (67, 68) (546, 547)</li>
<li><input disabled="" type="checkbox"> Dynamic (leases IP address, not persistent).</li>
<li><input disabled="" type="checkbox"> Automatic (leases IP address and remembers MAC and IP pairing in a table).</li>
<li><input disabled="" type="checkbox"> Manual (static IP set by administrator).</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> IRC
<ul>
<li><input disabled="" type="checkbox"> Understand use by hackers (botnets).</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> FTP/SFTP
<ul>
<li><input disabled="" type="checkbox"> (21, 22)</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> RPC
<ul>
<li><input disabled="" type="checkbox"> Predefined set of tasks that remote clients can execute.</li>
<li><input disabled="" type="checkbox"> Used inside orgs.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Service ports
<ul>
<li><input disabled="" type="checkbox"> 0 - 1023: Reserved for common services - sudo required.</li>
<li><input disabled="" type="checkbox"> 1024 - 49151: Registered ports used for IANA-registered services.</li>
<li><input disabled="" type="checkbox"> 49152 - 65535: Dynamic ports that can be used for anything.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> HTTP Header
<ul>
<li><input disabled="" type="checkbox"> | Verb | Path | HTTP version |</li>
<li><input disabled="" type="checkbox"> Domain</li>
<li><input disabled="" type="checkbox"> Accept</li>
<li><input disabled="" type="checkbox"> Accept-language</li>
<li><input disabled="" type="checkbox"> Accept-charset</li>
<li><input disabled="" type="checkbox"> Accept-encoding(compression type)</li>
<li><input disabled="" type="checkbox"> Connection- close or keep-alive</li>
<li><input disabled="" type="checkbox"> Referrer</li>
<li><input disabled="" type="checkbox"> Return address</li>
<li><input disabled="" type="checkbox"> Expected Size?</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> HTTP Response Header
<ul>
<li><input disabled="" type="checkbox"> HTTP version</li>
<li><input disabled="" type="checkbox"> Status Codes:
<ul>
<li><input disabled="" type="checkbox"> 1xx: Informational Response</li>
<li><input disabled="" type="checkbox"> 2xx: Successful</li>
<li><input disabled="" type="checkbox"> 3xx: Redirection</li>
<li><input disabled="" type="checkbox"> 4xx: Client Error</li>
<li><input disabled="" type="checkbox"> 5xx: Server Error</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Type of data in response</li>
<li><input disabled="" type="checkbox"> Type of encoding</li>
<li><input disabled="" type="checkbox"> Language</li>
<li><input disabled="" type="checkbox"> Charset</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> UDP Header
<ul>
<li><input disabled="" type="checkbox"> Source port</li>
<li><input disabled="" type="checkbox"> Destination port</li>
<li><input disabled="" type="checkbox"> Length</li>
<li><input disabled="" type="checkbox"> Checksum</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Broadcast domains and collision domains.</li>
<li><input disabled="" type="checkbox"> Root stores</li>
<li><input disabled="" type="checkbox"> CAM table overflow</li>
</ul>
<h3 id="web-application">Web Application</h3>
<ul>
<li><input checked="" disabled="" type="checkbox"> Same origin policy</li>
<li><input checked="" disabled="" type="checkbox"> ‚ùóÔ∏è CORS</li>
<li><input checked="" disabled="" type="checkbox"> HSTS</li>
<li><input checked="" disabled="" type="checkbox"> Cert transparency, Can verify certificates against public logs</li>
<li><input checked="" disabled="" type="checkbox"> HTTP Public Key Pinning- (HPKP) Deprecated by Google Chrome (like SSL pinning in iOS and Android, I suupose)</li>
<li><input checked="" disabled="" type="checkbox"> Cookies, httponly - cannot be accessed by javascript.</li>
<li><input checked="" disabled="" type="checkbox"> CSRF, Cross-Site Request Forgery</li>
<li><input checked="" disabled="" type="checkbox"> XSS
<ul>
<li><input checked="" disabled="" type="checkbox"> Reflected XSS.</li>
<li><input checked="" disabled="" type="checkbox"> Persistent XSS.</li>
<li><input checked="" disabled="" type="checkbox"> DOM based /client-side XSS.</li>
<li><input checked="" disabled="" type="checkbox"> <code>&lt;img scr=‚Äù‚Äù&gt;</code>¬†will often load content from other websites, making a cross-origin HTTP request.</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> SQLi</li>
<li><input checked="" disabled="" type="checkbox"> Person-in-the-browser (flash / java applets) (malware).</li>
<li><input checked="" disabled="" type="checkbox"> Validation / sanitisation of webforms.</li>
<li><input checked="" disabled="" type="checkbox"> POST</li>
<li><input checked="" disabled="" type="checkbox"> GET. Queries, Visible from URL.</li>
<li><input checked="" disabled="" type="checkbox"> Directory traversal
<ul>
<li><input checked="" disabled="" type="checkbox"> Find directories on the server you‚Äôre not meant to be able to see.</li>
<li><input checked="" disabled="" type="checkbox"> There are tools that do this.</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> APIs
<ul>
<li><input checked="" disabled="" type="checkbox"> Think about what information they return.</li>
<li><input checked="" disabled="" type="checkbox"> And what can be sent.</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Beefhook, Get info about Chrome extensions.</li>
<li><input checked="" disabled="" type="checkbox"> User agents. Is this a legitimate browser? Or a botnet?</li>
<li><input checked="" disabled="" type="checkbox"> Browser extension take-overs
<ul>
<li><input checked="" disabled="" type="checkbox"> Miners, cred stealers, adware.</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Local file inclusion</li>
<li><input checked="" disabled="" type="checkbox"> Remote file inclusion (not as common these days)</li>
<li><input checked="" disabled="" type="checkbox"> SSRF</li>
<li><input checked="" disabled="" type="checkbox"> Web vuln scanners.</li>
<li><input checked="" disabled="" type="checkbox"> SQLmap.</li>
<li><input checked="" disabled="" type="checkbox"> Malicious redirects.</li>
</ul>
<h3 id="infrastructure-prod--cloud-virtualisation">Infrastructure (Prod / Cloud) Virtualisation</h3>
<ul>
<li><input disabled="" type="checkbox"> Hypervisors.</li>
<li><input disabled="" type="checkbox"> Hyperjacking.</li>
<li><input disabled="" type="checkbox"> ‚ùóÔ∏èContainers, VMs, clusters.</li>
<li><input disabled="" type="checkbox"> Escaping techniques.
<ul>
<li><input disabled="" type="checkbox"> Network connections from VMs / containers.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Lateral movement and privilege escalation techniques.
<ul>
<li><input disabled="" type="checkbox"> Cloud Service Accounts can be used for lateral movement and privilege escalation in Cloud environments.</li>
<li><input disabled="" type="checkbox"> ‚ùóÔ∏èGCPloit tool for Google Cloud Projects.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Site isolation.</li>
<li><input disabled="" type="checkbox"> Side-channel attacks.
<ul>
<li><input disabled="" type="checkbox"> Spectre, Meltdown.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> ‚ùóÔ∏è Beyondcorp. Trusting the host but not the network. ZTN</li>
<li><input disabled="" type="checkbox"> Log4j vuln.</li>
</ul>
<h3 id="os-implementation-and-systems">OS Implementation and Systems</h3>
<ul>
<li><input disabled="" type="checkbox"> Privilege escalation techniques, and prevention.</li>
<li><input disabled="" type="checkbox"> Buffer Overflows.</li>
<li><input disabled="" type="checkbox"> Directory traversal (prevention).</li>
<li><input disabled="" type="checkbox"> Remote Code Execution / getting shells.</li>
<li><input disabled="" type="checkbox"> Local databases
<ul>
<li><input disabled="" type="checkbox"> Some messaging apps use sqlite for storing messages.</li>
<li><input disabled="" type="checkbox"> Useful for digital forensics, especially on phones.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Windows
<ul>
<li><input disabled="" type="checkbox"> ‚ùóÔ∏èWindows registry and group policy.</li>
<li><input disabled="" type="checkbox"> Active Directory (AD).
<ul>
<li><input disabled="" type="checkbox"> Bloodhound tool.</li>
<li><input disabled="" type="checkbox"> ‚ùóÔ∏èKerberos authentication with AD.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Windows SMB.</li>
<li><input disabled="" type="checkbox"> Samba (with SMB).</li>
<li><input disabled="" type="checkbox"> Buffer Overflows.</li>
<li><input disabled="" type="checkbox"> ROP.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> *nix
<ul>
<li><input disabled="" type="checkbox"> SELinux.</li>
<li><input disabled="" type="checkbox"> Kernel, userspace, permissions.</li>
<li><input disabled="" type="checkbox"> MAC vs DAC.</li>
<li><input disabled="" type="checkbox"> /proc</li>
<li><input disabled="" type="checkbox"> /tmp - code can be saved here and executed.</li>
<li><input disabled="" type="checkbox"> /shadow</li>
<li><input disabled="" type="checkbox"> LDAP - Lightweight Directory Browsing Protocol. Lets users have one password for many services. This is similar to Active Directory in windows.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> MacOS
<ul>
<li><input disabled="" type="checkbox"> Gotofail error (SSL).</li>
<li><input disabled="" type="checkbox"> MacSweeper.</li>
<li><input disabled="" type="checkbox"> Research Mac vulnerabilities.</li>
</ul>
</li>
</ul>
<h3 id="mitigations">Mitigations</h3>
<ul>
<li><input disabled="" type="checkbox"> Patching</li>
<li><input disabled="" type="checkbox"> Data Execution Prevention</li>
<li><input disabled="" type="checkbox"> Address space layout randomisation
<ul>
<li><input disabled="" type="checkbox"> To make it harder for buffer overruns to execute privileged instructions at known addresses in memory.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Principle of least privilege
<ul>
<li><input disabled="" type="checkbox"> Eg running Internet Explorer with the Administrator SID disabled in the process token. Reduces the ability of buffer overrun exploits to run as elevated user.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Code signing
<ul>
<li><input disabled="" type="checkbox"> Requiring kernel mode code to be digitally signed.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Compiler security features
<ul>
<li><input disabled="" type="checkbox"> Use of compilers that trap buffer overruns.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Encryption
<ul>
<li><input disabled="" type="checkbox"> Of software and/or firmware components.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Mandatory Access Controls
<ul>
<li><input disabled="" type="checkbox"> (MACs)</li>
<li><input disabled="" type="checkbox"> Access Control Lists (ACLs)</li>
<li><input disabled="" type="checkbox"> Operating systems with Mandatory Access Controls - eg. SELinux.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> &ldquo;Insecure by exception&rdquo;
<ul>
<li><input disabled="" type="checkbox"> When to allow people to do certain things for their job, and how to improve everything else. Don&rsquo;t try to &ldquo;fix&rdquo; security, just improve it by 99%.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Do not blame the user
<ul>
<li><input disabled="" type="checkbox"> Security is about protecting people, we should build technology that people can trust, not constantly blame users.</li>
</ul>
</li>
</ul>
<h3 id="cryptography-authentication-identity">Cryptography, Authentication, Identity</h3>
<ul>
<li><input checked="" disabled="" type="checkbox"> Encryption vs Encoding vs Hashing vs Obfuscation vs Signing
<ul>
<li><input checked="" disabled="" type="checkbox"> Be able to explain the differences between these things.</li>
<li><input disabled="" type="checkbox"> <a href="https://en.wikipedia.org/wiki/Attack_model">Various attack models</a>¬†(e.g. chosen-plaintext attack).</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Encryption standards + implementations
<ul>
<li><input disabled="" type="checkbox"> <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)">RSA</a>¬†(asymmetrical).</li>
<li><input disabled="" type="checkbox"> <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">AES</a>¬†(symmetrical).</li>
<li><input disabled="" type="checkbox"> <a href="https://en.wikipedia.org/wiki/EdDSA">ECC</a>¬†(namely ed25519) (asymmetric).</li>
<li><input disabled="" type="checkbox"> <a href="https://en.wikipedia.org/wiki/Salsa20#ChaCha_variant">Chacha/Salsa</a>¬†(symmetric).</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Asymmetric vs symmetric
<ul>
<li><input checked="" disabled="" type="checkbox"> Asymmetric is slow, but good for establishing a trusted connection.</li>
<li><input checked="" disabled="" type="checkbox"> Symmetric has a shared key and is faster. Protocols often use asymmetric to transfer symmetric key.</li>
<li><input disabled="" type="checkbox"> Perfect forward secrecy - eg Signal uses this.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Cyphers
<ul>
<li><input disabled="" type="checkbox"> Block vs stream¬†<a href="https://en.wikipedia.org/wiki/Cipher">ciphers</a>.</li>
<li><input disabled="" type="checkbox"> <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">Block cipher modes of operation</a>.</li>
<li><input disabled="" type="checkbox"> <a href="https://en.wikipedia.org/wiki/Galois/Counter_Mode">AES-GCM</a>.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Integrity and authenticity primitives
<ul>
<li><input disabled="" type="checkbox"> <a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function">Hashing functions</a>¬†e.g. MD5, Sha-1, BLAKE. Used for identifiers, very useful for fingerprinting malware samples.</li>
<li><input disabled="" type="checkbox"> <a href="https://en.wikipedia.org/wiki/Message_authentication_code">Message Authentication Codes (MACs)</a>.</li>
<li><input disabled="" type="checkbox"> <a href="https://en.wikipedia.org/wiki/HMAC">Keyed-hash MAC (HMAC)</a>. <a href="https://youtu.be/cBuHXDWp5Ek">https://youtu.be/cBuHXDWp5Ek</a></li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Entropy
<ul>
<li><input disabled="" type="checkbox"> PRNG (pseudo random number generators).</li>
<li><input disabled="" type="checkbox"> Entropy buffer draining.</li>
<li><input disabled="" type="checkbox"> Methods of filling entropy buffer.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Authentication
<ul>
<li><input disabled="" type="checkbox"> Certificates
<ul>
<li><input disabled="" type="checkbox"> What info do certs contain, how are they signed?</li>
<li><input disabled="" type="checkbox"> Look at DigiNotar.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Trusted Platform Module
<ul>
<li><input disabled="" type="checkbox"> (TPM)</li>
<li><input disabled="" type="checkbox"> Trusted storage for certs and auth data locally on device/host.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> O-auth
<ul>
<li><input disabled="" type="checkbox"> Bearer tokens, this can be stolen and used, just like cookies.</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Auth Cookies
<ul>
<li><input disabled="" type="checkbox"> Client side.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Sessions
<ul>
<li><input disabled="" type="checkbox"> Server side.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Auth systems
<ul>
<li><input disabled="" type="checkbox"> SAMLv2o.</li>
<li><input disabled="" type="checkbox"> OpenID.</li>
<li><input disabled="" type="checkbox"> Kerberos.
<ul>
<li><input disabled="" type="checkbox"> Gold &amp; silver tickets.</li>
<li><input disabled="" type="checkbox"> Mimikatz.</li>
<li><input disabled="" type="checkbox"> Pass-the-hash.</li>
</ul>
</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Biometrics
<ul>
<li><input disabled="" type="checkbox"> Can&rsquo;t rotate unlike passwords.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Password management
<ul>
<li><input disabled="" type="checkbox"> Rotating passwords (and why this is bad).</li>
<li><input disabled="" type="checkbox"> Different password lockers.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> U2F / FIDO
<ul>
<li><input disabled="" type="checkbox"> Eg. Yubikeys.</li>
<li><input disabled="" type="checkbox"> Helps prevent successful phishing of credentials.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Compare and contrast multi-factor auth methods.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Identity
<ul>
<li><input checked="" disabled="" type="checkbox"> Access Control Lists (ACLs)
<ul>
<li><input checked="" disabled="" type="checkbox"> Control which authenicated users can access which resources.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Service accounts vs User accounts
<ul>
<li><input disabled="" type="checkbox"> Robot accounts or Service accounts are used for automation.</li>
<li><input checked="" disabled="" type="checkbox"> Service accounts should have heavily restricted priviledges.</li>
<li><input disabled="" type="checkbox"> Understanding how Service accounts are used by attackers is important for understanding Cloud security.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> impersonation
<ul>
<li><input disabled="" type="checkbox"> Exported account keys.</li>
<li><input disabled="" type="checkbox"> ActAs, JWT (JSON Web Token) in Cloud.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Federated identity</li>
</ul>
</li>
</ul>
<h3 id="malware--reversing">Malware &amp; Reversing</h3>
<ul>
<li><input disabled="" type="checkbox"> Interesting malware
<ul>
<li><input disabled="" type="checkbox"> Conficker.</li>
<li><input disabled="" type="checkbox"> Morris worm.</li>
<li><input disabled="" type="checkbox"> Zeus malware.</li>
<li><input disabled="" type="checkbox"> Stuxnet.</li>
<li><input disabled="" type="checkbox"> Wannacry.</li>
<li><input disabled="" type="checkbox"> CookieMiner.</li>
<li><input disabled="" type="checkbox"> Sunburst.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Malware features
<ul>
<li><input disabled="" type="checkbox"> Various methods of getting remote code execution.</li>
<li><input disabled="" type="checkbox"> Domain-flux.</li>
<li><input disabled="" type="checkbox"> Fast-Flux.</li>
<li><input disabled="" type="checkbox"> Covert C2 channels.</li>
<li><input disabled="" type="checkbox"> Evasion techniques (e.g. anti-sandbox).</li>
<li><input disabled="" type="checkbox"> Process hollowing.</li>
<li><input disabled="" type="checkbox"> Mutexes.</li>
<li><input disabled="" type="checkbox"> Multi-vector and polymorphic attacks.</li>
<li><input disabled="" type="checkbox"> RAT (remote access trojan) features.</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Decompiling/ reversing
<ul>
<li><input checked="" disabled="" type="checkbox"> Obfuscation of code, unique strings (you can use for identifying code).</li>
<li><input checked="" disabled="" type="checkbox"> IdaPro, Ghidra.</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Static / dynamic analysis
<ul>
<li><input checked="" disabled="" type="checkbox"> Describe the differences.</li>
<li><input checked="" disabled="" type="checkbox"> Virus total.</li>
<li><input checked="" disabled="" type="checkbox"> Reverse.it.</li>
<li><input checked="" disabled="" type="checkbox"> Hybrid Analysis.</li>
</ul>
</li>
</ul>
<h3 id="exploits">Exploits</h3>
<ul>
<li><input disabled="" type="checkbox"> Three ways to attack - Social, Physical, Network
<ul>
<li><input disabled="" type="checkbox"> <strong>Social</strong>
<ul>
<li><input disabled="" type="checkbox"> Ask the person for access, phishing.</li>
<li><input disabled="" type="checkbox"> Cognitive biases - look at how these are exploited.</li>
<li><input disabled="" type="checkbox"> Spear phishing.</li>
<li><input disabled="" type="checkbox"> Water holing.</li>
<li><input disabled="" type="checkbox"> Baiting (dropping CDs or USB drivers and hoping people use them).</li>
<li><input disabled="" type="checkbox"> Tailgating.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> <strong>Physical</strong>
<ul>
<li><input disabled="" type="checkbox"> Get hard drive access, will it be encrypted?</li>
<li><input disabled="" type="checkbox"> Boot from linux.</li>
<li><input disabled="" type="checkbox"> Brute force password.</li>
<li><input disabled="" type="checkbox"> Keyloggers.</li>
<li><input disabled="" type="checkbox"> Frequency jamming (bluetooth/wifi).</li>
<li><input disabled="" type="checkbox"> Covert listening devices.</li>
<li><input disabled="" type="checkbox"> Hidden cameras.</li>
<li><input disabled="" type="checkbox"> Disk encryption.</li>
<li><input disabled="" type="checkbox"> Trusted Platform Module.</li>
<li><input disabled="" type="checkbox"> Spying via unintentional radio or electrical signals, sounds, and vibrations (TEMPEST - NSA).</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> <strong>Network</strong>
<ul>
<li><input disabled="" type="checkbox"> Nmap.</li>
<li><input disabled="" type="checkbox"> Find CVEs for any services running.</li>
<li><input disabled="" type="checkbox"> Interception attacks.</li>
<li><input disabled="" type="checkbox"> Getting unsecured info over the network.</li>
</ul>
</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Exploit Kits and drive-by download attacks</li>
<li><input disabled="" type="checkbox"> Remote Control
<ul>
<li><input disabled="" type="checkbox"> Remote code execution (RCE) and privilege.</li>
<li><input disabled="" type="checkbox"> Bind shell (opens port and waits for attacker).</li>
<li><input disabled="" type="checkbox"> Reverse shell (connects to port on attackers C2 server).</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Spoofing
<ul>
<li><input disabled="" type="checkbox"> Email spoofing.</li>
<li><input disabled="" type="checkbox"> IP address spoofing.</li>
<li><input disabled="" type="checkbox"> MAC spoofing.</li>
<li><input disabled="" type="checkbox"> Biometric spoofing.</li>
<li><input disabled="" type="checkbox"> ARP spoofing.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Tools
<ul>
<li><input disabled="" type="checkbox"> Metasploit.</li>
<li><input disabled="" type="checkbox"> ExploitDB.</li>
<li><input disabled="" type="checkbox"> Shodan - Google but for devices/servers connected to the internet.</li>
<li><input disabled="" type="checkbox"> Google the version number of anything to look for exploits.</li>
<li><input disabled="" type="checkbox"> Hak5 tools.</li>
</ul>
</li>
</ul>
<h3 id="attack-structure">Attack Structure</h3>
<p>Practice describing security concepts in the context of an attack. These categories are a rough guide on attack structure for a targeted attack. Non-targeted attacks tend to be a bit more &ldquo;all-in-one&rdquo;.</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Reconnaissance
<ul>
<li><input checked="" disabled="" type="checkbox"> OSINT, Google dorking, Shodan.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Resource development
<ul>
<li><input disabled="" type="checkbox"> Get infrastructure (via compromise or otherwise).</li>
<li><input disabled="" type="checkbox"> Build malware.</li>
<li><input disabled="" type="checkbox"> Compromise accounts.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Initial access
<ul>
<li><input disabled="" type="checkbox"> Phishing.</li>
<li><input disabled="" type="checkbox"> Hardware placements.</li>
<li><input disabled="" type="checkbox"> Supply chain compromise.</li>
<li><input disabled="" type="checkbox"> Exploit public-facing apps.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Execution
<ul>
<li><input disabled="" type="checkbox"> Shells &amp; interpreters (powershell, python, javascript, etc.).</li>
<li><input disabled="" type="checkbox"> Scheduled tasks, Windows Management Instrumentation (WMI).</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Persistence
<ul>
<li><input disabled="" type="checkbox"> Additional accounts/creds.</li>
<li><input disabled="" type="checkbox"> Start-up/log-on/boot scripts, modify launch agents, DLL side-loading, Webshells.</li>
<li><input disabled="" type="checkbox"> Scheduled tasks.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Privilege escalation
<ul>
<li><input disabled="" type="checkbox"> Sudo, token/key theft, IAM/group policy modification.</li>
<li><input disabled="" type="checkbox"> Many persistence exploits are PrivEsc methods too.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Defense evasion
<ul>
<li><input disabled="" type="checkbox"> Disable detection software &amp; logging.</li>
<li><input disabled="" type="checkbox"> Revert VM/Cloud instances.</li>
<li><input disabled="" type="checkbox"> Process hollowing/injection, bootkits.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Credential access
<ul>
<li><input disabled="" type="checkbox"> Brute force, access password managers, keylogging.</li>
<li><input disabled="" type="checkbox"> etc/passwd &amp; etc/shadow.</li>
<li><input disabled="" type="checkbox"> Windows DCSync, Kerberos Gold &amp; Silver tickets.</li>
<li><input disabled="" type="checkbox"> Clear-text creds in files/pastebin, etc.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Discovery
<ul>
<li><input disabled="" type="checkbox"> Network scanning.</li>
<li><input disabled="" type="checkbox"> Find accounts by listing policies.</li>
<li><input disabled="" type="checkbox"> Find remote systems, software and system info, VM/sandbox.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Lateral movement
<ul>
<li><input disabled="" type="checkbox"> SSH/RDP/SMB.</li>
<li><input disabled="" type="checkbox"> Compromise shared content, internal spear phishing.</li>
<li><input disabled="" type="checkbox"> Pass the hash/ticket, tokens, cookies.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Collection
<ul>
<li><input disabled="" type="checkbox"> Database dumps.</li>
<li><input disabled="" type="checkbox"> Audio/video/screen capture, keylogging.</li>
<li><input disabled="" type="checkbox"> Internal documentation, network shared drives, internal traffic interception.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Exfiltration
<ul>
<li><input disabled="" type="checkbox"> Removable media/USB, Bluetooth exfil.</li>
<li><input disabled="" type="checkbox"> C2 channels, DNS exfil, web services like code repos &amp; Cloud backup storage.</li>
<li><input disabled="" type="checkbox"> Scheduled transfers.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Command and control
<ul>
<li><input disabled="" type="checkbox"> Web service (dead drop resolvers, one-way/bi-directional traffic), encrypted channels.</li>
<li><input disabled="" type="checkbox"> Removable media.</li>
<li><input disabled="" type="checkbox"> Steganography, encoded commands.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Impact
<ul>
<li><input disabled="" type="checkbox"> Deleted accounts or data, encrypt data (like ransomware).</li>
<li><input disabled="" type="checkbox"> Defacement.</li>
<li><input disabled="" type="checkbox"> Denial of service, shutdown/reboot systems.</li>
</ul>
</li>
</ul>
<h3 id="threat-modeling">Threat Modeling</h3>
<ul>
<li><input disabled="" type="checkbox"> Threat Matrix</li>
<li><input disabled="" type="checkbox"> Trust Boundries</li>
<li><input disabled="" type="checkbox"> Security Controls</li>
<li><input disabled="" type="checkbox"> STRIDE framework
<ul>
<li><input disabled="" type="checkbox"> <strong>S</strong>poofing</li>
<li><input disabled="" type="checkbox"> <strong>T</strong>ampering</li>
<li><input disabled="" type="checkbox"> <strong>R</strong>epudiation</li>
<li><input disabled="" type="checkbox"> <strong>I</strong>nformation disclosure</li>
<li><input disabled="" type="checkbox"> <strong>D</strong>enial of service</li>
<li><input disabled="" type="checkbox"> <strong>E</strong>levation of privilege</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> <a href="https://attack.mitre.org/">MITRE Att&amp;ck</a>¬†framework</li>
<li><input disabled="" type="checkbox"> <a href="https://www.youtube.com/watch?v=vbwb6zqjZ7o">Excellent talk</a>¬†on &ldquo;Defense Against the Dark Arts&rdquo; by Lilly Ryan (contains¬†<em>many</em>¬†Harry Potter spoilers)</li>
</ul>
<h3 id="detection">Detection</h3>
<ul>
<li><input disabled="" type="checkbox"> IDS
<ul>
<li><input disabled="" type="checkbox"> Intrusion Detection System (signature based (eg. snort) or behaviour based).</li>
<li><input disabled="" type="checkbox"> Snort/Suricata/YARA rule writing</li>
<li><input disabled="" type="checkbox"> Host-based Intrusion Detection System (eg. OSSEC)</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> SIEM
<ul>
<li><input disabled="" type="checkbox"> Security Information and Event Management.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> IOC
<ul>
<li><input disabled="" type="checkbox"> Indicator of compromise (often shared amongst orgs/groups).</li>
<li><input disabled="" type="checkbox"> Specific details (e.g. IP addresses, hashes, domains)</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Things that create signals
<ul>
<li><input disabled="" type="checkbox"> Honeypots, snort.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Things that triage signals
<ul>
<li><input disabled="" type="checkbox"> SIEM, eg splunk.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Things that will alert a human
<ul>
<li><input disabled="" type="checkbox"> Automatic triage of collated logs, machine learning.</li>
<li><input disabled="" type="checkbox"> Notifications and analyst fatigue.</li>
<li><input disabled="" type="checkbox"> Systems that make it easy to decide if alert is actual hacks or not.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Signatures
<ul>
<li><input disabled="" type="checkbox"> Host-based signatures
<ul>
<li><input disabled="" type="checkbox"> Eg changes to the registry, files created or modified.</li>
<li><input disabled="" type="checkbox"> Strings in found in malware samples appearing in binaries installed on hosts (/Antivirus).</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Network signatures
<ul>
<li><input disabled="" type="checkbox"> Eg checking DNS records for attempts to contact C2 (command and control) servers.</li>
</ul>
</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Anomaly / Behaviour based detection
<ul>
<li><input disabled="" type="checkbox"> IDS learns model of ‚Äúnormal‚Äù behaviour, then can detect things that deviate too far from normal - eg unusual urls being accessed, user specific- login times / usual work hours, normal files accessed.</li>
<li><input disabled="" type="checkbox"> Can also look for things that a hacker might specifically do (eg, HISTFILE commands, accessing /proc).</li>
<li><input disabled="" type="checkbox"> If someone is inside the network- If action could be suspicious, increase log verbosity for that user.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Firewall rules
<ul>
<li><input disabled="" type="checkbox"> Brute force (trying to log in with a lot of failures).</li>
<li><input disabled="" type="checkbox"> Detecting port scanning (could look for TCP SYN packets with no following SYN ACK/ half connections).</li>
<li><input disabled="" type="checkbox"> Antivirus software notifications.</li>
<li><input disabled="" type="checkbox"> Large amounts of upload traffic.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Honey pots
<ul>
<li><input disabled="" type="checkbox"> Canary tokens.</li>
<li><input disabled="" type="checkbox"> Dummy internal service / web server, can check traffic, see what attacker tries.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Things to know about attackers
<ul>
<li><input disabled="" type="checkbox"> Slow attacks are harder to detect.</li>
<li><input disabled="" type="checkbox"> Attacker can spoof packets that look like other types of attacks, deliberately create a lot of noise.</li>
<li><input disabled="" type="checkbox"> Attacker can spoof IP address sending packets, but can check TTL of packets and TTL of reverse lookup to find spoofed addresses.</li>
<li><input disabled="" type="checkbox"> Correlating IPs with physical location (is difficult and inaccurate often).</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Logs to look at
<ul>
<li><input disabled="" type="checkbox"> DNS queries to suspicious domains.</li>
<li><input disabled="" type="checkbox"> HTTP headers could contain wonky information.</li>
<li><input disabled="" type="checkbox"> Metadata of files (eg. author of file) (more forensics?).</li>
<li><input disabled="" type="checkbox"> Traffic volume.</li>
<li><input disabled="" type="checkbox"> Traffic patterns.</li>
<li><input disabled="" type="checkbox"> Execution logs.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Detection related tools
<ul>
<li><input disabled="" type="checkbox"> Splunk.</li>
<li><input disabled="" type="checkbox"> Arcsight.</li>
<li><input disabled="" type="checkbox"> Qradar.</li>
<li><input disabled="" type="checkbox"> Darktrace.</li>
<li><input disabled="" type="checkbox"> Tcpdump.</li>
<li><input disabled="" type="checkbox"> Wireshark.</li>
<li><input disabled="" type="checkbox"> Zeek.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> A curated list of¬†<a href="https://github.com/0x4D31/awesome-threat-detection">awesome threat detection</a>¬†resources</li>
</ul>
<h3 id="digital-forensics">Digital Forensics</h3>
<ul>
<li><input checked="" disabled="" type="checkbox"> Evidence volatility (network vs memory vs disk)</li>
<li><input disabled="" type="checkbox"> Network forensics
<ul>
<li><input disabled="" type="checkbox"> DNS logs / passive DNS</li>
<li><input disabled="" type="checkbox"> Netflow</li>
<li><input disabled="" type="checkbox"> Sampling rate</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Disk forensics
<ul>
<li><input checked="" disabled="" type="checkbox"> Disk imaging</li>
<li><input disabled="" type="checkbox"> Filesystems (NTFS / ext2/3/4 / AFPS)</li>
<li><input disabled="" type="checkbox"> Logs (Windows event logs, Unix system logs, application logs)</li>
<li><input checked="" disabled="" type="checkbox"> Data recovery (carving)</li>
<li><input disabled="" type="checkbox"> Tools</li>
<li><input disabled="" type="checkbox"> plaso / log2timeline</li>
<li><input disabled="" type="checkbox"> FTK imager</li>
<li><input disabled="" type="checkbox"> encase</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Memory forensics
<ul>
<li><input disabled="" type="checkbox"> Memory acquisition (footprint, smear, hiberfiles)</li>
<li><input disabled="" type="checkbox"> Virtual vs physical memory</li>
<li><input disabled="" type="checkbox"> Life of an executable</li>
<li><input disabled="" type="checkbox"> Memory structures</li>
<li><input checked="" disabled="" type="checkbox"> Kernel space vs user space</li>
<li><input checked="" disabled="" type="checkbox"> Tools</li>
<li><input checked="" disabled="" type="checkbox"> Volatility</li>
<li><input checked="" disabled="" type="checkbox"> Google Rapid Response (GRR) / Rekall</li>
<li><input checked="" disabled="" type="checkbox"> WinDbg</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Mobile forensics
<ul>
<li><input disabled="" type="checkbox"> Jailbreaking devices, implications</li>
<li><input disabled="" type="checkbox"> Differences between mobile and computer forensics</li>
<li><input disabled="" type="checkbox"> Android vs. iPhone</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Anti forensics
<ul>
<li><input disabled="" type="checkbox"> How does malware try to hide?</li>
<li><input disabled="" type="checkbox"> Timestomping</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Chain of custody
<ul>
<li><input checked="" disabled="" type="checkbox"> Handover notes</li>
</ul>
</li>
</ul>
<h3 id="incident-management">Incident Management</h3>
<ul>
<li><input disabled="" type="checkbox"> Privacy incidents vs information security incidents</li>
<li><input disabled="" type="checkbox"> Know when to talk to legal, users, managers, directors.</li>
<li><input disabled="" type="checkbox"> Run a scenario from A to Z, how would you &hellip;</li>
<li><input disabled="" type="checkbox"> Good practices for running incidents
<ul>
<li><input disabled="" type="checkbox"> How to delegate.</li>
<li><input disabled="" type="checkbox"> Who does what role.</li>
<li><input disabled="" type="checkbox"> How is communication managed + methods of communication.</li>
<li><input disabled="" type="checkbox"> When to stop an attack.</li>
<li><input disabled="" type="checkbox"> Understand risk of alerting attacker.</li>
<li><input disabled="" type="checkbox"> Ways an attacker may clean up / hide their attack.</li>
<li><input disabled="" type="checkbox"> When / how to inform upper management (manage expectations).</li>
<li><input disabled="" type="checkbox"> Metrics to assign Priorities (e.g. what needs to happen until you increase the prio for a case)</li>
<li><input disabled="" type="checkbox"> Use playbooks if available</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Important things to know and understand
<ul>
<li><input disabled="" type="checkbox"> Type of alerts, how these are triggered.</li>
<li><input disabled="" type="checkbox"> Finding the root cause.</li>
<li><input disabled="" type="checkbox"> Understand stages of an attack (e.g. cyber-killchain)</li>
<li><input disabled="" type="checkbox"> Symptom vs Cause.</li>
<li><input disabled="" type="checkbox"> First principles vs in depth systems knowledge (why both are good).</li>
<li><input disabled="" type="checkbox"> Building timeline of events.</li>
<li><input disabled="" type="checkbox"> Understand why you should assume good intent, and how to work with people rather than against them.</li>
<li><input disabled="" type="checkbox"> Prevent future incidents with the same root cause</li>
<li><input disabled="" type="checkbox"> Response models
<ul>
<li><input checked="" disabled="" type="checkbox"> SANS&rsquo; PICERL (Preparation, Identification, Containement, Eradication, Recovery, Lessons learned)</li>
<li><input disabled="" type="checkbox"> ‚ùóÔ∏èGoogle&rsquo;s IMAG (Incident Management At Google) - <a href="https://sre.google/workbook/incident-response/#:~:text=Incident%20Management%20at%20Google,and%20scale%20up%20their%20response">https://sre.google/workbook/incident-response/#:~:text=Incident%20Management%20at%20Google,and%20scale%20up%20their%20response</a>, <a href="https://sre.google/sre-book/managing-incidents/">https://sre.google/sre-book/managing-incidents/</a>, <a href="https://cloud.google.com/blog/products/gcp/incident-management-at-google-adventures-in-sre-land/">https://cloud.google.com/blog/products/gcp/incident-management-at-google-adventures-in-sre-land/</a>, <a href="https://cloud.google.com/docs/security/incident-response">https://cloud.google.com/docs/security/incident-response</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="heading"></h3>
<h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    Something here
</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
