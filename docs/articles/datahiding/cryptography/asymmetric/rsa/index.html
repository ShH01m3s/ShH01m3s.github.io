<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>RSA - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.828a1ae7da70cdee5ba13793dd197c2c1038b8507de0d492eb44184171d76360.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-articles">
      <a href="/docs/articles">
        <span>Articles</span>
      </a>
    </li>
    
    <li class="menu-item-blog">
      <a href="/docs/blog">
        <span>Blog</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit">
      <a href="/docs/toolkit">
        <span>Toolkit</span>
      </a>
    </li>
    
    <li class="menu-item-about me">
      <a href="/docs/about">
        <span>About me</span>
      </a>
    </li>
    
    <li class="menu-item-achievements">
      <a href="/docs/achievements">
        <span>Achievements</span>
      </a>
    </li>
    
    <li class="menu-item-contacts">
      <a href="/docs/contact">
        <span>Contacts</span>
      </a>
    </li>
    
    <li class="menu-item-course notes">
      <a href="/docs/coursenotes">
        <span>Course Notes</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-articles">
      <a href="/docs/articles">
        <span>Articles</span>
      </a>
    </li>
    
    <li class="menu-item-blog">
      <a href="/docs/blog">
        <span>Blog</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit">
      <a href="/docs/toolkit">
        <span>Toolkit</span>
      </a>
    </li>
    
    <li class="menu-item-about me">
      <a href="/docs/about">
        <span>About me</span>
      </a>
    </li>
    
    <li class="menu-item-achievements">
      <a href="/docs/achievements">
        <span>Achievements</span>
      </a>
    </li>
    
    <li class="menu-item-contacts">
      <a href="/docs/contact">
        <span>Contacts</span>
      </a>
    </li>
    
    <li class="menu-item-course notes">
      <a href="/docs/coursenotes">
        <span>Course Notes</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/articles/datahiding/cryptography/asymmetric/"> Back to Assymetric Algorithms Section </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#the-story-of-evelyn">The Story of Evelyn</a></li>
    <li><a href="#locking-the-message">Locking the Message</a></li>
    <li><a href="#creating-the-key">Creating the Key</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">RSA</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fa fa-magic"></i>
              
          <a class="category-link" href="/domain/crypto">crypto</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br />
      
      
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p><em>To my utter embarrassment I had to admit that I&rsquo;ve recently realized I didn&rsquo;t remember how the RSA worked&hellip;. What I though to be RSA turned out to be Diffie-Hellman algorithm&hellip; Oops ğŸ˜¬. So, I&rsquo;ve rewatched Khan&rsquo;s video about RSA and was surprised I could every confuse the two. This article and another one about Diffie-Hellman is my way of explaining cryptographic notions: visual representation, verbal explanation and&hellip; code. Thanks to Python ğŸ.</em></p>
<p><img src="images/_109474861_angrycat-index-getty3-3.jpg" alt="_109474861_angrycat-index-getty3-3"></p>
<p>Diffie Hellman key exchange ğŸ”‘ is based on the following mathmetical laws and theorems:</p>
<ol>
<li>modulus arithmetics</li>
<li>prime numbers</li>
<li>raising to power</li>
</ol>
<p>This algorithm is <strong>not</strong> encrypting anything! It&rsquo;s used to generate the same key without sending it over network in order to use symmetric encryption algorithm. So, basically, it&rsquo;s assymmetric algo for symmetric algo.</p>
<p>RSA is based on several mathematical &hellip; things:</p>
<ol>
<li>module exponantiation (as in Diffie Hellman&rsquo;s algo)</li>
<li>prime factorization and phi. Diffie Hellman uses factorization as well, but doesn&rsquo;t use phi of numbers.</li>
<li>raising to power (as in Diffie Hellman&rsquo;s algo)</li>
<li>Extended Euclidean algorithm (this one is also RSA personal stuff)</li>
</ol>
<p>It <strong>is</strong> used to encrypt the message. Only assymetric algo is used, only <del>hardcode</del> hardcore!</p>
<p>Probably because these two guys share some basic principles which they are both relying on, I&rsquo;ve been confusing them. When I was trying to untangle each one of these, I&rsquo;ve found it very helpful to write down code while listening the explanation. Writing code requires full understanding of an algorithm in order to run it. When I thought I&rsquo;ve got the main idea and started writing code, I&rsquo;ve realised, that I was wrong&hellip;. It was still a long way to go. I also tried to explain it to my husband and it turned out to be even harder. And as the intro to this site states, you don&rsquo;t understand a subject if you can&rsquo;t explain it to a 6 year old. Well, I&rsquo;ll be trying to explain it as easy as I can and since 6 year old are unlikely to read this article anyway, I&rsquo;m going to raise the age of my target audience to at least 17-20 year olds (when people might start do some coding). To make it easier to understand and easier to code, I&rsquo;m going to use very small numbers. I&rsquo;ll be giving a small coding task along the way in order to keep the reader follow my chain of thoughs as well as to make sure it&rsquo;s absolutely clear. A good starting analogy for this algorithm was given in the video on Khan academy: while other cryptography algorithms (symmetric ones) use a key both to lock and unlock the &ldquo;message box&rdquo;, this one uses a lock ğŸ”’ to encrypt the message and a key ğŸ”‘ to decrypt. What does it mean? I&rsquo;ll try to explain this using a what seems to be a very realistic example.</p>
<h2 id="the-story-of-evelyn">The Story of Evelyn</h2>
<p>Let&rsquo;s imagine a system adminstrator intern Evelyn ğŸ‘¨â€ğŸ’» who has leaked a DB of client passwords to a hacker ğŸˆ that resulted in a massive damage to the company ğŸ¤‘ because the hacker managed to steal lots of client money that the company needs to compensate now. This company&rsquo;s director ğŸ‘¨ğŸ½â€ğŸ’¼ turned out to be a hard nut ğŸŒ° and hired a forensic investigator ğŸ•µï¸â€â™€ï¸ to help with this matter. The company&rsquo;s director ğŸ‘¨ğŸ½â€ğŸ’¼and the forensic investigator ğŸ•µï¸â€â™€ï¸ are exchanging messages over corporate network which is of course sniffed by  Evelyn ğŸ‘¨â€ğŸ’» . They are using RSA as their encryption method and we are going to test, whether he has a chance to decrypt the messages.</p>
<h2 id="locking-the-message">Locking the Message</h2>
<p>For the forensic investigator ğŸ•µï¸â€â™€ï¸, let&rsquo;s call her Veronica (why not? ğŸ˜†), everyone  in the company is a suspect, including system administrator and his interns (Evelyn ğŸ‘¨â€ğŸ’» is, of course, one of them). That&rsquo;s why she insisted that the company&rsquo;s director ğŸ‘¨ğŸ½â€ğŸ’¼, let&rsquo;s call him Anduin (again, why not?), and herself encrypt the weekly status reports before sending. She proposes RSA since the messages are going to be small (only the name of the current suspect). Why size matters? Well, for this I&rsquo;ve posted a separete small article <a href="/docs/articles/datahiding/cryptography/symmetric-vs-asymmetric">here</a>.</p>
<p>Anduin ğŸ‘¨ğŸ½â€ğŸ’¼ and Veronica ğŸ•µï¸â€â™€ï¸ don&rsquo;t have any keys yet. They need to generate them and then may be exchange&hellip; (a little spoiler, yes and no). But how are they going to do so over the network which they both suspect to be sniffed by the person responsible for the data breach ğŸ’”? Keep in mind that Evelyn ğŸ‘¨â€ğŸ’» is a <em>system administrator</em> of the network and can see all messages sent over internal network. He will try to decrypt the messages that are exchanged by Veronica and Anduin or at least determine whether the message contains his name or not.</p>
<p>So, Veronica ğŸ•µï¸â€â™€ï¸ want&rsquo;s to let Anduin ğŸ‘¨ğŸ½â€ğŸ’¼ that there are no results there yet. She writes down a message <code>Nothing yet</code> and converts it to a digit. Since any letter, digit or a symbol can be converted into a number (computers, binary and staff), this message looks like this in binary:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="m">01001110</span> <span class="m">01101111</span> <span class="m">01110100</span> <span class="m">01101000</span> <span class="m">01101001</span> <span class="m">01101110</span> <span class="m">01100111</span> <span class="m">00100000</span> <span class="m">01111001</span> <span class="m">01100101</span> <span class="m">01110100</span>
</code></pre></div><p>Binary data is hard for a human to operate with, so I&rsquo;ll use hex (16 base integers):</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">0x4e 0x6f 0x74 0x68 0x69 0x6e 0x67 0x20 0x79 0x65 0x74
</code></pre></div><p><img src="images/maxresdefault.jpg" alt="maxresdefault"></p>
<p>At this point we have a message we are going to encrypt. Try to write down some code that takes a string (this message as an input) and generates an array of  integers <code>secret</code> as an output. Express it in your prefered language, I&rsquo;ll use my beloved Python ğŸ:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">message_str</span> <span class="o">=</span> <span class="s2">&#34;Nothing yet&#34;</span>
<span class="n">message_int</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">secret_message</span><span class="p">:</span>
  	<span class="c1"># this piece of code takes each char and converts</span>
    <span class="c1"># it into its hex ASCII representation, </span>
    <span class="c1"># so for example &#39;A&#39; becomes 0x41</span>
    <span class="n">message_int</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">))</span>
<span class="c1"># the following line is optional, but useful for this demo</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;The message from Veronica to Anduin is {}&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">message_int</span><span class="p">))</span>

<span class="c1"># I could, por supuesto, write print(&#34;The message from Veronica to Anduin is&#34; + str(message_int)), but I won&#39;t :) Learning to write safe and easy to read code</span>
</code></pre></div><p>According to this algorithm, AnduinğŸ‘¨ğŸ½â€ğŸ’¼ now needs to give Veronica ğŸ•µï¸â€â™€ï¸  some open lock ğŸ”“ which only he can unlock with his private key ğŸ”‘. Veronica ğŸ•µï¸â€â™€ï¸  will use this lock to encrypt (close) the message she wants to send.</p>
<p>AnduinğŸ‘¨ğŸ½â€ğŸ’¼ chooses two prime numbers ğŸ§™ğŸ§™ (those almoust mystic numbers that can be divided by 1 and itself only). Write some piece of code that checks whether two given integers are primes and choose two primes.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># this code is from https://www.geeksforgeeks.org/python-program-to-check-whether-a-number-is-prime-or-not/</span>
<span class="c1"># a simple solution would be to divide a number by all numbers between 2 and the number previous to the one being checked</span>
<span class="c1"># but this solution is optimized</span>
<span class="k">def</span> <span class="nf">isPrime</span><span class="p">():</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">:</span> 
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">:</span> 
        <span class="k">return</span> <span class="bp">True</span>
  
    <span class="c1"># This is checked so that we can skip  </span>
    <span class="c1"># middle five numbers in below loop </span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">:</span> 
        <span class="k">return</span> <span class="bp">False</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">)</span> <span class="p">:</span> 
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">:</span> 
            <span class="k">return</span> <span class="bp">False</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">6</span>
    <span class="k">return</span> <span class="bp">True</span>

<span class="n">prime1</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">prime2</span> <span class="o">=</span> <span class="mi">19</span>
<span class="k">if</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">prime1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">prime2</span><span class="p">):</span>
  <span class="k">print</span><span class="p">(</span><span class="s2">&#34;The chosen numbers are both primes. Good choice!&#34;</span><span class="p">)</span>
</code></pre></div><p>The next step of this algorithm is to multiply the chosen numbers. Let&rsquo;s code it down:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">public_number</span> <span class="o">=</span> <span class="n">prime1</span> <span class="o">*</span> <span class="n">prime2</span>
</code></pre></div><p>This number is going to be Anduin&rsquo;s  ğŸ‘¨ğŸ½â€ğŸ’¼ public number and a public exponent (open lockğŸ‘¨ğŸ½â€ğŸ’¼ğŸ”“), i.e. he&rsquo;s sending it in clear text to Veronica ğŸ•µï¸â€â™€ï¸. So, that&rsquo;s the part that Evelyn ğŸ‘¨â€ğŸ’» has as well. How exactly does the lockğŸ”“ look like, mathematically?</p>
<p>Here is supposed to be a picture</p>
<p>The part of the above formula in orange is Veronica&rsquo;s ğŸ•µï¸â€â™€ï¸ and Anduin&rsquo;s mathmetical lock! So, it&rsquo;s like Veronica will put the message in a box ğŸ—³ and lock it with the key provided by Anduin ğŸ‘¨ğŸ½â€ğŸ’¼. Keep in mind, t Anduin ğŸ‘¨ğŸ½â€ğŸ’¼hat  is only sending an open lockğŸ”“. As soon as Veronica&rsquo;s ğŸ•µï¸â€â™€ï¸ locks it, she will not be able to unlock it again since only Anduin ğŸ‘¨ğŸ½â€ğŸ’¼ has the ğŸ”‘. Above expression is what  Veronica ğŸ•µï¸â€â™€ï¸ will use to send the message.</p>
<p>It&rsquo;s time to introduce our parties in code ğŸ™‚. Code three classes and instanciate them: Detective, Director and Administrator.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Detective</span><span class="p">:</span>
  <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Veronica&#34;</span>
  <span class="n">__prime1</span> <span class="o">=</span> <span class="mi">7</span>
  <span class="n">__prime2</span> <span class="o">=</span> <span class="mi">19</span>
  <span class="n">public_number</span> <span class="o">=</span> <span class="n">__prime1</span> <span class="o">*</span> <span class="n">__prime2</span> <span class="c1"># 133</span>
  <span class="n">public_exponent</span> <span class="o">=</span> <span class="mi">5</span>
  
<span class="k">class</span> <span class="nc">Director</span><span class="p">:</span>
  <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Anduin&#34;</span>
  
<span class="k">class</span> <span class="nc">Administrator</span><span class="p">:</span>
  <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Evelyn&#34;</span>  
</code></pre></div><p>I&rsquo;m not thinking about beautiful code and perfect architecture, I&rsquo;m using this code to show, which information which class has. Since Anduin&rsquo;s <code>public_number</code> and <code>public_exponent</code> were sent to Veronica over the internal network, controlled by Evelyn, everyone has these <code>public_number</code> and <code>public_exponent</code>. Let&rsquo;s express it in code as well:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Detective</span><span class="p">:</span>
  <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Veronica&#34;</span>
  <span class="n">public_exponent</span> <span class="o">=</span> <span class="mi">5</span>
  <span class="n">anduins_public_number</span> <span class="o">=</span> <span class="mi">133</span>
  
<span class="k">class</span> <span class="nc">Director</span><span class="p">:</span>
  <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Anduin&#34;</span>
  <span class="n">__prime1</span> <span class="o">=</span> <span class="mi">7</span>
  <span class="n">__prime2</span> <span class="o">=</span> <span class="mi">19</span>
  <span class="n">public_number</span> <span class="o">=</span> <span class="n">__prime1</span> <span class="o">*</span> <span class="n">__prime2</span> <span class="c1"># 133</span>
  <span class="n">public_exponent</span> <span class="o">=</span> <span class="mi">5</span>
  
<span class="k">class</span> <span class="nc">Administrator</span><span class="p">:</span>
  <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Evelyn&#34;</span> 
  <span class="n">anduins_public_number</span> <span class="o">=</span> <span class="mi">133</span>
  <span class="n">public_exponent</span> <span class="o">=</span> <span class="mi">5</span>
</code></pre></div><p>Now, since we know the formula and the numbers, we can finally encrypt the message. Let&rsquo;s edit the <code>Detective</code> class now:</p>
<p><img src="images/maxresdefault2.jpg" alt="maxresdefault2"></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Detective</span><span class="p">:</span>
  <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Veronica&#34;</span>
  <span class="n">message_str</span> <span class="o">=</span> <span class="s2">&#34;Nothing yet&#34;</span>
  <span class="n">message_int</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">cipher_int</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">public_exponent</span> <span class="o">=</span> <span class="mi">5</span>
  <span class="n">anduins_public_number</span> <span class="o">=</span> <span class="mi">133</span>
  
  <span class="k">def</span> <span class="nf">convert_msg_to_integers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">secret_message</span><span class="p">:</span>
    	<span class="n">message_int</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">))</span>
  
  <span class="k">def</span> <span class="nf">lock_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">public_exponent</span><span class="p">,</span> <span class="n">anduins_public_number</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">message_int</span><span class="p">:</span>
    	<span class="n">cipher_int</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">char</span> <span class="o">**</span> <span class="n">public_exponent</span><span class="p">)</span> <span class="o">%</span> <span class="n">anduins_public_number</span><span class="p">)</span> 
</code></pre></div><h2 id="creating-the-key">Creating the Key</h2>
<p>The following stage is private for Anduin. He needs to craft a key ğŸ”‘ to unlock the lock ğŸ”“ he has sent and read the message. So, it should be some operation that let&rsquo;s him reverse the operation Veronica applied to the message using some information he knows but no one else knows. What information is that?</p>
<p>Did you wonder, why we needed to first choose two primes, multiply them and then share the result? And why both of them are marked as private in code? (in Python <code>__</code> before an attribute means <code>private</code>, so when you instanciate the class you can&rsquo;t get or set the value of these variables directly, only using some public function of this class).</p>
<p><strong>Step 1</strong>. Alice ğŸ‘§creates an open lock and the key. The lock will be sent to Bob ğŸ‘¨, and the key is private.</p>
<p>Trapdoor one-way function.</p>
<p>m ^ e mod N = c</p>
<p>c - cipher text, m - message. So, if m=0x6d and e is 3:</p>
<p>0x6d ^ 3 mod N = c</p>
<p>What&rsquo;s the N? Alice ğŸ‘§chooses two huge prime numbers of the same size (over 250 symbols) P1 = 3 and P2 = 5. Multiplies them and get&rsquo;s N = 15. Now, she knows the prime factorisation of N which P1 and P2. Alice ğŸ‘§shares N with Bob ğŸ‘¨. Eve&rsquo;s got a copy, of course.</p>
<p>What&rsquo;s the public exponent e? Alice ğŸ‘§chooses this (usually, some small number) and shares with Bob ğŸ‘¨. Eve&rsquo;s got a copy, of course.</p>
<p>0x6d ^ <strong>3 mod 15</strong> = c - everything in bold is the open lock ğŸ”“ we talked about.</p>
<p>109 ^ 3 mod 15 = 4, which is 0x04 in hex. Now, Alice ğŸ‘§has got 0x04. What is she supposed to do with it?</p>
<p>Remember P1 = 3 and P2 = 5? N = 15.</p>
<p>F(N) = F(P1-1) * F(P2-1) = F(3-1) * F(5-1) = 2 * 4 = 8</p>
<p>m ^ F(n) = 1 mod n</p>
<p>5^8 = 1 mod 15</p>
<p>They should not share a common factor (m and n). e should not share a common factor with F(n) and should be odd. m and N should not share a factor. So, 3 and 15 or 5 and 15 don&rsquo;t work.</p>
<p>2 ^ 8 mod 15 = 1 always. But it&rsquo;s not 390625 mod 15 = 10&hellip; .</p>
<p>1 raised to any power is 1</p>
<p>so m ^ k*F(n) = 1 mod n. So, 5 ^ 8 mod 15 = 1 is the same as 5 ^ k*8 mod 15 = 1</p>
<p>1 * any number = any number. So, m*m ^ k<em>F(n) = m mod n is the same as m ^ k</em>F(n) = 1 mod n. 5 ^ k<em>8 = 1 mod 8 is the same as 5*5 ^ k</em>8 = 5 mod 8</p>
<p><strong>m * m ^ k * F(n) = m mod n</strong> which is the same as <strong>m ^ k * F(n) + 1 = m mod n</strong>. And with our digits: 5 ^ k*8 + 1 = 5 mod 15.</p>
<p>If e*d  = k * F(n) + 1, then to find d we need to divide k*F(n) +1 by e.</p>
<h2 id="references">References</h2>
<p><a href="https://www.youtube.com/watch?v=6KmhCKxFWOs">https://www.youtube.com/watch?v=6KmhCKxFWOs</a></p>
<p><a href="https://ccom.uprrp.edu/~humberto/very-small-rsa-example.html">https://ccom.uprrp.edu/~humberto/very-small-rsa-example.html</a></p>
<p><a href="https://www.khanacademy.org/computing/computer-science/cryptography/modarithmetic/a/the-euclidean-algorithm">https://www.khanacademy.org/computing/computer-science/cryptography/modarithmetic/a/the-euclidean-algorithm</a></p>
<p><a href="https://www.khanacademy.org/computing/computer-science/cryptography/modarithmetic/a/modular-inverses">https://www.khanacademy.org/computing/computer-science/cryptography/modarithmetic/a/modular-inverses</a></p>
<p><a href="https://www.geeksforgeeks.org/python-program-for-basic-and-extended-euclidean-algorithms-2/">https://www.geeksforgeeks.org/python-program-for-basic-and-extended-euclidean-algorithms-2/</a></p>
<p><a href="https://en.wikibooks.org/wiki/Algorithm_Implementation/Mathematics/Extended_Euclidean_algorithm#Python">https://en.wikibooks.org/wiki/Algorithm_Implementation/Mathematics/Extended_Euclidean_algorithm#Python</a></p>
<p><a href="https://stackoverflow.com/questions/4798654/modular-multiplicative-inverse-function-in-python">https://stackoverflow.com/questions/4798654/modular-multiplicative-inverse-function-in-python</a></p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
