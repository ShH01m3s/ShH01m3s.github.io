<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Forensic Analysis Plan - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.b67d7fec5daec98747a80616a05e9e1e96dc0976219c428241762578c5ae69c3.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-articles">
      <a href="/docs/articles">
        <span>Articles</span>
      </a>
    </li>
    
    <li class="menu-item-blog">
      <a href="/docs/blog">
        <span>Blog</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit">
      <a href="/docs/toolkit">
        <span>Toolkit</span>
      </a>
    </li>
    
    <li class="menu-item-about me">
      <a href="/docs/about">
        <span>About me</span>
      </a>
    </li>
    
    <li class="menu-item-achievements">
      <a href="/docs/achievements">
        <span>Achievements</span>
      </a>
    </li>
    
    <li class="menu-item-contacts">
      <a href="/docs/contact">
        <span>Contacts</span>
      </a>
    </li>
    
    <li class="menu-item-notes">
      <a href="/docs/notes">
        <span>Notes</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-articles">
      <a href="/docs/articles">
        <span>Articles</span>
      </a>
    </li>
    
    <li class="menu-item-blog">
      <a href="/docs/blog">
        <span>Blog</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit">
      <a href="/docs/toolkit">
        <span>Toolkit</span>
      </a>
    </li>
    
    <li class="menu-item-about me">
      <a href="/docs/about">
        <span>About me</span>
      </a>
    </li>
    
    <li class="menu-item-achievements">
      <a href="/docs/achievements">
        <span>Achievements</span>
      </a>
    </li>
    
    <li class="menu-item-contacts">
      <a href="/docs/contact">
        <span>Contacts</span>
      </a>
    </li>
    
    <li class="menu-item-notes">
      <a href="/docs/notes">
        <span>Notes</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/articles/forensics/"> Back to Forensics Section </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#intro">Intro</a></li>
    <li><a href="#example">Example</a></li>
    <li><a href="#tools">Tools</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#cyber-triage">Cyber Triage</a></li>
    <li><a href="#user-activity">User Activity</a></li>
    <li><a href="#malware">Malware</a>
      <ul>
        <li><a href="#persistence">Persistence</a></li>
        <li><a href="#running">Running</a></li>
        <li><a href="#remnants">Remnants</a></li>
        <li><a href="#key-list">Key list</a></li>
      </ul>
    </li>
    <li><a href="#os-configurations">OS configurations</a></li>
    <li><a href="#prioritization-and-process">Prioritization and Process</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#steps">Steps</a>
      <ul>
        <li><a href="#discover">Discover</a></li>
      </ul>
    </li>
    <li><a href="#dfir-samples">DFIR Samples</a></li>
    <li><a href="#references">References</a></li>
    <li><a href="#references-1">References</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Forensic Analysis Plan</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-search"></i>
              
          <a class="category-link" href="/domain/forensics">forensics</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <h2 id="intro">Intro</h2>
<p>Main idea is to concentrate on some areas, answer some specific questions, like:</p>
<ol>
<li>Is there child exploitation material? Search videos and pictures.</li>
<li>Is this PC compromised? Not obvious.</li>
<li>Who did this computer communicate with?</li>
</ol>
<p><strong>First option:</strong></p>
<p>Big problem &ndash;&gt; n*(small problem). Recursively break a problem into smaller problems until one of them becomes solvable.</p>
<p><strong>Second option:</strong></p>
<p>Or we can be guided by artifact ‚õèÔ∏è  categories.</p>
<p>First, break the bigger problem into a smaller one. Then answer questions with artifact ‚õèÔ∏è categories.</p>
<p>Here is the pseudocode for this:</p>
<div class="highlight"><pre class="chroma"><code class="language-c#" data-lang="c#"><span class="n">function</span> <span class="n">breakIntoSmallerProblems</span><span class="p">(</span><span class="n">Stack</span> <span class="n">problemStack</span><span class="p">,</span> <span class="kt">int</span> <span class="n">stackLen</span><span class="p">){</span>
  <span class="k">if</span> <span class="n">problemStack</span><span class="p">.</span><span class="n">len</span> <span class="p">==</span> <span class="m">0</span> <span class="k">return</span> <span class="m">0</span><span class="p">;</span>
  <span class="n">currentProblem</span> <span class="p">=</span> <span class="n">problem</span><span class="p">.</span><span class="n">pop</span><span class="p">;</span> 
  <span class="n">getArtifacts</span><span class="p">(</span><span class="n">poseQuestion</span><span class="p">(</span><span class="n">currentProblem</span><span class="p">,</span> <span class="n">stackLen</span><span class="p">));</span>
  <span class="n">breakIntoSmallerProblems</span><span class="p">(</span><span class="n">problemStack</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">function</span> <span class="n">poseQuestion</span><span class="p">(</span><span class="kt">string</span> <span class="n">problem</span><span class="p">,</span> <span class="kt">int</span> <span class="n">stackLen</span><span class="p">){</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">stackLen</span> <span class="p">&lt;</span> <span class="m">100</span><span class="p">)</span> <span class="n">prioritisize</span><span class="p">(</span><span class="n">problem</span><span class="p">);</span>
  <span class="k">else</span> <span class="n">answerWithAutoTools</span><span class="p">(</span><span class="n">problem</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><p><strong>How computer works?</strong> Hardware, OS, Processes. <strong>How attacker works?</strong> Remote access changes, detection avoidance etc.</p>
<p><strong>RoadMap</strong></p>
<ol>
<li>Is the system compromised?
<ol>
<li>Are there mal related changes?</li>
<li>Is there mal user activity?
<ol>
<li>Suspicious logins?
<ol>
<li>Login artifact category ‚õèÔ∏è: Event log 4624, 4778, active users etc</li>
</ol>
</li>
</ol>
</li>
<li>Are there malware progs?</li>
<li>Are there mal OS changes?</li>
</ol>
</li>
</ol>
<p>Prioritization is based on: likely relevant, result acuracy, time to answer.</p>
<p>Beginner: start with a process and fill in categories</p>
<p>Advanced: when you already know about categories, think from that procpective.</p>
<p>Manager: categories</p>
<p>Cyber Truage User: same</p>
<p>File name &ndash;&gt; meta &ndash;&gt; content</p>
<h2 id="example">Example</h2>
<p>Is this computer compromised? Let&rsquo;s break down into smaller questions.</p>
<ol>
<li>Malicious Process ‚ùìAre there malprograms (backdoors, key loggers)?
<ol>
<li>Network</li>
<li>Files</li>
<li>Processes</li>
</ol>
</li>
<li>User ‚ùìIs there maluser activity (account takeover, insider threat)?</li>
<li>OS Configs ‚ùìAre there malconfigs (services enabled, disabled logging)?</li>
<li>Hardware ‚ùìAre there Mal hardware changes (firmware, BIOS)?</li>
</ol>
<h2 id="tools">Tools</h2>
<ol>
<li>Continuous monitoring vs snapshot</li>
<li>Artifacts vs full images</li>
</ol>
<p><a href="https://github.com/meirwah/awesome-incident-response">https://github.com/meirwah/awesome-incident-response</a></p>
<h2 id="analysis">Analysis</h2>
<p>Pivot between artifacts, score them, context about an artifact.</p>
<p>Challenges</p>
<p>Example 1. Logging in remotely to collect artifacts and run preinstalled UI admin tools:</p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr>
<td>Easy to collect artifacts?</td>
<td>Hard üß±: Many non-DFIR tools</td>
</tr>
<tr>
<td>Easy to connect remotely?</td>
<td>Easy üí∏: if remote connection is allowed</td>
</tr>
<tr>
<td>Identify relevant data?</td>
<td>Hard üß±: not DFIR specific</td>
</tr>
<tr>
<td>Pivoting</td>
<td>Hard üçØ-üß±: Depends</td>
</tr>
<tr>
<td>Scaling</td>
<td>Hard üß±: one at a time</td>
</tr>
</tbody>
</table>
<p>Example 2. Logging in remotely to collect artifacts with cmd tools:</p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr>
<td>Easy to collect artifacts?</td>
<td>Medium üçØ. Many tools, but can be scripted. Generally free.</td>
</tr>
<tr>
<td>Easy to connect remotely?</td>
<td>Hard üß±: have to copy tools to the system.</td>
</tr>
<tr>
<td>Identify relevant data?</td>
<td>Hard üß±: not DFIR specific</td>
</tr>
<tr>
<td>Pivoting</td>
<td>Hard üß±: Many output files</td>
</tr>
<tr>
<td>Scaling</td>
<td>Hard üß±: one at a time</td>
</tr>
</tbody>
</table>
<p>Example 3. Continuous monitoring:</p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr>
<td>Easy to collect artifacts?</td>
<td>Easy üí∏: for artifacts being monitored. Hard üß±: for others.</td>
</tr>
<tr>
<td>Easy to connect remotely?</td>
<td>Easy üí∏: if configured.</td>
</tr>
<tr>
<td>Identify relevant data?</td>
<td>Medium üçØ: depends on the tools.</td>
</tr>
<tr>
<td>Pivoting</td>
<td>Medium üçØ: depends on the tools.</td>
</tr>
<tr>
<td>Scaling</td>
<td>Easy üí∏: if monitoring is enabled</td>
</tr>
</tbody>
</table>
<p>Example 4. Full image:</p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr>
<td>Easy to collect artifacts?</td>
<td>Hard üß±to get full image and also there is a need to parse it. But reliable.</td>
</tr>
<tr>
<td>Easy to connect remotely?</td>
<td>Medium üçØ: depends</td>
</tr>
<tr>
<td>Identify relevant data?</td>
<td>Medium üçØ: depends on the parser tool.</td>
</tr>
<tr>
<td>Pivoting</td>
<td>Medium üçØ: depends on the parser tool.</td>
</tr>
<tr>
<td>Scaling</td>
<td>Medium üçØ: depends on aquisition tools.</td>
</tr>
</tbody>
</table>
<p>Example 5. Cyber Triage:</p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr>
<td>Easy to collect artifacts?</td>
<td>Easy üí∏: one exe for local or remote.</td>
</tr>
<tr>
<td>Easy to connect remotely?</td>
<td>Easy üí∏: easy to send over network.</td>
</tr>
<tr>
<td>Identify relevant data?</td>
<td>Medium üçØ: scores data.</td>
</tr>
<tr>
<td>Pivoting</td>
<td>Easy üí∏: navigation via UI.</td>
</tr>
<tr>
<td>Scaling</td>
<td>Multiple</td>
</tr>
</tbody>
</table>
<h2 id="cyber-triage">Cyber Triage</h2>
<p>Live, remote or image. Steps:</p>
<ol>
<li>Collect artifacts</li>
<li>Score</li>
<li>Review</li>
<li>Deep Dive (optional)</li>
<li>Report</li>
</ol>
<h2 id="user-activity">User Activity</h2>
<p>Lot&rsquo;s of attacks involve account compromise. In this case sometimes malware is not even needed.</p>
<p>Is there maluser activity? Breaking down:</p>
<ol>
<li>
<p>Computer fundamentals</p>
</li>
<li>
<p>User lifecycle. Is there maluser activity</p>
<ol>
<li>
<p>Are there suspicious accounts? SAM reg hive (local and domain). Even if the account is deleted, then you can still spot it: user directory sometimes is retained and also check logs.</p>
<ol>
<li>User Name: does it match conventions</li>
<li>Provoledges</li>
<li>Scope (local or domain)</li>
<li>creation time and date.</li>
</ol>
</li>
<li>
<p>Suspicious logins? Event logs, domain logs.</p>
<ol>
<li>Should this user use this account</li>
<li>Are they new to the computer</li>
<li>If remote, does the acc usually come from that computer?</li>
<li>Is the time expected</li>
<li>Does the acc have lots of failed logins?</li>
</ol>
</li>
<li>
<p>Suspicious activity?</p>
<ol>
<li>
<p>User started processes (Event log, RunMRU, MUICache, UserAssist, AppCompatCache or Shimcache, BAM (Background activity monitor), RecentApps, RecentFilecache or AmCache, SRUM (system resource usage monitor), Windows Timeline, Prefetch)</p>
<ol>
<li>Is it malware?</li>
<li>Is it signed?</li>
<li>Atypical location?</li>
<li>Suspicious time?</li>
<li>Created at suspicious time?</li>
<li>Recon?</li>
</ol>
</li>
<li>
<p>Search. Terms and times when the search was performed. Web artifacts and saved previous searches.</p>
<ol>
<li>Search relevant to job role?</li>
<li>Search for malicious progs or techniques?</li>
</ol>
</li>
<li>
<p>access resources Includes Host (remote or local), path, time. (configs like history of browser; recently used files, process handles). FileExplorer&rsquo;s ShellBags (what folder was opened) and RunMRU,Application Most Recently Used Files, Web artifacts (cookies, history, db, cache), Memory (commands, remote desk info, paths), cont monitoring.</p>
<ol>
<li>Accessed malwebsite?</li>
<li>network shares?</li>
<li>mass copy?</li>
</ol>
</li>
<li>
<p>remotely execute code. remote host + username; interactive or cmd; time. Registry. Event logs for logins and Event login for remote processes.</p>
<ol>
<li>Remote = local?</li>
<li>Expected?</li>
<li>Prog expected?</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<p>Account needs to exist. Login. Do stuff.  Enumerate users. Attacker could create an account, grant admin rights, domain accounts. <em>#todo: for each platform make a table of artifacts.</em></p>
<h2 id="malware">Malware</h2>
<p>APT - smarter malware.</p>
<p>Needs to start (one time or regulary on startup or schedule; or trick the user), hides itself, wicked stuff done. Launch malware instead of leg prog by placing it in the same directory if the full path is specified. Trick process to launch malicious library. For example, DLL injection. See the presentation <a href="/files/presentations/Injects_p1.pptx">here</a> and <a href="/files/presentations/Injects_p2.pptx">here</a>.  Data injection (exploit).</p>
<p>Hide itself, modify OS data structs to make itself invisble from some APIs. Parasite (Hijack another process with malthreads). Hollowing etc.</p>
<p>Triggered, trick launch and trick load.</p>
<p>Is it malicious?</p>
<ul>
<li>Hash (Threat Intelligence)</li>
<li>Byte-level signatures from previous malware?</li>
<li>Mal behaviour?</li>
<li>Reverse - mal instructions</li>
</ul>
<h3 id="persistence">Persistence</h3>
<p><strong>Startup</strong>. Are there mal persistence mechanisms?</p>
<ol>
<li>Are there mal <strong>triggered</strong> programs? Path to progs launched, when triggered (login, startup, schedule), user priv (service), creating date (unreliable). Run/RunOnce Registry, scheduled task, malicious service, WMI action that triggers based on some local event. AutoRuns, Startup folders, WMI Actions. Sandboxing, hashing or reverse. Prioritisation
<ol>
<li>Normally there?</li>
<li>Suspicious location?</li>
<li>Times similar to the event</li>
<li>Leg sign?</li>
<li>Do you find it on other machines withing the enterprise?</li>
</ol>
</li>
<li>Are there mal accidentally run (<strong>trick launch</strong>)?
1.</li>
<li>Are there libs accidentally loaded?
<ol>
<li><strong>LoadLibraryPathFile</strong> - set of folders for finding and resolving libraries.</li>
<li>The same folder as the exe.</li>
</ol>
</li>
</ol>
<h3 id="running">Running</h3>
<p>Are there mal processes running? Harderst part of IR ‚ùó Processes, Network ports, active network connections.</p>
<ol>
<li>Did any process start from a malexe?
<ol>
<li>Do any exe get flagged as malware?</li>
<li>unexpected folders?</li>
<li>signed?</li>
</ol>
</li>
<li>Did any process load mallib?
<ol>
<li>flagged as malware?</li>
<li>unexpected?</li>
</ol>
</li>
<li>Strange name similar to leg one? svchosts for example.</li>
<li>unexpected owners</li>
<li>Processes hidden by WinAPI?</li>
<li>Process taken over?
<ol>
<li>contents on disk and in memory should match</li>
<li>Behaviour unusual for this executable?</li>
</ol>
</li>
<li>Memory content flagged by malware engines?</li>
<li>Suspicious files opened, netwrk ports and connections, OS resources (mutexes, hooks etc), significant amount of CPU or RAM?</li>
<li></li>
</ol>
<p><strong>Memory forensics</strong>. Sometimes is the only way to detect malware. It&rsquo;s difficult, I should do that.</p>
<h3 id="remnants">Remnants</h3>
<p>Are there signs that the malware was run? May be it was removed or it&rsquo;s stealthy. Or may be it&rsquo;ll be too hard. Things that are left behind. The same artifacts that with processes in general (User Activity).</p>
<ul>
<li>Remnants that it was <strong>started</strong>. AutoRuns, schedule scripts, Run, RunOnce etc.</li>
<li>Remnants that it was <strong>running</strong>. Depends on the process. IOC (Indicator of Compromise). File artifacts, network cache (based on past incidents). Memory - unallocated memory that contains malware signatures.</li>
<li>Remnants that it was <strong>shutdown</strong>. Program Ended Artifact Category: name + time + reason*. Event logs, audit logs (not enabled by default).</li>
</ul>
<h3 id="key-list">Key list</h3>
<ul>
<li>Suspicious name or path</li>
<li>Exes or libs for the program are found? Are they malicious?</li>
<li>Time corresponds to the incident time?</li>
<li>Crashed? Did it crash before? Does it have known vulnerabilities?</li>
</ul>
<p>Cyber Triage uses WinAPI to answer questions about malware. Also uses SleuthKit to answer questions about rootkits.  Can work on memory image and run different volatility modules in UI.</p>
<p><a href="https://medium.com/bugbountywriteup/intro-to-malware-detection-using-yara-eacab8373cf4">Yara</a>:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">brew install yara
pip install yara-python
</code></pre></div><p>Repo for <a href="https://github.com/InQuest/awesome-yara">malware</a> and <a href="https://github.com/Xumeiquer/yara-forensics">forensics</a>. YaraGen.</p>
<h2 id="os-configurations">OS configurations</h2>
<p>Can be hard (no consistency). Are they different by accident or from malicous intent. Baseline reference (what the settings should be). Configs have only one place to set thing. Attacker motivation:</p>
<ul>
<li>Get access</li>
<li>Avoid detection</li>
<li>Make the response harder</li>
<li>Make malware to work</li>
</ul>
<p>Are there changes &hellip; (see above).  Why remote?</p>
<ul>
<li>Windows Remote Desktop feature enabled. RAT installed - malware-related question</li>
<li>enable ps remote exe</li>
<li>backdoor (launch cmd.exe)</li>
</ul>
<p>Answering questions:</p>
<ol>
<li>to ease access
<ol>
<li>has the remote access been enabled?</li>
<li>file sharing enabled?</li>
<li>config to launch different progs?</li>
</ol>
</li>
<li>prevent detection (disable firewalls, anti-virus). Rootkits are in malware section.
<ol>
<li>have any prevention tools been disabled?</li>
<li>installed mal certificates to trick prevention tools?</li>
<li>have many detection tools been disabled?</li>
</ol>
</li>
<li>Response harder (disable endpoint visibility, accounts (or reduce privs), reduce or disable logs, backups, volume shadow)
<ol>
<li>Were any accs disabled?</li>
<li>Visibility tools disabled?</li>
<li>Settings to record less data
<ol>
<li>audit settings changed?</li>
<li>logs cleared</li>
<li>Backup disabled?</li>
</ol>
</li>
</ol>
</li>
<li>Changes needed by malware? Change exe path, lib path, hosts file.</li>
</ol>
<p>Locations: lots of.</p>
<ul>
<li>Registry</li>
<li>Congif files (app specific or OS)</li>
</ul>
<p>Need to have a baseline of settings. Compare. Categories:</p>
<ul>
<li>remote</li>
<li>Detections avoidance</li>
<li>response prevention</li>
</ul>
<h2 id="prioritization-and-process">Prioritization and Process</h2>
<p>There are different paths to follow to answer the same questions. Some are more efficitent.</p>
<p>Pulling on threads.  Find a piece of evidence and focus on that to fully understand it. Example (depth search):</p>
<ul>
<li>Looking for malware and find program run entry for malware</li>
<li>Stop looking for other malware and focus on that one
<ul>
<li>What happened before and after?</li>
<li>What else is in the same folder?</li>
<li>What does it do?</li>
</ul>
</li>
<li>Repeat for each you find</li>
</ul>
<p>How to find the first evidence? Prioritize or brute force.</p>
<ul>
<li><strong>Prioritize</strong> (Manual). You never know where the evidence are going to be.
<ul>
<li>impact on investigation result</li>
<li>likelyhood to find anything</li>
<li>false poisitive?</li>
<li>time required</li>
</ul>
</li>
<li><strong>Brute force</strong> (Automated). Let tools and software to find evidence.</li>
</ul>
<blockquote>
<p>Cyber Triage: can I mark something as bad and run analysis for this piece of evidence again. - yes</p>
</blockquote>
<h2 id="conclusion">Conclusion</h2>
<p>Break into smaller questions up to the point where you can answer with a specific artifact category&hellip;</p>
<ul>
<li>users
<ul>
<li>accs</li>
<li>logins</li>
<li>activity</li>
</ul>
</li>
<li>malware
<ul>
<li>persistence / start-up mechanisms</li>
<li>running processes</li>
<li>remnants left</li>
</ul>
</li>
<li>os config
<ul>
<li>remote access</li>
<li>detection prevention</li>
<li>response challenges</li>
<li>malware enablement</li>
</ul>
</li>
</ul>
<p>See the general schema <a href="/files/pdf/DivideAndConquerDiag202010-201008-094835.pdf">here</a>.</p>
<h2 id="steps">Steps</h2>
<h3 id="discover">Discover</h3>
<p>Obtain and image or physical evidence to work with.</p>
<p>For Android, to see installed apps and recent activity:</p>
<ul>
<li><code>packages.list</code></li>
<li><code>packages.xml</code> - to see permissions for <strong>all</strong> applications in one place. For example, if this application has a SMS or messaging permission, you&rsquo;ll know to look. Or, for example, I need all applications that have chat permissions or access to camera.</li>
<li>com.vending.adnroid</li>
<li>usagestats</li>
<li>usage history</li>
<li>battery stats</li>
<li>recent images</li>
<li>snapshots</li>
</ul>
<p>tccb on iOS?</p>
<p>Chromebook - extension preferences file.</p>
<p>Run commercial tools to parse the info. If not, then try to find some specific parser, may be for similar app and try.</p>
<p>Create profiles and you any real data for generation.</p>
<p>Fake data - mockaroo and generatedata.com</p>
<ol>
<li>take the snapshot of the system state before populating with data</li>
<li>Write a script-plan</li>
<li>take notes</li>
<li>perform actions 1 min apart</li>
<li>scrrencap actions</li>
<li>document them (log with script)</li>
<li>compare with the the baseline &ldquo;snapshot&rdquo; from step 1.</li>
</ol>
<p><a href="https://blog.d204n6.com/2020/08/setting-up-testing-lab-of-ios-and.html">https://blog.d204n6.com/2020/08/setting-up-testing-lab-of-ios-and.html</a></p>
<p><a href="https://www.mac4n6.com/blog/2020/8/23/step-by-step-iphone-setup-for-ios-research-via-bizzybarney">https://www.mac4n6.com/blog/2020/8/23/step-by-step-iphone-setup-for-ios-research-via-bizzybarney</a></p>
<p><a href="https://www.mac4n6.com/blog/2020/8/13/step-by-step-macos-setup-for-ios-research-via-bizzybarney">https://www.mac4n6.com/blog/2020/8/13/step-by-step-macos-setup-for-ios-research-via-bizzybarney</a></p>
<p>Do not make assumptions before testing! For example, a QuizUp game folder contained some usernames and pictures and the assumption would be that this person was in touch with the suspect. However, testing revealed that when you choose to randomly find you a rival from around the globe üåé, QuizUp automatically adds them to the player&rsquo;s contacts.</p>
<p>Jessica advices to use appropriate view-managers for specific files, but I would also recommend to check these files in hex as well. There was once a case when I performed vulnerability assessment of a mobile application and I got a SQLite DB, opened it in SQLite Browser DB and couldn&rsquo;t find the data I was looking for. However <code>grep</code>  command showed that this data <em>was</em> in the DB. I opened it in hex and noticed that it might have been damaged because there was an amount of data almoust the same size as the visible one, that was not shown in the viewer. Perhaps that were some deleted rows or the DB <em>was</em> damaged indeed.</p>
<p>Applications of different versions or platforms may have different data structure. For example, iOS QuizUp had a geolocation field, while Android didn&rsquo;t at that point in time.	[<a href="https://www.eccu.edu/methodology-for-testing-forensic-hypothesis-and-finding-truth/#attend">1</a>]</p>
<h2 id="dfir-samples">DFIR Samples</h2>
<p><a href="https://medium.com/@soji256/where-can-you-find-images-that-you-can-use-to-learn-forensics-141c6c8cdc9e">https://medium.com/@soji256/where-can-you-find-images-that-you-can-use-to-learn-forensics-141c6c8cdc9e</a></p>
<h2 id="references">References</h2>
<p>[<a href="https://www.eccu.edu/methodology-for-testing-forensic-hypothesis-and-finding-truth/#attend">1</a>] Webinar, METHODOLOGY FOR TESTING FORENSIC HYPOTHESIS AND FINDING TRUTH by Jessica Hyde</p>
<h2 id="references-1">References</h2>
<p>[<a href="https://www.eccu.edu/methodology-for-testing-forensic-hypothesis-and-finding-truth/#attend">1</a>] Webinar, METHODOLOGY FOR TESTING FORENSIC HYPOTHESIS AND FINDING TRUTH by Jessica Hyde</p>
<p>[<a href="https://ijcsit.com/docs/Volume%208/vol8issue3/ijcsit2017080331.pdf">2</a>] Live vs Dead System Acquisition</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
