<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Investigation Layout - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.b67d7fec5daec98747a80616a05e9e1e96dc0976219c428241762578c5ae69c3.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-articles">
      <a href="/docs/articles">
        <span>Articles</span>
      </a>
    </li>
    
    <li class="menu-item-blog">
      <a href="/docs/blog">
        <span>Blog</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit">
      <a href="/docs/toolkit">
        <span>Toolkit</span>
      </a>
    </li>
    
    <li class="menu-item-about me">
      <a href="/docs/about">
        <span>About me</span>
      </a>
    </li>
    
    <li class="menu-item-achievements">
      <a href="/docs/achievements">
        <span>Achievements</span>
      </a>
    </li>
    
    <li class="menu-item-contacts">
      <a href="/docs/contact">
        <span>Contacts</span>
      </a>
    </li>
    
    <li class="menu-item-notes">
      <a href="/docs/notes">
        <span>Notes</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-articles">
      <a href="/docs/articles">
        <span>Articles</span>
      </a>
    </li>
    
    <li class="menu-item-blog">
      <a href="/docs/blog">
        <span>Blog</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit">
      <a href="/docs/toolkit">
        <span>Toolkit</span>
      </a>
    </li>
    
    <li class="menu-item-about me">
      <a href="/docs/about">
        <span>About me</span>
      </a>
    </li>
    
    <li class="menu-item-achievements">
      <a href="/docs/achievements">
        <span>Achievements</span>
      </a>
    </li>
    
    <li class="menu-item-contacts">
      <a href="/docs/contact">
        <span>Contacts</span>
      </a>
    </li>
    
    <li class="menu-item-notes">
      <a href="/docs/notes">
        <span>Notes</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/articles/forensics/"> Back to Forensics Section </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#anatomy-of-an-investigation">Anatomy of an investigation:</a></li>
    <li><a href="#emails">Emails</a></li>
    <li><a href="#logs">Logs</a></li>
    <li><a href="#web-history">Web History</a></li>
    <li><a href="#antiforensics">Antiforensics</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Investigation Layout</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-search"></i>
              
          <a class="category-link" href="/domain/forensics">forensics</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      
      <div class="article-category">
          
            
            
            
            
            
              <i class="fab fa-linux"></i>&nbsp;<i class="fab fa-apple"></i>&nbsp;<i class="fab fa-windows"></i>&nbsp;<i class="fas fa-mobile"></i>
            
          <a class="platform-link" href="/platforms/all">all</a>
          
      </div> <br />
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <h2 id="anatomy-of-an-investigation">Anatomy of an investigation:</h2>
<p><strong>Identification/Assessment</strong>. Understand your scope (technical and legal aspects), your goals and people you are going to work with. Identify the stakeholders. Decide on the tools.</p>
<p><strong>Collection/Acquisition</strong>. Begins with first response and arriving to the scene. Everything must be recorded and documented. Opponents will try to discredit your work. Use industry accepted tools. Know the digital footprint of these tools. Document everything.</p>
<p><strong>Preservation</strong>. Making extra copies of all media. Don&rsquo;t examine and analyse the original. Calculate hashes. If there is no way to copy - document why.</p>
<p><strong>Examination</strong>. Document each step taken. Might take audio notes. There is no court-approved tools: use familiar tools. If it&rsquo;s a new tool, demonstrate the proficiency and your testing of it.</p>
<p><strong>Analysis</strong>. Art supersedes science. Know what is garbage. Unexpected places. Don&rsquo;t ignore exculpatory (proving innocence) data.</p>
<p><strong>Reporting</strong>. Begins at the very beginning and goes on until the last day. Document EVERYTHING! Know the laws. If you don&rsquo;t know something, ask.</p>
<p>Types of investigation:</p>
<ul>
<li>civil (constitutional law may not apply but privacy legislation is likely to)</li>
<li>criminal (usually leads to arrest)</li>
<li>Internal (not intended for others to see)</li>
</ul>
<p>Stakeholders - everyone investing their money üíµ, time üï∞ or effort into the company. So, employees are also stakeholders. Some of them might become my opponents or proponents. Scope!</p>
<p>First responders first arrive to the crime scene. Always behave as if this is a crimila case and that it will go to the court. Things to note when you&rsquo;ve come first:</p>
<ul>
<li>make many photos</li>
<li>make videos</li>
</ul>
<p>Responsibilities:</p>
<ul>
<li>Who&rsquo;s in charge</li>
<li>preserve the scene</li>
<li>before touching, record and document everything</li>
<li>protect the integrity of the material found</li>
<li>don&rsquo;t contaminate the scene (try not to be tempted to eat buiscuits üç™ and burgers üçî on the scene however hard that might seem). This means, that you should also preserve the physical evidence as well.</li>
</ul>
<p>Tools üõ†:</p>
<ul>
<li>A PC technician&rsquo;s toolkit (screwdrivers ü™õ, squeezers and etc) to be able to remove HDD, removing lockdown cables, ‚úÖ</li>
<li>Digital camera üì∏  that embed timestamps on the photos. Take photos, the more the better.</li>
<li>Video camera üìπ. Take a video, the longer the better.</li>
<li>Label evidence</li>
<li>Transporting the evidence</li>
</ul>
<p>Start documenting even before you get to the scene.</p>
<p>Is the PC turned off?</p>
<ul>
<li>Yes. Then transport it as is.</li>
<li>No. Depending on the case nature, turn off or perform the RAM capture.</li>
</ul>
<p>Evidence:</p>
<ul>
<li>Obvious - PC, cameras, flash drives, PDAs, removable media. Mind the chain of custody. Document the physical condition (mouse to left or right as the owner is a lefty or a righty), applications running, keep audio notes.</li>
<li>Non-obvious
<ul>
<li>manuals for devices that were not found - look for these devices</li>
<li>digital media taken with some device that was not found -look for this device</li>
<li>Sticky notes or liitle papers with scrambled notes.</li>
</ul>
</li>
</ul>
<p>Collecting the evidence:</p>
<ul>
<li>don&rsquo;t touch before the lead says ok
<ul>
<li>do fingerprints need to be collected?</li>
<li>DNA?</li>
</ul>
</li>
<li>mind the scope and get it in writing even if it&rsquo;s not a crimial case</li>
<li>protect from environmtal hazards (anti-static bags, Faraday bags for mobile phones and such, protect from extreme cold and heat, protect from dust with zip-bags or boxes, keep dry, pad everything sufficiently to withstand the shock of a collision or fall).</li>
</ul>
<p>Live capture or nuclear ‚ò¢Ô∏è shutdown? Whenever possible, do the RAM capture:</p>
<ul>
<li>processes</li>
<li>network connections</li>
<li>routing tables</li>
<li>Passwords</li>
</ul>
<p>But there might be a rootkit installed that will deem all unusable the moment you try doing something.</p>
<p>Wear gloves, üß§ Identify with ids, FD (flash drive) + its <em>sequence number</em> within this case + case number. Subsequent images of these devices will have the same number + copy&rsquo;s sequence number.</p>
<p>Example: <em>A USB Flash drive was found on the scene during case study 0124. It was the first USB drive found yet. This device was assigned a number FD-01-0124. Then we made two bit-by-bit copies of this drive and these were assigned numbers FD-01-0124-01 and FD-01-0124-02 respectively.</em></p>
<p>Media capture tools üõ†:</p>
<ul>
<li>Moonsols Dumpit (capture only)</li>
<li>Mandiant redline (capture and analysis)</li>
<li>FTK</li>
<li><code>vol.py</code> ?</li>
</ul>
<p>Live memory capture (know data sources - digital corpora, SourceForge, NIST):</p>
<ul>
<li><code>fciv -both nps-2009-ddfs.e01 &gt; hash.txt</code> for Windows</li>
<li><code>type hash.txt</code> - load the <code>hash.txt</code> on Win</li>
<li>ProDiscover -</li>
<li>DFF</li>
</ul>
<p>Search techniques:</p>
<ul>
<li>Ever widening circle (few people)</li>
<li>Grid search (many people)</li>
<li>Strip search (in between)</li>
</ul>
<p>Remeber to havesufficient space for this and the appripriate FS that supports large files.</p>
<h2 id="emails">Emails</h2>
<p>Almoust anything can be forged.</p>
<ol>
<li>Understand the contents</li>
<li>Verify the source</li>
<li>Get the other side of the exchange</li>
</ol>
<p>Tools üõ†:</p>
<ul>
<li>Email Examiner</li>
</ul>
<h2 id="logs">Logs</h2>
<p>Event Viewer. Usage example: you need to prove that system time was changed. In the Event Viewer filter System logs by event id=1 and the user name.</p>
<p>Log Parser 2.2. <code>LogParser -i: EVT -o: CSV &quot;SELECT TimeGenerated, SourceName, EventCategoryName,  Message INTO C:\tmp\report.csv FROM System WHERE EventID = 1 AND SID LIKE '%Michael% '&quot; -resolveSIDs:ON</code></p>
<p>You are not proving, you are providing information.</p>
<h2 id="web-history">Web History</h2>
<p>üõ†  Mandiant Web Historian .</p>
<p>Directory Snoop. If the file was deleted and some clusters overwritten, save clusters as a file. Look up the last cluster under the &ldquo;Cluster chain&rdquo;, click the file in question and select Cluster - Copy to file. Fill in &ldquo;Last cluster&rdquo; and save. May take a very long time. Use some data carving tools to try to get the information from there.</p>
<h2 id="antiforensics">Antiforensics</h2>
<h2 id="references">References</h2>
<p>[<a href="https://learning.oreilly.com/videos/digital-archaeology-livelessons/9780132853835/9780132853835-02_01/">1</a>] Digital Archaeology from O&rsquo;Reilly by LiveLessons</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
