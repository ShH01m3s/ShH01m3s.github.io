<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸº RAM - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/tools">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/tools">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/tools">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/tools">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/artefacts/win/"> ğŸ‘ˆğŸ¼ Back to </br> ğŸªŸ Windows Artefacts </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#collection">Collection</a>
      <ul>
        <li><a href="#live">Live</a></li>
        <li><a href="#dead">Dead</a></li>
        <li><a href="#determine-the-correct-profile-vol2">Determine the correct profile (Vol2)</a></li>
        <li><a href="#convert-to-raw">Convert To Raw</a></li>
        <li><a href="#hyperfilsys"><code>hyperfil.sys</code></a></li>
        <li><a href="#pagefilesys"><code>pagefile.sys</code></a></li>
        <li><a href="#swapfilesys"><code>swapfile.sys</code></a></li>
        <li><a href="#vmem">VMEM</a>
          <ul>
            <li><a href="#virtualbox">VirtualBox</a></li>
            <li><a href="#vmware">VMware</a></li>
            <li><a href="#hyper-v">Hyper-V</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#analysis">Analysis</a>
      <ul>
        <li><a href="#get-the-profile-info-vol2">Get the Profile Info (vol2)</a></li>
        <li><a href="#convert-to-raw-1">Convert to raw</a></li>
        <li><a href="#compression">Compression</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">ğŸº RAM</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 01.06.2023
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p>*Memory is the best evidence, although the hardest to preserve. If you recall Frozen II, &ldquo;Water has memory&rdquo; - same story. Even if you delete all the evidence, memory silently remembers all that. But it&rsquo;s so fragile&hellip;
<img src="images/boiler-leaking-water-scaled.jpg" alt="img"></p>
<p><strong>KPCR</strong> - (Kernel) Processor Control Region. It points to a <strong>KDBG</strong>, Kernel Debugging Data Block, a structure maintained by the Windows kernel for debugging purposes. KPCR&rsquo;s offset is fixed on Windows XP but differs in later versions. There are two ways to find KDBG: scan for its signature or find the KPCR and then follow the offset specified. Why do we even need this KDBG? It has a pointer <code>PsActiveProcessHead</code> which points to the list of processes (called <code>EPROCESS</code>) with all the information about those dudes.</p>
<p><img src="images/win-mem.png" alt="img"></p>
<p>Each <code>EPROCESS</code> has two essential structures: PEB (Process Environment Block) and VAD (Virtual Address Descriptors). PEB contains ğŸ¾ path to the executable, ğŸ¾ command line that spawned the process, ğŸ¾ linked list of DLLs used. VAD is a balanced tree structure that keeps track of all pages allocated for this process (virtual addresses).</p>
<p>PEB contains several doubly-linked lists that can be helpful when spotting hiding malware:
ğŸ¾ <code>InLoadOrderModule</code> list (<code>InLoad</code>) - doubly-linked list
ğŸ¾ <code>InInitializationOrderModule</code> list (<code>InInit</code>) - doubly-linked list
ğŸ¾ <code>InMemoryOrderModule</code> list (<code>InMem</code>) - doubly-linked list</p>
<h2 id="collection">Collection</h2>
<p>Why even bother collecting RAM?</p>
<ul>
<li><strong>User Activity</strong> &ndash;&gt; File usage and knowledge. Prove someone did something or used something. Common artefacts: Prefetch, ShimCache, Web browser, $MFT (master file table).</li>
<li><strong>Encryption</strong> &ndash;&gt;  Key files and passwords. Standard tools: <code>hashcat</code>, <code>passware</code>.</li>
<li><strong>Host compromise</strong> &ndash;&gt; Processes, network activity, malware, rootkits, persistence.</li>
</ul>
<blockquote>
<p>&hellip;force a crash and subsequently produce a memory dump as a mechanism for collecting volatile data. Sheward, Mike. Hands-on Incident Response and Digital Forensics (p. 165). BCS Learning &amp; Development Limited. Kindle Edition.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="err">ğŸ“˜</span> <span class="n">dd</span> <span class="k">if</span><span class="p">=\\.\</span><span class="n">PhysicalMemory</span> <span class="n">of</span><span class="p">=</span><span class="n">memory</span><span class="p">.</span><span class="n">img</span> <span class="n">conv</span><span class="p">=</span><span class="n">noerror</span> <span class="c"># requires elevated privileges.</span>
</span></span><span class="line"><span class="cl"><span class="c"># â€˜\\.\PhysicalMemoryâ€™; a second device, â€˜\\.\DebugMemoryâ€™</span>
</span></span></code></pre></div><blockquote>
<p>â—ï¸ All loaded device drivers on modern systems must be digitally signed.
â—ï¸To be loaded on servers, drivers now must pass the Windows Hardware Quality Labs certification. The forensic workaround is not yet clear.</p>
</blockquote>
<h3 id="live">Live</h3>
<p>ğŸ¾ <strong>RAM image</strong> (bit-by-bit copy of RAM). It can be acquired for all PC, there are certain complications with a Mac. Also, you can collect RAM data for mobile devices for separate processes only. Virtual machines are usually stored in a separate file once the system is suspended.
ğŸ¾ <strong>Network</strong> connections, ARP cache
ğŸ¾ Process tree</p>
<p>ğŸ› ï¸ WinPMEM, ğŸ› ï¸ DumpIt, ğŸ› ï¸ F-Response and SIFT, ğŸ› ï¸ Belkasoft Live RAM Capturer, ğŸ› ï¸ MagnetForensics Ram Capture</p>
<h3 id="dead">Dead</h3>
<p>ğŸ¾ <strong>Hibernation files</strong>. Exist on major OS (Windows, Mac, Linux). For Windows - <a href="/docs/dfir/host/reference/windows/windows-hibernation">hyberfil.sys</a>. It&rsquo;s a RAM capture made by OS when the PC falls asleep ğŸ’¤. ğŸ“‚ <code>%SystemDrive%\hyberfil.sys</code>
ğŸ¾ <strong>Page files</strong>. ğŸ“‚ <code>%SystemDrive%\pagefile.sys</code>. Partial RAM.
ğŸ¾ <strong>Swap files</strong>. ğŸ“‚ <code>%SystemDrive%\swapfile.sys</code> (Win8+ and 2012+). Partial RAM, suspended modern applications swapped to disk.
ğŸ¾ <strong>Crash dumps</strong>. ğŸ“‚ <code>%WINDIR%\MEMORY.DMP</code>, it&rsquo;s a full RAM copy.</p>
<blockquote>
<p>ğŸ›  Belkasoft RAM Capturer. ~4Mb footprint in RAM, slow. Magnet RAM Capturer - huge footprint, fast. Dumpit - the fastest, the smallest footprint (didn&rsquo;t work on Win10 on a VM Parallels on macOS). All of the aforementioned tools run in kernel mode! FTK Imager - big footprint, <strong>user mode</strong>, doesn&rsquo;t work on VM (in my case). Benchmark the tools yourself from time to time. Redline, Fast Dump (<code>fdpro.exe</code>). Sumuri&rsquo;s Interception (included with Paladin). Exploits some memory bug on some OS for machines that have either Thunderbolt or a Firewire to overwrite the admin&rsquo;s password in memory.</p>
</blockquote>
<p><strong>Malfind</strong>. <a href="https://www.linkedin.com/pulse/process-injection-detection-malfind-britton-manahan/">https://www.linkedin.com/pulse/process-injection-detection-malfind-britton-manahan/</a></p>
<h3 id="determine-the-correct-profile-vol2">Determine the correct profile (Vol2)</h3>
<p>Volatility 3 deduces the profile itself. With <code>vol2</code>, you need to do that manually. Two plugins are available for that: <code>kdbgscan</code> and <code>imageinfo</code>.</p>
<blockquote>
<p>âœï¸ A useful note, use ğŸ“˜ <code>export VOLATILITY_LOCATION</code> and ğŸ“˜ <code>export VOLATILITY_PROFILE</code> so that you won&rsquo;t have to specify <code>--profile</code> and <code>-f</code> options every time.</p>
</blockquote>
<p><code>kdbgscan</code> is very slow since it has to scan the image to find the KDBG. The latest OS versions encrypt KDBG; thus, volatility needs to find <code>KdCopyDataBlock</code> to decrypt it, making it work even slower. So, once you get the offset (virtual offset of KDBG on Vista- and <code>KdCopyDataBlock</code> on Win8+), use <code>-g</code> or <code>--kdbg</code> option with other plugins to speed up the analysis since some modules will try to find this structure on their own (<code>pslist</code>, for instance).</p>
<p><code>kdbgscan</code> will spill out several possible guesses, and you must choose the right one. Of course, it helps if you know the OS and the patch version and can explicitly provide it. But when it&rsquo;s not an option, try several options to see which one yields any good-looking results (<code>Kernal Base</code> <code>Matches MZ</code> set to <code>True</code>, <code>PsActiveProcessHead</code> and <code>PsLoadedModuleList</code> showing the reasonable number for a live system, KPCR address is provided).</p>
<p><code>imagescan</code> can give you additional info that&rsquo;s useful for the investigation: ğŸ¾ capture time (system time) and DTB (directory table base).</p>
<p>How to determine if the profile is correct?</p>
<h3 id="convert-to-raw">Convert To Raw</h3>
<p>Several other formats can contain RAM residues: crash dumps, hibernation and swap files, virtual machine RAM, and live firewire sessions. To normalise the data so that volatility can feast on it, use <code>imagecopy</code> plugin.</p>
<h3 id="hyperfilsys"><code>hyperfil.sys</code></h3>
<p>ğŸ“‚ <code>%SystemDrive%\hiberfil.sys</code></p>
<p>Compressed RAM dump at the moment of hibernation. On Win8+ - new format and greater frequency.</p>
<blockquote>
<p>â—ï¸Doesn&rsquo;t work on VMs.</p>
</blockquote>
<p>On Win8+ the file is zeroed out (leaving only 4K at the beginning), hence the new artefact is smaller. Also, Fast Startup is now taking over, which means it logs the user out before creating a hibernation file. Hence, the file is even smaller.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="err">ğŸ“˜</span> <span class="n">powercfg</span><span class="p">.</span><span class="n">exe</span> <span class="c"># to see the hibernation settings</span>
</span></span><span class="line"><span class="cl"><span class="err">ğŸ“˜</span> <span class="n">powercfg</span><span class="p">.</span><span class="n">exe</span> <span class="p">/</span><span class="n">hibernate</span> <span class="n">on</span> <span class="c"># turn hibernation on</span>
</span></span></code></pre></div><p><strong>Decompression</strong> tools ğŸ› ï¸: Volatility, <code>imagecopy</code>, <code>hibr2bin.exe</code>, Hibernation Recon.
<strong>Analysis</strong> tools ğŸ› ï¸: BulkExtractor, Magnet AXIOM, Volatility, Passware.</p>
<p><strong>Structure</strong>:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Content</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header</td>
<td>PO_MEMORY_IMAGE structure</td>
</tr>
<tr>
<td>Page list</td>
<td>An array of physical page</td>
</tr>
<tr>
<td>Processor State</td>
<td>CONTEXT + KSPECIAL_REGISTERS</td>
</tr>
<tr>
<td>Memory Range Array n</td>
<td>Header: NextTable page, Number of entries. Entries: Destination page + Checksum.</td>
</tr>
<tr>
<td>Xpress compressed block p</td>
<td>Magic \x81\x81xpress (&gt;Win2K). Compressed data</td>
</tr>
<tr>
<td>Xpress compressed block p+1</td>
<td></td>
</tr>
<tr>
<td>Memory Range Array n+1</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Win8+ - new file format.</p>
<p>Not as common, but just as good. <code>imagecopy</code> plugin converts different formats into raw format to speed up. Hiberfile - compressed. Determine the OS profile and run the plugin.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vol.py -f crash.dmp --profile<span class="o">=</span>Win7SP2x64 imagecopy -O crash2mem.raw
</span></span><span class="line"><span class="cl">vol.py -f hyberfil.sys --profile<span class="o">=</span>Win7SP2x64 imagecopy -O hibir2mem.raw
</span></span></code></pre></div><p>C:\hiberfil.sys</p>
<p>C:\Memory.dmp</p>
<p>What is <a href="https://www.howtogeek.com/howto/15140/what-is-hiberfil.sys-and-how-do-i-delete-it/">hyberfil.sys</a>. Two types of compression.</p>
<p><code>imageinfo</code> - to identify the profile for memory image. Running <code>vol.py imageinfo -f hiberfil.sys</code> is slow and inefficient. No profiles were sugested. But when we have a live capture of a system, we can use this dump to determine the profile to perfom actions with the right profile on <code>hyberfil.sys</code>.</p>
<h3 id="pagefilesys"><code>pagefile.sys</code></h3>
<p>ğŸ“‚ <code>%SystemDrive%\pagefile.sys</code></p>
<p>When Windows system runs out of RAM, it uses HDD space to temporarily store the data from RAM. To acquire it from a live system: use <a href="https://ericzimmerman.github.io/#!index.md">https://ericzimmerman.github.io/#!index.md</a> or FTK Imager. Get separate files using <a href="https://www.cgsecurity.org/wiki/PhotoRec">PhotoRec</a> or using a Hex redactor (for example, <a href="https://www.sweetscape.com/010editor/">101 Editor</a>). This file is deleted on reboot.</p>
<p><strong>Properties</strong>:</p>
<table>
<thead>
<tr>
<th><strong>Hidden</strong></th>
<th>True</th>
<th><strong>Owner SID</strong></th>
<th>S-1-5-32-544</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>System</strong></td>
<td>True</td>
<td><strong>Owner Name</strong></td>
<td>ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹</td>
</tr>
<tr>
<td><strong>Read Only</strong></td>
<td>False</td>
<td><strong>Group SID</strong></td>
<td>S-1-5-18</td>
</tr>
<tr>
<td><strong>Archive</strong></td>
<td>True</td>
<td><strong>Group Name</strong></td>
<td>SYSTEM</td>
</tr>
</tbody>
</table>
<p>To copy this file use <code>RawCopy64.exe /FileNamePath:c:\pagefile.sys</code>.</p>
<p>To parse this file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">strings pagefile.sys <span class="p">|</span> egrep <span class="s2">&#34;^https?://&#34;</span> <span class="c1"># show URLs found in memory</span>
</span></span><span class="line"><span class="cl">strings pagefile.sys <span class="p">|</span> grep -i <span class="s2">&#34;^[a-z]:\\\\&#34;</span> <span class="c1"># file paths used are shown</span>
</span></span><span class="line"><span class="cl">strings pagefile.sys <span class="p">|</span> grep -i <span class="s2">&#34;^[a-zA-Z09_]*=.*&#34;</span> <span class="c1"># env vars</span>
</span></span></code></pre></div><p>Apply <a href="https://github.com/matonis/page_brute">yarn rules</a> against <code>pagefile</code>.</p>
<h3 id="swapfilesys"><code>swapfile.sys</code></h3>
<p>ğŸ“‚ <code>%SystemDrive%\swapfile.sys</code></p>
<h3 id="vmem">VMEM</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="err">ğŸ“˜</span> <span class="n">python3</span> <span class="n">vol</span><span class="p">.</span><span class="n">py</span> <span class="o">-f</span> <span class="n">1</span><span class="p">.</span><span class="n">vmem</span> <span class="n">windows</span><span class="p">.</span><span class="n">vadinfo</span><span class="p">.</span><span class="n">VadInfo</span> <span class="c"># to view Virtual Address Descriptors ([VAD](https://resources.infosecinstitute.com/topic/finding-enumerating-processes-within-memory-part-2/)).</span>
</span></span></code></pre></div><h4 id="virtualbox">VirtualBox</h4>
<p>When the VM is suspended, NOT full memory dump is saved. So, it&rsquo;s tricky to parse and analyse it. Either collect RAM from within the VM itself or use volatility for some formats.</p>
<p>ğŸ¾ <code>.sav</code> - partial memory image</p>
<p>ğŸ“‚ <code>.VirtualBox/Machines/vmname/Snapshots</code></p>
<h4 id="vmware">VMware</h4>
<blockquote>
<p>â—ï¸ Uses a more complex format that needs prior parsing, ESX.</p>
</blockquote>
<p>Each snapshot has a separate <code>.vmem</code> file. These are not raw memory dumps but contain everything that was in RAM then.</p>
<p>ğŸ¾ <code>.vmem</code> - ram memory
ğŸ¾ <code>.vmss</code> - VMware saved state
ğŸ¾ <code>.vmsn</code> - VMware snapshot</p>
<p>ğŸ“‚ <code>C:\XXX\My Virtual Machines\vmname</code> (VMware workstation)
ğŸ“‚ <code>dcname\dsname\dirname\vmname\</code> (ESX)</p>
<h4 id="hyper-v">Hyper-V</h4>
<blockquote>
<p>â—ï¸ Uses a more complex format that needs prior parsing, Hyper-V.</p>
</blockquote>
<p>ğŸ¾ <code>.bin</code> - memory image, <code>.vsv</code> - save state.</p>
<p>ğŸ“‚ <code>C:\XXX\vmname\Virtual Machines\GUID</code></p>
<h2 id="analysis">Analysis</h2>
<p>First, you need to understand that data in RAM is not scattered willy-nilly. Weren&rsquo;t that the case, we would eventually find ourselves up a creek without a paddle.</p>
<h3 id="get-the-profile-info-vol2">Get the Profile Info (vol2)</h3>
<p><code>imagecopy</code> plugin is used to convert some file types into raw format. It decreases the time, needed to analyse the file. How to get the correct profile since <code>imageinfo</code> gives you several options and <code>kdbscan</code> gives even more? Below is the output from <code>imageinfo</code>. The purple square shows the service pack version and the green one - the correct profile with the correct service pack. The other two suggested profiles have some service pack versions appended to the end.</p>
<p><img src="images/vol_py_imageinfo_mem_udemy%201.png" alt="vol_py_imageinfo_mem_udemy"></p>
<p>Then validate the file by listing processes that were run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ğŸ“˜ vol.py -f hiberfil.raw pslist --profile<span class="o">=</span>Win7SP0x86
</span></span></code></pre></div><p>If the output makes sense (like the one one in the picture below), the profile is correct.</p>
<p><img src="images/vol_py_pslist_udemy%201.png" alt="vol_py_pslist_udemy"></p>
<h3 id="convert-to-raw-1">Convert to raw</h3>
<p><code>hiberfil</code> files are not as common, but just as good. <code>imagecopy</code> plugin converts different formats into <code>raw</code> format to speed up. Also saves up to 75% of memory size, therefore decreasing the time for analysis.  First, determine the OS profile (for vol2) and run the plugin.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ğŸ“˜ vol.py -f hiberfil.sys --profile<span class="o">=</span>Win7SP0x86 imagecopy -O hyber.raw
</span></span><span class="line"><span class="cl">ğŸ“˜ vol.py -f crash.dmp --profile<span class="o">=</span>Win7SP2x64 imagecopy -O crash2mem.raw
</span></span><span class="line"><span class="cl">ğŸ“˜ vol.py -f hyberfil.sys --profile<span class="o">=</span>Win7SP2x64 imagecopy -O hibir2mem.raw
</span></span></code></pre></div><blockquote>
<p>Running <code>vol.py imageinfo -f hiberfil.sys</code>, for example, is slow and inefficient. No profiles were suggested. But when we have a live system capture, we can use this dump to determine the profile to perform actions with the right profile on <code>hyberfil.sys</code>.</p>
</blockquote>
<h3 id="compression">Compression</h3>
<p>Win8.1+ is now compressing some memory regions.</p>
<p>ğŸ› ï¸ <code>winmem_decompress.py</code>. The output can&rsquo;t be analysed with volatility, it&rsquo;s slow. ğŸ› ï¸ <code>win10memcompression.py</code></p>
<h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    <p>[<a href="">1</a>] Magnet</p>
<p>[<a href="">2</a>] SDF Memory Forensics</p>
<p>[<a href="https://habr.com/ru/company/group-ib/blog/512728/">1</a>] Ğ¢Ğ°Ğ¹Ğ½Ñ‹ Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ¿Ğ¾Ğ´ĞºĞ°Ñ‡ĞºĞ¸ pagefile.sys: Ğ¿Ğ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ Ğ°Ñ€Ñ‚ĞµÑ„Ğ°ĞºÑ‚Ñ‹ Ğ´Ğ»Ñ ĞºĞ¾Ğ¼Ğ¿ÑŒÑÑ‚ĞµÑ€Ğ½Ğ¾Ğ³Ğ¾ ĞºÑ€Ğ¸Ğ¼Ğ¸Ğ½Ğ°Ğ»Ğ¸ÑÑ‚Ğ°</p>
<p>[<a href="https://www.blackhat.com/presentations/bh-usa-08/Suiche/BH_US_08_Suiche_Windows_hibernation.pdf">2</a>] About hybernation files</p>
<p>[<a href="https://www.researchgate.net/publication/311849840_Modern_windows_hibernation_file_analysis">3</a>] About new hybernation file format</p>
<p><a href="https://resources.infosecinstitute.com/topic/finding-enumerating-processes-within-memory-part-2/">https://resources.infosecinstitute.com/topic/finding-enumerating-processes-within-memory-part-2/</a></p>
<p><a href="https://imphash.medium.com/windows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e">https://imphash.medium.com/windows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e</a></p>
<p><a href="https://eforensicsmag.com/windows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-by-kirtar-oza/">https://eforensicsmag.com/windows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-by-kirtar-oza/</a></p>
<p><a href="https://eforensicsmag.com/85384-2/">https://eforensicsmag.com/85384-2/</a></p>

</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
