<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗒️ Forensic Investigation Methodology - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-exploits ⚙️">
      <a href="/docs/exploits">
        <span>Exploits ⚙️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-exploits ⚙️">
      <a href="/docs/exploits">
        <span>Exploits ⚙️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/"> 👈🏼 Back to </br> Incident Investigation 🔎 🥷 </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#identificationassessment-aka-preparation">Identification/Assessment (aka Preparation)</a>
      <ul>
        <li><a href="#scope">Scope</a></li>
        <li><a href="#sterilizing-target-media">Sterilizing Target Media</a></li>
      </ul>
    </li>
    <li><a href="#collection">Collection</a>
      <ul>
        <li><a href="#-first-responder-checklist">✅ First Responder Checklist</a></li>
        <li><a href="#documenting-and-recording">Documenting And Recording</a></li>
        <li><a href="#acquisition">Acquisition</a></li>
        <li><a href="#evidence-preservation">Evidence Preservation</a></li>
      </ul>
    </li>
    <li><a href="#examination--analysis">Examination &amp; Analysis</a>
      <ul>
        <li><a href="#-examiner-checklist">✅ Examiner Checklist</a></li>
        <li><a href="#prioritization-and-process">Prioritization and Process</a></li>
      </ul>
    </li>
    <li><a href="#critical-thinking">Critical Thinking</a></li>
    <li><a href="#known-good">Known Good</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">🗒️ Forensic Investigation Methodology</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      <div class="article-category">
          
            
            
            
            
            
              <i class="fab fa-linux"></i>&nbsp;<i class="fab fa-apple"></i>&nbsp;<i class="fab fa-windows"></i>&nbsp;<i class="fas fa-mobile"></i>
            
            
          
          
      </div> <br />
      

      
      

      
      <div class="article-tag">
          <i class="fas fa-tag"></i>
          
          
          <a class="tag-link" href="/tags/checklist" rel="tag">checklist</a>
          
      </div> 
      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p>Before this process starts, there probably has already been some Incident Response done or even finished (refer to <a href="https://bakerst221b.com/docs/dfir/ir-checklist/)">https://bakerst221b.com/docs/dfir/ir-checklist/)</a>.</p>
<h2 id="identificationassessment-aka-preparation">Identification/Assessment (aka Preparation)</h2>
<p>In short, understand your scope (technical and legal aspects), your goals and people you are going to work with. Identify the stakeholders. Decide on the tools.</p>
<h3 id="scope">Scope</h3>
<p>🖼  Get the <strong>scope</strong> for your investigation!</p>
<p><strong>Choose the appropriate media.</strong></p>
<p>❓ What&rsquo;s the file system and OS of the target media? Depending on the answer you might need to appropriately format the evidence drive and assemple a flash drive with the tools needed.</p>
<p><strong>Choose the acquision method.</strong></p>
<p>❓ Will there only be live or dead acquisition?
❓ Will you make a <strong>logical backup</strong> (doesn&rsquo;t copy all i.e. doesn&rsquo;t copy slack, free space and deleted files) or <strong>imaging</strong> (bit-by-bit copy). ⚠️ Should not be used on a live system!</p>
<h3 id="sterilizing-target-media">Sterilizing Target Media</h3>
<p>See <a href="https://bakerst221b.com/docs/dfir/investigation/collection/#sterilising-target-media">here</a> for media sterilisation.</p>
<h2 id="collection">Collection</h2>
<p>Evidence collection begins with the first response and arriving to the scene (how weird&hellip;.). The person collecting the evidence is assuming the role of a first responder. Not always they are digital forensic experts. Opponents will try to discredit their work. That’s why it’s so important to use industry accepted tools and know the digital footprint of these tools (checked on a monthly basis). For each media type there is a separate section under Incident Investigation -&gt; Collection section on this website - <a href="https://bakerst221b.com/docs/dfir/investigation/collection/">https://bakerst221b.com/docs/dfir/investigation/collection/</a>.</p>
<p>There are several important notes to keep in mind:</p>
<p>❗️Document everything. Before anything can be acquired, it needs to be properly documented first. First responder needs to record all the findings in the Chain of Custody form.</p>
<p>❗️Take photos and videos before touching anything. These photos/videos need to have proper time-stamping.</p>
<p>❗️Do never make any analysis on the original media! Any analysis and investigation is only performed against a copy.</p>
<p>❗️Make hashes before acquisition, after and when making copies.</p>
<h3 id="-first-responder-checklist">✅ First Responder Checklist</h3>
<ul>
<li><input disabled="" type="checkbox"> Sanitise the target disk that will be used to copy evidence to</li>
<li><input disabled="" type="checkbox"> Prepare all the toolkit that will be needed</li>
<li><input disabled="" type="checkbox"> Start filling out the Chain of Custody form, each evidence assigned a unique ID (see below for examples).</li>
<li><input disabled="" type="checkbox"> All photos taken before touching the scene</li>
<li><input disabled="" type="checkbox"> Make sure that Internet, Bluetooth, AirDrop are all turned off on the machine that is used to acquire the image (* in case of physical acquisition).</li>
<li><input disabled="" type="checkbox"> Connect the write blocker to the PC and the evidence drive to the write blocker (power + data cables) or launch a software write blocker on the acquirer machine (see below for how-to) (* in case of physical acquisition).</li>
<li><input disabled="" type="checkbox"> Calculate <strong>the hash of the evidence drive</strong> (pre-hash). Document it.</li>
<li><input disabled="" type="checkbox"> Image the evidence.</li>
<li><input disabled="" type="checkbox"> Calculate the <strong>hash of the original evidence</strong> again, validate the hash and document it.</li>
<li><input disabled="" type="checkbox"> Calculate the <strong>hash of the image that was taken</strong> (post-hash) and make sure it matches the above ones taken previously.</li>
</ul>
<h3 id="documenting-and-recording">Documenting And Recording</h3>
<p>Start documenting even before you get to the scene. First, make sure that timestamps are configured on both devices. Take as many photos and videos as possible. Take overall and close-up photos. Make sure that all the connections between the devices are photographed clearly. Photograph the evidence in situ (if possible). Identify and asign unique ids to the evidence collected</p>
<p><img src="images/chain-of-custody.png" alt="chain-of-custody"></p>
<h3 id="acquisition">Acquisition</h3>
<p>Dead Acquisition</p>
<p>Live Acquisition</p>
<h3 id="evidence-preservation">Evidence Preservation</h3>
<ol>
<li>copy original, operate on the copy</li>
<li>hashes</li>
<li>write blocking devices</li>
<li>min files created</li>
<li>register timestamps before openning files</li>
</ol>
<h2 id="examination--analysis">Examination &amp; Analysis</h2>
<p>Art supersedes science. Know what is garbage. Unexpected places. Don&rsquo;t ignore exculpatory (proving innocence) data.</p>
<p>❗️ Correlate data with other independent sources. Some data might have been tampered with and you should try to find other evidence that describe the same data. For example, timestamps can be easily changed. Therefore, try to find network or login events to correlate them.</p>
<ul>
<li>
<p>Analysis of non-volatile storage devices</p>
</li>
<li>
<p>Analysis of volatile storage devices (RAM)</p>
</li>
<li>
<p>Analysis of communication devices</p>
</li>
<li>
<p>Physical Storage Media Analysis</p>
<ul>
<li>Volume analysis. <strong>Volume</strong> - collection of storage locations.
<ul>
<li>File System
<ul>
<li>Application</li>
<li>OS</li>
</ul>
</li>
<li>DB</li>
<li>Swap space</li>
</ul>
</li>
<li>Memory analysis</li>
</ul>
</li>
<li>
<p>Network</p>
</li>
</ul>
<h3 id="-examiner-checklist">✅ Examiner Checklist</h3>
<details>
    <summary>Expand &hellip;</summary>
    <p>Is this computer compromised? Let&rsquo;s break down into smaller questions. Below will be the full checklist, this one is for overview.</p>
<ul>
<li><input disabled="" type="checkbox"> Malicious Process
<ul>
<li><input disabled="" type="checkbox"> Are there malprograms (backdoors, key loggers)?</li>
<li><input disabled="" type="checkbox"> Network</li>
<li><input disabled="" type="checkbox"> Files</li>
<li><input disabled="" type="checkbox"> Processes</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> User
<ul>
<li><input disabled="" type="checkbox"> Is there maluser activity (account takeover, insider threat)?</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> OS Configs
<ul>
<li><input disabled="" type="checkbox"> Are there malconfigs (services enabled, disabled logging)?</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Hardware
<ul>
<li><input disabled="" type="checkbox"> Are there Mal hardware changes (firmware, BIOS)?</li>
</ul>
</li>
</ul>

</details>
<p>Bypassing controls (if, say, it&rsquo;s PIN protected, data encrypted, ACL, compression). There will be lots of data and only some is relevant. In most cases, NSRL file data is used to eliminate known files, such as operating system and application files, during criminal forensic investigations. This reduces the number of files which must be manually examined and thus increases the efficiency of the investigation. See <a href="https://www.nist.gov/itl/ssd/software-quality-group/national-software-reference-library-nsrl/about-nsrl/nsrl-introduction">here</a>. This list is used by Autopsy.</p>
<p>Testing computer <a href="https://www.nist.gov/itl/ssd/software-quality-group/computer-forensics-tool-testing-program-cftt">tools</a>. Video analytics <a href="https://www.nist.gov/programs-projects/video-analytics">here</a> and photo <a href="https://www.nist.gov/itl/iad/image-group">here</a>. And about NIST research in cloud forensics <a href="https://www.nist.gov/programs-projects/nist-cloud-computing-forensic-science">here</a>.</p>
<p>About SIM forensics as well <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-101r1.pdf">here</a>.</p>
<p>Main idea is to concentrate on some areas, answer some specific questions, like:</p>
<ol>
<li>Is there child exploitation material? Search videos and pictures.</li>
<li>Is this PC compromised? Not obvious.</li>
<li>Who did this computer communicate with?</li>
</ol>
<p><strong>First option:</strong></p>
<p>Big problem &ndash;&gt; n*(small problem). Recursively break a problem into smaller problems until one of them becomes solvable.</p>
<p><strong>Second option:</strong></p>
<p>Or we can be guided by artifact ⛏️  categories.</p>
<p>First, break the bigger problem into a smaller one. Then answer questions with artifact ⛏️ categories.</p>
<p>Here is the pseudocode for this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">breakIntoSmallerProblems</span><span class="p">(</span><span class="n">Stack</span> <span class="n">problemStack</span><span class="p">,</span> <span class="kt">int</span> <span class="n">stackLen</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="n">problemStack</span><span class="p">.</span><span class="n">len</span> <span class="p">==</span> <span class="m">0</span> <span class="k">return</span> <span class="m">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">currentProblem</span> <span class="p">=</span> <span class="n">problem</span><span class="p">.</span><span class="n">pop</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">  <span class="n">getArtifacts</span><span class="p">(</span><span class="n">poseQuestion</span><span class="p">(</span><span class="n">currentProblem</span><span class="p">,</span> <span class="n">stackLen</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="n">breakIntoSmallerProblems</span><span class="p">(</span><span class="n">problemStack</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">poseQuestion</span><span class="p">(</span><span class="kt">string</span> <span class="n">problem</span><span class="p">,</span> <span class="kt">int</span> <span class="n">stackLen</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">stackLen</span> <span class="p">&lt;</span> <span class="m">100</span><span class="p">)</span> <span class="n">prioritisize</span><span class="p">(</span><span class="n">problem</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span> <span class="n">answerWithAutoTools</span><span class="p">(</span><span class="n">problem</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>How computer works?</strong> Hardware, OS, Processes. <strong>How attacker works?</strong> Remote access changes, detection avoidance etc.</p>
<p><strong>RoadMap</strong></p>
<ol>
<li>Is the system compromised?
<ol>
<li>Are there mal related changes?</li>
<li>Is there mal user activity?
<ol>
<li>Suspicious logins?
<ol>
<li>Login artifact category ⛏️: Event log 4624, 4778, active users etc</li>
</ol>
</li>
</ol>
</li>
<li>Are there malware progs?</li>
<li>Are there mal OS changes?</li>
</ol>
</li>
</ol>
<p>Prioritization is based on: likely relevant, result acuracy, time to answer.</p>
<p>Beginner: start with a process and fill in categories</p>
<p>Advanced: when you already know about categories, think from that procpective.</p>
<p>Manager: categories</p>
<p>Cyber Truage User: same</p>
<p>File name &ndash;&gt; meta &ndash;&gt; content</p>
<h3 id="prioritization-and-process">Prioritization and Process</h3>
<p>There are different paths to follow to answer the same questions. Some are more efficitent.</p>
<p>Pulling on threads.  Find a piece of evidence and focus on that to fully understand it. Example (depth search):</p>
<ul>
<li>Looking for malware and find program run entry for malware</li>
<li>Stop looking for other malware and focus on that one
<ul>
<li>What happened before and after?</li>
<li>What else is in the same folder?</li>
<li>What does it do?</li>
</ul>
</li>
<li>Repeat for each you find</li>
</ul>
<p>How to find the first evidence? Prioritize or brute force.</p>
<ul>
<li><strong>Prioritize</strong> (Manual). You never know where the evidence are going to be.
<ul>
<li>impact on investigation result</li>
<li>likelyhood to find anything</li>
<li>false poisitive?</li>
<li>time required</li>
</ul>
</li>
<li><strong>Brute force</strong> (Automated). Let tools and software to find evidence.</li>
</ul>
<blockquote>
<p>Cyber Triage: can I mark something as bad and run analysis for this piece of evidence again. - yes</p>
</blockquote>
<p>See the general schema <a href="/files/pdf/DivideAndConquerDiag202010-201008-094835.pdf">here</a>.</p>
<h2 id="critical-thinking">Critical Thinking</h2>
<p><strong>Challenge assumptions</strong> (sometimes its something you have not seen or dealt with before), consider alternatives, evaluate data, identify key drivers, understand context.</p>
<p>List all assumptions and ask yourself how sure you are of these statements and what might happen if they are wrong. Categorize these assumptions based on the certainty. Refine and remove those assumptions that are proven to be wrong. Identify addition data needs for those assumptions that are still uncertain. Research?</p>
<p>Think about the <strong>alternatives</strong>, for example, brainstorming. Ask yourself the six W&rsquo;s to help develop the alternatives. Null hypothesis - the opposite to the main hypothesis (for anomalous data).</p>
<p>Know your data! <strong>Know normal and abnormal</strong>. Establish the baselines for normal to be able to detect the abnormal (like, a clean installation of a system is examined and everything is then compared to it). Look for incosistent data. <strong>Assess the data against different hypothesis</strong> to see how well it fits.</p>
<p>Identify key drivers: technology, regulatory (laws and standards), society (politics, people want to be safe), supply chain (logistics, cost, scheduling, customer requirements), employees (skills and training needed), threat actors (tech capabilities, motives, opportunity).</p>
<p>Understand the context from the perspective of different stakeholders. Framing techniques help keep everyone on the same page (what do they need from me, how can I frame the issue, do I need to place their questions in a broader context). Same vocabulary. Steps:</p>
<ul>
<li>Key components. Break the problem down and identify the partss, actors and categories.</li>
<li>Factors at Play.</li>
<li>Relationships. Static? Dynamic? Graphing.</li>
<li>Similarities/Differences. Leverage the past work!</li>
<li>Redefine. Rephrase and paraphrase the issue. What is the root cause?</li>
</ul>
<blockquote>
<p>💡 May be it&rsquo;s better to arrange it as a table. Merge with the information from Cyber Triage DFIR webinar by Brian Carrier and Digital Archaeology.</p>
</blockquote>
<h2 id="known-good">Known Good</h2>
<p>Not all the files are worth considering. However, it&rsquo;s hard to keep all of them in mind. So, I&rsquo;ve made (about to) several database files that contain information on files on a clean installed system. There will be some diviations, I presume, but I hope it will help eliminate a huge pack of files as well.</p>
<h2 id="references">References</h2>
<details>
    <summary>Expand &hellip;</summary>
    <p>[<a href="https://learning.oreilly.com/videos/digital-archaeology-livelessons/9780132853835/9780132853835-09_01/">1</a>] Digital Archaeology LiveLessons (Video Training), Safari by [Michael W Graves](<a href="https://learning.oreilly.com/search?query=author%3A%22Michael">https://learning.oreilly.com/search?query=author%3A&quot;Michael</a> W Graves&quot;&amp;sort=relevance&amp;highlight=true)</p>
<p>[<a href="https://www.coursera.org/lecture/digital-forensics-concepts/forensics-methodology-and-investigations-33wNN">2</a>] InfoSec Digital Forensics Course, module Forensics Methodology and Investigations</p>
<p>[<a href="https://www.eccu.edu/methodology-for-testing-forensic-hypothesis-and-finding-truth/#attend">3</a>] Webinar, METHODOLOGY FOR TESTING FORENSIC HYPOTHESIS AND FINDING TRUTH by Jessica Hyde</p>
<p>[<a href="https://ijcsit.com/docs/Volume%208/vol8issue3/ijcsit2017080331.pdf">4</a>] Live vs Dead System Acquisition</p>
<p>[<a href="https://www.coursera.org/learn/introduction-cybersecurity-cyber-attacks/home/welcome">5</a>] IBM course</p>

</details>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
