<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hiding Data - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-dfir üîç">
      <a href="/docs/dfir">
        <span>DFIR üîç</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit üß∞">
      <a href="/docs/toolkit">
        <span>Toolkit üß∞</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-dfir üîç">
      <a href="/docs/dfir">
        <span>DFIR üîç</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit üß∞">
      <a href="/docs/toolkit">
        <span>Toolkit üß∞</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/antiforensics/"> üëàüèº Back to </br> üï∂Ô∏è Anti-Forensics </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#alternative-data-stream">Alternative data stream</a></li>
    <li><a href="#registry">Registry</a></li>
    <li><a href="#attributes">Attributes</a></li>
    <li><a href="#documents-metadata">Documents Metadata</a></li>
    <li><a href="#logs">Logs</a></li>
    <li><a href="#bad-clusters">Bad clusters</a></li>
    <li><a href="#steganography">Steganography</a></li>
    <li><a href="#fs">FS</a></li>
    <li><a href="#malware">Malware</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Hiding Data</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      <div class="article-category">
          
            
            
            
            
            
              <i class="fab fa-linux"></i>&nbsp;<i class="fab fa-apple"></i>&nbsp;<i class="fab fa-windows"></i>&nbsp;<i class="fas fa-mobile"></i>
            
            
          
          
      </div> <br />
      

      
      

      
    </div>
    
    <b>Created:</b> 01.10.2020
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <h2 id="alternative-data-stream">Alternative data stream</h2>
<p>Alternate data streams. Specific for Windows. See more <a href="/docs/dfir/forensic-investigation/reference/windows/win-ads">here</a>. Are there such streams for other OS? If yes, how to make them and discover them?</p>
<p>To ensure compatability between NTFS and HFS. Allows hiding files.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">C:</span><span class="p">\</span><span class="nb">type </span><span class="n">C:</span><span class="p">\</span><span class="n">mal</span><span class="p">.</span><span class="n">exe</span> <span class="p">&gt;</span> <span class="n">C:</span><span class="p">\</span><span class="n">readme</span><span class="p">.</span><span class="n">txt</span><span class="err">:</span><span class="n">naughty</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl"><span class="nb">start </span><span class="n">readme</span><span class="p">.</span><span class="n">txt</span><span class="err">:</span><span class="n">naughty</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl"><span class="n">C:</span><span class="p">\</span><span class="n">mklink</span> <span class="n">innocent</span><span class="p">.</span><span class="n">exe</span> <span class="n">readme</span><span class="p">.</span><span class="n">txt</span><span class="err">:</span><span class="n">naughty</span><span class="p">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># to run</span>
</span></span><span class="line"><span class="cl"><span class="n">innocent</span><span class="p">.</span><span class="n">exe</span>
</span></span></code></pre></div><p>But <code>dir /r</code> - will display <strong>all</strong> streams. LNS and Sfind will hunt down such files. Also, when you copy files from and to a FAT partition - all residual files will be deleted.</p>
<h2 id="registry">Registry</h2>
<p>Specific for Windows. See more <a href="/docs/articles/forensics/analysis/materials/artifactsdb/windows/win-registry">here</a> or <a href="https://www.notion.so/Windows-Registry-05f763c061b94572838c6c99fdc3ffe0">here</a>.</p>
<p>As an example, see <code>HKEY_USERS/Software/Microsoft/Internet Explorer/Scripts/1</code>. Doesn&rsquo;t have anything. Add Multistring value, name &ldquo;Hidden data&rdquo;, click key and start with random data like <code>0x111110000</code> to make it look legitimate, press many spaces to hide it from preview. Add some secret data, ignoring warnings about empty strings. Now, it will be difficult to find this.</p>
<blockquote>
<p>üí° Interesting idea for security policies. Everyday automatically run RegShot upon system start and before turning off to see the changes everyday. In case of an incident, there might be very helpful. How costy would that tactics be?</p>
</blockquote>
<h2 id="attributes">Attributes</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">attrib</span> <span class="p">+</span><span class="nb">h
</span></span></span></code></pre></div><h2 id="documents-metadata">Documents Metadata</h2>
<p>Possible for any OS. Examples for Windows might include macros. For Office doc - <code>File -&gt; Info -&gt; Comments</code>. Click file and properties -&gt; Details. Other fields can be used to store information. In case of Office docs, most of the data is not the contents, but formatting and metadata. When adding comments, file&rsquo;s last accessed and modified dates are updates and the file size is increased.</p>
<p><strong>Tools</strong> üõ†:</p>
<ul>
<li><a href="https://new.thepaynegroup.com/metadata-assistant">Metadata Assistant</a>. Commercial. Not too expensive. bulb üí° <em>May be I should write a python tool that does the same?</em></li>
<li><code>strings.exe</code> + <code>grep</code> - simple string search for known case-specific keywords.</li>
</ul>
<h2 id="logs">Logs</h2>
<p>Logs can be disabled, cleared or tamprered. The noisest is to diable them or clear. Although the evidence is deleted this way, this is a very strong indicator that the sysmtem <strong>was</strong> compromised.</p>
<ol>
<li>application <code>APPEVENT.EVT</code></li>
<li>system <code>SYSEVENT.EVT</code></li>
<li>security <code>SECEVENT.EVT</code></li>
</ol>
<p><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog</code> allows to change log location. By default, logs are here: <code>System32\Config</code>.</p>
<ul>
<li><code>MRU</code> - most recently used</li>
<li>cache</li>
<li>cookies</li>
<li>turnoff Autocomplete</li>
<li>clear Toolbar</li>
</ul>
<p><code>HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer</code></p>
<p><code>C:\auditpol \\targetIPaddress /disable</code> delete recent docs.</p>
<h2 id="bad-clusters">Bad clusters</h2>
<p>Edit <code>$BadClus</code> file to mark a block of sectors to be skipped by file system (NTFS). üõ† Metasploit can do it.</p>
<h2 id="steganography">Steganography</h2>
<h2 id="fs">FS</h2>
<p>In case of FAT systems, they read the root directory from top to bottom and stop at the directory starting with <code>0x0</code>. Anything past that value is not seen by the OS. Sometimes there might be information hidden there. More <a href="/docs/dfir/data-storage/file-systems#fat">here</a>.</p>
<h2 id="malware">Malware</h2>
<p>Service Hijacking and Replacement.</p>
<p>Process Injection.</p>
<p>Filename/Service Hijacking.</p>
<p>ADS.</p>
<p>WebShells and Beacons.</p>
<p>Firmware.</p>
<p>DLL Injeciton.</p>
<p>A/V Bypass.</p>
<p>Defense Manipulation.</p>
<p>Frequent Compilation.</p>
<p>Binary Padding.</p>
<p>Packing/Armoring.</p>
<p>Dormant Malware.</p>
<p>Signing Code with Valid Cert.</p>
<p>Anti-Forensics/Timestomping.</p>
<p>Rootkits.</p>
<p>&ldquo;Fileless&rdquo; Malware.</p>
<h2 id="references">References</h2>
<p>[<a href="https://dfir.ru/2018/10/07/hiding-data-in-the-registry/">1</a>] Hiding data in the registry, M. Suhanov</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
