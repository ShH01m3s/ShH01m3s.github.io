<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî• Detection Devices - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.1af15d612be2936e296de738ed7062bbcecd3efedde8f895f919d76ce622691e.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-forensics üîç and incident response ü•∑">
      <a href="/docs/dfir">
        <span>Forensics üîç and Incident Response ü•∑</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-reverse üîß">
      <a href="/docs/reverse">
        <span>Reverse üîß</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit üß∞">
      <a href="/docs/toolkit">
        <span>Toolkit üß∞</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference üìö">
      <a href="/docs/reference">
        <span>Tech Reference üìö</span>
      </a>
    </li>
    
    <li class="menu-item-notes üìù">
      <a href="/docs/notes">
        <span>Notes üìù</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-forensics üîç and incident response ü•∑">
      <a href="/docs/dfir">
        <span>Forensics üîç and Incident Response ü•∑</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-reverse üîß">
      <a href="/docs/reverse">
        <span>Reverse üîß</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit üß∞">
      <a href="/docs/toolkit">
        <span>Toolkit üß∞</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference üìö">
      <a href="/docs/reference">
        <span>Tech Reference üìö</span>
      </a>
    </li>
    
    <li class="menu-item-notes üìù">
      <a href="/docs/notes">
        <span>Notes üìù</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/"> Back to Incident Investigation üîé ü•∑ Section üëàüèº </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#host-based">Host-based</a>
      <ul>
        <li><a href="#tripwire">Tripwire</a></li>
        <li><a href="#ossec">OSSEC</a></li>
        <li><a href="#samhain">Samhain</a></li>
        <li><a href="#centralized-logging">Centralized logging</a></li>
        <li><a href="#logwatch">LogWatch</a></li>
      </ul>
    </li>
    <li><a href="#network-based">Network-based</a>
      <ul>
        <li><a href="#common-filters">Common filters</a></li>
        <li><a href="#snort">Snort</a></li>
      </ul>
    </li>
    <li><a href="#logs">Logs</a>
      <ul>
        <li><a href="#event-viewer-">Event Viewer üåà</a></li>
        <li><a href="#varlog-"><code>/var/log</code> üêß</a></li>
        <li><a href="#excersice">Excersice</a></li>
      </ul>
    </li>
    <li><a href="#file-settings">File Settings</a></li>
    <li><a href="#firewall">Firewall</a>
      <ul>
        <li><a href="#stateless-inspection">Stateless Inspection</a></li>
        <li><a href="#stateful-inspection">Stateful Inspection</a></li>
        <li><a href="#both">Both</a></li>
        <li><a href="#xml-gateway">XML Gateway</a></li>
        <li><a href="#proxy-firewall">Proxy Firewall</a></li>
        <li><a href="#next-generation-firewalls-ngfw">Next generation Firewalls (NGFW)</a></li>
        <li><a href="#limitations">Limitations</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">üî• Detection Devices</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
          <a class="category-link" href="/domain/ir">ir</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      
      <div class="article-category">
          
            
            
            
            
            
              <i class="fab fa-linux"></i>&nbsp;<i class="fab fa-apple"></i>&nbsp;<i class="fab fa-windows"></i>&nbsp;<i class="fas fa-mobile"></i>
            
          <a class="platform-link" href="/platforms/all">all</a>
          
      </div> <br />
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p>Host-based IDS look for local system configurations and behaviour, while network-based IDS look for network connections and looks for anomalies and common signatures.</p>
<p>IDS and IPS as firewall&rsquo;s filters. There are Control Plane (looks after the OS and routing table) and the Forwarding Plane (makes decisions on routing and discarding). If something happens to the Control Plane, the device will still forward the traffic (really???).</p>
<p>By default IDS only <strong>listens üëÇ</strong> the traffic. It&rsquo;s usually connected to the span port on a switch. Looks for anomalies and sends alerts. Won&rsquo;t take any actions by default, but can be configured in such a way. If the IDS is down, nothing is changed for the rest of the network, it&rsquo;s still operating.</p>
<p>IPS takes actions on its own. It is not connected to the span port, but rather is a gateway. Before it inspects and allows a packet through, nothing can move forward. So, if IPS is down, everyone is down (unless there is some load balancing enabled or may be some policy for such cases). Positioned right after the router, edge device or a firewall.</p>
<h2 id="host-based">Host-based</h2>
<h3 id="tripwire">Tripwire</h3>
<p>Uses a mail server to send alerts. So, a mail server also has to be installed. Keeps its logs and configs in <code>/etc/tripwire</code>.</p>
<p>To install: <code>apt-get install tripwire</code>. Answer <code>yes</code> to all questions promted. <code>/etc/tripwire/twcfg</code> - is a config file. <code>twpol</code> - list of files to watch for. Determines, whether critical files have changed. <code>tw.pol</code>, <code>tw.cfg</code> - are the files produced after compilation of the previously mentioned ones.</p>
<p><code>twadmin --create-cfgfile --cfgfile tw.cfg.enc --site-keyfile site.key twcfg.txt</code>:</p>
<ul>
<li><code>--create-cfgfile</code> - create config file, <code>--cfgfile tw.cfg.enc</code>   to specify the file to create</li>
<li><code>--site-keyfile site.key</code> - key to use</li>
<li><code> twcfg.txt</code> file to use</li>
</ul>
<p>Now, creating a policy:</p>
<p><code>twadmin --create-polfile --cfgfile tw.cfg.enc --polfile tw.pol.enc --site-keyfile site.key twpol.txt</code>:</p>
<ul>
<li><code>--create-polfile</code> - create policy file, <code>--cfgfile tw.cfg.enc</code>   to specify the configuration file to use,</li>
<li><code>--polfile tw.pol.enc</code> - the policy file to create</li>
<li><code>--site-keyfile site.key</code> - key to use</li>
<li><code> twpol.txt</code> file to use</li>
</ul>
<p>Initialize the database:</p>
<p><code>tripwire --init --cfgfile tw.cfg.enc --polfile tw.pol.enc --site-key site.key --local-keyfile local.key</code></p>
<p>To check the system for any critical files changes: <code>tripwire --check</code>.</p>
<p>All these files need to be updates everytime you make changes to the policy or the configuration. The database needs to be updated as well.</p>
<h3 id="ossec">OSSEC</h3>
<p>Not just integrity checking (like Tripwire), but also some additional checking. It performs logs analysis and rootkit checking + process monitoring. Consists of two parts: a server and an agent. Server can only be installed on Linux, while an agent can also be installed on Windows.</p>
<p><strong>Install the server</strong></p>
<p><code>tar -xfv ossec-hids-version.tar.gz &amp;&amp; cd ossec-hids-version</code> to unpack the files.</p>
<p>To start: <code>/etc/init.d/ossec start</code>.</p>
<p><strong>Install the agent</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> /var/ossec/bin
</span></span><span class="line"><span class="cl">./manage_agents
</span></span><span class="line"><span class="cl">&gt; a
</span></span><span class="line"><span class="cl">&gt; some IP
</span></span><span class="line"><span class="cl">&gt; y
</span></span><span class="line"><span class="cl">&gt; e <span class="c1"># extract the key</span>
</span></span><span class="line"><span class="cl">&gt; <span class="m">001</span> <span class="c1"># agent id, copy the key</span>
</span></span></code></pre></div><p>Install it on the Windows machine (for example). Now, connect to the server. On the server go to <code>cd ../logs &amp;&amp; less ossec.log</code>. You can <code>cd alerts</code> and see the alerts.</p>
<h3 id="samhain">Samhain</h3>
<p><code>apt install samhain &amp;&amp; cd /etc/samhain</code>. Open the config file.</p>
<p><code>samhain -t init -p info</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">vi /etc/samhain/samhainrc
</span></span></code></pre></div><p>In this file go to the Trusted User option and type something like the following: <code>TrustedUser = 104</code>. Then run <code>samhain -t update</code>.</p>
<p><strong>To run</strong></p>
<p><code>samhain -t check</code> then <code>cd /var/log/samhain</code> and open the <code>samhain-init.log</code> and <code>samhain.log</code>.</p>
<h3 id="centralized-logging">Centralized logging</h3>
<p>Open a syslog file. Each system might have a sligtly different name for these. For example: <code>nano /etc/rsyslog.conf</code>. Uncomment the line for UDP syslog reception. And for the clients now to log remotely to this machine, need to go through <del>hell</del> <code>/etc/rsyslog.d/ &amp;&amp; nano 50-default.conf</code>. Add something like <code>*.* 	@@IP:port</code> to log everything remotely.</p>
<h3 id="logwatch">LogWatch</h3>
<p><code>apt install logwatch</code></p>
<p>Reads all the logs and generates a summary.</p>
<p><code>cd /etc/logwatch</code>, <code>cd /usr/share/logwatch</code>. The configs in this folder will overwrite the configs from   <code>cd /etc/logwatch</code>.</p>
<p><code>logwatch.conf</code> - is the general config file. Separately, there is a folder with lots of file, each for each specific log.</p>
<h2 id="network-based">Network-based</h2>
<p>A network-based IDS usually monitors the network, logs it and alerts the admin if something catches its eye. Using a span port, you can run <em>all</em> the traffic through IDS. Another way to analyse the network is to get the network capture (for example, <code>pcap</code> file) and check it with an IDS offline.</p>
<ul>
<li>Snort</li>
<li>Suricata</li>
<li>Bro-IDS</li>
<li>Network Captures</li>
</ul>
<p>Endpoint protection:</p>
<ul>
<li>Browser protection</li>
<li>Anti-virus ü¶†</li>
<li>Data loss prevention</li>
<li>E-mail üìÆ</li>
</ul>
<p><code>tcpdump -s 0 -w file.pcap</code></p>
<ul>
<li><code>-s 0</code> - grab the entire packet</li>
<li><code>w file.pcap</code> - write to file.pcap</li>
<li><code>host &lt;IP&gt;</code> - only capture particular IP address</li>
<li><code>-nn</code> - don‚Äôt resolve hostnames <em>or</em> port names.</li>
<li><code>-E</code> - decrypt IPSEC traffic by providing an encryption key.</li>
<li><code>-tttt</code> - give maximally human-readable timestamp output.</li>
<li><code>-X</code> or <code>e</code> - display Ethernet header as well.</li>
</ul>
<p>You can also use Wireshark for that. Or a Python üêç  script. Or any other PL for that matter.</p>
<h3 id="common-filters">Common filters</h3>
<p>üß∫ <em>I want to see all TCP packets that have <code>1.1.1.1</code> source or destination IP address. Also, I would l like to get only those packets, that have destination port 80, assuming the web server is listening on port <code>80</code>.</em></p>
<p>For tcpdump üåö - <code>tcpdump src 192.168.1.65 and dst port 80</code>.</p>
<p>For Wireshark ü¶à  - <code>ip.src==192.168.1.65 and tcp.port==80</code>.</p>
<p>For Python üêç:</p>
<h3 id="snort">Snort</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt-get install snort
</span></span><span class="line"><span class="cl">cat /etc/snort/dafault
</span></span><span class="line"><span class="cl"><span class="c1"># or</span>
</span></span><span class="line"><span class="cl">cat /etc/init.d/snort
</span></span></code></pre></div><h2 id="logs">Logs</h2>
<h3 id="event-viewer-">Event Viewer üåà</h3>
<blockquote>
<p>‚ùì How could an attacker delete entries from the Event Viewer and what level of access would they need?</p>
</blockquote>
<p>To configure what&rsquo;s being logged and what&rsquo;s ignored, set up the appropriate policies here -<code>secpol.msc</code>. Config example:</p>
<ol>
<li>Audit account logon events - success + failure</li>
<li>Audit account management - success + failure</li>
<li>Audit logon events - success + failure</li>
<li>Audit object accesss - failure (too many successes will be generated)</li>
<li>Audit privileged use - success + failure</li>
<li>Audir system events - success + failure</li>
</ol>
<p>This might chew up lots of disk space, so be careful. I might try this configs to look for network events, I could not see before.</p>
<h3 id="varlog-"><code>/var/log</code> üêß</h3>
<p><code>/etc/rsyslog.conf</code> - see the log owners, what specific logs are logging and where the additional configurations are stored.</p>
<p><code>cd rsyslog.d &amp;&amp; less 50-default.conf</code> - to see additional configurations: what specific logs are logging, how they are called and where to find them.</p>
<p><code>sudo less syslog</code> - most of the system logs.</p>
<p><code>auth.log</code> - authorization messages</p>
<p><code>kern.log</code> - kernel messages</p>
<p>To configure what is being logged, how and when, go to <code>/etc/audit</code>. <code>apt-cache search auditd</code> (if it&rsquo;s not installed). <code>nano audit.rules</code> files to open. Config example:</p>
<ol>
<li><code>-w /etc/shadow</code> to keep track of the users added/deleted/modified. <code>w</code> - watch file:
<ol>
<li><code>-p</code> - watch for permission;</li>
<li><code>wa</code> - look for writes;</li>
<li><code>-k &lt;name&gt;</code> - give the name of this log entries.</li>
</ol>
</li>
<li><code>a always,exit</code> - look for actions:
<ol>
<li>generate alerts <code>always</code>;</li>
<li>look for specific syscall <code>-S clock_settime</code>;</li>
<li><code>-k &lt;name</code> - give the name of this log entries, for example, <code>timechange</code>.</li>
</ol>
</li>
</ol>
<p>To start auditing, run the daemon: <code>service auditd start</code>. The results are stored in <code>/etc/audit.log</code>.</p>
<h3 id="excersice">Excersice</h3>
<p>I&rsquo;ve set up my lab as vaguely described <a href="/docs/blog/2021/03/how-i-have-built-my-lab">here</a>. Then, I&rsquo;ve logged into the user <code>sherlock</code> account. Now, I want to see this even in the Event Viewer. Most probably, it&rsquo;s the Security of System logs. I have wrong time settings on the both machines, but I don&rsquo;t think it&rsquo;s a problem for now. I&rsquo;ve noticed some Logon of type 3 in the logs, but the user is not specified. I don&rsquo;t quite remember, which id the network logon type has. I think it&rsquo;s 4&hellip; .</p>
<p>No, logon type 3 is the network logon. Weird. It happens very often.</p>
<p>Since there is no SID shown, I suspect that might be a system acc.</p>
<p>Sorting took some time, and I have noticed that Logon events have these IDs: 4624, 4634, 4625, 4648. Now I am going to filter by these IDs and revert to sorting by date and time. Nothing was found. I&rsquo;ve cleared IDs, leaving just the user name. The filter returned no results as well.</p>
<p>However, I&rsquo;ve also noticed, that even though no username was specified (<code>N/A</code>), the PC name was mentioned: SHERLOCKPC$. Using this to filter the logs, resulted in null results. Tried SHERLOCKPC as well - nothing.</p>
<p>Some packet was blocked.</p>
<p>Clear log. Then try logging in several times with the wrong password. Then log in with the correct one. Observe the logs. Well, seems like <code>Logon</code> and <code>Logoff</code> events are not initiated by the user. So, the login attempts are actually <code>Kerberos Authentication Service</code>. Now it makes more sense. Let&rsquo;s filter by this event (4768 - success and 4771 - failure). After successful authentication, we have Kerberos Service Ticket Operations (4769). And now I have it!</p>
<p>I&rsquo;ve now triggered several authentication failures and one authentication success. And there it is. I have 2 events 4771 (failures) then one event 4768 (success) followed by three events 4769. Why three?</p>
<p>Every minute 4624 and 4634 events are created, meaning new session creating. It seems so that every time I do something in my user account, the events 4624 and 4634 emerge in the logs. Or just every minute.</p>
<p>Let&rsquo;s go to the user PC (sherlock) and see his logs. It says that access was denied (either the query is too long or the daemon is not running). Of course, the first thing to do was to check whether the service is really running, but it was. So, the problem was something else. Query too long? Don&rsquo;t think so, since I have not created any views so far. I tried to clear the logs, but failed. May be it&rsquo;s because the DC is shutdown, or because the user doesn&rsquo;t have the rights to do so. The only way to check that is to turn on the DC.</p>
<p>Can&rsquo;t find the event id that is associated with this activity. Thought 5152 was, but then I saw it appeared on its own.</p>
<p>However System logs had one interesting entry. But failing again has not triggered it.</p>
<h2 id="file-settings">File Settings</h2>
<p>Hashing only applies to the file contents, but not to the file name, since the file name is stored in the file table and the file itself is stored on the file system. Running <code>ls -la</code> shows information about the files, including the hidden ones. On Windows machine you can run properties on the file to see the same data. To see hidden files on the Windows machine follow the <a href="https://support.microsoft.com/en-us/windows/view-hidden-files-and-folders-in-windows-10-97fbc472-c603-9d90-91d0-1166d1d9f4b5#:~:text=Open%20File%20Explorer%20from%20the,folders%2C%20and%20drives%20and%20OK.">instructions</a>.</p>
<p>Looking for file permissions changes is very important (owners or write/read/execute permissions added).</p>
<p>Remove existing files from the repository:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">find . -name .DS_Store -print0 | xargs -0 git rm -f --ignore-unmatch
</span></span></code></pre></div><p>Add this line:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">.DS_Store
</span></span></code></pre></div><p>to the file <code>.gitignore</code>, which can be found at the top level of your repository (or create the file if it isn&rsquo;t there already). You can do this easily with this command in the top directory:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">echo .DS_Store &gt;&gt; .gitignore
</span></span></code></pre></div><p>Then commit the file to the repo:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git add .gitignore
</span></span><span class="line"><span class="cl">git commit -m &#39;.DS_Store banished!&#39;
</span></span></code></pre></div><h2 id="firewall">Firewall</h2>
<h3 id="stateless-inspection">Stateless Inspection</h3>
<p>Each packet is inspected one at a time with no knowledge of the previous ones. Firwall üî• reads the IP and determines if it&rsquo;s allowed according to the ACL. The destination port is also checked. Benefits: faster, troubleshooting, useful for routers with virtualization (control traffic routing through the use of routing instances?), control traffic, QoS and CoS (quality of service switches for traffic prioritisation).</p>
<h3 id="stateful-inspection">Stateful Inspection</h3>
<p>Every packer is inspected in the context of a stream/conversation. Sessions for this type of machines are defined by: src and dst IPs, src and dst ports, optionally vlan (in case of virtualization). üî• Firewall will keep a DB of sessions and associated policy names it&rsquo;s assigning.</p>
<h3 id="both">Both</h3>
<p>First, the stateless inspection is performed first. Juniper firewall example. If the session is in the DB, evaluate the screens, see the traffic type and match against the session, NAT and other sevices required (AppTrack, AppDoS, AppQoS, AppFW, IDP stream, SSL Rev Proxy?, AppID stream, SSL Frd Proxy, TCP Proxy, IDP packet, AppID packet).</p>
<p>If there is no such session ID, apply screen first anyway (filters against flow or DoS), Static NAT applied*, Dest NAT* (if configured), Route, Zones, Policy, Reverse Static NAT, Source NAT,  Services, Session.</p>
<h3 id="xml-gateway">XML Gateway</h3>
<p>All XML passes through the ordinary firewall without inspection. Then, XML gateway inspects the XML for validity, no code, IP src/dst.</p>
<p><strong>Example 1</strong>. Block all in-out datagrams with IP protocol field 17 and src/dst port=23. Means blocking all telnet.</p>
<p><strong>Example 2</strong>. Block all inbound traffic with ACK=0. Prevents external users to initiate TCP connections with internal ones. But allows the later to connect to the outside.</p>
<p>Packet filtering firewalls only look at packet layer. Application layer firewalls look at the both.</p>
<h3 id="proxy-firewall">Proxy Firewall</h3>
<p>Two TCP handshakes.</p>
<h3 id="next-generation-firewalls-ngfw">Next generation Firewalls (NGFW)</h3>
<p>Juniper, for example. Firewall + other filtering device. Firewall + deep packet inspection = DPI. Firewall + IPS. Minds sessions. Can inspect encrypted traffic. Traditional firewalls don&rsquo;t understand business policies and cannot distinguish between different types of traffic (business and non-business). When the first packet is arriving, it&rsquo;s inspected. But all further requests within this session are not inspected. Layers 2-7. You can not only block/allow HTTP traffic, for example, but also decide which application is using HTTP in this case and decide. For example, block YouTube HTTP, but allow Facebook HTTP.</p>
<p>Ingress/Egress.</p>
<h3 id="limitations">Limitations</h3>
<p>Cannot protect itself from IP spoofing. Each app might have its own gateway. Client software must know how to contact gateway. Usually use all or nothing policy for UDP.</p>
<p>Tradeoff - performance, level of security.</p>
<h2 id="references">References</h2>
<p>IBM Coursera, Network Security &amp; Database Vulnerabilities</p>
<p>[<a href="https://learning.oreilly.com/videos/understanding-intrusion-detection/9781491962701/9781491962701-video256435/">1</a>] Understanding Intrusion Detection Systems with Ric Messier (O&rsquo;Reilly website)</p>
<p>[<a href="https://danielmiessler.com/study/tcpdump/">2</a>] tcmpdump tutorial</p>
<p>[<a href="https://www.secureauth.com/labs/open-source-tools/impacket/">3</a>] About impacket</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
