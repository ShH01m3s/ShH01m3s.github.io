<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Firewalls - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/defense/"> ğŸ‘ˆğŸ¼ Back to </br> ğŸ›¡ Defence Mechanisms </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#stateless-inspection">Stateless Inspection</a></li>
    <li><a href="#stateful-inspection">Stateful Inspection</a></li>
    <li><a href="#both">Both</a></li>
    <li><a href="#xml-gateway">XML Gateway</a></li>
    <li><a href="#proxy-firewall">Proxy Firewall</a></li>
    <li><a href="#next-generation-firewalls-ngfw">Next generation Firewalls (NGFW)</a></li>
    <li><a href="#limitations">Limitations</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Firewalls</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      <div class="article-category">
          
            
            
            
            
            
              <i class="fab fa-linux"></i>&nbsp;<i class="fab fa-apple"></i>&nbsp;<i class="fab fa-windows"></i>&nbsp;<i class="fas fa-mobile"></i>
            
            
          
          
      </div> <br />
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p>Host-based IDS look for local system configurations and behaviour, while network-based IDS look for network connections and looks for anomalies and common signatures.</p>
<p>IDS and IPS as firewall&rsquo;s filters. There are Control Plane (looks after the OS and routing table) and the Forwarding Plane (makes decisions on routing and discarding). If something happens to the Control Plane, the device will still forward the traffic (really???).</p>
<p>By default IDS only <strong>listens ğŸ‘‚</strong> the traffic. It&rsquo;s usually connected to the span port on a switch. Looks for anomalies and sends alerts. Won&rsquo;t take any actions by default, but can be configured in such a way. If the IDS is down, nothing is changed for the rest of the network, it&rsquo;s still operating.</p>
<p>IPS takes actions on its own. It is not connected to the span port, but rather is a gateway. Before it inspects and allows a packet through, nothing can move forward. So, if IPS is down, everyone is down (unless there is some load balancing enabled or may be some policy for such cases). Positioned right after the router, edge device or a firewall.</p>
<h2 id="stateless-inspection">Stateless Inspection</h2>
<p>Each packet is inspected one at a time with no knowledge of the previous ones. Firwall ğŸ”¥ reads the IP and determines if it&rsquo;s allowed according to the ACL. The destination port is also checked. Benefits: faster, troubleshooting, useful for routers with virtualization (control traffic routing through the use of routing instances?), control traffic, QoS and CoS (quality of service switches for traffic prioritisation).</p>
<h2 id="stateful-inspection">Stateful Inspection</h2>
<p>Every packer is inspected in the context of a stream/conversation. Sessions for this type of machines are defined by: src and dst IPs, src and dst ports, optionally vlan (in case of virtualization). ğŸ”¥ Firewall will keep a DB of sessions and associated policy names it&rsquo;s assigning.</p>
<h2 id="both">Both</h2>
<p>First, the stateless inspection is performed first. Juniper firewall example. If the session is in the DB, evaluate the screens, see the traffic type and match against the session, NAT and other sevices required (AppTrack, AppDoS, AppQoS, AppFW, IDP stream, SSL Rev Proxy?, AppID stream, SSL Frd Proxy, TCP Proxy, IDP packet, AppID packet).</p>
<p>If there is no such session ID, apply screen first anyway (filters against flow or DoS), Static NAT applied*, Dest NAT* (if configured), Route, Zones, Policy, Reverse Static NAT, Source NAT,  Services, Session.</p>
<h2 id="xml-gateway">XML Gateway</h2>
<p>All XML passes through the ordinary firewall without inspection. Then, XML gateway inspects the XML for validity, no code, IP src/dst.</p>
<p><strong>Example 1</strong>. Block all in-out datagrams with IP protocol field 17 and src/dst port=23. Means blocking all telnet.</p>
<p><strong>Example 2</strong>. Block all inbound traffic with ACK=0. Prevents external users to initiate TCP connections with internal ones. But allows the later to connect to the outside.</p>
<p>Packet filtering firewalls only look at packet layer. Application layer firewalls look at the both.</p>
<h2 id="proxy-firewall">Proxy Firewall</h2>
<p>Two TCP handshakes.</p>
<h2 id="next-generation-firewalls-ngfw">Next generation Firewalls (NGFW)</h2>
<p>Juniper, for example. Firewall + other filtering device. Firewall + deep packet inspection = DPI. Firewall + IPS. Minds sessions. Can inspect encrypted traffic. Traditional firewalls don&rsquo;t understand business policies and cannot distinguish between different types of traffic (business and non-business). When the first packet is arriving, it&rsquo;s inspected. But all further requests within this session are not inspected. Layers 2-7. You can not only block/allow HTTP traffic, for example, but also decide which application is using HTTP in this case and decide. For example, block YouTube HTTP, but allow Facebook HTTP.</p>
<p>Ingress/Egress.</p>
<h2 id="limitations">Limitations</h2>
<p>Cannot protect itself from IP spoofing. Each app might have its own gateway. Client software must know how to contact gateway. Usually use all or nothing policy for UDP.</p>
<p>Tradeoff - performance, level of security.</p>
<h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    <p>IBM Coursera, Network Security &amp; Database Vulnerabilities</p>
<p>[<a href="https://learning.oreilly.com/videos/understanding-intrusion-detection/9781491962701/9781491962701-video256435/">1</a>] Understanding Intrusion Detection Systems with Ric Messier (O&rsquo;Reilly website)</p>
<p>[<a href="https://danielmiessler.com/study/tcpdump/">2</a>] tcmpdump tutorial</p>
<p>[<a href="https://www.secureauth.com/labs/open-source-tools/impacket/">3</a>] About impacket</p>

</details>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
