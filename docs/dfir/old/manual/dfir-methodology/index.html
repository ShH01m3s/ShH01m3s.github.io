<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DFIR Methodology - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-dfir üîç">
      <a href="/docs/dfir">
        <span>DFIR üîç</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit üß∞">
      <a href="/docs/toolkit">
        <span>Toolkit üß∞</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-dfir üîç">
      <a href="/docs/dfir">
        <span>DFIR üîç</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit üß∞">
      <a href="/docs/toolkit">
        <span>Toolkit üß∞</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/old/manual/"> üëàüèº Back to </br> Misc </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#-ir-methodology">ü•∑üèº IR Methodology</a>
      <ul>
        <li><a href="#detection-and-analysis-sans-identification">Detection and Analysis (SANS Identification)</a>
          <ul>
            <li><a href="#common-malicious-activity-detection-and-countermeasures">Common Malicious Activity, Detection and Countermeasures</a></li>
            <li><a href="#spillage">Spillage</a></li>
            <li><a href="#documentation">Documentation</a></li>
            <li><a href="#protected-data">Protected Data</a></li>
          </ul>
        </li>
        <li><a href="#containment-eradication-recovery">Containment. Eradication. Recovery.</a></li>
        <li><a href="#post-incident-activity-sans-lessons-learned">Post-Incident Activity (SANS Lessons Learned)</a></li>
        <li><a href="#cloud-ir-specifics">Cloud IR Specifics</a></li>
      </ul>
    </li>
    <li><a href="#--df-methodology">üî¨ üß™ DF Methodology</a>
      <ul>
        <li><a href="#collection">Collection</a>
          <ul>
            <li><a href="#documentation-1">Documentation</a></li>
          </ul>
        </li>
        <li><a href="#evidence">Evidence</a>
          <ul>
            <li><a href="#evidence-integrity">Evidence Integrity</a></li>
          </ul>
        </li>
        <li><a href="#chain-of-custody">Chain Of Custody</a></li>
        <li><a href="#report">Report</a></li>
        <li><a href="#examination-and-analysis">Examination and Analysis</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">DFIR Methodology</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 28.07.2022
    <br />

    
            <div class="post-info-last-mod">
                (Updated: 26.05.2023)
            </div>
            <br />

  </header>


  <div class="content" itemprop="articleBody">
    <h2 id="-ir-methodology">ü•∑üèº IR Methodology</h2>
<p>For the most relevant scenarios, keeping playbooks and runbooks at your disposal is crucial. This will help you stay less stressed and be prepared for various outcomes. I have created a <a href="https://www.canva.com/design/DAFfIbPpEuo/Frhvq9uiLJssDby2MJtXJA/view?utm_content=DAFfIbPpEuo&amp;utm_campaign=designshare&amp;utm_medium=link2&amp;utm_source=sharebutton">high-level overview of potential playbooks</a> based on the MITRE ATTACK matrix, which includes guidelines for detection, investigation, and cleanup techniques. Runbooks, on the other hand, are highly detailed and technical instructions, such as &ldquo;How to reset an account password&rdquo; or &ldquo;How to change an AWS EC2 inline policy.&rdquo; One runbook can be referred to by several playbooks, which is perfectly fine. Consider playbooks as constructors with a relatively unique plan and runbooks as the specific steps linked to some or all of the described plan&rsquo;s stages. Below is a part of the table I have mentioned above.</p>
<p><img src="images/mitre-playbooks.png" alt="img"></p>
<p>Following the MITRE matrix, I have roughly divided the content into two different realms: infrastructure and applications. Each sticker represents two things simultaneously:</p>
<ol>
<li>üìò It&rsquo;s a playbook that needs to be followed if an incident occurs.</li>
<li>‚ùì It answers a question like &ldquo;How can the adversary get an initial foothold in the system?&rdquo; The answer would differ for each realm.</li>
</ol>
<p>Some playbooks have arrows pointing to other playbooks within one cell. This indicates that an investigation of a particular event might lead to another playbook. For example, while investigating a possibility that suggests a vulnerability in a system within the infrastructure was exploited, we might discover that the exposure was not in our system but in a vendor&rsquo;s system. This could lead to the investigation shifting to a different playbook more applicable to the vendor&rsquo;s system.</p>
<p>I am working on a framework (MITRE + the above table + Jupyter) for companies to establish which playbooks should be prioritised and developed. The way to go would be as follows:</p>
<ol>
<li>Define the infrastructure.</li>
<li>Go through the relevant MITRE matrix to understand potential risks.</li>
<li>Profile the potential adversary and align this profile with the MITRE matrix.</li>
<li>Using the table above, define playbooks of the highest priority.</li>
<li>In each playbook, describe the detection, investigation and cleanup flow for the most relevant TTPs.</li>
<li>Ensure a runbook provides technical details (links, scripts, etc.) for each playbook.</li>
</ol>
<h3 id="detection-and-analysis-sans-identification">Detection and Analysis (SANS Identification)</h3>
<p>Lots of systems can be used to monitor the network and host for malicious activity. These are IDS, IPS, firewalls, AV, SIEM (Security Information and Event Management solutions, SIM + SEM), IR frameworks, threat intelligence etc. However, the employee might report the incident (for example, receiving a suspicious email) or by a third party (data exfiltrated seen in the dark net). Before it is confirmed to be accurate or the result of malicious intent, it&rsquo;s called an <em>event</em>.</p>
<p><strong>Precursors</strong>‚ùì - signs that the incident <em>may</em> occur in the future. For example, logs show that a vulnerability scanner was used. Or a vulnerability was found in some software used by the company.</p>
<p><strong>Indicators</strong> üö® - signs that an incident has occurred or is occurring. Malware detected by an anti-virus program, configurations changed, multiple failed logins etc.</p>
<p>Several techniques help confirm the incident. See the <code>Investigation -&gt; Methodology</code> section for more details.</p>
<ul>
<li><strong>Frequency analysis</strong>. Something that is outstandingly rare across systems might be malicious.</li>
<li>Average vs Evil behaviour. You know what&rsquo;s considered normal for the given system/user, and something unusual is a primary suspect for further analysis.</li>
<li><strong>IoC</strong>. Indicators of compromise, like some virus hashes or file extensions used by a known crypto malware.</li>
<li><strong>IoA or pattern analysis</strong>. Indicators of attack. Depending on the vulnerability/attack in place, these would be of some particular pattern. For example, you see some string like <code>&lt;script&gt;alert(1)&lt;/script&gt;</code> - it&rsquo;s probably an XSS attempt.</li>
</ul>
<p>For AWS - <a href="https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/visibility-and-alerting.html">https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/visibility-and-alerting.html</a></p>
<p>After the incident is confirmed, you initiate an investigation.</p>
<blockquote>
<p>üìù I found it quite hard to separate incident response and digital forensics articles from one another. For now, I see the incident response as a more general process that could require a more thorough examination (digital forensics) but not necessarily. As I see it, we have an event and start the IR process to determine whether it&rsquo;s malicious. Identify compromised hosts and map the artefacts to the ATCK MITRE framework. Then, to fully contain and remediate the incident, we call for DF, trying to analyse malware, analyse the registry on Windows, recover data from unallocated space, etc., to reconstruct the whole picture in detail. So, roughly speaking, IR is about sketching, and DF is about more information.</p>
</blockquote>
<h4 id="common-malicious-activity-detection-and-countermeasures">Common Malicious Activity, Detection and Countermeasures</h4>
<p><strong>Mapping</strong>. Attackers must first collect information about the target system:  <code>ping</code>, <code>nmap</code>.     <strong>Countermeasures:</strong></p>
<ul>
<li>record traffic</li>
<li>Look for suspicious activity.</li>
<li>Use a host scanner and keep track of all the PCs within your network. A new PC should trigger an alert.</li>
</ul>
<p><strong>Packet Sniffing</strong>. An attacker may perform (or try to achieve) <strong>traffic sniffing</strong>. It is possible in the following cases: Broadcasting, promiscuous NIC, and if the traffic is unencrypted.  <strong>Countermeasures:</strong></p>
<ul>
<li>Periodically check whether the NICs of the hosts are in promiscuous mode.</li>
<li>We switched Ethernet (1 host per segment of broadcast media).</li>
</ul>
<p><strong>IP-spoofing.</strong> Can generate &ldquo;raw&rdquo; IP packets, putting any value as a source IP. The receiver won&rsquo;t know that the other party is spoofed. <strong>Countermeasures:</strong></p>
<p><strong>DoS</strong>. <strong>Countermeasures:</strong></p>
<ul>
<li>Filter out flooded packets (e.g. SYN) before they reach the host.</li>
<li>traceback to the source of floods</li>
</ul>
<p>üé£ <strong>Phishing.</strong> <strong>Spear phishing</strong> - targeted attack on specific users or groups of users. <strong>Whaling</strong> - spear phishing for high executive managers. <strong>Strategies</strong>:</p>
<ul>
<li>They claim they&rsquo;ve seen numerous failed login attempts or other suspicious activity.</li>
<li>They claim that there is some problem with your account or payment method.</li>
<li>Confirm some personal information.</li>
<li>Include a fake invoice.</li>
<li>Click on a link to make a payment.</li>
<li>You are eligible for a government refund.</li>
<li>Coupon for free stuff.</li>
</ul>
<p>How to detect it?</p>
<ul>
<li>Suspicious sender&rsquo;s address.</li>
<li>Generic signature and greetings.</li>
<li>They spoofed hyperlinks and websites.</li>
<li>Spelling and layout.</li>
<li>Suspicious attachment.</li>
</ul>
<p><strong>PoS</strong>. Most of the malware is equipped with a backdoor and C&amp;C features. The cardholder&rsquo;s data is decrypted in RAM; that&rsquo;s why this type of malware sniffs the RAM (RAM scraping). <strong>Countermeasures</strong>:</p>
<ul>
<li>Monitor the network for changes.</li>
<li>Good encryption</li>
<li>Limit the host that communicates with PoS.</li>
<li>chip-card-enabled PoS terminals</li>
<li>Employee screening and training</li>
</ul>
<p><strong>Injections</strong>. MongoDB. <code>$where</code> is interpreted as JS. DoS: <code>$where=&quot;d=new Date; do {c=new Date;} while {c-d&lt;10000};&quot;</code>, XPath. <code>'or 1=1 or '1'='1</code>, LDAP.<code>*)(cn=))(|cn=*</code>, SQL <code>or 1=1--</code> etc. The best practice is to allow listing allowed and needed characters.</p>
<ul>
<li>Preventing <strong>OS injection</strong>
<ul>
<li>Don&rsquo;t use OS commands.</li>
<li>Sanitise input</li>
<li>Accept, say, ids and lookup.</li>
<li>Leat prev</li>
<li>do not run through shell interpreters</li>
<li>explicit paths</li>
</ul>
</li>
<li>Preventing <strong>SQLi</strong>
<ul>
<li>prepared statements</li>
<li>sanitise</li>
<li>do not expose errors with SQL statements etc</li>
<li>limit permissions</li>
<li>stored procedures</li>
<li>ORM libs (Hibernate)</li>
</ul>
</li>
</ul>
<p><strong>Common AWS issues</strong>
The following list is the top ten identified misconfigurations in Amazon EC2 instances and workloads from our data set:</p>
<ol>
<li>Unconfigured EC2 instance single-point-of-failure and auto-scaling issue</li>
<li>S3 logging not enabled</li>
<li>S3 object versioning is not enabled</li>
<li>User not configured to use MFA</li>
<li>User access key not configured with rotation</li>
<li>IAM policies are attached directly to the user</li>
<li>Dangerous user-privileged access to S3</li>
<li>ELB security group allows insecure access to ports or protocols</li>
<li>IAM access keys unused for 90 days</li>
<li>Dangerous user-privileged access to RDS</li>
</ol>
<h4 id="spillage">Spillage</h4>
<p>If it&rsquo;s AWS - open up a case with AWS Business Support: report spillage findings and response actions, DoD 5220.</p>
<h4 id="documentation">Documentation</h4>
<p>This is when you start taking notes for the incident (or event). Current status of the incident, summary, indicators, other related incidents, actions taken by all, a chain of custody*, impact assessment, contacts, list of evidence, comments from incident handlers (IH), next steps to be taken (rebuild the host/upgrade).</p>
<p>How to categorise the incident? Simply put, how bad is that?</p>
<ul>
<li>Functional Impact Categories
<ul>
<li><strong>None</strong> - nothing&rsquo;s changed.</li>
<li><strong>Low</strong> - the business can still provide critical services, but the efficiency needs to be recovered.</li>
<li><strong>Medium</strong> - O. needs to be able to provide critical services to some users.</li>
<li><strong>High</strong> - O. is no longer able to provide its critical services.</li>
</ul>
</li>
<li>Information Impact Categories
<ul>
<li><strong>None</strong> - no info was exfiltrated or compromised.</li>
<li><strong>Privacy breach</strong> - sensitive PII was accessed or exfiltrated.</li>
<li><strong>Proprietary breach</strong> - unclassified proprietary info exfiltrated (PCII).</li>
<li><strong>Integrity loss</strong> - sensitive or proprietary info was changed or deleted.</li>
</ul>
</li>
<li>Recoverability Effort Categories, TTR - time to recovery
<ul>
<li><strong>Regular</strong> - TTR is predictable with existing resources.</li>
<li><strong>Supplemented</strong> - TTR is predictable with additional resources.</li>
<li><strong>Extended</strong> - TTR is unpredictable.</li>
<li><strong>If not recoverable</strong>, launch the investigation.</li>
</ul>
</li>
</ul>
<h4 id="protected-data">Protected Data</h4>
<p>Suppose the GDPR data was leaked - 72 hours to disclose the breach. HIPAA has other time limits.</p>
<h3 id="containment-eradication-recovery">Containment. Eradication. Recovery.</h3>
<p><strong>Containment</strong> üì¶ aims to stop the bleedingü©∏. It&rsquo;s a critical stage. While during Identification (aka detection and analysis), we confirm that something&rsquo;s going wrong, this stage is used to see the whole picture, how the breach happened, what damage was already done, which systems are compromised, etc. Quoting SANS:</p>
<blockquote>
<p>The goal of containment is to limit damage from the current security incident and prevent further damage. Several steps are necessary to completely mitigate the incident while avoiding the destruction of evidence that may be needed for prosecution.</p>
</blockquote>
<p>So, digital forensics can occur anywhere from Analysis (aka Identification) to the Lessons Learned stage. It may not happen, however. For example, a DoS attack may not need this facility.</p>
<p>Choosing a containment strategy:</p>
<ul>
<li><input disabled="" type="checkbox"> ‚ùì Is there potential damage or theft of resources?</li>
<li><input disabled="" type="checkbox"> ‚ùì Do we need to preserve the evidence for the court/ourselves and make an image of the compromised system?</li>
<li><input disabled="" type="checkbox"> ‚ùì Do we need the service to be available during the investigation?</li>
<li><input disabled="" type="checkbox"> ‚ùì How much time do we have and need?</li>
<li><input disabled="" type="checkbox"> ‚ùìWhat resources are available to implement this strategy?</li>
<li><input disabled="" type="checkbox"> ‚ùì What&rsquo;s the strategy&rsquo;s effectiveness (partial or complete containment)?</li>
</ul>
<p>Below is the checklist to ensure the responder has done their job. These questions can be used in a ticket or IR timesheet, mentioned above in the <em>Documentation</em> section.</p>
<ul>
<li><input disabled="" type="checkbox"> ‚ùì Who attacked you and why?</li>
<li><input disabled="" type="checkbox"> ‚ùì When and How did it happen?</li>
<li><input disabled="" type="checkbox"> ‚ùì Did this happen because of the poor sec policy and processes?</li>
<li><input disabled="" type="checkbox"> ‚ùì How widespread is the incident?</li>
<li><input disabled="" type="checkbox"> ‚ùì What steps are being taken to determine what happened and prevent it in future?</li>
<li><input disabled="" type="checkbox"> ‚ùì What&rsquo;s the impact?</li>
<li><input disabled="" type="checkbox"> ‚ùì Was any personally identifiable information leaked?</li>
<li><input disabled="" type="checkbox"> ‚ùì What is the estimated cost of this incident?</li>
</ul>
<blockquote>
<p>The SANS containment process involves:</p>
<p><strong>Short-term containment</strong>‚Äîlimiting damage before the incident worsens, usually by isolating network segments, taking down hacked production servers and routing to failover.</p>
<p><strong>System backup</strong>‚Äîtaking a forensic image of the affected system(s) with tools such as Forensic Tool Kit (FTK) or EnCase, and only then wiping and reimaging the systems. This will preserve evidence from the attack that can be used in court and for further investigation of the incident and lessons learned.</p>
<p><strong>Long-term containment</strong>‚Äîapplying temporary fixes to make it possible to bring production systems back up. The primary focus is removing accounts or backdoors left by attackers on the methods and addressing the root cause‚Äîfor example, fixing a broken authentication mechanism or patching a vulnerability that led to the attack.</p>
</blockquote>
<p><strong>Eradication</strong> aims to remove the threat. For example, please remove the malware, and return configs to their normal state. It&rsquo;s a common mistake of many companies to jump right to this stage without proper prior investigation and containment. In this case, the attacker might still be inside, the vulnerability they used is still unmatched, or the user they social engineered still needs to be informed about this event properly etc. It can turn into a &ldquo;whack-a-mole&rdquo; game which is no fun when a company&rsquo;s reputation and finance üíµ are concerned.</p>
<ul>
<li><input disabled="" type="checkbox"> ‚ùì Can the problem be isolated? Are all affected isolated?</li>
<li><input disabled="" type="checkbox"> ‚ùì Have the forensic copy been created? For each piece of evidence, keep the info (or chain of custody, even better):
<ul>
<li><input disabled="" type="checkbox"> Identifying information (location, serial, model, hostname, MAC and IP)</li>
<li><input disabled="" type="checkbox"> Name, title, and phone of each individual who collected or handled the evidence</li>
<li><input disabled="" type="checkbox"> Time and date (+ time zone) of each occurrence of evidence handling</li>
<li><input disabled="" type="checkbox"> The location where the evidence was stored</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> ‚ùì Can this system be reimaged and patched?</li>
<li><input disabled="" type="checkbox"> ‚ùì Was all malware removed and the system hardened?</li>
<li><input disabled="" type="checkbox"> ‚ùì What tools will you use to test, monitor and verify that the exact cause no longer compromises the restored systems?</li>
</ul>
<p><strong>Recovery</strong> aims to get the system operational if it goes down or simply back to business as usual if it doesn‚Äôt.</p>
<h3 id="post-incident-activity-sans-lessons-learned">Post-Incident Activity (SANS Lessons Learned)</h3>
<p>Learn from your experience so you can better respond to future security events. Adjust your playbooks accordingly.</p>
<h3 id="cloud-ir-specifics">Cloud IR Specifics</h3>
<p>If there are any shared resources with other companies that care about security less, you might be in trouble. For example, several companies host their web application on one website.</p>
<p>Cloud IR is easier. Some tools and methods are available ONLY for the Cloud‚ÄîIR Simulation on AWS.</p>
<p><a href="https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/security-incident-response-simulations.html">https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/security-incident-response-simulations.html</a></p>
<p>Automation - <a href="https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/automation-1.html">https://docs.aws.amazon.com/whitepapers/latest/aws-security-incident-response-guide/automation-1.html</a></p>
<h2 id="--df-methodology">üî¨ üß™ DF Methodology</h2>
<h3 id="collection">Collection</h3>
<p>Evidence collection begins with the first response and arriving at the scene (how weird&hellip;.). The person collecting the evidence assumes the role of a first responder. Only sometimes are they digital forensic experts. Opponents will try to discredit their work. That‚Äôs why it‚Äôs essential to use industry-accepted tools and know the digital footprint of these tools (checked every month). Each media type has a separate section under Incident Investigation -&gt; Collection section on this website - <a href="https://bakerst221b.com/docs/dfir/investigation/collection/">https://bakerst221b.com/docs/dfir/investigation/collection/</a>.</p>
<p>There are several important notes to keep in mind:</p>
<p>‚ùóÔ∏èDocument everything. Before anything can be acquired, it needs to be properly documented first. The first responder must record all the findings in the Chain of Custody form.</p>
<p>‚ùóÔ∏èTake photos and videos before touching anything. These photos/videos need to have proper time-stamping.</p>
<p>‚ùóÔ∏èDo never make any analysis on the original media! Any analysis and investigation are only performed against a copy.</p>
<p>‚ùóÔ∏èMake hashes before the acquisition, after and when making copies.</p>
<h4 id="documentation-1">Documentation</h4>
<p>Start documenting even before you get to the scene. First, make sure that timestamps are configured on both devices. Take as many photos and videos as possible. Take overall and close-up images. Make sure that all the connections between the devices are photographed clearly. Photograph the evidence in situ (if possible). Identify and assign unique ids to the evidence collected.</p>
<p><img src="images/chain-of-custody.png" alt="chain-of-custody"></p>
<h3 id="evidence">Evidence</h3>
<details>
    <summary>Expand &hellip;</summary>
    <blockquote>
<p>‚ùóÔ∏èMind the scope when collecting the evidence. For example, you might not have permission to manage personal devices.</p>
</blockquote>
<p><strong>Obvious Physical Evidence</strong>. PC, cameras, flash drives, PDAs, removable media, and mobile devices. Mind the chain of custody.</p>
<p><strong>Non-obvious Physical Evidence</strong>. Manuals for devices that were not found - look for these devices. Digital media taken with some device that was not found -look for this device: sticky notes or little papers with scrambled letters.</p>
<p><strong>Cloud Evidence</strong>.</p>
<blockquote>
<p>‚ö†Ô∏è Do not forget the charger!</p>
</blockquote>

</details>
<h4 id="evidence-integrity">Evidence Integrity</h4>
<p>One of the essential parts is to ensure evidence integrity. Hashing and Chain of Custody (CoC) exist for this purpose. You can always video record all you do on the screen, commenting on every step. Evidence also needs to be transported and stored safely.</p>
<h5 id="physical">Physical</h5>
<p>Don‚Äôt contaminate the scene itself (try not to be tempted to eat biscuits üç™ and burgers üçî on the stage, however hard that might seem). This means that you should also preserve the physical evidence as well. Don‚Äôt touch ANYTHING before the lead investigator says ‚ÄúOK‚Äù üëç. Always mind the scope and get it in writing, even if it‚Äôs not a criminal case. Do fingerprints need to be collected? DNA?</p>
<p>Package the evidence for transport. Transport the evidence. Store the proof while in possession. Use Faraday bags to avoid remote tampering and anti-static and plastic bags to protect from discharge and moisture. Tape and seal the bags with the evidence.</p>
<h5 id="digital-integrity">Digital Integrity</h5>
<p>For dead acquisition, it&rsquo;s pretty simple:</p>
<ul>
<li><input disabled="" type="checkbox"> You calculate the hash of the drive before imaging it.</li>
<li><input disabled="" type="checkbox"> Do you imagine the drive?</li>
<li><input disabled="" type="checkbox"> You get the hash of the image.</li>
<li><input disabled="" type="checkbox"> whenever you copy this image, you get the copy&rsquo;s hash as well</li>
</ul>
<p>All of the steps are recorded in the report and the CoC.</p>
<p>For live acquisition, it becomes trickier.</p>
<p>The live system is changing all the time. At all times, keep in mind the <a href="https://www.sciencedirect.com/topics/social-sciences/exchange-principle#:~:text=Locard's%20Exchange%20Principle%20states%20that,pollen%2C%20paint%2C%20and%20soil." title="https://www.sciencedirect.com/topics/social-sciences/exchange-principle#:~:text=Locard's%20Exchange%20Principle%20states%20that,pollen%2C%20paint%2C%20and%20soil.">Locard&rsquo;s Exchange Principle</a>. It states that when two entities come into contact, they leave the evidence on each other. For the DF field, the investigator will leave traces of their activity when working with the system. This might even result in overwriting some information. That&rsquo;s why keeping a profile as low as possible is essential. That&rsquo;s why you need to know how &ldquo;noisy&rdquo; the tool is, how many files it writes to the disk, and how much RAM space it needs. It&rsquo;s called footprint üêæ. To see how much data is being written to the disk or how much space is occupied in RAM (this overwriting some portion of this RAM), open Task Manager or Activity Monitor to stop etc., whatever tool is working for this OS. Note the &ldquo;Memory&rdquo; and &ldquo;Disk&rdquo; columns, run the utility and see how heavy the footprint is. For example, Belkasoft RAM Capturer has a ~4Mb footprint for RAM acquisition. Magnet RAM Capturer - colossal footprint. Dumpit - the fastest, the smallest footprint. That&rsquo;s why tools must be checked and tested regularly before the investigation.</p>
<p>Block any network connection, Bluetooth, while on the scene to avoid remote wiping. Look for running wiping software or kill switches.</p>
<p>Use the latest industry-acceptable hashing algorithms (at least SHA-256). Even though collisions might not be that probable, DF is usually about the court, and if you use MD5, for example, this might be used to discredit your work. The best practice is to use several hashing algorithms (especially when automating the process). If there are arguments around one of the hashing algorithms you&rsquo;ve been using, you&rsquo;d always have another one to back up your process sanity.</p>
<blockquote>
<p>‚ùóÔ∏èSometimes, a tool might produce a different hash. It might be due to a bug in the code. That&rsquo;s why it&rsquo;s essential to validate the instruments. It&rsquo;s always better to use built-in Linux or macOS hashing tools (<code>shasum</code>, for example). For more examples, see the Tools section.</p>
</blockquote>
<p>To prevent battery loss (in case we need the device to be on), keep the device connected to the power supply (for example, portable).</p>
<blockquote>
<p>‚ö†Ô∏è Turning off might trigger encryption!</p>
</blockquote>
<h3 id="chain-of-custody">Chain Of Custody</h3>
<details>
    <summary>Expand &hellip;</summary>
    <p>‚ùìWhere the evidence was found
‚ùìTime and date the evidence was collected       <br>
‚ùìWho found the evidence                      <br>
‚ùìDescription of the evidence<br>
‚ùìMake, model, and S/N of device (if applicable)</p>
<blockquote>
<p>üìù I think one of the best ways to keep the Chain of Custody is on Google Drive. This way, we have a history of changes and who has made them. Another way would be to use GitHub.</p>
</blockquote>
<h4 id="identify-the-evidence">Identify the evidence</h4>
<p>Assign IDs for each piece of evidence. For example, for a flash drive, it would look like this‚ÄîFD (flash drive) + its <em>sequence number</em> within this case + case number. Subsequent images of these devices will have the same number + copy sequence number.</p>
<p>Example: <em>A USB Flash drive was found on the scene during case study 0124. It was the first USB drive found yet. This device was assigned the number FD-01-0124. Then we made two bit-by-bit copies of this drive, ids assigned: FD-01-0124-01 and FD-01-0124-02, respectively.</em></p>

</details>
<h3 id="report">Report</h3>
<details>
    <summary>Expand &hellip;</summary>
    <p>Keep track of all the steps taken, the reason for these steps and the outcome. Document the physical condition (mouse to left or right as the owner is a lefty or a righty), applications running, and keep audio notes. Make photos and videos, and make notes. Maintain the Chain of Custody at all times.</p>
<p>Reports are often read by those who could be more techie. Besides, you would want your information usable at court, should the need arise.</p>
<p>This is also crucial to share the findings, IOCs and info about threat actors with the threat-hunting team üî™ .</p>
<p>The final report should contain the following:</p>
<ul>
<li>Case summary (who requested, who&rsquo;s in charge, principles involved, when did the incident occur, when was this report filed, what allegedly happened, copies of all legal authorisations to proceed);</li>
<li>Authorisations (original request in writing, warrants, subpoenas, written permissions);</li>
<li>procedural docs (inventory of items examined and chain of custody for each, tools used, a timeline of procedures, list of people performing these procedures, hashed before and after);</li>
<li>Case notes (all logs extracted from the target system and from the forensic tools, a diagram of the network where investigation occurred (sometimes));</li>
<li>What physical evidence was collected (videos, pics, copies of docs, interview transcripts);</li>
<li>Conclusion (ties altogether, supports or refuses the original claim, does NOT prove guilt/innocence).</li>
</ul>
<p>Make electronic copies of the report. An archive copy is maintained by the team‚ÄîDVDs for distribution. Copies of written docs are filed. A summary report is provided along with timelines and written + electronic docs.</p>
<h4 id="photos-and-videos">Photos And Videos</h4>
<p>First, make sure that timestamps are configured on both devices. Take as many photos and videos as possible. Take overall and close-up images. Make sure that all the connections between the devices are photographed clearly. Photograph the evidence in situ (if possible).</p>

</details>
<h3 id="examination-and-analysis">Examination and Analysis</h3>
<p>Art supersedes science. Know what garbage is. Unexpected places. Pay attention to exculpatory (proving innocence) data.</p>
<p>‚ùóÔ∏è Correlate data with other independent sources. Some data might have been tampered with, and you should try to find other evidence that describes the same data. For example, timestamps can be easily changed. Therefore, try to find network or login events to correlate them.</p>
<p>Bypassing controls (if PIN protected, data encrypted, ACL, compression). There will be lots of data, and only some are relevant. In most cases, NSRL file data is used to eliminate known files, such as operating system and application files, during criminal forensic investigations. This reduces the number of files which must be manually examined and thus increases the efficiency of the investigation. See <a href="https://www.nist.gov/itl/ssd/software-quality-group/national-software-reference-library-nsrl/about-nsrl/nsrl-introduction">here</a>. Autopsy uses this list.</p>
<p>I am testing computer <a href="https://www.nist.gov/itl/ssd/software-quality-group/computer-forensics-tool-testing-program-cftt">tools</a>. Video analytics <a href="https://www.nist.gov/programs-projects/video-analytics">here</a> and photo <a href="https://www.nist.gov/itl/iad/image-group">here</a>. And about NIST research in cloud forensics <a href="https://www.nist.gov/programs-projects/nist-cloud-computing-forensic-science">here</a>.</p>
<p>About SIM forensics as well <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-101r1.pdf">here</a>.</p>
<h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    <p>[<a href="https://www.coursera.org/learn/introduction-cybersecurity-cyber-attacks/home/welcome">1</a>] IBM course</p>
<p>[<a href="https://www.sentinelone.com/labs/macos-incident-response-part-1-collecting-device-file-system-data/">2</a>] Mac IR</p>
<p>[<a href="https://cybersecurity.att.com/blogs/security-essentials/incident-response-steps-comparison-guide">3</a>] NIST vs SANS IR frameworks</p>
<p>[<a href="https://www.sans.org/reading-room/whitepapers/incident/documentation-incident-response-air-tank-scuba-diving-2021">4</a>] Documentation is to Incident Response as an Air Tank is to Scuba Diving</p>
<p>[<a href="https://www.cynet.com/incident-response/incident-response-sans-the-6-steps-in-depth/">5</a>] Incident Response SANS: The 6 Steps in Depth</p>
<p>[<a href="https://aws.amazon.com/blogs/publicsector/building-a-cloud-specific-incident-response-plan/">6</a>] IR in the Cloud, SANS</p>
<p>[<a href="https://learning.oreilly.com/videos/digital-archaeology-livelessons/9780132853835/9780132853835-09_01/">1</a>] Digital Archaeology LiveLessons (Video Training), Safari by [Michael W Graves](<a href="https://learning.oreilly.com/search?query=author%3A%22Michael">https://learning.oreilly.com/search?query=author%3A&quot;Michael</a> W Graves&quot;&amp;sort=relevance&amp;highlight=true)</p>
<p>[<a href="https://www.coursera.org/lecture/digital-forensics-concepts/forensics-methodology-and-investigations-33wNN">2</a>] InfoSec Digital Forensics Course, module Forensics Methodology and Investigations</p>
<p>[<a href="https://www.eccu.edu/methodology-for-testing-forensic-hypothesis-and-finding-truth/#attend">3</a>] Webinar, METHODOLOGY FOR TESTING FORENSIC HYPOTHESIS AND FINDING TRUTH by Jessica Hyde</p>
<p>[<a href="https://ijcsit.com/docs/Volume%208/vol8issue3/ijcsit2017080331.pdf">4</a>] Live vs Dead System Acquisition</p>
<p>[<a href="https://www.coursera.org/learn/introduction-cybersecurity-cyber-attacks/home/welcome">5</a>] IBM course</p>

</details>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
