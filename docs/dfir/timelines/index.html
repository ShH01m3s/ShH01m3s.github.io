<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â±ï¸ Timelines And Timestamps - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/"> ğŸ‘ˆğŸ¼ Back to </br> Incident Investigation ğŸ” ğŸ¥· </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#time-formats-and-standards">Time formats and Standards</a></li>
    <li><a href="#the-importance-of-timestamps">The Importance Of Timestamps</a></li>
    <li><a href="#file-systems-timestamps">File Systems Timestamps</a>
      <ul>
        <li><a href="#ntfs-vs-apfs">NTFS vs APFS</a></li>
        <li><a href="#lnk-files">LNK files</a></li>
      </ul>
    </li>
    <li><a href="#application-specific-timestamps">Application Specific Timestamps</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">â±ï¸ Timelines And Timestamps</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      <div class="article-category">
          
            
            
            
            
            
              <i class="fab fa-linux"></i>&nbsp;<i class="fab fa-apple"></i>&nbsp;<i class="fab fa-windows"></i>&nbsp;<i class="fas fa-mobile"></i>
            
            
          
          
      </div> <br />
      

      
      <div class="article-category">
        <i class="fas fa-tools"></i>
          
          
          <a class="platform-link" href="/tools/timeline-explorer">Timeline Explorer</a> 
          
           , 
          <a class="platform-link" href="/tools/kubectl">kubectl</a> 
          
           , 
          <a class="platform-link" href="/tools/filelist">FileList</a> 
          
           , 
          <a class="platform-link" href="/tools/sleuth-kit">Sleuth Kit</a> 
          
           , 
          <a class="platform-link" href="/tools/autopsy">Autopsy</a> 
          
      </div> <br />
      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <h2 id="time-formats-and-standards">Time formats and Standards</h2>
<p>GMT and UTC are the same and usually are used interchangeably. Although, there is some difference: <a href="https://www.timeanddate.com/time/gmt-utc-time.html">https://www.timeanddate.com/time/gmt-utc-time.html</a>.</p>
<blockquote>
<p>â—ï¸But GMT is a time zone and UTC is a time standard. So, UTC+0 = GMT</p>
</blockquote>
<p>The following format <code>2022-09-27T10:42:41.947Z</code> it&rsquo;s ISO 8601. I don&rsquo;t think it&rsquo;s possible to determine the timezone based solely on the format itself. Many times you have to know the configs for the server to be sure. However, if you see something like <code>2022-09-27T10:42:41.947+0000</code>, it&rsquo;s showing the time zone as well: <code>+0000</code> tells it&rsquo;s GMT/UTC +0.</p>
<p>Convert from UTC to local time: <a href="https://support.microsoft.com/en-us/topic/how-to-convert-utc-time-to-local-time-0569c45d-5fb8-a516-814c-75374b44830a">https://support.microsoft.com/en-us/topic/how-to-convert-utc-time-to-local-time-0569c45d-5fb8-a516-814c-75374b44830a</a>.</p>
<p>Looks like if there is <code>+00Z</code> at the end of a date-time string, it&rsquo;s UTC, otherwise - local time.</p>
<p>Since then, GMT is no longer a time standard. Today, Greenwich Mean Time (GMT) is only the name of a time zone that is used by a few countries in Africa and Western Europe, including the UK during winter and all year in Iceland.</p>
<blockquote>
<p>Examples <code>1994-11-05T08:15:30-05:00</code> corresponds to November 5, 1994, 8:15:30 am, US Eastern Standard Time.</p>
</blockquote>
<blockquote>
<p>So, letâ€™s say in Greenwich today is January 27th, 2020 at 6:00 AM. Using ISO standard, this would be as follows:
2020â€“01â€“27T06:00:00Z (Greenwich)
2020â€“01â€“27T00:00:00â€“06:00 (MÃ©xico City)
2020â€“01â€“27T14:00:00+08:00 (Beijing)</p>
</blockquote>
<p>Basically, even if it&rsquo;s blowing my mind, when you see <code>+</code>, you subtract to get the UTC time and when you see <code>-</code> -, you add to get the UTC.</p>
<p><a href="https://www.w3.org/TR/NOTE-datetime">https://www.w3.org/TR/NOTE-datetime</a></p>
<p><code>2019-11-14T00:55:31.820Z</code> is the same as <code>2019-11-14T00:55:31.820+0000Z</code>. <a href="https://stackoverflow.com/questions/58847869/utc-vs-iso-format-for-time">https://stackoverflow.com/questions/58847869/utc-vs-iso-format-for-time</a></p>
<p>Different date-time formats: <a href="https://www.utctime.net/">https://www.utctime.net/</a>.</p>
<p>1994-11-05T13:15:30Z corresponds to the same instant.</p>
<blockquote>
<p>â—ï¸ So, if the timestamp logged is local, there is no telling the exact time from the actor&rsquo;s point of view unless you know the time zone at the of the event.</p>
</blockquote>
<h2 id="the-importance-of-timestamps">The Importance Of Timestamps</h2>
<p>If something was downloaded and accessed over several days, the suspect knew about this file. Otherwise, they might prove they didn&rsquo;t. There also might be a pattern that tells a lot about possible motives. If the files were deleted, it also might prove that the user knew about them and wanted to hide them and not keeping for themselves but for distribution only (if they, say, emailed those files before deleting them).</p>
<p>There are several timestamps: timestamps the file systems keep in their metadata, timestamps of the files controlled by the OS and FS, and timestamps in the files&rsquo; metadata. More?</p>
<p><strong>Tools</strong> ğŸ› :</p>
<ul>
<li><strong>FileList</strong>. <code>file list &lt;directory_to_process&gt; /s /md5 /sha256 /owners /fullpath &gt; evidence.csv</code>. <code>/s</code> - recursive search, <code>/owners</code> - identify the user, <code>fullpath</code> - full directory path. Open this .csv in Excel as a delimited file, start the processing from the third row (skip the headers) and use the tab and comma as delimiters. Filters and pivot tables in Excel can be of use.</li>
<li>Autopsy. Has a dedicated feature for timeline creation. Better use Hash lookup with NSRL, Recent Activity and EXIF data modules. Based on Sleuth Kit, you can use the below commands to manually get the same info in the command line.</li>
<li>Sleuth Kit. <code>fls -r -m &quot;/&quot; -o &lt;offset&gt; &lt;image/disk&gt; &gt; bodyfile.txt</code> and afterwards: <code>mactime.pl -b bodyfile.txt -d &gt; timeline.csv</code>. For timezone - <code>-z</code>.</li>
</ul>
<p>Timelines are created based on the following sources:</p>
<ul>
<li>MAC data</li>
<li>System logs</li>
<li>Event logs</li>
<li>E-mails</li>
<li>Internet history</li>
<li>File metadata</li>
</ul>
<h2 id="file-systems-timestamps">File Systems Timestamps</h2>
<h3 id="ntfs-vs-apfs">NTFS vs APFS</h3>
<p>Mind that APFS <a href="/docs/dfir/host/apple/mac-artifacts">timestamps</a> and NTFS <a href="/docs/dfir/host/windows/win-artifacts">timestamps</a> are different! When you add a file to the system (for example, copy it from a USB drive), the MAC times are changed with NTFS. However, the APFS Added attribute is added, providing you with more information.</p>
<blockquote>
<p>âš ï¸ Both for APFS and NTFS, the last accessed times might not be updated. Refer to the artefacts page mentioned above for more information.</p>
</blockquote>
<p>NTFS has an additional MAC attribute - EM (entry modified). That&rsquo;s the time when <code>$MFT</code> is modified.</p>
<p>NTFS Last Accessed Update (Win10+) -</p>
<p>80000000 (hex) = User Managed, Last Access Updates Enabled
80000001 (hex) = User Managed, Last Access Updates Disabled
80000002 (hex) = System Managed, Last Access Updates Enabled - default for Windows 11 (in my case).
80000003 (hex) = System Managed, Last Access Updates Disabled</p>
<h3 id="lnk-files">LNK files</h3>
<p>These have timestamps embedded. They are &ldquo;screenshots&rdquo; of the host file at the time of link file creation. In the case of the <code>Recent</code> folder, this is the time when the file was <strong>first accessed</strong>.</p>
<h2 id="application-specific-timestamps">Application Specific Timestamps</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl describe pod podname <span class="c1"># to see the pod description, MAC times and settings</span>
</span></span></code></pre></div><h2 id="references">References</h2>
<p>[<a href="https://learning.oreilly.com/videos/digital-archaeology-livelessons/9780132853835/9780132853835-09_01/">1</a>] Digital Archaeology LiveLessons (Video Training), Safari by [Michael W Graves](<a href="https://learning.oreilly.com/search?query=author%3A%22Michael">https://learning.oreilly.com/search?query=author%3A&quot;Michael</a> W Graves&quot;&amp;sort=relevance&amp;highlight=true)</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
