<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Execution - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/attacks/recent/"> ğŸ‘ˆğŸ¼ Back to </br> Recent Activity </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#windows">Windows</a></li>
    <li><a href="#macos">macOS</a>
      <ul>
        <li><a href="#appstore-downloads">AppStore Downloads</a></li>
        <li><a href="#search">Search</a>
          <ul>
            <li><a href="#spotlight-shortcuts">Spotlight shortcuts</a></li>
            <li><a href="#finder-mru">Finder MRU</a></li>
          </ul>
        </li>
        <li><a href="#share-points">Share Points</a></li>
      </ul>
    </li>
    <li><a href="#linux">Linux</a></li>
    <li><a href="#android">Android</a></li>
    <li><a href="#ios">iOS</a>
      <ul>
        <li><a href="#knowledgec">KnowledgeC:</a></li>
        <li><a href="#screentime">Screentime:</a>
          <ul>
            <li><a href="#snapshots">Snapshots:</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Execution</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 02.06.2023
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p><em>This is about &hellip; .</em></p>
<h2 id="windows">Windows</h2>
<p>To find the evidence of execution, try the following artefacts:</p>
<ol>
<li>Dr Watson</li>
<li>Installed and unintalled
<ol>
<li>Key ğŸ”‘: Microsoft\Windows\CurrentVersion\Uninstall. There can be some data for programs that do not exist on the system anymore. The last write time is when the application was installed.</li>
<li>Key ğŸ”‘ Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore for installed Microsoft applications. Defines between those that were installed for a specific user or system-wide.</li>
<li>Key ğŸ”‘: Wiw6432Node (SYSTEM hive root node) - those that run a 32-bit mode. Separate sub-keys for different versions of a program.</li>
<li>Key ğŸ”‘: Classes\Installer\Products - installed using Miscrosoft installer (those with msi extension).</li>
</ol>
</li>
<li>Prefetch</li>
<li>AmCache</li>
<li>ShimCache</li>
<li>BAM</li>
<li>MUICache</li>
<li>ComDlg32</li>
<li>Jump List Data</li>
<li>Recent Apps</li>
<li>User Assist</li>
</ol>
<h2 id="macos">macOS</h2>
<h3 id="appstore-downloads">AppStore Downloads</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/Library/Receipts/InstallHistory.plist
</span></span></code></pre></div><h3 id="search">Search</h3>
<h4 id="spotlight-shortcuts">Spotlight shortcuts</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/Users/%username%/Library/Application Support/com.apple.spotlight.Shortcuts
</span></span></code></pre></div><h4 id="finder-mru">Finder MRU</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/Users/%username%/Library/Preferences/com.apple.finder.plist
</span></span></code></pre></div><h3 id="share-points">Share Points</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">plutil -p &#34;./0/root/private/var/db/dslocal/nodes/Default/sharepoints/Super Sneakyâ€™s Public Folder.plist&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">`/Users/username/.zsh_history` look for something like `hdiutil mount silenteye-0.4.1b-snowleopard.dmg` and `sudo cp -R /Volumes/SilentEye/silenteye-0.4.1b-snowleopard_installer.app /Applications`. 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Also, `/Users/sneaky/Library/Application Support/com.apple.spotlight/com.apple.spotlight.Shortcuts` if it was then searched via Spotlight.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">`plutil -p &#34;/Users/sneaky/Library/Preferences/com.apple.dock.plist&#34;` . Also gives some information on the file location, timestamps and bundle id.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">```bash
</span></span><span class="line"><span class="cl">1 =&gt; {
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Â  Â  Â  &#34;GUID&#34; =&gt; 2221790314
</span></span><span class="line"><span class="cl">Â  Â  Â  &#34;tile-data&#34; =&gt; {
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  &#34;book&#34; =&gt; {length = 592, bytes = 0x626f6f6b 50020000 00000410 30000000 ... 04000000 00000000 }
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  &#34;bundle-identifier&#34; =&gt; &#34;com.bitrock.installbuilder&#34;
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  &#34;dock-extra&#34; =&gt; 0
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  &#34;file-data&#34; =&gt; {
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  Â  &#34;_CFURLString&#34; =&gt; &#34;file:///Applications/silenteye-0.4.1b-snowleopard_installer.app/&#34;
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  Â  &#34;_CFURLStringType&#34; =&gt; 15
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  }
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  &#34;file-label&#34; =&gt; &#34;silenteye-0.4.1b-snowleopard_installer&#34;
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  &#34;file-mod-date&#34; =&gt; 187534827240406
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  &#34;file-type&#34; =&gt; 1
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  &#34;parent-mod-date&#34; =&gt; 187380208417750
</span></span><span class="line"><span class="cl">Â  Â  Â  }
</span></span><span class="line"><span class="cl">Â  Â  Â  &#34;tile-type&#34; =&gt; &#34;file-tile&#34;
</span></span><span class="line"><span class="cl">Â  Â  }
</span></span></code></pre></div><blockquote>
<p>ğŸ—’ TODO:
Binary file ./0/root/Users/sneaky/Library/Application Support/com.apple.spotlight/appList.dat matches
Binary file ./0/root/Users/sneaky/Library/Application Support/com.apple.sharedfilelist/com.apple.LSSharedFileList.FavoriteVolumes.sfl2 matches
Binary file ./0/root/Users/sneaky/Library/Application Support/com.apple.sharedfilelist/com.apple.LSSharedFileList.RecentApplications.sfl2 matches</p>
</blockquote>
<h2 id="linux">Linux</h2>
<ol>
<li>Trash <code>/home/%username%/.local/share/Trash/</code></li>
<li>Recent Files <code>/home/%username%/.local/share/recently-used.xbel</code></li>
</ol>
<h2 id="android">Android</h2>
<p>Obtain and image or physical evidence to work with. For Android, to see installed apps and recent activity:</p>
<ul>
<li><code>packages.list</code></li>
<li><code>packages.xml</code> - to see permissions for <strong>all</strong> applications in one place. For example, if this application has a SMS or messaging permission, you&rsquo;ll know to look. Or, for example, I need all applications with chat permissions or access to the camera.</li>
<li>com.vending.adnroid</li>
<li>usagestats</li>
<li>usage history</li>
<li>battery stats</li>
<li>recent images</li>
<li>snapshots</li>
</ul>
<p>tccb on iOS?</p>
<p>Chromebook - extension preferences file.</p>
<p>Run commercial tools to parse the info. If not, then try to find some specific parser, may be for similar app and try.</p>
<p>Create profiles and you any real data for generation.</p>
<p>Fake data - mockaroo and generatedata.com</p>
<ol>
<li>take the snapshot of the system state before populating with data</li>
<li>Write a script-plan</li>
<li>take notes</li>
<li>perform actions 1 min apart</li>
<li>scrrencap actions</li>
<li>document them (log with script)</li>
<li>compare with the the baseline &ldquo;snapshot&rdquo; from step 1.</li>
</ol>
<p><a href="https://blog.d204n6.com/2020/08/setting-up-testing-lab-of-ios-and.html">https://blog.d204n6.com/2020/08/setting-up-testing-lab-of-ios-and.html</a></p>
<p><a href="https://www.mac4n6.com/blog/2020/8/23/step-by-step-iphone-setup-for-ios-research-via-bizzybarney">https://www.mac4n6.com/blog/2020/8/23/step-by-step-iphone-setup-for-ios-research-via-bizzybarney</a></p>
<p><a href="https://www.mac4n6.com/blog/2020/8/13/step-by-step-macos-setup-for-ios-research-via-bizzybarney">https://www.mac4n6.com/blog/2020/8/13/step-by-step-macos-setup-for-ios-research-via-bizzybarney</a></p>
<p>Do not make assumptions before testing! For example, a QuizUp game folder contained some usernames and pictures and the assumption would be that this person was in touch with the suspect. However, testing revealed that when you choose to randomly find you a rival from around the globe ğŸŒ, QuizUp automatically adds them to the player&rsquo;s contacts.</p>
<p>Jessica advises using appropriate view-managers for specific files, but I would also recommend to check these files in hex as well. There was once a case when I performed vulnerability assessment of a mobile application and I got a SQLite DB, opened it in SQLite Browser DB and couldn&rsquo;t find the data I was looking for. However <code>grep</code>  command showed that this data <em>was</em> in the DB. I opened it in hex and noticed that it might have been damaged because there was an amount of data almoust the same size as the visible one, that was not shown in the viewer. Perhaps that were some deleted rows or the DB <em>was</em> damaged indeed.</p>
<p>Applications of different versions or platforms may have different data structure. For example, iOS QuizUp had a geolocation field, while Android didn&rsquo;t at that point in time.	[<a href="https://www.eccu.edu/methodology-for-testing-forensic-hypothesis-and-finding-truth/#attend">1</a>]</p>
<h2 id="ios">iOS</h2>
<h3 id="knowledgec">KnowledgeC:</h3>
<pre><code>https://www.magnetforensics.com/blog/analysis-of-graykey-images-with-axiom-new-knowledgec-database-artifact-additions/
â€¢ /private/var/mobile/Library/CoreDuet/Knowledge/ knowledgeC.db
</code></pre>
<h3 id="screentime">Screentime:</h3>
<ul>
<li>
<p>/private/car/mobile/Library/Application</p>
</li>
<li>
<p>Support/com.apple.remotemanagementd/</p>
</li>
<li>
<p>RMAdminStore-Local.sqlite</p>
<h4 id="snapshots">Snapshots:</h4>
<p>â€¢ /private/var/mobile/Library/Containers/Data/ Application/[APPGUID]/Library/Splashboard/ Snapshots/</p>
</li>
</ul>
<h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    Something here
</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
