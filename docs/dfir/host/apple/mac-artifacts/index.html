<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mac Artifacts - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.9d91cbb32c96c334ae7b38c3d99d30727e0836e1182125cc5f007d215f0b9e59.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-forensics üîç and incident response ü•∑">
      <a href="/docs/dfir">
        <span>Forensics üîç and Incident Response ü•∑</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-reverse üîß">
      <a href="/docs/reverse">
        <span>Reverse üîß</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit üß∞">
      <a href="/docs/toolkit">
        <span>Toolkit üß∞</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-notes üìù">
      <a href="/docs/notes">
        <span>Notes üìù</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home üè°">
      <a href="/">
        <span>Home üè°</span>
      </a>
    </li>
    
    <li class="menu-item-blog ‚úçÔ∏è">
      <a href="/docs/blog">
        <span>Blog ‚úçÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-forensics üîç and incident response ü•∑">
      <a href="/docs/dfir">
        <span>Forensics üîç and Incident Response ü•∑</span>
      </a>
    </li>
    
    <li class="menu-item-crypto üóùÔ∏è">
      <a href="/docs/cryptography">
        <span>Crypto üóùÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-reverse üîß">
      <a href="/docs/reverse">
        <span>Reverse üîß</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit üß∞">
      <a href="/docs/toolkit">
        <span>Toolkit üß∞</span>
      </a>
    </li>
    
    <li class="menu-item-about me üßùüèΩ‚Äç‚ôÄÔ∏è">
      <a href="/docs/about">
        <span>About me üßùüèΩ‚Äç‚ôÄÔ∏è</span>
      </a>
    </li>
    
    <li class="menu-item-notes üìù">
      <a href="/docs/notes">
        <span>Notes üìù</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/host/apple/"> Back to Apple Basics üìö Section üëàüèº </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#user-data">User Data</a>
      <ul>
        <li><a href="#password-hashes">Password hashes</a></li>
        <li><a href="#account-info">Account Info</a></li>
        <li><a href="#login-history">Login History</a></li>
      </ul>
    </li>
    <li><a href="#notifications">Notifications</a></li>
    <li><a href="#usb-devices">USB Devices</a>
      <ul>
        <li><a href="#0x5ac"><code>0x5ac</code></a></li>
        <li><a href="#tracev3"><code>tracev3</code></a></li>
        <li><a href="#systemlog"><code>system.log</code></a></li>
        <li><a href="#comapplefinderplist"><code>com.apple.finder.plist</code></a></li>
        <li><a href="#fsevents">FSEvents</a></li>
        <li><a href="#dailyout-log">Daily.Out log</a></li>
        <li><a href="#unified-log">Unified Log</a></li>
      </ul>
    </li>
    <li><a href="#web-browsing-activity">Web Browsing Activity</a></li>
    <li><a href="#ios-backups">iOS Backups</a></li>
    <li><a href="#icloud-data">iCloud Data</a></li>
    <li><a href="#unified-logs">Unified Logs</a></li>
    <li><a href="#lockdown-folder">Lockdown folder</a></li>
    <li><a href="#quarantine-files">Quarantine files</a>
      <ul>
        <li><a href="#v2">v2</a></li>
      </ul>
    </li>
    <li><a href="#bash-history">Bash History</a></li>
    <li><a href="#spotlight-shortcuts">Spotlight shortcuts</a></li>
    <li><a href="#fsevents-1">FSEvents</a></li>
    <li><a href="#dailyout">Daily.out</a></li>
    <li><a href="#finder-mru">Finder MRU</a></li>
    <li><a href="#appstore-downloads">AppStore Downloads</a></li>
    <li><a href="#snapshots">Snapshots</a></li>
    <li><a href="#airdrop">AirDrop</a></li>
    <li><a href="#todo">ToDo</a></li>
    <li><a href="#referenfces">Referenfces</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Mac Artifacts</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-search"></i>
              
          <a class="category-link" href="/domain/forensics">forensics</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      
      <div class="article-category">
          
            
            
            
              <i class="fab fa-apple"></i>
            
            
            
          <a class="platform-link" href="/platforms/mac">mac</a>
          
      </div> <br />
      

      
      <div class="article-category">
        <i class="fas fa-tools"></i>
          
          <a class="platform-link" href="/tools/apollo">apollo</a>
          
      </div> <br />
      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <h2 id="user-data">User Data</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">/Users/%username%/
</code></pre></div><h3 id="password-hashes">Password hashes</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">sudo plutil -p /var/db/dslocal/nodes/Default/users/&lt;usename&gt;.plist
</code></pre></div><h3 id="account-info">Account Info</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">sudo plutil -p /private/var/db/dslocal/nodes/Default/Users/&lt;User&gt;.plist
</code></pre></div><p>Contains name, profile name, password hint, account image, UID</p>
<h3 id="login-history">Login History</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">sudo su
<span class="nb">cd</span> /private/var/log/asl 
cat BB.&lt;date&gt;.asl
</code></pre></div><h2 id="notifications">Notifications</h2>
<h2 id="usb-devices">USB Devices</h2>
<p>Lots of devices that are in fact built-in into the Mac, are considered as external connection by tracev3 log files. So, if you see the <code>0x5ac</code> vendor id in the logs, it might be the keyboard or trackpad.</p>
<h3 id="0x5ac"><code>0x5ac</code></h3>
<p>Apple&rsquo;s vendor ID.</p>
<h3 id="tracev3"><code>tracev3</code></h3>
<p><code>/private/var/db/diagnostics/Persist/*****.tracev3</code> binary log file. See the eForensics magazine for more information. For example, <code>000000000000057b.tracev3</code>. Contains connection start times, vendor ID, product ID.</p>
<h3 id="systemlog"><code>system.log</code></h3>
<p>Another place to look for USB connections. Use <code>grep -r usbmsc</code>.</p>
<blockquote>
<p>‚ö†Ô∏è Keep in mind that a lot of cheap USB drives might have the SAME serial number!!!</p>
</blockquote>
<h3 id="comapplefinderplist"><code>com.apple.finder.plist</code></h3>
<p>Full path to the artifact: <code>/Users/&lt;username&gt;/Library/Preferences/com.apple.finder.plist</code>.</p>
<blockquote>
<p>üîç Not on my Mac!</p>
</blockquote>
<h3 id="fsevents">FSEvents</h3>
<p>Mount, Unmount, Volume. See <a href="/docs/dfir/host/apple/apple-fsevents">here</a> to know more about this artefact.</p>
<h3 id="dailyout-log">Daily.Out log</h3>
<p><code>/private/var/log.daily.log</code>.</p>
<h3 id="unified-log">Unified Log</h3>
<p><strong>Keywords</strong>: <code>USBMC</code>, <code>Manufacturer</code>.</p>
<h2 id="web-browsing-activity">Web Browsing Activity</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">/Users/%username%/Library/Application Support/Google/Chrome/Default
/Users/%username%/Library/Caches/Chrome/Default
/Users/%username%/Library/Application Support/Firefox/Profile
/Users/%username%/Library/Caches/Firefox/Profile
/Users/%username%/Library/Application Support/Opera/
/Users/%username%/Library/Caches/Opera/
/Users/%username%/Library/Application Support/Safari/
/Users/%username%/Library/Caches/com.apple.Safari
</code></pre></div><h2 id="ios-backups">iOS Backups</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">/Users/%username%/Library/Application Support/MobileSync/Backup/
</code></pre></div><h2 id="icloud-data">iCloud Data</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">/Users/%username%/Library/Application Support/iCloud/Account
/Users/%username%/Library/Application Support/CloudDocs/session/db/
</code></pre></div><h2 id="unified-logs">Unified Logs</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">/private/var/db/diagnostics
</code></pre></div><h2 id="lockdown-folder">Lockdown folder</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">/private/var/db/lockdown/
</code></pre></div><h2 id="quarantine-files">Quarantine files</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">/Users/%username%/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2
</code></pre></div><p>The warning ‚ö†Ô∏è that appears once you want to launch a file that was downloaded from the internet. Quarantine-aware applications: Safari, Messages, iChat, Mail. Known malware is also detected.</p>
<h3 id="v2">v2</h3>
<h2 id="bash-history">Bash History</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">/Users/%username%/.bash_sessions
/Users/%username%/.bash_history
</code></pre></div><h2 id="spotlight-shortcuts">Spotlight shortcuts</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">/Users/%username%/Library/Application Support/com.apple.spotlight.Shortcuts
</code></pre></div><h2 id="fsevents-1">FSEvents</h2>
<p>More <a href="/docs/dfir/host/apple/apple-fsevents">here</a>.</p>
<h2 id="dailyout">Daily.out</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">/private/var/log/daily.out
</code></pre></div><h2 id="finder-mru">Finder MRU</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">/Users/%username%/Library/Preferences/com.apple.finder.plist
</code></pre></div><h2 id="appstore-downloads">AppStore Downloads</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">/Library/Receipts/InstallHistory.plist
</code></pre></div><h2 id="snapshots">Snapshots</h2>
<p><code>tmutil</code> to find and list all snapshots</p>
<h2 id="airdrop">AirDrop</h2>
<p>Since OX Lion (10.7) and iOS 7.</p>
<h2 id="todo">ToDo</h2>
<ul>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/category/mac-forensics/">https://digitalforensicsurvivalpodcast.com/category/mac-forensics/</a></li>
<li><input disabled="" type="checkbox"> Logs - <a href="https://digitalforensicsurvivalpodcast.com/2016/11/22/dfsp-040-mac-log-files/">https://digitalforensicsurvivalpodcast.com/2016/11/22/dfsp-040-mac-log-files/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/12/27/dfsp-045-run-dma/">https://digitalforensicsurvivalpodcast.com/2016/12/27/dfsp-045-run-dma/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/11/08/dfsp-038-finder-sidebar-forensics/">https://digitalforensicsurvivalpodcast.com/2016/11/08/dfsp-038-finder-sidebar-forensics/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/10/18/dfsp-035-recent-file-listings-on-a-mac/">https://digitalforensicsurvivalpodcast.com/2016/10/18/dfsp-035-recent-file-listings-on-a-mac/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/10/25/dfsp-036-icloud-forensic-evidence/">https://digitalforensicsurvivalpodcast.com/2016/10/25/dfsp-036-icloud-forensic-evidence/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/10/11/dfsp-034-forensic-tools-for-your-mac/">https://digitalforensicsurvivalpodcast.com/2016/10/11/dfsp-034-forensic-tools-for-your-mac/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/10/04/dfsp-033-plists-for-mac-triage/">https://digitalforensicsurvivalpodcast.com/2016/10/04/dfsp-033-plists-for-mac-triage/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/09/20/dfsp-031-mac-user-home-folder/">https://digitalforensicsurvivalpodcast.com/2016/09/20/dfsp-031-mac-user-home-folder/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/09/27/dfsp-032-mac-formats-libraries-keychains/">https://digitalforensicsurvivalpodcast.com/2016/09/27/dfsp-032-mac-formats-libraries-keychains/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/09/13/dfsp-030-os-x-spotlight/">https://digitalforensicsurvivalpodcast.com/2016/09/13/dfsp-030-os-x-spotlight/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/09/06/dfsp-029-mac-cooties/">https://digitalforensicsurvivalpodcast.com/2016/09/06/dfsp-029-mac-cooties/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/02/14/plist-survival-finding-auto-run-applications-on-a-mac/">https://digitalforensicsurvivalpodcast.com/2016/02/14/plist-survival-finding-auto-run-applications-on-a-mac/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/08/23/dfsp-027-mac-as-a-forensic-platform/">https://digitalforensicsurvivalpodcast.com/2016/08/23/dfsp-027-mac-as-a-forensic-platform/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/02/14/do-you-have-mac-cooties/">https://digitalforensicsurvivalpodcast.com/2016/02/14/do-you-have-mac-cooties/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/02/14/safari-private-browsing-not-so-private/">https://digitalforensicsurvivalpodcast.com/2016/02/14/safari-private-browsing-not-so-private/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/02/14/plist-survival-is-trash-set-to-secure-erase/">https://digitalforensicsurvivalpodcast.com/2016/02/14/plist-survival-is-trash-set-to-secure-erase/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/02/14/plist-survival-finding-the-mac-os-version-of-your-evidence/">https://digitalforensicsurvivalpodcast.com/2016/02/14/plist-survival-finding-the-mac-os-version-of-your-evidence/</a></li>
<li><input disabled="" type="checkbox"> <a href="https://digitalforensicsurvivalpodcast.com/2016/02/14/tale-of-two-trashes/">https://digitalforensicsurvivalpodcast.com/2016/02/14/tale-of-two-trashes/</a></li>
</ul>
<h2 id="referenfces">Referenfces</h2>
<p>[<a href="https://docviewer.yandex.ru/view/0/?page=2&amp;*=JNYgyeoXguLhcrLTlwivMQ5z3rZ7InVybCI6Imh0dHBzOi8vd3d3LmlqcnRlLm9yZy93cC1jb250ZW50L3VwbG9hZHMvcGFwZXJzL3Y3aTZzL0YwMjA5MDM3NlMxOS5wZGYiLCJ0aXRsZSI6IkYwMjA5MDM3NlMxOS5wZGYiLCJub2lmcmFtZSI6dHJ1ZSwidWlkIjoiMCIsInRzIjoxNjAxODgyNTI0OTg2LCJ5dSI6IjEzOTAxNjQwOTE1OTg2MTQ0NTIiLCJzZXJwUGFyYW1zIjoibGFuZz1lbiZ0bT0xNjAxODgyNDg5JnRsZD1ydSZuYW1lPUYwMjA5MDM3NlMxOS5wZGYmdGV4dD1tYWMrb3MrZm9yZW5zaWNzJnVybD1odHRwcyUzQS8vd3d3LmlqcnRlLm9yZy93cC1jb250ZW50L3VwbG9hZHMvcGFwZXJzL3Y3aTZzL0YwMjA5MDM3NlMxOS5wZGYmbHI9MjEzJm1pbWU9cGRmJmwxMG49cnUmc2lnbj1jZDI5NzhlYTU0NGNmMTkyNWI5ZTE0ZmJmMTBiOGNhOSZrZXlubz0wIn0%3D&amp;lang=en">1</a>] OS X Artifacts Analysis</p>
<p>[<a href="https://blog.elcomsoft.com/2016/07/mac-os-forensics-attacking-filevault-2/">2</a>] MacOS, FV2 and forensics</p>
<p>[<a href="https://macforensicslab.com/2011/01/01/general-forensics-tips-mac-platform/">3</a>] Forensics tips</p>
<p>[<a href="https://forensicswiki.xyz/wiki/index.php?title=Mac_OS_X">4</a>] About MacOS X</p>
<p>[<a href="https://github.com/pstirparo/mac4n6">5</a>] Mac and iOS artifacts repository</p>
<p>[<a href="https://www.youtube.com/watch?v=5VKTaFBlMcE">6</a>] [<a href="https://en.wikipedia.org/wiki/.DS_Store">8</a>] DS_Store</p>
<p>[<a href="https://www.youtube.com/watch?v=FOpiDSAD-Yk">7</a>] MacOS DS_Stores: Like Shellbags but for Macs - SANS DFIR Summit 2019</p>
<p>[<a href="https://www.magnetforensics.com/resources/demystifying-mac-investigations-mac-vs-windows-artifacts-comparison/?submission=https://go.magnetforensics.com/l/52162/2020-08-25/kqxr57">9</a>] Demystifying Mac Investigations: Mac vs. Windows Artifacts Comparison</p>
<p>[<a href="">9</a>] OSDF Conference 2020 - Apollo</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
