<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>First Response Process Overview - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.9c9bbb2be2e02926bfcb1204398724e12f9d26927371144ebd6aac75c0640f71.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/host/collection/"> Back to Host Evidence Collection ğŸ‘ Section ğŸ‘ˆğŸ¼ </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#checklist">Checklist</a></li>
    <li><a href="#on-scene-tools-">On-scene tools ğŸ› :</a></li>
    <li><a href="#options">Options</a>
      <ul>
        <li><a href="#clone">Clone</a></li>
        <li><a href="#copy">Copy</a></li>
        <li><a href="#imaging">Imaging</a></li>
      </ul>
    </li>
    <li><a href="#validating-the-tools">Validating the tools</a>
      <ul>
        <li><a href="#validate-sanitisation">Validate Sanitisation</a></li>
        <li><a href="#validate-software-write-blocker">Validate Software Write Blocker</a></li>
      </ul>
    </li>
    <li><a href="#capturing-the-scene-">Capturing the scene âœï¸</a>
      <ul>
        <li><a href="#prepare-documentation">Prepare documentation</a></li>
        <li><a href="#identify-the-evidence">Identify the evidence</a></li>
        <li><a href="#take-photos-and-videos">Take photos and videos</a></li>
        <li><a href="#documenting">Documenting</a></li>
        <li><a href="#acquisition">Acquisition</a></li>
        <li><a href="#ftk-imager">FTK Imager</a></li>
        <li><a href="#dd"><code>dd</code></a></li>
        <li><a href="#write-blockers">Write Blockers</a></li>
        <li><a href="#ram">RAM</a></li>
        <li><a href="#package-and-transport">Package and transport</a></li>
      </ul>
    </li>
    <li><a href="#evidence-preservation">Evidence Preservation</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">First Response Process Overview</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-search"></i>
              
          <a class="category-link" href="/domain/forensics">forensics</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      
      <div class="article-category">
          
            
            
            
            
            
              <i class="fab fa-linux"></i>&nbsp;<i class="fab fa-apple"></i>&nbsp;<i class="fab fa-windows"></i>&nbsp;<i class="fas fa-mobile"></i>
            
          <a class="platform-link" href="/platforms/all">all</a>
          
      </div> <br />
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p><em>First responders first arrive on the scene. Not always they are digital forensic experts. But what if I get so lucky to be the first responder?</em></p>
<h2 id="checklist">Checklist</h2>
<ul>
<li><input disabled="" type="checkbox"> <em>â“All photos taken before touching the scene?</em></li>
<li><input disabled="" type="checkbox"> <em>â“Chain of custody properly carried out?</em></li>
<li><input disabled="" type="checkbox"> Remove evidence drive from the PC</li>
<li><input disabled="" type="checkbox"> Sanitize the target disk</li>
<li><input disabled="" type="checkbox"> <em>â“Is all the write blocker to be used verified prior to this investigation?</em></li>
<li><input disabled="" type="checkbox"> <em>â“Is the imaging software verified according to the policy or at least once a month? (the whole drive is imaged)?</em></li>
<li><input disabled="" type="checkbox"> Connect the write blocker to the PC and the evidence drive to the write blocker (power + data cables)</li>
<li><input disabled="" type="checkbox"> <em>â“Is the WB option on?</em></li>
<li><input disabled="" type="checkbox"> Calculate <strong>the hash of the evidence drive</strong> (pre-hash). Document it.</li>
<li><input disabled="" type="checkbox"> Image the evidence.</li>
<li><input disabled="" type="checkbox"> Calculate the <strong>hash of the original evidence</strong> again, validate the hash and document it.</li>
<li><input disabled="" type="checkbox"> Calculate the <strong>hash of the image that was taken</strong> (post-hash) and make sure it matches the above ones taken previously.</li>
</ul>
<h2 id="on-scene-tools-">On-scene tools ğŸ› :</h2>
<ul>
<li>A PC technician&rsquo;s toolkit ğŸ§° (screwdrivers ğŸª›, squeezers, scissorsâœ‚ï¸ , portable batteries ğŸ”‹and etc) to be able to remove HDD, lockdown cables etc) âœ….</li>
<li>Digital camera ğŸ“¸  that embed timestamps on the photos. ğŸ“ Take photos, the more the better!</li>
<li>Video camera ğŸ“¹. ğŸ“ Take a video, the longer the better.</li>
<li>For labeling and documenting (labels, markers, pens, ğŸ–Š, evidence tape ğŸš§).</li>
<li>Transporting and managing evidence ğŸ’¼ (Faraday bag , Anti-static bag, evidence log, large envelopes âœ‰ï¸,  glovesğŸ§¤, sanitizer, ).</li>
<li>Documents (chain of custody, notes ğŸ—’, warrants/subpoenas).</li>
<li>Digital forensics specifics (forensics software, write blockers, laptop ğŸ’», sterilize target media, flash drives for live/dead acquisition, bootable ).</li>
</ul>
<h2 id="options">Options</h2>
<h3 id="clone">Clone</h3>
<p>Bit-by-bit copy on another drive. Can even boot from it.</p>
<h3 id="copy">Copy</h3>
<p>Only files and their slack space is copied.</p>
<h3 id="imaging">Imaging</h3>
<p>Bit-by-bit copy, but stored as a file. The image can be compressed to save space and store data on a smaller disk.</p>
<p>Types:</p>
<ul>
<li><code>dd</code>. No compression.</li>
<li><code>E01</code>. Compressed.</li>
<li><code>AFF</code>. Compressed.</li>
<li><code>Smart</code>. Compressed.</li>
<li>Etc</li>
</ul>
<h2 id="validating-the-tools">Validating the tools</h2>
<h3 id="validate-sanitisation">Validate Sanitisation</h3>
<p>Check that the target disk is all <code>0</code>s. For that use <code>HxD</code> or <code>010 Editor</code> (?) and run a checksum 64 against it. It should be all zeroes.</p>
<h3 id="validate-software-write-blocker">Validate Software Write Blocker</h3>
<p>In order to validate the software WB, uplug the drive, turn the WriteBlocker on, plug the drive back in and run some software capable of calculating the hash of a drive (FTK Imager, for example). Then document the result. This is a <strong>pre-hash value</strong>. Remove the drive from FTK and close the tool (in order to prevent it reading from cache). Try writing something to the drive or changing a file and then follow the above steps again. The hash values should be the same!</p>
<blockquote>
<p>âš ï¸ Make sure to run the hashing funciton against the physical drive, not the logical one!</p>
</blockquote>
<h2 id="capturing-the-scene-">Capturing the scene âœï¸</h2>
<h3 id="prepare-documentation">Prepare documentation</h3>
<p>Start documenting even before you get to the scene.</p>
<p><img src="images/chain-of-custody.png" alt="chain-of-custody"></p>
<h3 id="identify-the-evidence">Identify the evidence</h3>
<p>Assign IDs for each evidence. For example, for a flash drive it would look like this. FD (flash drive) + its <em>sequence number</em> within this case + case number. Subsequent images of these devices will have the same number + copy&rsquo;s sequence number.</p>
<p>Example: <em>A USB Flash drive was found on the scene during case study 0124. It was the first USB drive found yet. This device was assigned a number FD-01-0124. Then we made two bit-by-bit copies of this drive and these were assigned numbers FD-01-0124-01 and FD-01-0124-02 respectively.</em></p>
<h3 id="take-photos-and-videos">Take photos and videos</h3>
<p>First, make sure that timestamps are configured on both devices. Take as many photos and videos as possible. Take overall and close-up photos. Make sure that all the connections between the devices are photographed clearly. Photograph the evidence in situ (if possible).</p>
<h3 id="documenting">Documenting</h3>
<p>Document the evidence (where found, by whom, make, model, serial number, etc.).</p>
<table>
<thead>
<tr>
<th>questions</th>
<th>answers</th>
</tr>
</thead>
<tbody>
<tr>
<td>â“Where the evidence was found</td>
<td></td>
</tr>
<tr>
<td>â“Time and date the evidence was collected</td>
<td></td>
</tr>
<tr>
<td>â“Who found the evidence</td>
<td></td>
</tr>
<tr>
<td>â“Description of the evidence</td>
<td></td>
</tr>
<tr>
<td>â“Make, model, and S/N of device (if applicable)</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="acquisition">Acquisition</h3>
<p>Don&rsquo;t contaminate the scene (try not to be tempted to eat buiscuits ğŸª and burgers ğŸ” on the scene, however hard that might seem). This means, that you should also preserve the physical evidence as well. Don&rsquo;t touch ANYTHING before the lead investigator says &ldquo;OK&rdquo; ğŸ‘. Always mind the scope and get it in writing even if it&rsquo;s not a crimial case. Do fingerprints need to be collected? DNA?</p>
<p>What types of evidence can I come across?</p>
<ul>
<li>Obvious - PC, cameras, flash drives, PDAs, removable media. Mind the chain of custody. Document the physical condition (mouse to left or right as the owner is a lefty or a righty), applications running, keep audio notes.</li>
<li>Non-obvious
<ul>
<li>manuals for devices that were not found - look for these devices</li>
<li>digital media taken with some device that was not found -look for this device</li>
<li>Sticky notes or liitle papers with scrambled notes.</li>
</ul>
</li>
</ul>
<p>The first thing to consider when acquiring a PC is wether it&rsquo;s turned on or off?</p>
<ul>
<li>Yes. Then transport it as is. Do not forget the charger!</li>
<li>No. Depending on the case nature, turn off or perform the RAM capture.</li>
</ul>
<h3 id="ftk-imager">FTK Imager</h3>
<h3 id="dd"><code>dd</code></h3>
<p>Stands for disk duplicate. <code>if</code> - input file to make an image of. <code>of</code> - where we are writing the evidence to.</p>
<h3 id="write-blockers">Write Blockers</h3>
<p>There are hardware and software write blockers. They both ensure that the changes are not made to target media when plugging in disks or flash drives. InfoSec course recommends using hardware blockers instead of software whenever possible. However if the hardware option is not available, software are acceptable.</p>
<blockquote>
<p>ğŸ” Why?</p>
<p>âœï¸ They have a dedicated firmware which is independent of the target OS. That means they work with any OS and any BIOS version. Software writeblockers are not reliable. Some of them do not work at all, some don&rsquo;t work for specific drives.</p>
</blockquote>
<p>Read <a href="https://habr.com/ru/company/bizone/blog/320032/">this</a> article on habr which is a research whether software write blockers are worse than hardware ones. Write blocker needs to validated prior to imaging on a small drive in every investigation!</p>
<h4 id="software-write-blockers">Software Write Blockers</h4>
<p>For Windows ğŸ› : Safe Block ğŸ’°, FastBloc SE (EnCase module) ğŸ’°; for USB ports: <a href="https://www.softpedia.com/get/Security/Security-Related/Thumbscrew.shtml">Thuscrew</a> (flips the bit in <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\StorageDevicePolicies\WriteProtect</code>), <a href="https://sourceforge.net/projects/usbwriteblockerforwindows8/files/latest/download">USB Write Blocker for Windows</a>.</p>
<h3 id="ram">RAM</h3>
<p>Now, about the RAM capture. Here is the order of volatility (processes &gt; network connections &gt; routing tables &gt; passwords):</p>
<ol>
<li>Regisrers and cache. How to collect them? What&rsquo;s registers? CPU or &hellip;?</li>
<li>Routing tables, ARP cache, process tables, kernel statistics, memory
<ol>
<li>Windows - <code>route print | more</code></li>
<li>Linux -  <code>ip route</code></li>
<li>Mac OSX - <code>netstat -rn</code></li>
</ol>
</li>
<li>Temporary file systems?</li>
<li>Disk</li>
<li>Remote logging and monitoring data that is revelevant to the system in question</li>
<li>Physical configuration, network topolgy</li>
<li>Archival media</li>
</ol>
<p>âš ï¸ In case of live capture, mind that there might be a kill switch somewhere or a rootkit that will deem all unusable the moment you try doing something.</p>
<p>Along with the device itself, document and acquire sub-items as well (attached USBs and other stuff, manuals, papers, adapters etc).</p>
<p>Now, what about each device type acquisition specifics?</p>
<p>ğŸ Apple Acquisition.</p>
<p><strong>Mac</strong>. On the forensic Macbook turn off disk arbitration or use write blockers. To turn off this feature refer to <a href="https://forensicswiki.xyz/wiki/index.php?title=Disabling_Macintosh_Disk_Arbitration_Daemon">this</a> page. It&rsquo;s needed so that the forensic machine won&rsquo;t make changes to the data on the suspect Macbook. For Mac acquisition - follow <a href="https://forensicswiki.xyz/wiki/index.php?title=Acquiring_a_MacOS_System_with_Target_Disk_Mode">these</a> steps.</p>
<blockquote>
<p>â“<em>What files are changed when something is connected to a Mac (USB or using Thunderbolt)? Is turning off the disk arbitration feature really prevents the changed being made to the target drive?</em></p>
</blockquote>
<p><strong>iOS</strong>.</p>
<p>ğŸªŸ Windows Acquisition</p>
<p>ğŸ§ Linux Acquisition.</p>
<p>ğŸ¤– Android Acquisition</p>
<h3 id="package-and-transport">Package and transport</h3>
<p>Package the evidence for transport. Transport the evidence. Store the evidence while in possession. Use Faraday bags for avoiding remote tampering, anti-static and plastic bags as a protection from discharge and moisture. Tape and seal the bags with the evidence.</p>
<h2 id="evidence-preservation">Evidence Preservation</h2>
<p>Keep in mind the <a href="https://www.sciencedirect.com/topics/social-sciences/exchange-principle#:~:text=Locard's%20Exchange%20Principle%20states%20that,pollen%2C%20paint%2C%20and%20soil.">Locard&rsquo;s Exchange Principle</a>. To keep the evidence safe and admissable in court, document everything. When acquiring data from memory, use write blockers (soft- or hardware-based). If the device is off, don&rsquo;t turn it on. If it&rsquo;s on - take photos ğŸ“¸ of all windows, note running applications and processes (mind destructive processes and encryption ğŸ”). If you see a destructive process running, pull the plug from the PC (not the wall), take out the battery or shut it down immediatly. You need to be able to identify at least some of disk-wiping software. However, some of them might be command line and get triggered when USB is plugged in (<a href="/docs/dfir/antiforensics/usbkill-switch">kill switch</a>).</p>
<blockquote>
<p>ğŸ—’ Make a list of the most popular disk-wipers with their icons.</p>
</blockquote>
<p>To avoid remote wiping or evidence tampering - RF shielding (Faraday bag).</p>
<p>To prevent battery loss (in case we need the device to be on), keep the device connected to the power supply (for example, portable). âš ï¸ Turning off might trigger encryption!</p>
<p>Document the changes that you are making. Know your tools ğŸ› ! What changes they are making (<a href="https://peat-chameleon-e41.notion.site/bf3cb04f2a074cfc816f853cec92d783?v=f8cbcf21bcb641b6806fb22decfccf9f">see</a>).</p>
<h2 id="references">References</h2>
<p>[<a href="https://learning.oreilly.com/videos/digital-archaeology-livelessons/9780132853835/9780132853835-02_01/">1</a>] Digital Archaeology from O&rsquo;Reilly by LiveLessons</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
