<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ—’  Incident Response Methodology - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.eeb61b3f25f73088eb3aeb02bc61f28d33975f447fc5649add3b83c10059c331.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/"> Back to Incident Investigation ğŸ” ğŸ¥· Section ğŸ‘ˆğŸ¼ </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#preparation">Preparation</a>
      <ul>
        <li><a href="#creating-a-playbook">Creating a playbook</a></li>
      </ul>
    </li>
    <li><a href="#detection-and-analysis-sans-identification">Detection and Analysis (SANS Identification)</a>
      <ul>
        <li>
          <ul>
            <li><a href="#common-malicious-activity-detection-and-countermeasures">Common Malicious Activity, Detection and Countermeasures</a></li>
          </ul>
        </li>
        <li><a href="#documentation">Documentation</a></li>
      </ul>
    </li>
    <li><a href="#containment-eradication-recovery">Containment. Eradication. Recovery.</a></li>
    <li><a href="#post-incident-activity-sans-lessons-learned">Post-Incident Activity (SANS Lessons Learned)</a></li>
    <li><a href="#cloud-ir-specifics">Cloud IR Specifics</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">ğŸ—’  Incident Response Methodology</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
          <a class="category-link" href="/domain/ir">ir</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
          <a class="platform-link" href="/doctype/methodology">methodology</a>
          
      </div> <br /><br/>
      
      
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <h2 id="preparation">Preparation</h2>
<ul>
<li><input checked="" disabled="" type="checkbox"> ğŸ“ <strong>Compile</strong> a list of all your assets (servers, networks, applications etc)</li>
<li><input checked="" disabled="" type="checkbox"> ğŸ“ˆ <strong>Rank</strong> them by level of importance.</li>
<li><input checked="" disabled="" type="checkbox"> ğŸ‘ <strong>Monitor</strong> their traffic patterns and create baselines.</li>
<li><input checked="" disabled="" type="checkbox"> ğŸ«‚ Create a <strong>communication plan</strong> (who to contact, how, and when based on each incident type). <strong>Incident Handler Communications and Facilities</strong> (contacts, on-call info, reporting mechanism, issue tracking, smartphones, encryption soft, war room, secure storage).</li>
<li><input checked="" disabled="" type="checkbox"> ğŸš§ Determine which security events, and at what <strong>thresholds</strong>, these events should be investigated.</li>
<li><input checked="" disabled="" type="checkbox"> ğŸ“– Create an <strong>incident response plan</strong> for each type of incident.</li>
</ul>
<p>Below are some questions to help assess your readiness:</p>
<ul>
<li><input disabled="" type="checkbox"> â“ Area all members aware of the sec policies?</li>
<li><input disabled="" type="checkbox"> â“ Do all members of IR know whom to contact?</li>
<li><input disabled="" type="checkbox"> â“ Do all of them have access to journals and toolkit?</li>
<li><input disabled="" type="checkbox"> â“ Have they all participated in IR drills?</li>
</ul>
<h3 id="creating-a-playbook">Creating a playbook</h3>
<h2 id="detection-and-analysis-sans-identification">Detection and Analysis (SANS Identification)</h2>
<p>Lot&rsquo;s of systems can be used to monitor the network and host for malicious activity. These are IDS, IPS, firewalls, AV, SIEM (Security Information and Event Management solutions, SIM + SEM), IR frameworks, threat intelligence etc. However, the incident might be reported by employee (for example, receiving a suspicious email) or by a third party (data exfiltrated seen in the dark net). Before it is confirmed to be true or be the result of a malicious intent, it&rsquo;s called an <em>event</em>.</p>
<ol>
<li><strong>Discover</strong>. Discovery and classification (Where is the sensitive data?), Entitlements reporting (Who can access), Vulnerability Assessment (How to secure it?).</li>
<li><strong>Harden</strong>. Reconfigure, mask, encrypt (How to protect sensitive data?)</li>
<li><strong>Monitor and Protect.</strong> Activity monitoring, Blocking quarantine, dynamic data masking</li>
<li><strong>Repeat</strong>.</li>
</ol>
<p><strong>Precursors</strong>â“ - signs that in incident <em>may</em> occur in the future. For example, logs show that a vulnerability scanner was used. Or a vulnerability was found in some software that&rsquo;s used by the company.</p>
<p><strong>Indicators</strong> ğŸš¨ - signs that an incident have occurred already or is occurring now. Malware detected by a anti-virus program, configurations changed, multiple failed logins etc.</p>
<p>There are several techniques that help confirming the incident:</p>
<ul>
<li><strong>Frequency analysis</strong>. Something that is outstandingly rare accross systems might be malicious</li>
<li><strong>Normal vs Evil</strong>. You know what&rsquo;s considered normal for the given system/user and something that&rsquo;s not usual is a primary suspect for the further analysis.</li>
<li><strong>IoC</strong>. Indicators of compromise, like some virus hashes or file extensions used by a known cryptor malware.</li>
</ul>
<p>After the incident is confirmed, you initiate an investigation.</p>
<blockquote>
<p>ğŸ“ I found it quite hard to separate incident response and digital forensics articles from one another. For now I am seeing incident response as a more general process that could require more thorough examination (digital forensics) but not neccessarilly. As I see it, we have an event, start IR process to determine whether it&rsquo;s malicious. Identify compromised hosts and map the artifacts to ATCK MITRE framework. Then, to be able to fully contain and remediate the incident, we call for DF, trying to analyse malware, analyse the registry on Windows, recover data from unallocated space etc in order to reconstruct the whole picture in detail. So, roughly speaking, IR is about sketching and DF is about details.</p>
</blockquote>
<h4 id="common-malicious-activity-detection-and-countermeasures">Common Malicious Activity, Detection and Countermeasures</h4>
<p><strong>Mapping</strong>. Attackers need to <strong>collect information</strong> about the target system first:  <code>ping</code>, <code>nmap</code>.     <strong>Countermeasures:</strong></p>
<ul>
<li>record traffic</li>
<li>look for suspicious activity</li>
<li>use a host scanner and keep track of all the PCs withing your network. A new PC should trigger an alert.</li>
</ul>
<p><strong>Packet Sniffing</strong>. Now, attacker may perform (or try to perform) <strong>traffic sniffing</strong>. It is possible in the following cases: Broadcasting, promiscuous NIC, and if the traffic is unencrypted.  <strong>Countermeasures:</strong></p>
<ul>
<li>periodcally check wether the NICs of the hosts are in promiscuous mode</li>
<li>switched Ethernet (1 host per segment of broadcast media).</li>
</ul>
<p><strong>IP-spoofing.</strong> Can generate &ldquo;raw&rdquo; IP packets, putting any value as a source IP. Receiver won&rsquo;t be able to know that the other party is spoofed. <strong>Countermeasures:</strong></p>
<p><strong>DoS</strong>. <strong>Countermeasures:</strong></p>
<ul>
<li>filter out flooded packets (eg SYN) before they reach the host</li>
<li>traceback to source of floods</li>
</ul>
<p>ğŸ£ <strong>Phishing.</strong> <strong>Spear phishing</strong> - targeted attack to a specific users or groups of users. <strong>Whaling</strong> - spear phishing for high executive managers. <strong>Strategies</strong>:</p>
<ul>
<li>They claim that they&rsquo;ve seen numerous failed login attempts or other suspicious activity.</li>
<li>They claim that there is some problem with your account or payment method.</li>
<li>Confirm some personal information.</li>
<li>Include a fake invoice.</li>
<li>Click on a link to make a payment.</li>
<li>You are eligible for a government refund.</li>
<li>Coupon for free stuff.</li>
</ul>
<p>How to detect?</p>
<ul>
<li>Suspicious sender&rsquo;s address.</li>
<li>Generic signature and greetings.</li>
<li>Spoofed hyperlinks and websites.</li>
<li>Spelling and layout.</li>
<li>Suspicious attachment.</li>
</ul>
<p><strong>PoS</strong>. Most of the malware is equipped with a backdoor and C&amp;C features. The data of the card holder is decrypted in RAM, that&rsquo;s why this type of malware sniffs the RAM (RAM scraping). <strong>Countermeasures</strong>:</p>
<ul>
<li>Monitor network for changes</li>
<li>Good encryption</li>
<li>limit the host that communicate with PoS</li>
<li>chip-card enabled PoS terminals</li>
<li>Employee screening and training</li>
</ul>
<p><strong>Injections</strong>. MongoDB. <code>$where</code> is interpreted as JS. DoS: <code>$where=&quot;d=new Date; do {c=new Date;} while {c-d&lt;10000};&quot;</code>, XPath. <code>'or 1=1 or '1'='1</code>, LDAP.<code>*)(cn=))(|cn=*</code>, SQL <code>or 1=1--</code> etc. The best practice is whitelisting allowed and needed characters.</p>
<ul>
<li>Preventing <strong>OS injection</strong>
<ul>
<li>Don&rsquo;t use OS commands</li>
<li>Sanitise input</li>
<li>Accept, say, ids and lookup</li>
<li>Leat priv</li>
<li>do not run through shell interpreters</li>
<li>explicit paths</li>
</ul>
</li>
<li>Preventing <strong>SQLi</strong>
<ul>
<li>prepared statements</li>
<li>sanitise</li>
<li>do not expose errors with sql statements etc</li>
<li>limit permissions</li>
<li>stored procedures</li>
<li>ORM libs (Hibernate)</li>
</ul>
</li>
</ul>
<p><strong>Common AWS issues</strong>
The following list is the top ten identified misconfigurations in Amazon EC2 instances and workloads from our data set:</p>
<ol>
<li>Unconfigured EC2 instance single-point-of-failure and/or auto scaling issue</li>
<li>S3 logging not enabled</li>
<li>S3 object versioning is not enabled</li>
<li>User not configured to use MFA</li>
<li>User access key not configured with rotation</li>
<li>IAM policies are attached directly to user</li>
<li>Dangerous user privileged access to S3</li>
<li>ELB security group allows insecure access to ports or protocols</li>
<li>IAM access keys unused for 90 days</li>
<li>Dangerous user privileged access to RDS</li>
</ol>
<h3 id="documentation">Documentation</h3>
<p>This is the stage when you start taking notes for the incident (or event). Current status of the incident, summary, indicators, other incidents related, actions taken by all, chain of custody*, impact assessment, contacts, list of evidence, comments from incident handlers (IH), next steps to be taken (rebuild the host/upgrade).</p>
<p>How to categorize the incident? Simply put, how bad is that?</p>
<ul>
<li>Functional Impact Categories
<ul>
<li><strong>None</strong> - nothing&rsquo;s changed.</li>
<li><strong>Low</strong> - the business can still provide its critical services but the efficiency is lost.</li>
<li><strong>Medium</strong> - O. has lost an ability to provide its critical services to some users.</li>
<li><strong>High</strong> - O. is no longer able to provide its critical services.</li>
</ul>
</li>
<li>Information Impact Categories
<ul>
<li><strong>None</strong> - no info was exfiltrated or compromised.</li>
<li><strong>Privacy breach</strong> - sensitive PII was accessed or exfiltrated.</li>
<li><strong>Proprietary breach</strong> - unclassified proprietary info exfiltrated (PCII).</li>
<li><strong>Integrity loss</strong> - sensitive or proprietary info was changed or deleted.</li>
</ul>
</li>
<li>Recoverability Effort Categories, TTR - time to recovery
<ul>
<li><strong>Regular</strong> - TTR is predictable with existing resources.</li>
<li><strong>Supplemented</strong> - TTR is predictable with additional resources.</li>
<li><strong>Extended</strong> - TTR is unpredictable.</li>
<li><strong>Not recoverable</strong>, launch the investigation.</li>
</ul>
</li>
</ul>
<h2 id="containment-eradication-recovery">Containment. Eradication. Recovery.</h2>
<p><strong>Containment</strong> ğŸ“¦ aims to stop the bleedingğŸ©¸. It&rsquo;s a very important stage. While during Identification (aka detection and analysis) we are <em>confirming</em> that something&rsquo;s going wrong, this stage is used in order to see the full picture, how the breach happened, what damage was already done, which systems are compromised etc. Quoting SANS:</p>
<blockquote>
<p>The goal of containment is to limit damage from the current security incident and prevent any further damage. Several steps are necessary to completely mitigate the incident, while also preventing destruction of evidence that may be needed for prosecution.</p>
</blockquote>
<p>So, digital forensics can occur anywhere from Analysis (aka Identification) to Lessons Learned stage. It may not occur, however. For example, a DoS attack may not need this facility.</p>
<p>Choosing a containment strategy:</p>
<ul>
<li><input disabled="" type="checkbox"> â“ Is there a potential damage or theft of resources?</li>
<li><input disabled="" type="checkbox"> â“ Do we need to preserve the evidence for court/ourselves, make an image of the compromised system?</li>
<li><input disabled="" type="checkbox"> â“ Do we need the service to be available during the investigation?</li>
<li><input disabled="" type="checkbox"> â“ How much time do we have and need?</li>
<li><input disabled="" type="checkbox"> â“What resources are available in order to implement this strategy?</li>
<li><input disabled="" type="checkbox"> â“ What&rsquo;s the effectiveness of the strategy (partial of full containment)?</li>
</ul>
<p>Below is the checklist for the reference to make sure, the responder has done their job. These questions can be used in a ticket or IR timesheet, mentioned above in the <em>Documentation</em> section.</p>
<ul>
<li><input disabled="" type="checkbox"> â“ Who attacked you and why?</li>
<li><input disabled="" type="checkbox"> â“ When and How did it happen?</li>
<li><input disabled="" type="checkbox"> â“ Did this happen because of the poor sec policy and processes?</li>
<li><input disabled="" type="checkbox"> â“ How widespread is the incident?</li>
<li><input disabled="" type="checkbox"> â“ What steps are being taken to determine what happened and prevent it in future?</li>
<li><input disabled="" type="checkbox"> â“ What&rsquo;s the impact?</li>
<li><input disabled="" type="checkbox"> â“ Was any personally identifiable information leaked?</li>
<li><input disabled="" type="checkbox"> â“ What is the estimated cost of this incident?</li>
</ul>
<blockquote>
<p>The SANS containment process involves:</p>
<p><strong>Short-term containment</strong>â€”limiting damage before the incident gets worse, usually by isolating network segments, taking down hacked production server and routing to failover.</p>
<p><strong>System backup</strong>â€”taking a forensic image of the affected system(s) with tools such as Forensic Tool Kit (FTK) or EnCase, and only then wipe and reimage the systems. This will preserve evidence from the attack that can be used in court, and also for further investigation of the incident and lessons learned.</p>
<p><strong>Long-term containment</strong>â€”applying temporarily fixes to make it possible to bring production systems back up. The primary focus is removing accounts or backdoors left by attackers on the systems, and addressing the root causeâ€”for example, fixing a broken authentication mechanism or patching a vulnerability that led to the attack.</p>
</blockquote>
<p><strong>Eradication</strong> aims to remove the threat. For example, get rid of the malware, retrun configs to its normal state. It&rsquo;s a common mistake of many companies to jump right to this stage without proper prior investigation and containment. In this case, the attacker might still be inside, or the vulnerability they used is still unmatched, or the user they social engineered is still not informed about this event properly etc. It can turn into &ldquo;whack-a-mole&rdquo; game which is no fun when a comapny&rsquo;s reputation and finance ğŸ’µ are concerned.</p>
<ul>
<li><input disabled="" type="checkbox"> â“ Can the problem be isolated? Are all affected isolated?</li>
<li><input disabled="" type="checkbox"> â“ Have the forensic copied been created? For each evidence, keep the info (or chain of custody, even better):
<ul>
<li><input checked="" disabled="" type="checkbox"> Identifying information (location, serial, model, hostname, MAC and IP)</li>
<li><input checked="" disabled="" type="checkbox"> Name, title, phone of each individual who collected or handled the evidence</li>
<li><input checked="" disabled="" type="checkbox"> Time and date (+ time zone) of each occurrence of evidence handling</li>
<li><input checked="" disabled="" type="checkbox"> Location where the evidence were stored</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> â“ Can this system be reimaged and patched?</li>
<li><input disabled="" type="checkbox"> â“ Was all malware removed and the system hardened?</li>
<li><input disabled="" type="checkbox"> â“ What tools are you going to use to test, monitor and verify that the systems being restored and are no longer compromised by the same cause?</li>
</ul>
<p><strong>Recovery</strong> aims to get the system operational if it went down or simply back to business as usual if it didnâ€™t.</p>
<h2 id="post-incident-activity-sans-lessons-learned">Post-Incident Activity (SANS Lessons Learned)</h2>
<p>Learn from your experience so you can better respond to future security events. Adjust your playbooks accordingly.</p>
<h2 id="cloud-ir-specifics">Cloud IR Specifics</h2>
<p>In case there are any shared resources with other companies which do not care about security as much, you might be into trouble. For example, several companies host their web application on one website.</p>
<h2 id="references">References</h2>
<p>[<a href="https://www.coursera.org/learn/introduction-cybersecurity-cyber-attacks/home/welcome">1</a>] IBM course</p>
<p>[<a href="https://www.sentinelone.com/labs/macos-incident-response-part-1-collecting-device-file-system-data/">2</a>] Mac IR</p>
<p>[<a href="https://cybersecurity.att.com/blogs/security-essentials/incident-response-steps-comparison-guide">3</a>] NIST vs SANS IR frameworks</p>
<p>[<a href="https://www.sans.org/reading-room/whitepapers/incident/documentation-incident-response-air-tank-scuba-diving-2021">4</a>] Documentation is to Incident Response as an Air Tank is to Scuba Diving</p>
<p>[<a href="https://www.cynet.com/incident-response/incident-response-sans-the-6-steps-in-depth/">5</a>] Incident Response SANS: The 6 Steps in Depth</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
