<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>File Systems - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.32b06cb74069d8b26d087fbfd2852fc54428a31ff14ddead5c220eddcb248b07.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-forensics 🔍 and incident response 🥷">
      <a href="/docs/dfir">
        <span>Forensics 🔍 and Incident Response 🥷</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-forensics 🔍 and incident response 🥷">
      <a href="/docs/dfir">
        <span>Forensics 🔍 and Incident Response 🥷</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/data-storage/"> Back to Data Storage Section 👈🏼 </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#data-structures-and-flags">Data structures and Flags</a></li>
      </ul>
    </li>
    <li><a href="#bootcode-and-booting-process">Bootcode and Booting Process</a></li>
    <li><a href="#file-systems">File Systems</a></li>
    <li><a href="#fat">FAT</a>
      <ul>
        <li><a href="#versions">Versions</a></li>
        <li><a href="#structure">Structure</a></li>
      </ul>
    </li>
    <li><a href="#extx">ExtX</a>
      <ul>
        <li><a href="#2">2</a></li>
        <li><a href="#3">3</a></li>
        <li><a href="#4">4</a></li>
      </ul>
    </li>
    <li><a href="#reiserfs">ReiserFS</a></li>
    <li><a href="#xfs">XFS</a></li>
    <li><a href="#hfs">HFS</a></li>
    <li><a href="#hfs-1">HFS+</a></li>
    <li><a href="#apfs">APFS</a>
      <ul>
        <li><a href="#timestamps">Timestamps</a></li>
        <li><a href="#metadata">Metadata</a></li>
      </ul>
    </li>
    <li><a href="#ntfs">NTFS</a>
      <ul>
        <li><a href="#timestamps-1">Timestamps</a></li>
        <li><a href="#ntfs-metadata">NTFS Metadata</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">File Systems</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-archive"></i>
              
          <a class="category-link" href="/domain/general">general</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p>There are: file name, file metadata and the contents of the file itself. They are not in the same place. File metadata contains filename and also a ptr to the sector, where the file&rsquo;s contents starts and size of data. Theoretically, we could change the file metadata to make it point to another cluster&hellip; 🤔</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Cluster</th>
<th>size</th>
<th>last accessed</th>
</tr>
</thead>
<tbody>
<tr>
<td>malware.txt</td>
<td>654</td>
<td>80</td>
<td>October 13, 2020</td>
</tr>
</tbody>
</table>
<p><strong>Essential</strong> data - can be trusted and <strong>non</strong>-<strong>essential</strong> cannot. But if ptr to cluster is called essential data, how we can trust it? Well, it&rsquo;s much harder to tamper with.</p>
<p><a href="https://apple.stackexchange.com/questions/321406/extract-hfs-hfsx-volume-from-dmg-file">https://apple.stackexchange.com/questions/321406/extract-hfs-hfsx-volume-from-dmg-file</a></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">open <span class="o">[</span>path/to/dmg<span class="o">]</span>
dd <span class="k">if</span><span class="o">=</span><span class="s2">&#34;/dev/disk[number]&#34;</span> <span class="nv">of</span><span class="o">=</span><span class="s2">&#34;/extract/path/file.img&#34;</span>
fdisk -l file.img
dd <span class="k">if</span><span class="o">=</span><span class="s2">&#34;path/to/file.img&#34;</span> <span class="nv">bs</span><span class="o">=</span>sector_size <span class="nv">skip</span><span class="o">=</span>sectors <span class="nv">count</span><span class="o">=</span>sectors &gt;&gt; output.hfs
</code></pre></div><h3 id="data-structures-and-flags">Data structures and Flags</h3>
<p>First, there must be some data structure identifier so that the CPU could know, how to read the subsequent data. For example, if we have the following:</p>
<p><code>1001 1000 1001 1110 1010 1100 1000 101</code></p>
<p>For example, the first 4 bits <code>0101</code> tell the CPU that the next bits should be interpreted as an image. Then, for example, there are other 4 bits <code>0011</code> that are 4 flags. Flag is a 1-bit value, indicating either <code>true</code> or <code>false</code>, or either <code>exists</code> or <code>doesn't</code>. This are flags, for example, that indicate: wether it&rsquo;s black-and-white (<code>0</code>) or colored (<code>1</code>); wether the image is editable <code>1</code> or <code>0</code> etc. And then the file contents.</p>
<p>Consider the above binary sequence. To make it more compressed, convert it to hex: <code>4c 4f 56 45</code>. What is this? That depends. If you tell CPU that it&rsquo;s machine instructions, then it&rsquo;s see this:</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">dec esp
dec edi
push esi
inc ebp
</code></pre></div><p>But what if you tell that it&rsquo;s text? Then CPU sees&hellip; check out <a href="https://www.rapidtables.com/convert/number/ascii-to-hex.html">here</a>.</p>
<h2 id="bootcode-and-booting-process">Bootcode and Booting Process</h2>
<h2 id="file-systems">File Systems</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Partition size (min/max)</th>
<th>Cluster size (min/max)</th>
<th>File Max Size</th>
<th><code>fstab</code> code</th>
</tr>
</thead>
<tbody>
<tr>
<td>FAT16</td>
<td>16Mb/2Gb</td>
<td>2Kb/32Kb</td>
<td></td>
<td></td>
</tr>
<tr>
<td>FAT32</td>
<td>260Mb/32Gb 🔍</td>
<td>2Kb/32Kb</td>
<td></td>
<td></td>
</tr>
<tr>
<td>NTFS 1.1</td>
<td>500Mb/8Gb 🔍</td>
<td>512B/8Kb</td>
<td></td>
<td></td>
</tr>
<tr>
<td>NTFS 3.0</td>
<td>500Mb/16EB</td>
<td>512B/64Kb</td>
<td></td>
<td></td>
</tr>
<tr>
<td>HFS</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>HFS+</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>APFS</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ext2</td>
<td>16Tb</td>
<td></td>
<td>2Tb</td>
<td><code>ext2</code></td>
</tr>
<tr>
<td>ext3</td>
<td>16Tb</td>
<td></td>
<td>2Tb</td>
<td><code>ext3</code></td>
</tr>
<tr>
<td>ext4</td>
<td>1Eb</td>
<td></td>
<td>16Tb</td>
<td><code>ext4</code></td>
</tr>
<tr>
<td>ReiserFS</td>
<td>16Tb</td>
<td></td>
<td>8Tb</td>
<td><code>resiserfs</code></td>
</tr>
<tr>
<td>JFS</td>
<td>32Pb</td>
<td></td>
<td>4Tb</td>
<td><code>jfs</code></td>
</tr>
<tr>
<td>XFS</td>
<td>16Eb</td>
<td></td>
<td>8Eb</td>
<td><code>xfs</code></td>
</tr>
<tr>
<td>Btrfs</td>
<td>16Eb</td>
<td></td>
<td>16Eb</td>
<td></td>
</tr>
</tbody>
</table>
<p>🔍 - this is from M. Graves' book &ldquo;Digital Archeaology&rdquo; book. I have not found any other information about max partition size on NTFS 1.1 and FAT32 max partition size is claimed to be 2,048 Gb, which doesn&rsquo;t correlate with other resources.</p>
<h2 id="fat">FAT</h2>
<p>Any FAT partition has two main parts: system area and data area. System area contains FAT boot record (every file system has a boot record), 1st FAT and 2nd FAT. FAT12 and FAT16 also have Root directory in the system area. Data area consists of Root directory in case of FAT32 and file and subdirectory data in clusters.</p>
<h3 id="versions">Versions</h3>
<h4 id="fat12">FAT12</h4>
<p>For the cluster addressing there were 12 bits available, which is 2^12 clusters at most (4096 clusters).</p>
<h4 id="fat16">FAT16</h4>
<p>For the cluster addressing there were 16 bits available, which is 2^16 clusters at most (65536 clusters).</p>
<h4 id="fat32">FAT32</h4>
<p>For the cluster addressing there were 28 bits available (not 32), which is 2^28 clusters at most (268 435 456 clusters). 4 bytes were reserved. Unlike in FAT12 and FAT16 the Root directory is in the data area, giving more space for data.</p>
<h4 id="exfat">ExFAT</h4>
<p>Uses all 32 bits for cluster addressing. Thus, the maximum number of clusters is 2^32 which gives us 4 294 967 296 clusters to call.</p>
<h3 id="structure">Structure</h3>
<h4 id="volume-boot-record">Volume Boot Record</h4>
<blockquote>
<p>⚠️ Not the MBR!!!!</p>
</blockquote>
<p>Located at sector 0 of the volume (❗️ not the physical sector 0). Starts with a jump instruction 3 bytes long at offset <code>0x0</code> (relative to VBR). Contains information about the volume (offset relative to the VBR start - size - name - description). Relevant information below:</p>
<ul>
<li><code>0x3</code> - 8 - <strong>OEM ID</strong>. Most likely MS-DOS5.0 for Win2000 and above.</li>
<li><code>0x0B</code> - 2- <strong>Bytes per sector</strong> (512 usually)</li>
<li><code>0x0D</code> - 1 - <strong>Sectors per cluster</strong></li>
<li><code>0x0E</code> - 2 - <strong>Reserved sectors</strong></li>
<li><code>0x10</code>  - 1 - <strong>Number of FATs</strong> (2, one of them is for backup purposes)</li>
<li><code>1C</code> - 4 - <strong>Hidden sectors</strong> 🙈 (preceding the volume)</li>
<li><strong>Total sectors</strong> (size of the volume)</li>
<li><code>0x16</code> - 2 - <strong>Sectors per FAT</strong> (FAT12 and 16)</li>
<li><code>0x24</code> - 4 - <strong>Sectors per FAT</strong> (FAT32)</li>
<li><code>0x2C</code> - 4 - <strong>Starting cluster of the root</strong> dir (2nd usually)</li>
<li><code>0x32</code> - 2 - <strong>Back-up boot sector</strong> location (6th usually)</li>
<li><code>0x43</code> - 4 - <strong>Volume serial number</strong>. In case of thumbdrive, this serial number can be used to track the device across the PC and other systems.</li>
<li><code>0x47</code> - 11 - <strong>Volume name/label</strong> 🏷 (not user defined, &ldquo;NONAME&rdquo; usually)</li>
<li><code>0x52</code> - 8 - <strong>FS type</strong></li>
</ul>
<p>Here is the full information available:</p>
<p><img src="images/fat-boot-struct.png" alt="fat-boot-struct"></p>
<h4 id="root-directory">Root Directory</h4>
<p>The name speaks for itself. It&rsquo;s the highest node in the dir structure of this volume, consists of 32 byte dir entries. Lists files and dirs in the root directory. FS stops reading these entries when it sees anything starting with <code>0x0</code>. So, data written here won&rsquo;t be seen by the OS and this is one of the ways to hide data. Types of root dir entries:</p>
<ul>
<li>volume name (user created)</li>
<li>short file name (8 uppercase letters + &ldquo;.&rdquo; + 3 letters for extension)</li>
<li>long file name. Can consist of several entries (each 32-bits). When the entry is the last in the set (1 set for each file), its sequence number starts with <code>4</code>. If the file name is more than 8 characters, there will be more than one long enry. The last one contains the last characters + extension. See below the example of a long entry set for a file with the name <code>asdjasdlkjasldkjsalkdaskljdjaljdajd.txt</code>.</li>
</ul>
<p><img src="images/fat-long-fragmented.png" alt="fat-long-fragmented"></p>
<p>Possible file attributes: hidden (<code>0x02</code>), read-only (<code>0x01</code>), system (<code>0x04</code>), volume label (<code>0x08</code>), directory (<code>0x10</code>) and archive (<code>0x20</code>). These attributes can be combined. Flags occupy just one byte and when there are more than one flag, their values are combined (like the access flags on Unix systems). Below is a screenshot of my test thumbdrive formatted as a FAT volume and its label&rsquo;s short entry:</p>
<p><img src="images/fat-short-attr.png" alt="fat-short-attr"></p>
<p>See the attributes. Only the bit for <code>volume</code> is set, which, given its position, has the value <code>0x08</code>.</p>
<p><strong>Short entry structure</strong></p>
<p><img src="images/fat-short-struct.png" alt="fat-short-struct"></p>
<p>The reserved bit above is for distinguishing between short and long file names. <code>0x00</code> for the long file name (not-8.3 compliant) and <code>0x10</code> for short file name (8.3 compliant).</p>
<p><img src="images/fat-entry-struct.png" alt="fat-entry-struct"></p>
<p>Four bytes for date and time created (first two bytes for time 🕰 and the second two bytes for date 📆). The time bytes are first converted from the little-endian notation (two bytes flipped). In the example abobe, for the yellow short entry the created date and time <code>0x55 0x6E 0x31 0x53</code>. Bytes <code>0x55 0x6E</code> are for the time and <code>0x31 0x53</code> are for the date. Let&rsquo;s take the time bytes <code>0x55 0x6E</code>. Flip them to convert from the little-endian notation: <code>06E 0x55</code>. Convert each nibble to a binary value: <code>b0110</code>, <code>b1110</code>, <code>b0101</code>, <code>b0101</code>. Now, write them in a row and separate with the following template in mind: 5 bits - 6 bits - 5 bits: <code>b01101 b110010 b10101</code>. The first five bits are for hours, the next 6 bits are for minutes and the last ones are for seconds. Then, each value is converted into a decimal separately to get us 13 hrs, 50 mins and 21 seconds in the end (see the above picture only shows hours and minutes). For the date 📆 value the template is 7-4-5 but the process is the same.</p>
<p><strong>FAT high word</strong></p>
<p>Start at 65536 and continue as power of two.</p>
<h2 id="extx">ExtX</h2>
<h3 id="2">2</h3>
<p>No journaling</p>
<h3 id="3">3</h3>
<p>Same but + journaling</p>
<h3 id="4">4</h3>
<p>New FS</p>
<h2 id="reiserfs">ReiserFS</h2>
<p>Allows storing multiple files in a single sector. exclamation mark ❗️Unique to this FS!</p>
<h2 id="xfs">XFS</h2>
<p>Good for multimedia files.</p>
<h2 id="hfs">HFS</h2>
<h2 id="hfs-1">HFS+</h2>
<p>Since 1998, since macOS 8.1. Was replaced by APFS.</p>
<p>Didn&rsquo;t <em>natively</em> support full disk encryption (FV2 was added later). Timestamps were only to-the-second. Support up to 4 billion files.</p>
<h2 id="apfs">APFS</h2>
<p><strong>Advantages over HFS+</strong>:</p>
<ul>
<li>Optimized for Flash/SSD Storage.</li>
<li>Full disk encryption is <em>natively</em> supported.</li>
<li>Snapshot support.</li>
<li>Timestamps are to-the-nanosecond.</li>
<li>9 quintillion files at most (18 zeroes).</li>
</ul>
<p>Full support since iOS 10.3 and macOS High Sierra (10.13).</p>
<p>SANS Poster <a href="https://sansorg.egnyte.com/dl/zngSJguNqj/?">APFS File System Format Reference Sheet</a> (SANS FOR518 Reference Sheet).</p>
<p>Apple 🍏. 2006 PowerPC -&gt; Intel. They also moved to GUID partitioning (GPT). GPT replaces MPT at the end of MBR. The main difference between them is that MPT can only define 4 primary partitions, while GPT can have</p>
<p>Partitions and volumes are slightly different than for other FS. When we see a APFS disk, think in terms of volumes.</p>
<p>There  are five entries (raws) there. One of them, the first, is most likely a general, main container. The other 4 are volumes: MacHD, Preboot, Recovery, VM (standard, but MacHD is usually named Macintosh HD).</p>
<p>The first one - container GUID. All the volumes have the same container GUID. Container GUID is similar to disk signature or the serial number that we find at offset 440 of the MBR when we are looking at HDDs from a Windows system.</p>
<p>APFS volumes are not fixed in size. Share space within a container. Unallocated space is pooled to all the volumes within. That&rsquo;s why when analysing volumes there is no way to tell, which volume this unallocated space originated from (unlike on Win).</p>
<ul>
<li><input disabled="" type="checkbox"> <a href="https://eclecticlight.co/2019/12/18/making-sense-of-disk-utility-and-disk-structure-in-macos-10-13-10-15/">Making sense of Disk Utility and disk structure in macOS 10.13-10.15</a></li>
</ul>
<h3 id="timestamps">Timestamps</h3>
<p>📆 <code>Jan 1, 1970</code></p>
<h4 id="modified">Modified</h4>
<h4 id="created">Created</h4>
<h4 id="accessed">Accessed</h4>
<p>On macOS type <code>mount</code> in Terminal to get all the disks mounted with their corresponding attributes. If you see a <code>noatime</code> attribute, it means <em>Accessed</em> attribute is not updated for that volume.</p>
<h4 id="changed">Changed</h4>
<h4 id="added">Added</h4>
<p>Unique to APFS. Very useful for forensics since it differenciates between the file being actually created and it being copied from another media (USB, for example).</p>
<h3 id="metadata">Metadata</h3>
<h4 id="fsevents">FSEvents</h4>
<p>Like <code>$UsnJrnl</code>. ❗️It keeps track of file ids, which is useful for <strong>sequencing</strong> events. Can be found <code>/.fseventsd</code>. Lot&rsquo;s of gzip archives.</p>
<blockquote>
<p>🔍 However, I couldn&rsquo;t find it on my M1 (macOS Big Sur, 11.2.3). The daemon was running (checked with Activity Monitor). Grabbing the processes path on disk (search for <code>fseventsd</code>, double-click, choose <code>Sample</code> and get the path from the result)</p>
</blockquote>
<p><img src="images/fseventsd-path.png" alt="fseventsd-path"></p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">python FSEParser_V3.3.py -s -t folder /.fseventsd -o /Users/sentinel/Desktop/FSEvents_Out
</code></pre></div><p><strong>Keywords</strong>: Mount/Volume, Safari/Chrome (web search), Renamed/.trash (trash).</p>
<p>Lot&rsquo;s of information, so, think well whether to process it or not, since it&rsquo;ll take time.</p>
<blockquote>
<p>⚠️ If you insert a FAT-formatted thumb drive into a macOS machine, it will create fervents.</p>
</blockquote>
<p><strong>Tools</strong> 🛠: FSEventsParser.</p>
<h2 id="ntfs">NTFS</h2>
<h3 id="timestamps-1">Timestamps</h3>
<p>📆 <code>Jan 1, 1601</code></p>
<p>Modified, Accessed (``), Created, MFT Modified.</p>
<p>Sources: <code>$Standart_Information</code>,  <code>$Filename</code>, <code>$I30_Index</code>.</p>
<h4 id="modified-1">Modified</h4>
<h4 id="created-1">Created</h4>
<h4 id="accessed-1">Accessed</h4>
<p>Sometimes this option might be turned off. To check, check the <code>NTFSLastAccessUpdate</code> key at <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem</code> in Windows Registry.</p>
<p>Can be changed with <code>fsutils</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">fsutil behavior <span class="nb">set</span> disablelastaccess <span class="o">[</span>0<span class="p">|</span>1<span class="p">|</span>2<span class="p">|</span>3<span class="o">]</span>
<span class="c1"># restart the PC</span>
</code></pre></div><table>
<thead>
<tr>
<th><strong>Value</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0</strong></td>
<td>User Managed, Last Access Time Updates Enabled</td>
</tr>
<tr>
<td>❗️<strong>1</strong></td>
<td>❗️<strong>User Managed, Last Access Time Updates Disabled</strong></td>
</tr>
<tr>
<td><strong>2</strong> (default)</td>
<td>System Managed, Last Access Time Updates Enabled</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>System Managed, Last Access Time Updates Disabled</td>
</tr>
</tbody>
</table>
<h4 id="changed-1">Changed</h4>
<h3 id="ntfs-metadata">NTFS Metadata</h3>
<p>These files cannot be opened from the user space, it&rsquo;s maintained by NTFS driver. So, even if shown by Directory Snoop, you can&rsquo;t open it on a live system. You can view the hex data though in DS-NTFS. Another option would be to make a disk image and carve the files. View some more information here [<a href="http://blog.opensecurityresearch.com/2011/10/how-to-acquire-locked-files-from.html">3</a>].</p>
<h4 id="extendusnjrnl"><code>\$Extend\$UsnJrnl</code></h4>
<p>Journal change log for NTFS system. EVERYTHING! File and directory deletion, creation, encryption.</p>
<h4 id="logfile"><code>$LogFile</code></h4>
<p>It&rsquo;s a transaction journal of $MFT. Very similar to <code>$UsnJrnl</code>, but lives less. Tracks file creation, modification, renaming and deletion. May not exist, but since Windows Vista <code>$UsnJrnl</code> is there <strong>by default</strong>.</p>
<h2 id="references">References</h2>
<p>[<a href="">1</a>] Windows OS file system for 27 years</p>
<p>[<a href="https://www.magnetforensics.com/resources/demystifying-mac-investigations-mac-vs-windows-artifacts-comparison/?submission=https://go.magnetforensics.com/l/52162/2020-08-25/kqxr57">2</a>] Demystifying Mac Investigations: Mac vs. Windows Artifacts Comparison, Magnet Webinar</p>
<p>NTFS file system, Suhanov&rsquo;s blog: [<a href="https://dfir.ru/2021/07/15/playing-with-case-insensitive-file-names/">1</a>] Playing with case-insensitive file names, [<a href="https://dfir.ru/2021/01/10/standard_information-vs-file_name/">2</a>] $STANDARD_INFORMATION vs. $FILE_NAME, [<a href="https://dfir.ru/2020/10/03/exporting-registry-hives-from-a-live-system/">3</a>] Exporting registry hives from a live system, [<a href="https://dfir.ru/2020/06/12/trim-and-unallocated-space/">4</a>] Trim and unallocated space, [<a href="https://dfir.ru/2020/05/23/onedrive-and-ntfs-last-access-timestamps/">5</a>] OneDrive and NTFS last access timestamps, [<a href="https://dfir.ru/2020/05/18/deceptive-ntfs-short-file-names/">6</a>] Deceptive NTFS short file names, [<a href="https://dfir.ru/2020/02/23/you-write-to-a-logical-drive-when-you-read-from-it/">7</a>] You write to a logical drive when you read from it, [<a href="https://dfir.ru/2019/04/23/ntfs-large-clusters/">8</a>] NTFS: large clusters, [<a href="https://dfir.ru/2019/02/28/ntfs-unallocated-data-marked-as-allocated/">9</a>] NTFS: unallocated data marked as allocated, [<a href="https://dfir.ru/2019/02/16/how-the-logfile-works/">10</a>] How the $LogFile works?, [<a href="https://dfir.ru/2019/01/19/ntfs-today/">11</a>] NTFS today, [<a href="https://dfir.ru/2019/01/08/hibernation-and-ntfs/">12</a>] Hibernation and NTFS, [<a href="https://dfir.ru/2018/12/16/the-inconsistency-of-last-access-timestamps/">13</a>] The (in)consistency of last access timestamps, [<a href="https://dfir.ru/2018/12/08/the-last-access-updates-are-almost-back/">14</a>] The “Last Access” updates are almost back.</p>
<p>[<a href="http://blog.opensecurityresearch.com/2011/10/how-to-acquire-locked-files-from.html">3</a>] How to acquire &ldquo;locked&rdquo; files from a running Windows system, By Pär Österberg Medina</p>
<p>[<a href="https://stackoverflow.com/questions/19499257/opening-mft-file-causes-access-denied-even-if-run-as-administrator">4</a>] Opening $MFT file causes Access denied even if run as administrator, StackOverflow, answered by <a href="https://stackoverflow.com/users/175201/eric-brown">Eric Brown</a></p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
