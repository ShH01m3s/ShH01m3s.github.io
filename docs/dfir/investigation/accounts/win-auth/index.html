<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ” Windows Authentication - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.1af15d612be2936e296de738ed7062bbcecd3efedde8f895f919d76ce622691e.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting">
      <a href="/docs/thunting">
        <span>Threat Hunting</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting">
      <a href="/docs/thunting">
        <span>Threat Hunting</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/investigation/accounts/"> Back to ğŸ‘¥ Account Information Analysis Section ğŸ‘ˆğŸ¼ </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#sid">SID</a>
      <ul>
        <li><a href="#rid-hijacking">RID hijacking</a></li>
      </ul>
    </li>
    <li><a href="#local-security-authority-subsystem-lsa">Local Security Authority Subsystem (LSA)</a></li>
    <li><a href="#login-process">Login Process</a></li>
    <li><a href="#process-authorization">Process Authorization</a></li>
    <li><a href="#sam">SAM</a>
      <ul>
        <li><a href="#local-user-accounts">Local User Accounts</a></li>
        <li><a href="#microsoft-accounts">Microsoft Accounts</a></li>
        <li><a href="#domain-accounts--">Domain Accounts  âš ï¸</a></li>
        <li><a href="#deleted-accounts">Deleted Accounts</a></li>
        <li><a href="#lm-hash">LM hash</a></li>
        <li><a href="#ntlm-hash">NTLM hash</a></li>
        <li><a href="#ntlmv2">NTLMv2</a></li>
      </ul>
    </li>
    <li><a href="#accounts">Accounts</a></li>
    <li><a href="#active-directory">Active Directory</a>
      <ul>
        <li><a href="#attacks--investigation">Attacks &amp; Investigation</a></li>
        <li><a href="#default-accounts">Default accounts</a></li>
        <li><a href="#protecting-domain-accounts">Protecting Domain Accounts</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">ğŸ” Windows Authentication</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      
      <div class="article-category">
          
            
              <i class="fab fa-windows"></i>          
            
            
            
            
            
          <a class="platform-link" href="/platforms/windows">windows</a>
          
      </div> <br />
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p>Each process in the system has an access token. This token determies what privileges this fellow has. This token consists of:</p>
<ul>
<li>User SID</li>
<li>Group SID</li>
<li>Integrity level (mandatory label). Vista+/WinServer 2008+. This label determines what privileges the process has based on the assigned accesses and groups.</li>
<li>Logon session SID</li>
<li>Token type (primary or impresonation)</li>
<li>Impersonation level</li>
<li>User privileges list</li>
<li>Other</li>
</ul>
<p>Checks:</p>
<ul>
<li><input disabled="" type="checkbox"> <em>What is your mandatory labelâ“</em>
<ul>
<li><input disabled="" type="checkbox"> Compare this label to the object&rsquo;s label.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Take User and Group SIDs of the process and ACL of the object in question</li>
</ul>
<h2 id="sid">SID</h2>
<p>Below is the structure of a SID. SID, shortly speaking, is a user id. The actual ID of the user, is the RID (relative identifier) part.</p>
<p><img src="dfir/investigation/accounts/win-auth/images/1.png" alt="1"></p>
<p>In case <code>Who created it?</code> aka issuing authority ends with number <code>21</code>, there will be a trailing SID which represendts PC or domain identifier (purple in the picture above). <code>1</code> - revision number, <code>5</code> - issuing autority, <code>21</code> - sub-issuing authority.</p>
<blockquote>
<p>â—ï¸Built-in accounts don&rsquo;t have Unique domain identifier and RID.</p>
</blockquote>
<p>To get a user&rsquo;s SID:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">wmic</span> <span class="n">useraccount</span> <span class="nb">where </span><span class="n">name</span><span class="p">=</span><span class="s1">&#39;veronicazvereva&#39;</span> <span class="n">get</span> <span class="n">sid</span>
</span></span><span class="line"><span class="cl"><span class="c"># or</span>
</span></span><span class="line"><span class="cl"><span class="n">whoami</span> <span class="p">/</span><span class="n">user</span> <span class="c"># for current user</span>
</span></span></code></pre></div><p>PC/domain ID can be viewed in <code>SAM\SAM\Domains\Accounts</code>, value <code>V</code>, last 12 bytes of the data chunk:</p>
<p><img src="images/sam1.png" alt="sam1"></p>
<p>In order to translate this value, split the hex 12 byte value into three 4 byte chunks. Since these are little-endian, reverse the order of the bytes, convert each to decimal If this is a negative value, something is not right. It&rsquo;s a 32-bit unsigned value! For example, in the below picture we see that the machine id is <code>2d 48 f4 b4 1a b1 b8 73 f1 2a 8a a3</code>. Splitting into 3 chunks gives us: <code>2d 48 f4 b4</code>, <code>1a b1 b8 73</code> and <code>f1 2a 8a a3</code>. Lets now convert each to little-endian: <code>b4 f4 48 2d</code>, <code>73, b8, b1, 1a</code> and <code>a3 8a 2a f1</code>. Now, each set of 4 bytes in decimal: <code>3035908141</code>, <code>1941483802</code>, <code>2743741169</code>. The resulting machine ID part of the SID is then: <code>3035908141-1941483802-2743741169</code>. Let&rsquo;s check in PowerShell:</p>
<p><img src="images/whoami-sam-machineid.png" alt="whoami-sam-machineid"></p>
<p>In the picture above with the registry window the green square ğŸŸ© shows the RIDs in hex. Given the RID one can deduce something about the user, since there are some users that have predefined RIDs:</p>
<ul>
<li><code>S-1-5-21-X-X-X-500</code> - default admin</li>
<li><code>S-1-5-21-X-X-X-501</code> - default guest</li>
<li><code>S-1-5-21-X-X-X-1000</code> - the first user created on a Windows 7 and below, <code>S-1-5-21-X-X-X-1001</code> - for newer systems</li>
<li><code>S-1-5-18</code> - System</li>
<li><code>S-1-5-3</code> - batch</li>
<li><code>S-1-5-2</code> - network</li>
<li><code>S-1-5-21-544</code> - local admin group</li>
</ul>
<p>On the previous picture we can see that the RID is <code>1000</code>, meaning it&rsquo;s the first user account (surprisingly not <code>1001</code> since it&rsquo;s a Windows 10 machine).</p>
<h3 id="rid-hijacking">RID hijacking</h3>
<p>System udentifies users by their RIDs (the last portion of SID), not by username. What happens if we have changed manually the RID of the guest user? Well, if we set it to <code>500</code>, the system would treat him as default admin with all the corresponding rights.</p>
<h2 id="local-security-authority-subsystem-lsa">Local Security Authority Subsystem (LSA)</h2>
<p>Single Sign-on. LSA is its part. Responsible for authentication, authorisation. Manages <strong>derived</strong> credentials (NTLM, kerberos tickets, sessions, hashes etc).</p>
<p>Image file is located at <code>%WINDIR%\System32</code>.</p>
<h2 id="login-process">Login Process</h2>
<p>This is how a general picture looks like:</p>
<p><img src="images/mypic.jpg" alt="mypic"></p>
<p>Sorry for the dragon ğŸ‰.</p>
<h2 id="process-authorization">Process Authorization</h2>
<p>Each process, file or any other object has a set of requirement. In order for some process to get access, it needs to fulfill these requirements. At the same time, these processes have sort of passports or tickets ğŸ« which they can use to get something or somewhere. Requirements are called <strong>security descriptors</strong>, and these  &ldquo;passports&rdquo; are called <strong>access tokens</strong>. More information about the both can be found <a href="https://docs.microsoft.com/en-us/windows/win32/secauthz/access-tokens">here</a> and here.</p>
<p>Access tokens can have the following information (not limited):</p>
<ul>
<li>(SID) for the user&rsquo;s account or/and a group and their privileges</li>
<li>ID for current logon session - logon SID</li>
<li>Owner SID</li>
<li>The source of the access token</li>
<li>Primary or impersonalisation token?</li>
<li><strong>Integrity level</strong></li>
</ul>
<p>Security Descriptors also have a set of fields in it:</p>
<ul>
<li><strong>Integrity level</strong></li>
<li>SID of the owner or group</li>
<li>DACL (list of users allowed and what they can do)</li>
<li>SACL (list of access attempts that will generate alerts âš ï¸)</li>
</ul>
<h2 id="sam">SAM</h2>
<p><strong>Path to file</strong> ğŸ›£ï¸: <code>C:\Windows\System32\config\SAM</code>.</p>
<p>âš ï¸ This file cannot be edited through the RegEdit unless admin grants you permissions (data marked with red is not accesssible unless the access is granted by admin):</p>
<p><img src="/Users/veronicazvereva/Documents/website/analyst/content/docs/dfir/investigation/configs/win-registry/images/sam-hive-permissions.png" alt="sam-hive-permissions"></p>
<p>However, this file can be accessed on a dead-box system. âš ï¸ Also, this file only stores local creds, not domain or Microsoft account credentials!</p>
<p>SAM is a database of files, and it stores all the information about all the users: login information, password hashes, group information.</p>
<p>ğŸ›  Registry Explorer (Eric Zimmerman&rsquo;s tool) can collect all user from the SAM and Profile files and show them assembled. This data can be exported to Excel, for example.</p>
<h3 id="local-user-accounts">Local User Accounts</h3>
<p>For each user there will be a separate sub-key under <code>SAM\SAM\Domains\Account\Users</code>. The sub-keys names are actually RID of the user in hex. Each sub-key will have several values. Record <code>V</code> contains static information (username, password length etc), while record <code>F</code> contains constantly updated information like timestamps ğŸ•°:</p>
<ul>
<li>Last login is a little endian 8 byte value at <code>0x08-0x0f</code> offset.</li>
<li>Last password change time at offset <code>0x18-0x1f</code>, 8 bytes long.</li>
<li>Last failed logon time is at offset <code>0x28-0x2f</code>, 8 bytes.</li>
</ul>
<p>RID itself is stored here, in <code>F</code> record at offset <code>0x30-0x33</code> (little endian). Also, there is <code>PasswordRequired</code> (at <code>0x38</code>). There several possible values for this nibble (half byte): <code>0</code> - account active + pass required, <code>1</code> - account is not active, <code>4</code> - any policies do not apply to this account.</p>
<blockquote>
<p>ğŸ§ª I have <code>5</code> on my machine, what does it mean?</p>
</blockquote>
<p>Logon count is at <code>0x42-0x43</code> (two bytes).</p>
<p>The <code>V </code> value is more interesting. It contains usernames and hashes (NTLM). The user account name is at <code>0x1C0</code> offset (Unicode). What about the juicy stuff? I mean the password hashes. SAM file contains a 56-byte NTLM hash of the password, which is encrypted with a AES algo,  the key ğŸ”‘ is stored in a system file. To decrypt the password, you&rsquo;ll need both SAM <strong>and</strong> the system file. Password cracking methodology:</p>
<ul>
<li><input disabled="" type="checkbox"> Export SAM and SYSTEM hives from the forensic image/suspect machine.</li>
<li><input disabled="" type="checkbox"> Unencrypt the hash stored in the SAM file (ğŸ›  <code>mimikatz</code>).</li>
<li><input disabled="" type="checkbox"> Create a word list from the current case (may export from Autopsy, EnCase etc).</li>
<li><input disabled="" type="checkbox"> Run a dictionary ğŸ“– or brute-force attack ğŸ’ª against this NTLM hash (ğŸ› : <code>hashcat</code> ğŸˆâ€â¬› , <code>John the Ripper</code> ğŸ”ª, Cain and Able ğŸ”ª ğŸ).</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># decrypt the hashes:</span>
</span></span><span class="line"><span class="cl">mimikatz
</span></span><span class="line"><span class="cl">&gt; lsadump::sam /system:<span class="s2">&#34;path_to_SYSTEM&#34;</span> /SAM:<span class="s2">&#34;path_to_SAM&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># crach the hash with hashcat</span>
</span></span></code></pre></div><p><strong>Other values stored in this sub-key</strong>. <code>ForcePasswordReset</code> speaks for itself and <code>SupplementalCredentials</code> do not. There also can be a <code>UserPasswordHint</code>, sometimes contains the actual password. It also contains RID, which can be changed in <a href="/docs/dfir/host/reference/windows/win-lsa#rid-hijacking">RID hijacking attack</a>. There is also a technique that allows resetting local account password by clearing <code>lmpw_len</code> (LM password hash length) and <code>ntpw_len</code> (NTLM password hash length) at <code>0x2c</code> and <code>0x30</code> respectively [<a href="http://www.ijfcc.org/vol5/455-F005.pdf">8</a>].</p>
<h3 id="microsoft-accounts">Microsoft Accounts</h3>
<p>Since Win8. Can be logged in if there is internet access. Profiles and settings are stored in the cloud â˜ï¸. Additional values are stored in SAM: <code>InternetUID</code> and <code>InternetUserName</code>. Both are unique to the user. <code>InternetUID</code> is a 16 byte Unicode string. <code>InternetUserName</code> - usually an email used as a login.</p>
<h3 id="domain-accounts--">Domain Accounts  âš ï¸</h3>
<p><strong>Key</strong> ğŸ”‘ : <code>Software\Microsoft\Windows NT\CurrentVersion\ProfileList</code>.</p>
<p>The key above will have a <code>ProfileImagePath</code>.</p>
<p>âš ï¸ SAM doesn&rsquo;t have any informaiton about domain accounts! See more info <a href="#software/domain-accounts">in software section, domain accounts</a>.</p>
<h3 id="deleted-accounts">Deleted Accounts</h3>
<p>ğŸ›  Registry Explorer (Eric Zimmerman&rsquo;s tool) shows deleted accounts. If the data was not overwritten, we will be able to get the information.</p>
<p><code>C:\Windows\System32\Config</code></p>
<h3 id="lm-hash">LM hash</h3>
<p>DES</p>
<ol>
<li>toupper(password)</li>
<li>if len(password) &lt; 14, pad with 0</li>
<li>split in two parts and encrypt separately. WHY???</li>
<li>concat</li>
</ol>
<p>If the second part equals to AAD3B435B51404EE, the password is only 7 symbols long.  ?</p>
<h3 id="ntlm-hash">NTLM hash</h3>
<p>DES + MD4 until SP3</p>
<h3 id="ntlmv2">NTLMv2</h3>
<p>MD5</p>
<p>[username][sids][LM][NTLM]</p>
<p>[LM] is not generated if the password length is less then 15.</p>
<p>Passwords are not salted.</p>
<h2 id="accounts">Accounts</h2>
<p>Default local user account:</p>
<ul>
<li>Administrator</li>
<li>Guest</li>
<li>HelpAssistant</li>
<li>DefaultAccount</li>
</ul>
<p>Default system accounts (not visible for the user):</p>
<ul>
<li>SYSTEM</li>
<li>NETWORK SERVICE</li>
<li>LOCAL SEVICE</li>
</ul>
<h2 id="active-directory">Active Directory</h2>
<p>Moving accounts and auth policies to the server side. Azure Active Directory is when instead of having a physical server, you have a server in the cloud â›…ï¸. Defines a set of rules to restrict users&rsquo; access to resources. PCs that are part of AD usually don&rsquo;t have full access to the systems.</p>
<p>AD DS store contains db files and processes that manage directory information for users, services and applications. Consists of <code>Ntds.dit</code> file, at <code>%SystemRoot%\	NTDS</code> folder on all DC. Is only accessible thtough the DC&rsquo;s processes and protocols.</p>
<p><strong>Class objects</strong>. What objects can be created in the dir (User, Computer).</p>
<p><strong>Attribute objects</strong>. Info attached to an object (Display name).</p>
<p><strong>Forests</strong>. Share common schema, config partition, global catalog, trusts between domains in the forest, Enterprise Admins and Schema Admins groups.</p>
<p><strong>OU</strong>. Organisational Units. Containers with users, groups, computers or other OUs.  Represent the org hierarchy and logically, manage objects in consistent way, delegate permissions and apply policies.</p>
<p><strong>Trust</strong>. Directional (peer to peer) and Transitive (the friend of my friend is my friend).</p>
<h3 id="attacks--investigation">Attacks &amp; Investigation</h3>
<p><strong>LLMNR Poisoning</strong>. NBT-NS (former name). Used when DNS screws up. Uses NTLMv2 hash and username. âš”ï¸ Disable LLMNR (Turn off multicast name resolution) and NBT-NS. If these are needed: require network access control, strong user passwords (14+ chars).</p>
<p><strong>SMB Relay</strong>. Resend the stolen hashes to the machines that can use them instead of cracking them. Pass the hash? SMB must be disabled for the attack to work, relayed creds are admin for the machine. <code>nmap --script=smb2-security-mode.nse -p445 &lt;IP range&gt;</code> to check for SMB with signing <strong>off</strong>. Use the tool <code>ntlmrelayx.py tf targets.txt -smb2support -i</code> (<code>i</code> for Interactive shell) along with the responder (HTTP and SMB off). Use <code>nc &lt;IP&gt; &lt;port&gt;</code> to connect to the open connection. âš”ï¸ Enable SMB signing, disable NTLM auth over network, local admin restriction ()</p>
<h3 id="default-accounts">Default accounts</h3>
<p><strong>Administrator account</strong>.</p>
<p><strong>Guest account</strong>.</p>
<p><strong>HelpAssistant Account</strong>.</p>
<p><strong>KRBTGT account</strong>. More like a system account.</p>
<h3 id="protecting-domain-accounts">Protecting Domain Accounts</h3>
<p>First of all, separate admin accs from user accs. For admin accs follow the least priv principle.</p>
<p><strong>Privileged account</strong>:</p>
<p><strong>Minimum</strong>. Several levels of admins with separate accounts: domain, enterprise admins and other types of admins. They have various levels of access. This one ğŸ‘®â€â™‚ï¸ has most access, this one ğŸ‘¨â€ğŸ« a little more and this one ğŸ‘¨â€ğŸ¨ has not so much access as he would like to.</p>
<p><strong>Better</strong>. Separate accounts with different right for different admins roles (admin that only set up the PCs, admins that manage AD etc). Some of them have reduced rights. Usually, segregated by OU (org unit, i.e. department). For example, there is a marketing unit and they have their own admins, that support their daily activity.</p>
<p><strong>Ideal</strong>. Different accs for different <strong>trust levels</strong>. So, for example, one administrator ğŸ‘¨â€ğŸ« will have several accounts: main admin account for managing resources, another admin account for adding users. Also, standard account for his daily routine and say personal, for something that&rsquo;s not related to work.</p>
<p><strong>Standard user account</strong>Â ğŸ¤ª:</p>
<p>E-mail ğŸ“¬, browsing the Internet ğŸŒ, using business applications.</p>
<p>It&rsquo;s also a good practice to <strong>create dedicated workstations</strong> that don&rsquo;t have network and email access:</p>
<p><strong>Minimum</strong>.  Build dedicated worstations ğŸ–¥ that don&rsquo;t have internet access.</p>
<p><strong>Better</strong>. Don&rsquo;t grant local admin rights for the machine to the admins that are using these machines.</p>
<p><strong>Ideal</strong>. No network ğŸŒğŸš« access, only access to domains and servers that this admin manages.</p>
<p>Restrict admin logon to servers and workstations.</p>
<p><strong>Minimum</strong>.  Identify all machines that admins cannot login to. Then restrict access appropriately.</p>
<p><strong>Better</strong>. Don&rsquo;t let domain admins login to non-domain controller servers and worstations.</p>
<p><strong>Ideal</strong>. Restrict server admins logging into workstations in addition to domain admins.</p>
<p>â•Disable the account delegation for admins. Account delegation lets servers and PCs impersonate certain accounts and perform actions with these rights. For admin accs that should be disabled.</p>
<h2 id="references">References</h2>
<p>[<a href="https://www.youtube.com/watch?v=hilLHF37ng8">1</a>] RID Hijaking by Sergey Klevogin, LPT Mater</p>
<p>[<a href="http://www.ijfcc.org/vol5/455-F005.pdf">2</a>] Analysis the Structure of SAM and Cracking Password Base on Windows Operating System, by Jiang Du and Jiwei Li</p>
<p>[<a href="https://www.youtube.com/watch?v=2Aa9_yq4BX4&amp;t=1s">3</a>] Ğ’Ğ½Ğ¸Ğ· Ğ¿Ğ¾ ĞºÑ€Ğ¾Ğ»Ğ¸Ñ‡ÑŒĞµĞ¹ Ğ½Ğ¾Ñ€Ğµ ĞºĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ LSA, Ğ¸Ğ»Ğ¸ ĞŸĞ¾Ğ´ ĞºĞ°Ğ¿Ğ¾Ñ‚Ğ¾Ğ¼ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚Ğ¸ Windows,  ĞÑ€Ñ‚ĞµĞ¼ Ğ¡Ğ¸Ğ½Ğ¸Ñ†Ñ‹Ğ½</p>
<p>[<a href="https://www.youtube.com/watch?v=aCVdGUjP72Q">3</a>] Diving into Windows Logon Process</p>
<p>[<a href="https://docs.microsoft.com/en-us/windows-server/security/windows-authentication/credentials-processes-in-windows-authentication">4</a>]</p>
<p>[<a href="https://www.coursera.org/learn/cybersecurity-compliance-framework-system-administration/lecture/wHoeT/features-of-active-directory">1</a>] IBM Course on Coursera</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
