<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Evidence Of Installation And Execution - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/investigation/processes/"> ğŸ‘ˆğŸ¼ Back to </br> Process Analysis </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#windows">Windows</a>
      <ul>
        <li><a href="#dr-watson">Dr Watson</a></li>
        <li><a href="#installed-programs-and-applications">Installed programs and applications</a></li>
        <li><a href="#prefetch">Prefetch</a></li>
        <li><a href="#amcache">AmCache</a></li>
        <li><a href="#appcompatcache-aka-shimcache">AppCompatCache aka ShimCache</a></li>
        <li><a href="#bam">BAM</a></li>
        <li><a href="#muicache">MUICache</a></li>
        <li><a href="#comdlg32">ComDlg32</a></li>
        <li><a href="#jump-list-data">Jump List Data</a></li>
        <li><a href="#recent-apps">Recent Apps</a></li>
        <li><a href="#user-assist">User assist</a></li>
        <li><a href="#uninstalled-applications">Uninstalled applications</a></li>
      </ul>
    </li>
    <li><a href="#macos">macOS</a></li>
    <li><a href="#linux">Linux</a></li>
    <li><a href="#android">Android</a>
      <ul>
        <li><a href="#installed-applications">Installed Applications:</a></li>
        <li><a href="#application-permissions">Application Permissions:</a></li>
      </ul>
    </li>
    <li><a href="#ios">iOS</a>
      <ul>
        <li><a href="#installed-applications-1">Installed Applications:</a>
          <ul>
            <li><a href="#application-permissions-1">Application Permissions:</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Evidence Of Installation And Execution</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-search"></i>
              
          <a class="category-link" href="/domain/forensics">forensics</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-sticky-note"></i>
              
          <a class="platform-link" href="/doctype/coursenotes">coursenotes</a>
          
      </div> <br /><br/>
      
      
      
      

      
      

      
      <div class="article-tag">
          <i class="fas fa-tag"></i>
          
          
          <a class="tag-link" href="/tags/sdf" rel="tag">sdf</a>
          
           ,  
          <a class="tag-link" href="/tags/prefetch" rel="tag">prefetch</a>
          
      </div> 
      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p><em>There are lot&rsquo;s of evidence of installation and execution. Based on this data one can prove that the user knew about it or not. Below are the main evidence, tools for analysis and .</em></p>
<p>It&rsquo;s not always about malware. Sometimes it&rsquo;s just about user activity.</p>
<h2 id="windows">Windows</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\W</span>indows<span class="se">\P</span>refetch
</span></span><span class="line"><span class="cl"><span class="se">\W</span>indows<span class="se">\a</span>ppcompat<span class="se">\P</span>rograms<span class="se">\R</span>ecentFileCache.bcf
</span></span><span class="line"><span class="cl"><span class="se">\W</span>indows<span class="se">\a</span>ppcompat<span class="se">\P</span>rograms<span class="se">\A</span>mcache.hve
</span></span></code></pre></div><h3 id="dr-watson">Dr Watson</h3>
<p>Drwtsn32.log, traps a crashing program. Can create a file named <code>User.dmp</code>. 100% prove that the program <em><strong>was</strong></em> executed.</p>
<h3 id="installed-programs-and-applications">Installed programs and applications</h3>
<p><strong>Key</strong> ğŸ”‘: <code>Microsoft\Windows\CurrentVersion\Uninstall</code>. There can be some data for programs that do not exist on the system anymore. The last write time is when the application was installed.</p>
<p><strong>Key</strong> ğŸ”‘ <code>Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore</code> for installed Microsoft applications. Defines between those that were installed for a specific user or system-wide.</p>
<p><strong>Key</strong> ğŸ”‘: <code>Wiw6432Node</code> (<code>SYSTEM</code> hive root node) - those that run a 32-bit mode. Separate sub-keys for different versions of a program.</p>
<p><strong>Key</strong> ğŸ”‘: <code>Classes\Installer\Products</code> - installed using Miscrosoft installer (those with <code>msi</code> extension).</p>
<h3 id="prefetch">Prefetch</h3>
<details>
    <summary>Expand &hellip;</summary>
    <p>Prefetch is for efficiency of starting processes and their resources (movies for media players, spreadsheets for Excel for example). Improves startup time of applications. Each prefetch file name follows the pattern: <code>&lt;EXENAME&gt;-&lt;PATHHASHED+CMDARGS&gt;.pf</code>.</p>
<h4 id="â„¹-information-contained">â„¹ï¸ Information Contained</h4>
<ul>
<li>Filename</li>
<li>Creation time</li>
<li>Modified time</li>
<li>File Size</li>
<li>Process EXE</li>
<li>Process Path</li>
<li>Run Counter</li>
<li>Last Run Time</li>
<li>Missing Process + libraries and resources for each process.</li>
<li>Forensics value - tracks the execution of programs. Central repository of what was run on the system. File size can be used to search for the same process with a different name on a different machine.</li>
</ul>
<h4 id="-timestamps">â° Timestamps</h4>
<p><strong>Filesystem Timestamps</strong>. The first time the executable is run, a pf file is created. The last time it was run - a pf&rsquo;s file Modified date and time. However, consider a scenario when a program was run long time in the past, wasn&rsquo;t run for a while after that. Its pf file was overwritten (prefetch keeps 1024 entries). Some time after that the executable is run again and the pf file is created again. The FS timestamps will show that the file was first executed recently when it&rsquo;s not quite that straithforward.</p>
<h4 id="-structure-and-analysis">ğŸ” Structure and Analysis</h4>
<p>If collecting prefetch on a live system, run volatile collection tools before that and collect pf files to avoid overwriting oldest prefetch with prefetch for live response tools (or disable prefetch before collection).</p>
<p><strong>Path</strong> to files: C:\Windows\Prefetch. All prefetch have a <strong>signature</strong> at offset 4th byte. MAM - compressed and SCCA - plain text.</p>
<table>
<thead>
<tr>
<th>OS</th>
<th>Signature1 (version)</th>
<th>signature2 (type)</th>
</tr>
</thead>
<tbody>
<tr>
<td>WinXP &amp; 2003</td>
<td>0x00000011 or 17</td>
<td>SCCA</td>
</tr>
<tr>
<td>Vista</td>
<td>0x00000023 or 23</td>
<td>SCCA</td>
</tr>
<tr>
<td>W8</td>
<td>0x0000001a or 26</td>
<td>SCCA</td>
</tr>
<tr>
<td>W10</td>
<td>MAM</td>
<td>0x04</td>
</tr>
<tr>
<td>W10</td>
<td>0x0000001e or 30</td>
<td>SCCA</td>
</tr>
</tbody>
</table>
<p>Prefetch can be disabled in registry <code>C:\Windows\System32\config\SYSTEM</code>, key ğŸ”‘: <code>HKLM\SYSTEM\CurrentControlSet\Control\SessionManager\MemoryManagement\PrefetchParameters\Enable Prefetcher</code>:</p>
<table>
<thead>
<tr>
<th>key</th>
<th>meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0</code></td>
<td>disabled</td>
</tr>
<tr>
<td><code>1</code></td>
<td>enabled for apps only</td>
</tr>
<tr>
<td><code>2</code></td>
<td>enabled for boot only</td>
</tr>
<tr>
<td><code>3</code></td>
<td>boot and app enabled (default)</td>
</tr>
</tbody>
</table>
<p>You can check it with <code>rip.exe</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rip.exe -r SYSTEM -p prefetch <span class="c1"># to show whether prefetch is enabled</span>
</span></span></code></pre></div><h4 id="-caveats">ğŸ¤¨ Caveats</h4>
<p>On servers is usually turned off. And starting with Win10 - compressed. For systems with solid state drives it&rsquo;s also disabled. With Win8 - additional run times recorded. Also, there is latency issue - some apps are not closed upon clicking X, but remain running in background. Hence, the last time run might be different.</p>
<blockquote>
<p>If the app was deleted and then reinstalled? What the firtst run time will be?</p>
<p>What if I rename an executable?</p>
<p>If the exe is substitued?</p>
</blockquote>
<p>If the same exe was run from different locations - different <code>.pf</code> files. If the application was deleted, the info remains in prefetch.</p>
<blockquote>
<p>Write a sctipt to determine deleted files</p>
</blockquote>
<h4 id="-tools">ğŸ›  Tools</h4>
<p><strong>WinPrefetchView</strong>. To view pretech files (decompressed as well) in GUI.</p>
<p><strong>Fred</strong> - Forensic Registry Editor. To view exported hives.</p>
<p><strong>FTK Imager Lite</strong>. Fairly heavy footprint - 15-16Mb.</p>
<p><strong>CDQR</strong>. This tool focuses on the <code>pf</code> intself rather than on a data it contains. It&rsquo;s useful for making timelines.</p>
<p><strong>RegRipper (GUI and CUI)</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rip.exe -r SYSTEM -p prefetch <span class="c1"># to show whether prefetch is enabled</span>
</span></span></code></pre></div><p><strong>Prefetch parser.</strong> More info than with WinPrefetchView</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">prefetch.py -c -d -e
</span></span><span class="line"><span class="cl">prefetch.py -c -d &gt; pf.csv
</span></span><span class="line"><span class="cl">prefetch.py -f &lt;file_to_parse&gt; &gt; pf.txt
</span></span></code></pre></div><p>Columns: last executed, MFT sequence number, MFT record number, executable name, run counter,</p>
<p><strong>PECmd</strong>. Eric Zimmerman&rsquo;s tool.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">PECmd</span><span class="p">.</span><span class="n">exe</span> <span class="o">-f</span> <span class="p">&lt;</span><span class="n">pffile</span><span class="p">&gt;.</span><span class="n">pf</span>
</span></span><span class="line"><span class="cl"><span class="n">PECmd</span><span class="p">.</span><span class="n">exe</span> <span class="n">-d</span> <span class="s2">&#34;Prefetch folder&#34;</span> <span class="p">-</span><span class="n">-csv</span> <span class="s2">&#34;outoutdir&#34;</span> <span class="p">-</span><span class="n">-csvf</span> <span class="s2">&#34;outputfile&#34;</span>
</span></span></code></pre></div>
</details>
<h3 id="amcache">AmCache</h3>
<details>
    <summary>Expand &hellip;</summary>
    <p><strong>Path to file</strong> ğŸ›£ï¸: <code>C:\Windows\AppCompat\Programs</code>.</p>
<p>Since Windows 8. Stored information about program execution, including those, that were run from a USB drive.</p>
<h4 id="â„¹-information-contained">â„¹ï¸ Information Contained</h4>
<ul>
<li>install date and time</li>
<li>name</li>
<li>version</li>
<li>path to exe/dll</li>
<li>source info</li>
<li>path to uninstall</li>
<li>publisher name</li>
<li>volume GUIDs</li>
<li>container ID of the device from which the program was run.</li>
</ul>
<p><code>DeviceCensus</code> - some information about the physical machine itself. For example, for my Parallels VM there was also a <code>VM</code> subkey that contained some value <code>VMId</code>.</p>
<p><code>File</code>. Full path to the executable.</p>
<blockquote>
<p>âš ï¸ Not present on my Windows 10 (Parallels VM).</p>
</blockquote>
<p><code>InventoryApplication</code>. Consists of folders/subkeys named by the program id. Each folder will contain the following important information: <code>OSVersionAtInstallTime</code>, <code>InstallDateMsi</code>, <code>InstallDate</code>, <code>InstallDateArpLastModified</code>, <code>InstallDateFromLinkFile</code>, <code>Name</code>, <code>Publisher</code>, <code>RegistryKeyPath</code> (may show user SID), <code>Source</code>, <code>UninstallString</code>, <code>ProgramID</code> (consistent accross systems).</p>
<blockquote>
<p>âš ï¸ On my Parallels Windows 10/11 machine I noticed that here not only Windows, but also Mac executables are listed even though I have specifically set in preferences that I am not sharing Mac folders or disks with the VM.</p>
</blockquote>
<p><code>InventoryApplicationFile</code>. Contains a fileid which is actually a SHA-1 hash, padded with 4 leading zeros and full path to the executable. Use a list of known good or VirusTotal.</p>
<p><code>InventoryDeviceContainer</code>. Contains <code>ModelName</code> and <code>FriendlyName</code>. When devices get connected, they might install some software to be able to work correctly.</p>
<p><code>InventoryDevicePnp</code>. Contains <code>ContainerID</code>, <code>DriverID</code>, <code>Description</code>, <code>Manufacturer</code> and <code>Model</code>.</p>
<p><code>Programs</code>. Where this program is located within the FS and the source (for example, <code>AddRemoveProgram</code>). And also information path to the uninstaller in registry.</p>
<h4 id="-timestamps">â° Timestamps</h4>
<h4 id="-tools">ğŸ›  Tools</h4>
<p>AmCacheParser.exe + Timeline Explorer.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">AmcacheParser</span><span class="p">.</span><span class="n">exe</span> <span class="o">-f</span> <span class="p">&lt;</span><span class="n">path_to_AmCache</span><span class="p">.</span><span class="n">hve</span><span class="p">&gt;</span> <span class="n">-i</span> <span class="n">on</span> <span class="p">-</span><span class="n">-csv</span> <span class="p">&lt;</span><span class="n">export_to_folder_no_quotes</span><span class="p">&gt;</span> <span class="p">-</span><span class="n">-csvf</span> <span class="p">&lt;</span><span class="n">desired_filename</span><span class="p">&gt;</span> 
</span></span></code></pre></div><p>What are unassociated files? Those that are not associated with a known source. Good starting point when looking for bad files.</p>
<blockquote>
<p>âš ï¸ In my case on a macOS with Parallels and Windows 10 installed, this evidence also contained mac executables.</p>
</blockquote>

</details>
<h3 id="appcompatcache-aka-shimcache">AppCompatCache aka ShimCache</h3>
<p><strong>Key</strong> ğŸ”‘: <code>CurrentControlSet\Control\Session Manager\AppCompatCache\AppCompatCache</code>.</p>
<p><strong>ğŸ› </strong>: ShimCacheParser.py (requires Python2), AppCompatCacheParser</p>
<p>Originally was used to identify compatibility issues between 32 and 64 bit progs. Track the file path, size, last modified time â°. Only logs specific file extensions. It might not be a reliable evidnce that the program was executed or even installation, but if the program was installed and deleted - it won&rsquo;t be deleted from here. ShimCache is another name for this artifact. Uses file system timestamps.</p>
<p>If the executable is modified or renamed, new entry will be created, but modified date and time will be the same for both files even after these actions take place. $UsnJrnl is another place to make sure that is what had happened. $Logfile.</p>
<blockquote>
<p>âš ï¸ Written at shutdown!</p>
<p>âš ï¸ Doesnâ€™t track the file execution for Win7+ systems.</p>
</blockquote>
<h3 id="bam">BAM</h3>
<p><strong>Key</strong> ğŸ”‘: <code>ControlSet001\Services\BAM</code>.</p>
<blockquote>
<p>âš ï¸ Windows 10 only!</p>
</blockquote>
<p>Background Activity Monitor. Organaized by user SID. Windows apps&rsquo; names are not parsed very well here. Gives last executed time â° , 64-bit little-endian (first 8 bytes of the value). It <strong>does</strong> prove program execution and it ties it to the specific user. May use the same technique for core processes analysis and identifying rogue processes like in RAM.</p>
<h3 id="muicache">MUICache</h3>
<p><strong>Key</strong> ğŸ”‘: <code>Local Settings\Software\Microsoft\Windows\Shell\MuiCache</code>.</p>
<p>Installed and executed applications for <strong>that particular user</strong>. But no timestamps for this acts, only last write data and time for the key in registry.</p>
<h3 id="comdlg32">ComDlg32</h3>
<p><strong>Key</strong> ğŸ”‘: <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32</code>.</p>
<p><code>CIDSizeMRU</code>- Tracks applications globally. MRU start at zero. Timestamp for the most recent item only. <code>FirstFolder</code> -tracks the install locations of applications, full path to the app, but no exact file name. <code>OpenSavePidMRU</code> - tracks files that were saved with <code>Save As</code> dialog, or opened with <code>Open</code> dialog. Tracks autocomplete terms. <code>LastVisitedPidMRU</code> - tracks the specific executable used by an application to open the files documented in the <code>OpenSaveMRU</code> key. Also tracks the directory for the last application accessed for each file in <code>OpenSavePidMRU</code>, tracks the location the file existed.</p>
<h3 id="jump-list-data">Jump List Data</h3>
<p>Key ğŸ”‘: <code>NTUSER.DAT\SOFTWARE\Microsoft\Windows\CurrentVersion\Search\JumplistData</code>.</p>
<p>Shows applications accessed.</p>
<h3 id="recent-apps">Recent Apps</h3>
<p><strong>Key</strong> ğŸ”‘: <code>NTUSER.DAT\SOFTWARE\Microsoft\Windows\CurrentVersion\Search\RecentApps</code>.</p>
<p>Similar to User Assist. Also shows files and applications that were used through this application. This key consists of sub-keys that are marked with application&rsquo;s GUID. Some of them will have <code>Recent Items</code> sub-key (10 max), each has <code>Last Write Time</code> (Windows 64-bit, little-endian).</p>
<blockquote>
<p>âš ï¸ Not all Win10 machines will have this key.</p>
</blockquote>
<p><strong>Key</strong> ğŸ”‘: <code>Software\Microsoft\Windows\Current Version\Explorer\RunMRU</code>.</p>
<p>A list of the programs that have been run from the Run command is shown. Each time you use a command that has already been stored, it moves to the top of the list.</p>
<h3 id="user-assist">User assist</h3>
<p><strong>Key</strong> ğŸ”‘: <code>NTUSER.DAT\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Assist</code>.</p>
<p>List of progs and applets that can be quicly started from the Start menu for usability, the most often used items. Shows a <code>focus count</code> for each entry. It means, how many time was the window switched to (that doesn&rsquo;t include the time when the program is first run). Shows the last time that the program was executed, focus time, run count.</p>
<p>At the start of each entry between <code>{}</code> is the code for a location within file system. Registry Explorer will substitute these automatically, since these GUIDs are predefined.</p>
<p>This what a full filled User Assist key looks like. <code>{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}</code> is for programs that were lauched using their image files directly. <code>{F4E57C4B-2036-45F0-A9AB-443BCFE33D9F}</code> is for those, started with a shortcut.</p>
<p><img src="images/user-assist1.png" alt="user-assist1"></p>
<p>The structure is quite simple:</p>
<ul>
<li>At <code>0x04</code> offset starts the number of executions (4 bytes).</li>
<li>At <code>0xC</code> offset starts the focus time (4 bytes)</li>
<li>At <code>0x3C</code> offset starts the Last Execution time (8 bytes), which is a Win64-bit little-endian value (for Decode ğŸ› ).</li>
</ul>
<blockquote>
<p>âš ï¸ ğŸ” I could not find this key on my Win10 VM.</p>
<p>âš ï¸ When the program was started via <code>lnk</code> file, the focus count will be <code>0</code>.</p>
</blockquote>
<h3 id="uninstalled-applications">Uninstalled applications</h3>
<p><strong>Key</strong> ğŸ”‘:  <code>Microsoft\Windows\CurrentVersion\Uninstall</code></p>
<h2 id="macos">macOS</h2>
<p><code>/Users/username/.zsh_history</code> look for something like <code>hdiutil mount silenteye-0.4.1b-snowleopard.dmg</code> and <code>sudo cp -R /Volumes/SilentEye/silenteye-0.4.1b-snowleopard_installer.app /Applications</code>.</p>
<p>Also, <code>/Users/sneaky/Library/Application Support/com.apple.spotlight/com.apple.spotlight.Shortcuts</code> if it was then searched via Spotlight.</p>
<p><code>plutil -p &quot;/Users/sneaky/Library/Preferences/com.apple.dock.plist&quot;</code> . Also gives some information on the file location, timestamps and bundle id.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">1</span> <span class="o">=</span>&gt; <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Â  Â  Â  <span class="s2">&#34;GUID&#34;</span> <span class="o">=</span>&gt; <span class="m">2221790314</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  <span class="s2">&#34;tile-data&#34;</span> <span class="o">=</span>&gt; <span class="o">{</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  <span class="s2">&#34;book&#34;</span> <span class="o">=</span>&gt; <span class="o">{</span><span class="nv">length</span> <span class="o">=</span> 592, <span class="nv">bytes</span> <span class="o">=</span> 0x626f6f6b <span class="m">50020000</span> <span class="m">00000410</span> <span class="m">30000000</span> ... <span class="m">04000000</span> <span class="m">00000000</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  <span class="s2">&#34;bundle-identifier&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;com.bitrock.installbuilder&#34;</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  <span class="s2">&#34;dock-extra&#34;</span> <span class="o">=</span>&gt; <span class="m">0</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  <span class="s2">&#34;file-data&#34;</span> <span class="o">=</span>&gt; <span class="o">{</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  Â  <span class="s2">&#34;_CFURLString&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;file:///Applications/silenteye-0.4.1b-snowleopard_installer.app/&#34;</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  Â  <span class="s2">&#34;_CFURLStringType&#34;</span> <span class="o">=</span>&gt; <span class="m">15</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  <span class="o">}</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  <span class="s2">&#34;file-label&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;silenteye-0.4.1b-snowleopard_installer&#34;</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  <span class="s2">&#34;file-mod-date&#34;</span> <span class="o">=</span>&gt; <span class="m">187534827240406</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  <span class="s2">&#34;file-type&#34;</span> <span class="o">=</span>&gt; <span class="m">1</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  Â  <span class="s2">&#34;parent-mod-date&#34;</span> <span class="o">=</span>&gt; <span class="m">187380208417750</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  <span class="o">}</span>
</span></span><span class="line"><span class="cl">Â  Â  Â  <span class="s2">&#34;tile-type&#34;</span> <span class="o">=</span>&gt; <span class="s2">&#34;file-tile&#34;</span>
</span></span><span class="line"><span class="cl">Â  Â  <span class="o">}</span>
</span></span></code></pre></div><blockquote>
<p>ğŸ—’ TODO:
Binary file ./0/root/Users/sneaky/Library/Application Support/com.apple.spotlight/appList.dat matches
Binary file ./0/root/Users/sneaky/Library/Application Support/com.apple.sharedfilelist/com.apple.LSSharedFileList.FavoriteVolumes.sfl2 matches
Binary file ./0/root/Users/sneaky/Library/Application Support/com.apple.sharedfilelist/com.apple.LSSharedFileList.RecentApplications.sfl2 matches</p>
</blockquote>
<h2 id="linux">Linux</h2>
<h2 id="android">Android</h2>
<h3 id="installed-applications">Installed Applications:</h3>
<p>â€¢ /system/packages.list<br>
â€¢ /system/packages.xml<br>
â€¢ /data/com.android.vending/databases/library.db â€¢</p>
<h3 id="application-permissions">Application Permissions:</h3>
<p>â€¢ /data/system/packages.xml</p>
<h2 id="ios">iOS</h2>
<h3 id="installed-applications-1">Installed Applications:</h3>
<p>â€¢ HomeDomain-Library/FrontBoard/applicationState.db<br>
â€¢ Info.plist<br>
â€¢ Manifest.plist<br>
â€¢ /private/var/mobile/Library/FrontBoard/applicationState.db</p>
<h4 id="application-permissions-1">Application Permissions:</h4>
<p>â€¢ HomeDomain-Library/TCC/TCC.db<br>
â€¢ /private/var/mobile/Library/TCC/TCC.db</p>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
