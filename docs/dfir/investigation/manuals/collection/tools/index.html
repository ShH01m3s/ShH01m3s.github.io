<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§° Acquisition Toolkit - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/investigation/manuals/collection/"> ğŸ‘ˆğŸ¼ Back to </br> ğŸ—³ Evidence Collection And Preservation </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#validate-tools">Validate Tools</a></li>
    <li><a href="#collection">Collection</a>
      <ul>
        <li><a href="#kansa">Kansa</a></li>
        <li><a href="#powershell-csirt-collectps1">PowerShell (CSIRT-Collect.ps1)</a></li>
        <li><a href="#kape-kroll-artifact-parser--extractor">KAPE (Kroll Artifact Parser &amp; Extractor)</a></li>
        <li><a href="#winpmem">Winpmem</a></li>
        <li><a href="#7zip">7zip</a></li>
        <li><a href="#arsenal-image-mounter">Arsenal Image Mounter</a></li>
        <li><a href="#magnet-axiom">Magnet Axiom</a></li>
        <li><a href="#cyber-triage">Cyber Triage</a></li>
        <li><a href="#awesome-incident-response">Awesome Incident Response</a></li>
      </ul>
    </li>
    <li><a href="#hashing">Hashing</a>
      <ul>
        <li><a href="#native-hashing-tools">Native Hashing Tools</a></li>
      </ul>
    </li>
    <li><a href="#write-blockers">Write Blockers</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">ğŸ§° Acquisition Toolkit</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      <div class="article-category">
          
            
            
            
            
            
              <i class="fab fa-linux"></i>&nbsp;<i class="fab fa-apple"></i>&nbsp;<i class="fab fa-windows"></i>&nbsp;<i class="fas fa-mobile"></i>
            
            
          
          
      </div> <br />
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <h2 id="validate-tools">Validate Tools</h2>
<p>Document the changes that you are making. Know your tools ğŸ› ! What changes they are making (<a href="https://peat-chameleon-e41.notion.site/bf3cb04f2a074cfc816f853cec92d783?v=f8cbcf21bcb641b6806fb22decfccf9f">see</a>).</p>
<p>ğŸ§° <strong>Validate your tools.</strong> Tools used need to be periodically validated prior to each analysis. For example, check that you wiping software has thoroughly WIPED the drive you will be using for the evidence collectionc (for example, by running a checksum64 against it).</p>
<p><strong>Choose the appropriate one</strong>. Below are some questions to ask in order to decide.</p>
<p>Example 1. Logging in remotely to collect artifacts and run preinstalled UI admin tools:</p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr>
<td>Easy to collect artifacts?</td>
<td>Hard ğŸ§±: Many non-DFIR tools</td>
</tr>
<tr>
<td>Easy to connect remotely?</td>
<td>Easy ğŸ’¸: if remote connection is allowed</td>
</tr>
<tr>
<td>Identify relevant data?</td>
<td>Hard ğŸ§±: not DFIR specific</td>
</tr>
<tr>
<td>Pivoting</td>
<td>Hard ğŸ¯-ğŸ§±: Depends</td>
</tr>
<tr>
<td>Scaling</td>
<td>Hard ğŸ§±: one at a time</td>
</tr>
</tbody>
</table>
<p>Example 2. Logging in remotely to collect artifacts with cmd tools:</p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr>
<td>Easy to collect artifacts?</td>
<td>Medium ğŸ¯. Many tools, but can be scripted. Generally free.</td>
</tr>
<tr>
<td>Easy to connect remotely?</td>
<td>Hard ğŸ§±: have to copy tools to the system.</td>
</tr>
<tr>
<td>Identify relevant data?</td>
<td>Hard ğŸ§±: not DFIR specific</td>
</tr>
<tr>
<td>Pivoting</td>
<td>Hard ğŸ§±: Many output files</td>
</tr>
<tr>
<td>Scaling</td>
<td>Hard ğŸ§±: one at a time</td>
</tr>
</tbody>
</table>
<p>Example 3. Continuous monitoring:</p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr>
<td>Easy to collect artifacts?</td>
<td>Easy ğŸ’¸: for artifacts being monitored. Hard ğŸ§±: for others.</td>
</tr>
<tr>
<td>Easy to connect remotely?</td>
<td>Easy ğŸ’¸: if configured.</td>
</tr>
<tr>
<td>Identify relevant data?</td>
<td>Medium ğŸ¯: depends on the tools.</td>
</tr>
<tr>
<td>Pivoting</td>
<td>Medium ğŸ¯: depends on the tools.</td>
</tr>
<tr>
<td>Scaling</td>
<td>Easy ğŸ’¸: if monitoring is enabled</td>
</tr>
</tbody>
</table>
<p>Example 4. Full image:</p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr>
<td>Easy to collect artifacts?</td>
<td>Hard ğŸ§±to get full image and also there is a need to parse it. But reliable.</td>
</tr>
<tr>
<td>Easy to connect remotely?</td>
<td>Medium ğŸ¯: depends</td>
</tr>
<tr>
<td>Identify relevant data?</td>
<td>Medium ğŸ¯: depends on the parser tool.</td>
</tr>
<tr>
<td>Pivoting</td>
<td>Medium ğŸ¯: depends on the parser tool.</td>
</tr>
<tr>
<td>Scaling</td>
<td>Medium ğŸ¯: depends on aquisition tools.</td>
</tr>
</tbody>
</table>
<p>Example 5. Cyber Triage:</p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Answer</th>
</tr>
</thead>
<tbody>
<tr>
<td>Easy to collect artifacts?</td>
<td>Easy ğŸ’¸: one exe for local or remote.</td>
</tr>
<tr>
<td>Easy to connect remotely?</td>
<td>Easy ğŸ’¸: easy to send over network.</td>
</tr>
<tr>
<td>Identify relevant data?</td>
<td>Medium ğŸ¯: scores data.</td>
</tr>
<tr>
<td>Pivoting</td>
<td>Easy ğŸ’¸: navigation via UI.</td>
</tr>
<tr>
<td>Scaling</td>
<td>Multiple</td>
</tr>
</tbody>
</table>
<h2 id="collection">Collection</h2>
<p>Powershell is the best tool to automate and scale evidence collection accross the enterprise.</p>
<h3 id="kansa">Kansa</h3>
<p>Not only for collection, but also for analysis (stacking). Can be scaled. Good for acquisition across enterprise.</p>
<h3 id="powershell-csirt-collectps1">PowerShell (CSIRT-Collect.ps1)</h3>
<p>Two directories: one with Winpmem and 7zip, another with Kape, copied from local install. Makes a RAM image, zips it and sends to the network share. Cleans up the host under investigation after that. A very useful thing: it&rsquo;ll capture OS build, needed for <code>vol2.py</code> for profiling.</p>
<p>Then, it launches KAPE which performs triage.</p>
<h3 id="kape-kroll-artifact-parser--extractor">KAPE (Kroll Artifact Parser &amp; Extractor)</h3>
<p>Seems to be very close to what Kansa frawemork does. What&rsquo;s the difference? Kansa for live response and hunt; KAPE for forensics. Also, it seems that Kansa is dying. Better explained <a href="https://www.reddit.com/r/computerforensics/comments/d67vyz/kansa_vs_kape/">here</a> by <a href="https://www.reddit.com/user/sprint_ska/">sprint_ska</a>, thanks man. Also, Kansa relies on Windows built-in tools while Kape doesn&rsquo;t. Kansa scales better.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kape --tsource C: --target RegistryHives --tdest <span class="s2">&#34;\results&#34;</span> 
</span></span><span class="line"><span class="cl">kape --tsource H --target !ALL --tdest <span class="s2">&#34;dir&#34;</span> --debug  
</span></span><span class="line"><span class="cl">kape --msource â€œdirâ€ --module LECmd --mdest <span class="s2">&#34;dir&#34;</span> --trace --debug
</span></span></code></pre></div><h3 id="winpmem">Winpmem</h3>
<h3 id="7zip">7zip</h3>
<h3 id="arsenal-image-mounter">Arsenal Image Mounter</h3>
<h3 id="magnet-axiom">Magnet Axiom</h3>
<p>ğŸ’´ Don&rsquo;t forget it&rsquo;s a paid tool. Nevertheless, it&rsquo;s very easy to use. Works for macOS as well.</p>
<h3 id="cyber-triage">Cyber Triage</h3>
<p>Live, remote or image. Steps:</p>
<ol>
<li>Collect artifacts</li>
<li>Score</li>
<li>Review</li>
<li>Deep Dive (optional)</li>
<li>Report</li>
</ol>
<p>We need to analysie user activity, find indicators of malware and check whether configs were changed.</p>
<h3 id="awesome-incident-response">Awesome Incident Response</h3>
<p><a href="https://github.com/meirwah/awesome-incident-response">https://github.com/meirwah/awesome-incident-response</a></p>
<h2 id="hashing">Hashing</h2>
<h3 id="native-hashing-tools">Native Hashing Tools</h3>
<p><strong>Windows</strong>. certutil -file [filename] -hash [md5, sha1, sha256 etc].</p>
<p><strong>macOS</strong>. <code>md5</code>, <code>shasum</code>.</p>
<p><strong>Linux</strong>. <code>md5sum</code>, <code>sha256sum</code> etc.</p>
<h2 id="write-blockers">Write Blockers</h2>
<p>NIST about software write blockesr:Â <a href="https://www.nist.gov/itl/ssd/software-quality-group/computer-forensics-tool-testing-program-cftt/cftt-technical/software">https://www.nist.gov/itl/ssd/software-quality-group/computer-forensics-tool-testing-program-cftt/cftt-technical/software</a>.
Benchmark of different soft and hardware blockers:Â <a href="https://habr.com/ru/company/bizone/blog/320032/">https://habr.com/ru/company/bizone/blog/320032/</a>.</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
