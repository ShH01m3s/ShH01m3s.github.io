<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title> - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/investigation/artefacts/"> ğŸ‘ˆğŸ¼ Back to </br> ğŸ“œ Artefacts DB </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#windows-rdp">Windows RDP</a></li>
    <li><a href="#pipes">Pipes</a>
      <ul>
        <li><a href="#-rtfm">ğŸ“• RTFM</a></li>
      </ul>
    </li>
    <li><a href="#telnet">Telnet</a>
      <ul>
        <li><a href="#-rtfm-1">ğŸ“• RTFM</a></li>
      </ul>
    </li>
    <li><a href="#ftp">FTP</a>
      <ul>
        <li><a href="#-rtfm-2">ğŸ“• RTFM</a></li>
      </ul>
    </li>
    <li><a href="#smb">SMB</a>
      <ul>
        <li><a href="#-rtfm-3">ğŸ“• RTFM</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title"></h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 28.07.2022
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p><em>This is about &hellip; .</em></p>
<h2 id="windows-rdp">Windows RDP</h2>
<p>RDP Bitmap Cache. RDP was developed by Windows. Small chunks of screenshots. The size of each is <code>64x64</code> bit. And also there is 1 huge sprite with all of them.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">%</span><span class="n">USERPROFILE</span><span class="o">%</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Microsoft</span>\<span class="n">Terminal</span> <span class="n">Server</span> <span class="n">Client</span>\<span class="n">Cache</span>
</span></span></code></pre></div><ul>
<li>older - <code>.bmc</code></li>
<li>newer - <code>Cache####.bin</code> where # is a number starting from <code>0</code></li>
</ul>
<blockquote>
<p>In case you investigate a successful RDP login to a specific machine, note that only in the case of the RDP login the â€œWorkstation Nameâ€ field in the â€œNetwork Informationâ€ section does not refer to the source machine name instead it refers to the name of the machine that recorded the event log (Target machine). be careful because such wrong information may miss leading your incident investigations. For the example in the screenshot, the â€œpbeeslyâ€ account logged on the â€œSCARNTONâ€ hostname from the <code>172.18.39.2</code> source machine IP. If you want to find the source machine name you can use the Event IDs 4778 or 4779 recorded in the security events instead. <a href="https://www.linkedin.com/posts/mostafa-yahia-701b4b15a_in-case-you-investigate-a-successful-rdp-activity-7004505487912112130-W6Oo?utm_source=share&amp;utm_medium=member_desktop">https://www.linkedin.com/posts/mostafa-yahia-701b4b15a_in-case-you-investigate-a-successful-rdp-activity-7004505487912112130-W6Oo?utm_source=share&amp;utm_medium=member_desktop</a></p>
</blockquote>
<h2 id="pipes">Pipes</h2>
<blockquote>
<p>A named pipe is not exactly the same as a reverse shell, but it can be used in a similar way to establish a remote connection between two systems. A named pipe is a type of inter-process communication (IPC) mechanism that allows two or more processes to communicate with each other on a local computer or over a network. A named pipe has a name and is implemented as a file object. Processes can read from and write to the named pipe as if it were a regular file. Named pipes are commonly used in client-server applications, where a server process creates a named pipe and waits for client processes to connect to it. Once a client connects to the named pipe, the server can send and receive data to and from the client. ChatGPT</p>
</blockquote>
<h3 id="-rtfm">ğŸ“• RTFM</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cmd.exe /c <span class="nb">echo</span> something &gt; <span class="se">\\</span>.<span class="se">\p</span>ipe<span class="se">\s</span>omething2
</span></span></code></pre></div><p><code>/c</code> tells <code>cmd.exe</code> execute the command and then quit. Putting it all together, the command is echoing the text &ldquo;something&rdquo; and redirecting it to a named pipe called &ldquo;something2&rdquo;.</p>
<p>To create a named pipe, do the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkfifo <span class="se">\\</span>.<span class="se">\p</span>ipe<span class="se">\M</span>yNamedPipe
</span></span><span class="line"><span class="cl">dir <span class="se">\\</span>.<span class="se">\p</span>ipe<span class="se">\M</span>yNamedPipe
</span></span><span class="line"><span class="cl">del <span class="se">\\</span>.<span class="se">\p</span>ipe<span class="se">\M</span>yNamedPipe
</span></span></code></pre></div><h2 id="telnet">Telnet</h2>
<p><strong>Ports</strong>: <code>23</code></p>
<h3 id="-rtfm-1">ğŸ“• RTFM</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># If the Telnet port is open, you might try to log in with a user. If the user doesn&#39;t have a password set up, you might even be able to log in without a password.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">telnet &lt;IP&gt; &lt;port&gt;
</span></span><span class="line"><span class="cl">root <span class="c1"># or any other username that you think is there</span>
</span></span><span class="line"><span class="cl">Password: <span class="c1"># leave blank</span>
</span></span></code></pre></div><h2 id="ftp">FTP</h2>
<p><strong>Ports</strong>: <code>21</code>, <code>22</code></p>
<h3 id="-rtfm-2">ğŸ“• RTFM</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">brew unlink telnet <span class="c1"># for macOS if the telnet was already installed</span>
</span></span><span class="line"><span class="cl">brew install inetutils
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ftp &lt;IP&gt;
</span></span><span class="line"><span class="cl"><span class="c1"># When prompted for the username, type</span>
</span></span><span class="line"><span class="cl">anonymous
</span></span><span class="line"><span class="cl"><span class="c1"># for password just hit Enter</span>
</span></span><span class="line"><span class="cl"><span class="c1"># on macOS let gftp to accept incoming connection or else you won&#39;t be able to browse the FTP server. The server will respond with 200 PORT command successful. Consider using PASV, then hanging for a while and then puking the 425 Failed to establish connection. message. </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ls <span class="c1"># browse</span>
</span></span><span class="line"><span class="cl">get <span class="c1"># get file</span>
</span></span></code></pre></div><h2 id="smb">SMB</h2>
<p><strong>Ports</strong>: <code>135</code>, <code>139</code>, <code>445</code></p>
<h3 id="-rtfm-3">ğŸ“• RTFM</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmap -p 139,445 --script smb-enum-shares &lt;target&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">brew install samba
</span></span><span class="line"><span class="cl">smbclient -U username -W workgroup -c <span class="s1">&#39;ls&#39;</span> //server/share
</span></span></code></pre></div><h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    Something here
</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
