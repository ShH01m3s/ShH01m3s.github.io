<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Host and Network Logs - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.9d91cbb32c96c334ae7b38c3d99d30727e0836e1182125cc5f007d215f0b9e59.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/investigation/"> Back to ğŸ” Forensic Investigation Section ğŸ‘ˆğŸ¼ </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#macos">macOS</a></li>
    <li><a href="#heading"></a></li>
    <li><a href="#windows">Windows</a>
      <ul>
        <li><a href="#linuxessss">Linuxessss</a></li>
        <li><a href="#ios">iOS</a></li>
        <li><a href="#android">Android</a></li>
      </ul>
    </li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Host and Network Logs</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-search"></i>
              
          <a class="category-link" href="/domain/forensics">forensics</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p>One of the most useful artifacts when properly configured and maintained, are log files. All devices keep some sort of logs, even mobile devices. However, their relevance for the specific case may differ.</p>
<p>Different logs might be collected depending on the case:</p>
<ol>
<li>Network hack: logs of all network devices (on the route to the hacked device), perimeter router (ISP), Firewall rules might be required.</li>
<li>Unauthorised access: web server logs, application server logs, application logs, router or switch logs, firewall logs, db logs, IDS logs etc.</li>
<li>Trojan/Virus/Worm: antivirus logs, event logs.</li>
</ol>
<p>There are several formats that logs can exist in depending on the system in question and configurations as well.</p>
<ul>
<li>W3C. ASCII, UTC.</li>
<li>IIS. ASCII, local time.</li>
<li>NCSA. ASCII, no customization, local time</li>
<li>IIS ODBC. Needs to be enabled first, degrades performance.</li>
<li>BIN. IIS 5.1+, in binary format, logging several websites at once.</li>
<li>XML. Mostly used for applications to share data.</li>
</ul>
<h2 id="macos">macOS</h2>
<p><strong>syslog</strong>. Since macOS Sierra (10.12, 2016) Apple has redesigned its log system. Unix logs were replaced (syslog, for example). By the way, <code>syslog</code> was replaced as well on iOS (see <a href="/docs/dfir/host/mobile/ios/ios-logs">here</a>). Some still exist: <code>daily.out</code>, cups, <code>install.log</code>. ğŸ›‘ More about logs for iOS and macOS here.</p>
<p>ğŸ›‘ More about fervents here.</p>
<p>New unified log path in 2 directories:</p>
<ul>
<li><code>/var/db/diagnistics</code></li>
<li><code>/var/db/uuidtext</code></li>
</ul>
<p><strong>fsevents</strong>. Directory events only 10.5-10.6. File events since 10.7. Each record is assigned a name which is constucted the following way: <code>hex(last_event_id + 1)</code>. Lots of zeroes appended at the beginning of the file name. Example: <code>000000000112f2d8</code>. Can be found in either of these locations:</p>
<ul>
<li><code>/.fseventsd</code></li>
<li><code>./System/Volumes/Data/.fseventsd</code></li>
<li>On iOS - <code>/private/var/.fseventsd</code>, for System: <code>/.fseventsd</code> and Developer Patch at <code>/DeveloperPatch/.fseventsd</code>.</li>
</ul>
<p><code>python FSEParser_V3.3.py -s -t folder /.fseventsd -o /Users/sentinel/Desktop/FSEvents_Out	</code>. More about FSEvents might be seen here [<a href="http://www.osdfcon.org/presentations/2017/Ibrahim-Understanding-MacOS-File-Ststem-Events-with-FSEvents-Parser.pdf">10</a>]. Thanks to Nicole Ibrahim from OSDFCon, we have this filetype reverse engineered and documented. At least, v1.</p>
<blockquote>
<p>ğŸ˜­ Getting an error when trying to run <code>FSEventsParser</code> on a M1. No excpetion when running it on an Intel machine though.
ğŸ˜Š âœ… My solution was to run a windows version on a VM. Worked fine.</p>
</blockquote>
<p>Mount activity: DMGs, External devices or Shared network drives.</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">SELECT
*, _ROWID_ &#34;NAVICAT_ROWID&#34;
FROM
&#34;fsevents&#34;
WHERE
&#34;mask&#34; LIKE &#39;%mount%&#39;
</code></pre></div><p>Internet activity (websites visited)</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">SELECT
*, _ROWID_ &#34;NAVICAT_ROWID&#34;
FROM
&#34;fsevents&#34;
WHERE
&#34;filename&#34; LIKE
&#39;Users/%/Library/Caches/Metadata/Safari/History/%&#39;
OR &#34;filename&#34; LIKE &#39;Users/%/Library/Application
Support/Google/Chrome/Default/Local Storage/%&#39;
</code></pre></div><p>User folders activity</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">SELECT
*, _ROWID_ &#34;NAVICAT_ROWID&#34;
FROM
&#34;fsevents&#34;
WHERE
&#34;filename&#34; LIKE &#39;Users/%/Documents/%â€™
OR &#34;filename&#34; LIKE &#39;Users/%/Downloads/%â€™
OR &#34;filename&#34; LIKE &#39;Users/%/Desktop/%&#39;
</code></pre></div><p><strong>ğŸ—‘ Trash activity</strong>:</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">SELECT
*, _ROWID_ &#34;NAVICAT_ROWID&#34;
FROM
&#34;fsevents&#34;
WHERE
&#34;filename&#34; LIKE &#39;Users/%/.Trash/%&#39;
</code></pre></div><h2 id="heading"></h2>
<h2 id="windows">Windows</h2>
<p>The main guy for logs on Windows - Windows Event Manager. Located at <code>%SystemRoot%\Windows\System32\winevt\Logs</code>. Can be viewed by Event Viewer on a live system. Tools ğŸ›  for analysis: <code>Evtxtract</code> (python2, <a href="https://pypi.org/project/evtxtract/">here</a>, requires <code>pip install python-evtx</code> first), Magnet AXIOM ğŸ’°, <code>FullEventLogView</code> (can be used to get logs from current/remote machine or a folder and show them in GUI).</p>
<p>IIS logs are by default here: <code>C:\%System%\System32\LogFiles\W3SVC1</code>.</p>
<h3 id="linuxessss">Linuxessss</h3>
<h4 id="apache-weblogs">Apache Weblogs</h4>
<h3 id="ios">iOS</h3>
<p>Same as for macOS. On iOS - <code>/private/var/.fseventsd</code>, for System: <code>/.fseventsd</code> and Developer Patch at <code>/DeveloperPatch/.fseventsd</code>.</p>
<p>Internet activity</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">SELECT
*, _ROWID_ &#34;NAVICAT_ROWID&#34;
FROM
&#34;fsevents&#34;
WHERE
&#34;filename&#34; LIKE &#39;%websitedata/local%&#39;
</code></pre></div><p>Email activity</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">SELECT
*, _ROWID_ &#34;NAVICAT_ROWID&#34;
FROM
&#34;fsevents&#34;
WHERE
&#34;filename&#34; LIKE &#39;mobile/Library/Mail/%â€™
</code></pre></div><p>iCloud synced files</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">SELECT
*, _ROWID_ &#34;NAVICAT_ROWID&#34;
FROM
&#34;fsevents&#34;
WHERE
&#34;filename&#34; LIKE &#39;mobile/Library/Mobile
Documents/com~apple~CloudDocs/%&#39;
</code></pre></div><h3 id="android">Android</h3>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
