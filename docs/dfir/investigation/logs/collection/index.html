<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Logs Collection - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.f9f7cda90b4490a5a552158a718de9c4abd9dd115744de8d47655158cd53ec58.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/investigation/logs/"> 👈🏼 Back to </br> 🪵 Log Analysis </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#macos">macOS</a></li>
    <li><a href="#windows">Windows</a>
      <ul>
        <li><a href="#system-and-event-logs">System and Event Logs</a></li>
        <li><a href="#anti-virus-logs">Anti-virus logs</a></li>
      </ul>
    </li>
    <li><a href="#linuxessss">Linuxessss</a></li>
    <li><a href="#ios">iOS</a>
      <ul>
        <li><a href="#syslog">Syslog</a></li>
        <li><a href="#nslog">NSlog</a></li>
      </ul>
    </li>
    <li><a href="#android">Android</a></li>
    <li><a href="#webserver">WebServer</a></li>
    <li><a href="#weblogs">WebLogs</a>
      <ul>
        <li><a href="#apache-weblogs">Apache Weblogs</a></li>
      </ul>
    </li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Logs Collection</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-search"></i>
              
          <a class="category-link" href="/domain/forensics">forensics</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <h2 id="macos">macOS</h2>
<p><strong>syslog</strong>. Since macOS Sierra (10.12, 2016) Apple has redesigned its log system. Unix logs were replaced (syslog, for example). By the way, <code>syslog</code> was replaced as well on iOS (see <a href="/docs/dfir/host/mobile/ios/ios-logs">here</a>). Some still exist: <code>daily.out</code>, cups, <code>install.log</code>. 🛑 More about logs for iOS and macOS here.</p>
<p>🛑 More about fervents here.</p>
<p>New unified log path in 2 directories:</p>
<ul>
<li><code>/var/db/diagnistics</code></li>
<li><code>/var/db/uuidtext</code></li>
</ul>
<p><strong>fsevents</strong>. Mount, Unmount, Volume. See <a href="/docs/dfir/host/apple/apple-fsevents">here</a> to know more about this artefact. Directory events only 10.5-10.6. File events since 10.7. Each record is assigned a name which is constucted the following way: <code>hex(last_event_id + 1)</code>. Lots of zeroes appended at the beginning of the file name. Example: <code>000000000112f2d8</code>. Can be found in either of these locations:</p>
<ul>
<li><code>/.fseventsd</code></li>
<li><code>./System/Volumes/Data/.fseventsd</code></li>
<li>On iOS - <code>/private/var/.fseventsd</code>, for System: <code>/.fseventsd</code> and Developer Patch at <code>/DeveloperPatch/.fseventsd</code>.</li>
</ul>
<p><code>python FSEParser_V3.3.py -s -t folder /.fseventsd -o /Users/sentinel/Desktop/FSEvents_Out	</code>. More about FSEvents might be seen here [<a href="http://www.osdfcon.org/presentations/2017/Ibrahim-Understanding-MacOS-File-Ststem-Events-with-FSEvents-Parser.pdf">10</a>]. Thanks to Nicole Ibrahim from OSDFCon, we have this filetype reverse engineered and documented. At least, v1.</p>
<blockquote>
<p>😭 Getting an error when trying to run <code>FSEventsParser</code> on a M1. No excpetion when running it on an Intel machine though.
😊 ✅ My solution was to run a windows version on a VM. Worked fine.</p>
</blockquote>
<p>Mount activity: DMGs, External devices or Shared network drives.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SELECT
</span></span><span class="line"><span class="cl">*, _ROWID_ &#34;NAVICAT_ROWID&#34;
</span></span><span class="line"><span class="cl">FROM
</span></span><span class="line"><span class="cl">&#34;fsevents&#34;
</span></span><span class="line"><span class="cl">WHERE
</span></span><span class="line"><span class="cl">&#34;mask&#34; LIKE &#39;%mount%&#39;
</span></span></code></pre></div><p>Internet activity (websites visited)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SELECT
</span></span><span class="line"><span class="cl">*, _ROWID_ &#34;NAVICAT_ROWID&#34;
</span></span><span class="line"><span class="cl">FROM
</span></span><span class="line"><span class="cl">&#34;fsevents&#34;
</span></span><span class="line"><span class="cl">WHERE
</span></span><span class="line"><span class="cl">&#34;filename&#34; LIKE
</span></span><span class="line"><span class="cl">&#39;Users/%/Library/Caches/Metadata/Safari/History/%&#39;
</span></span><span class="line"><span class="cl">OR &#34;filename&#34; LIKE &#39;Users/%/Library/Application
</span></span><span class="line"><span class="cl">Support/Google/Chrome/Default/Local Storage/%&#39;
</span></span></code></pre></div><p>User folders activity</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SELECT
</span></span><span class="line"><span class="cl">*, _ROWID_ &#34;NAVICAT_ROWID&#34;
</span></span><span class="line"><span class="cl">FROM
</span></span><span class="line"><span class="cl">&#34;fsevents&#34;
</span></span><span class="line"><span class="cl">WHERE
</span></span><span class="line"><span class="cl">&#34;filename&#34; LIKE &#39;Users/%/Documents/%’
</span></span><span class="line"><span class="cl">OR &#34;filename&#34; LIKE &#39;Users/%/Downloads/%’
</span></span><span class="line"><span class="cl">OR &#34;filename&#34; LIKE &#39;Users/%/Desktop/%&#39;
</span></span></code></pre></div><p><strong>🗑 Trash activity</strong>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SELECT
</span></span><span class="line"><span class="cl">*, _ROWID_ &#34;NAVICAT_ROWID&#34;
</span></span><span class="line"><span class="cl">FROM
</span></span><span class="line"><span class="cl">&#34;fsevents&#34;
</span></span><span class="line"><span class="cl">WHERE
</span></span><span class="line"><span class="cl">&#34;filename&#34; LIKE &#39;Users/%/.Trash/%&#39;
</span></span></code></pre></div><p><strong>Unified logs</strong>. <code>/private/var/db/diagnostics</code></p>
<h2 id="windows">Windows</h2>
<p>The main guy for logs on Windows - Windows Event Manager. Located at <code>%SystemRoot%\Windows\System32\winevt\Logs</code>. Can be viewed by Event Viewer on a live system. Tools 🛠 for analysis: <code>Evtxtract</code> (python2, <a href="https://pypi.org/project/evtxtract/">here</a>, requires <code>pip install python-evtx</code> first), Magnet AXIOM 💰, <code>FullEventLogView</code> (can be used to get logs from current/remote machine or a folder and show them in GUI).</p>
<p>IIS logs are by default here: <code>C:\%System%\System32\LogFiles\W3SVC1</code>.</p>
<h3 id="system-and-event-logs">System and Event Logs</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\w</span>inevt<span class="se">\l</span>ogs<span class="se">\*</span>.evtx
</span></span><span class="line"><span class="cl"><span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\S</span>RU<span class="se">\s</span>rudb.dat
</span></span><span class="line"><span class="cl"><span class="se">\W</span>indows<span class="se">\i</span>nf<span class="se">\s</span>etupapi.dev.log
</span></span><span class="line"><span class="cl"><span class="se">\U</span>sers<span class="se">\%</span>username%<span class="se">\A</span>ppData<span class="se">\L</span>ocal<span class="se">\C</span>onnectedDevicesPlatform<span class="se">\*\A</span>ctivitiesCache.db
</span></span></code></pre></div><h3 id="anti-virus-logs">Anti-virus logs</h3>
<h2 id="linuxessss">Linuxessss</h2>
<h2 id="ios">iOS</h2>
<p>Same as for macOS. On iOS - <code>/private/var/.fseventsd</code>, for System: <code>/.fseventsd</code> and Developer Patch at <code>/DeveloperPatch/.fseventsd</code>.</p>
<p>Internet activity</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SELECT
</span></span><span class="line"><span class="cl">*, _ROWID_ &#34;NAVICAT_ROWID&#34;
</span></span><span class="line"><span class="cl">FROM
</span></span><span class="line"><span class="cl">&#34;fsevents&#34;
</span></span><span class="line"><span class="cl">WHERE
</span></span><span class="line"><span class="cl">&#34;filename&#34; LIKE &#39;%websitedata/local%&#39;
</span></span></code></pre></div><p>Email activity</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SELECT
</span></span><span class="line"><span class="cl">*, _ROWID_ &#34;NAVICAT_ROWID&#34;
</span></span><span class="line"><span class="cl">FROM
</span></span><span class="line"><span class="cl">&#34;fsevents&#34;
</span></span><span class="line"><span class="cl">WHERE
</span></span><span class="line"><span class="cl">&#34;filename&#34; LIKE &#39;mobile/Library/Mail/%’
</span></span></code></pre></div><p>iCloud synced files</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SELECT
</span></span><span class="line"><span class="cl">*, _ROWID_ &#34;NAVICAT_ROWID&#34;
</span></span><span class="line"><span class="cl">FROM
</span></span><span class="line"><span class="cl">&#34;fsevents&#34;
</span></span><span class="line"><span class="cl">WHERE
</span></span><span class="line"><span class="cl">&#34;filename&#34; LIKE &#39;mobile/Library/Mobile
</span></span><span class="line"><span class="cl">Documents/com~apple~CloudDocs/%&#39;
</span></span></code></pre></div><h3 id="syslog">Syslog</h3>
<p>According to <a href="https://developer.apple.com/documentation/os/logging">Apple docs</a>, NSLog now doesn&rsquo;t write to syslog, therefore I didn&rsquo;t find a <code>syslog.sock</code> or <code>syslog</code> file itself.</p>
<blockquote>
<p>Important</p>
<p>The unified logging system is available in iOS 10. and later, macOS 10.12 and later, tvOS 10.0 and later, and watchOS 3.0 and later. This system supersedes the Apple System Logger (ASL) and Syslog APIs.</p>
</blockquote>
<p>That&rsquo;s why now with newer devices you can&rsquo;t view logs with</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">socat - UNIX-CONNECT:/var/run/lockdown/syslog.sock
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># gives an error</span>
</span></span><span class="line"><span class="cl">socat<span class="o">[</span>2520<span class="o">]</span> E connect<span class="o">(</span>5, <span class="nv">LEN</span><span class="o">=</span><span class="m">31</span> <span class="nv">AF</span><span class="o">=</span><span class="m">1</span> <span class="s2">&#34;/var/run/lockdown/syslog.sock&#34;</span>, 31<span class="o">)</span>: No such file or directory
</span></span></code></pre></div><p>ondeviceconsole tool won&rsquo;t help either, since it uses the same socket (see <a href="https://github.com/eswick/ondeviceconsole/blob/master/main.m">main.c</a>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#define SOCKET_PATH &#34;/var/run/lockdown/syslog.sock&#34;
</span></span></span></code></pre></div><p>There is a socket file <code>syslog</code> (checked by trying to <code>cp</code> it), but using the above techniques with it didn&rsquo;t work.</p>
<h3 id="nslog">NSlog</h3>
<p>With newer versions of iOS the Oslog API is used. To see the logs, use <code>oslog</code> utility from Cydia repository or <code>Passionfruit</code> multitool. Can pipe to grep to filter output.</p>
<h2 id="android">Android</h2>
<p><code>logcat</code> command of adb is used to get system log. It&rsquo;s an equivalent to Ubuntu syslog, as far as I understand. <code>/data/log/prev_dump.log</code> file. On the device (in my case. Samsung Duo, Android 7, rooted) here I saw the latest records of <code>logcat</code>, however the buffer contained a little more.</p>
<h2 id="webserver">WebServer</h2>
<p>There are several formats that logs can exist in depending on the system in question and configurations as well.</p>
<ul>
<li>W3C. ASCII, UTC.</li>
<li>IIS. ASCII, local time.</li>
<li>NCSA. ASCII, no customization, local time</li>
<li>IIS ODBC. Needs to be enabled first, degrades performance.</li>
<li>BIN. IIS 5.1+, in binary format, logging several websites at once.</li>
<li>XML. Mostly used for applications to share data.</li>
</ul>
<h2 id="weblogs">WebLogs</h2>
<h3 id="apache-weblogs">Apache Weblogs</h3>
<p><code>access.log</code>.</p>
<p>Using pivot tables may help. Apache has an <code>access.log</code>.</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
