<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗄️ Artefacts Collection Repository - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.9d91cbb32c96c334ae7b38c3d99d30727e0836e1182125cc5f007d215f0b9e59.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-forensics 🔍 and incident response 🥷">
      <a href="/docs/dfir">
        <span>Forensics 🔍 and Incident Response 🥷</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-forensics 🔍 and incident response 🥷">
      <a href="/docs/dfir">
        <span>Forensics 🔍 and Incident Response 🥷</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/investigation/"> Back to 🔎 Incident Investigation Section 👈🏼 </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#account-information">Account Information</a>
      <ul>
        <li><a href="#windows">Windows</a></li>
        <li><a href="#macos">macOS</a></li>
        <li><a href="#linux">Linux</a></li>
      </ul>
    </li>
    <li><a href="#recent-activity">Recent Activity</a>
      <ul>
        <li><a href="#windows-1">Windows</a></li>
        <li><a href="#macos-1">macOS</a></li>
      </ul>
    </li>
    <li><a href="#host-and-network-logs">Host and Network Logs</a>
      <ul>
        <li><a href="#macos-2">macOS</a></li>
        <li><a href="#windows-2">Windows</a></li>
        <li><a href="#linuxessss">Linuxessss</a>
          <ul>
            <li><a href="#apache-weblogs">Apache Weblogs</a></li>
          </ul>
        </li>
        <li><a href="#ios">iOS</a></li>
        <li><a href="#android">Android</a></li>
      </ul>
    </li>
    <li><a href="#documents">Documents</a>
      <ul>
        <li><a href="#office">Office</a></li>
        <li><a href="#temp-file">Temp file</a></li>
        <li><a href="#ads">ADS</a></li>
      </ul>
    </li>
    <li><a href="#mail">Mail</a>
      <ul>
        <li><a href="#outlook">Outlook</a></li>
        <li><a href="#outlook-express">Outlook Express</a></li>
        <li><a href="#thunderbird">Thunderbird</a></li>
        <li><a href="#webmail">Webmail</a></li>
        <li><a href="#windows-10-mail">Windows 10 Mail</a></li>
      </ul>
    </li>
    <li><a href="#network-traffic">Network Traffic</a></li>
    <li><a href="#browser">Browser</a>
      <ul>
        <li><a href="#firefox">Firefox</a></li>
        <li><a href="#chrome">Chrome</a></li>
        <li><a href="#edge">Edge</a></li>
        <li><a href="#ie">IE</a></li>
        <li><a href="#opera">Opera</a></li>
      </ul>
    </li>
    <li><a href="#messangers">Messangers</a>
      <ul>
        <li><a href="#skype">Skype</a></li>
        <li><a href="#xbox">Xbox</a></li>
      </ul>
    </li>
    <li><a href="#devices-attached">Devices Attached</a>
      <ul>
        <li><a href="#windows-3">Windows</a></li>
        <li><a href="#macos-3">macOS</a></li>
      </ul>
    </li>
    <li><a href="#notifications">Notifications</a>
      <ul>
        <li><a href="#windows-4">Windows</a></li>
      </ul>
    </li>
    <li><a href="#voice-assistants">Voice Assistants</a>
      <ul>
        <li><a href="#windows-5">Windows</a></li>
      </ul>
    </li>
    <li><a href="#cloud-storage">Cloud Storage</a>
      <ul>
        <li><a href="#windows-6">Windows</a></li>
      </ul>
    </li>
    <li><a href="#screen-recordings">Screen Recordings</a>
      <ul>
        <li><a href="#windows-7">Windows</a></li>
      </ul>
    </li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">🗄️ Artefacts Collection Repository</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-search"></i>
              
          <a class="category-link" href="/domain/forensics">forensics</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <h2 id="account-information">Account Information</h2>
<h3 id="windows">Windows</h3>
<p>There are two main places within the registry that contains that information: SAM hive for local and Microsoft accounts and <code>Software\Microsoft\Windows NT\CurrentVersion\ProfileList</code> for Domain Accounts.</p>
<blockquote>
<p>❗️❗️❗️❗️ More details see here.</p>
</blockquote>
<p>To crack Windows NTLM hashes (for local accounts only), you&rsquo;ll need both SYSTEM and SAM hives. SYSTEM contains an AES key 🔑 for NTLM decryption and SAM contains the encrypted hash. After the hash is decrypted, either brute-force 💪 or dictionary 📖 attack needs.</p>
<p>Xbox on later versions is a built-in game center. It also contains some information about the user (if he uses it for fames): <code>C:\Users\%Username%\AppData\Local\LocalState\ModelManager\Xboxlivegamer.xml</code> (user profile).</p>
<p>Also, collect DPAPI master user and system keys: <a href="https://www.youtube.com/watch?v=vA4qa0uWRHU">https://www.youtube.com/watch?v=vA4qa0uWRHU</a>.</p>
<h3 id="macos">macOS</h3>
<p><code>private/var/db/dslocal/nodes/Default/Users/&lt;User&gt;.plist</code> - name, profile name, password hint, account image, UID</p>
<p>Password hashes</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">sudo plutil -p /var/db/dslocal/nodes/Default/users/&lt;usename&gt;.plist
</code></pre></div><p>Account Info</p>
<p><code>private/var/db/dslocal/nodes/Default/Users/&lt;User&gt;.plist</code> - name, profile name, password hint, account image, UID</p>
<p>Login History</p>
<p><code>private/var/log/asl</code> BB.date.asl - Best before.</p>
<blockquote>
<p>⚠️ When grabbing volumes from APFS system, better acquire Recovery volume as well, since it may contain account information as well (password hints, for example).</p>
</blockquote>
<p><strong>Tools</strong> 🛠: <code>plutil</code> (built-in on Macs).</p>
<p>Also, FSEvents can give you a lot of information. <strong>Tools</strong> 🛠: FSEventsParser.</p>
<h3 id="linux">Linux</h3>
<p><code>/etc/passwd</code> and <code>/etc/shadow</code>.</p>
<h2 id="recent-activity">Recent Activity</h2>
<h3 id="windows-1">Windows</h3>
<p>There are several artifacts indicating user activity. One of them is <code>LNK</code> files. To analyse acquired LNK files use 🛠 <a href="https://ericzimmerman.github.io/#!index.md">LECmd</a> (E. Zimmerman&rsquo;s) or <a href="https://4discovery.com/our-tools/link-parser/">Link Parser</a>.</p>
<p>Enother mechanism is Prefetch. It&rsquo;s usually located at <code>C:\Windows\Prefetch</code>. Several tools are available for viewing this artifact: Magnet AXIOM 💰, PECmd.</p>
<h3 id="macos-1">macOS</h3>
<h2 id="host-and-network-logs">Host and Network Logs</h2>
<p>One of the most useful artifacts when properly configured and maintained, are log files. All devices keep some sort of logs, even mobile devices. However, their relevance for the specific case may differ.</p>
<p>Different logs might be collected depending on the case:</p>
<ol>
<li>Network hack: logs of all network devices (on the route to the hacked device), perimeter router (ISP), Firewall rules might be required.</li>
<li>Unauthorised access: web server logs, application server logs, application logs, router or switch logs, firewall logs, db logs, IDS logs etc.</li>
<li>Trojan/Virus/Worm: antivirus logs, event logs.</li>
</ol>
<p>There are several formats that logs can exist in depending on the system in question and configurations as well.</p>
<ul>
<li>W3C. ASCII, UTC.</li>
<li>IIS. ASCII, local time.</li>
<li>NCSA. ASCII, no customization, local time</li>
<li>IIS ODBC. Needs to be enabled first, degrades performance.</li>
<li>BIN. IIS 5.1+, in binary format, logging several websites at once.</li>
<li>XML. Mostly used for applications to share data.</li>
</ul>
<h3 id="macos-2">macOS</h3>
<p><strong>syslog</strong>. Since macOS Sierra (10.12, 2016) Apple has redesigned its log system. Unix logs were replaced (syslog, for example). By the way, <code>syslog</code> was replaced as well on iOS (see <a href="/docs/dfir/host/mobile/ios/ios-logs">here</a>). Some still exist: <code>daily.out</code>, cups, <code>install.log</code>. 🛑 More about logs for iOS and macOS here.</p>
<p>🛑 More about fervents here.</p>
<p>New unified log path in 2 directories:</p>
<ul>
<li><code>/var/db/diagnistics</code></li>
<li><code>/var/db/uuidtext</code></li>
</ul>
<p><strong>fsevents</strong>. Directory events only 10.5-10.6. File events since 10.7. Each record is assigned a name which is constucted the following way: <code>hex(last_event_id + 1)</code>. Lots of zeroes appended at the beginning of the file name. Example: <code>000000000112f2d8</code>. Can be found in either of these locations:</p>
<ul>
<li><code>/.fseventsd</code></li>
<li><code>./System/Volumes/Data/.fseventsd</code></li>
<li>On iOS - <code>/private/var/.fseventsd</code>, for System: <code>/.fseventsd</code> and Developer Patch at <code>/DeveloperPatch/.fseventsd</code>.</li>
</ul>
<h3 id="windows-2">Windows</h3>
<p>The main guy for logs on Windows - Windows Event Manager. Located at <code>%SystemRoot%\Windows\System32\winevt\Logs</code>. Can be viewed by Event Viewer on a live system. Tools 🛠 for analysis: <code>Evtxtract</code> (python2, <a href="https://pypi.org/project/evtxtract/">here</a>, requires <code>pip install python-evtx</code> first), Magnet AXIOM 💰, <code>FullEventLogView</code> (can be used to get logs from current/remote machine or a folder and show them in GUI).</p>
<p>IIS logs are by default here: <code>C:\%System%\System32\LogFiles\W3SVC1</code>.</p>
<h3 id="linuxessss">Linuxessss</h3>
<p><img src="images/artworks-000579009953-6w0z2h-t500x500.jpeg" alt="artworks-000579009953-6w0z2h-t500x500"></p>
<h4 id="apache-weblogs">Apache Weblogs</h4>
<h3 id="ios">iOS</h3>
<h3 id="android">Android</h3>
<h2 id="documents">Documents</h2>
<p>There are several ways to determine file type: extension, signatures and structure. The most reliable is the last one, since extentsions can be easily changed and signatures are not very reliable (polymorphic files). Some file types and signatures are listed <a href="https://peat-chameleon-e41.notion.site/386aa42a50a649d2aba6bdc30d2babcf?v=6274428e7e57479a9ae962f18ee3d847">here</a> and in the book <em>Digital Archaeology</em>. Magic numbers can be viewed on a UNIX machine: <code>/usr/share/file/magic.mgc</code> (compiled list of magic numbers), <code>/usr/share/file/magic</code> (default list of magic numbers), <code>/usr/share/file/magic.mime.mgc</code> (default compiled list), <code>/usr/share/file/magic.mime</code> (default list).  Use <code>file</code> command to determine file type.</p>
<p>Data about a file is stored in several locations: system metadata (generated by file system or doc management of the OS), substantive metadata (information that defines modifications to a document), embedded metadata (information embedded by the application that creates or edits the file), external metadata (separate doc, for example, a database).</p>
<h3 id="office">Office</h3>
<p><em>General Properties</em> get information from OS metadata and <em>Statistics</em> tab for <code>word.exe</code> is for embedded metadata. If the timestamps are different is probably from a fatal system error. On reboot file was opened by recovery option which changed the embedded timestamps.</p>
<p>Also, some information can be hidden within embedded metadata. Just imagine, that most of the data for a tiny office document is the meta. 🛠 One of the tools to view <code>DocScrubber</code>. Office documents also have additional meta that reveals much about the document, for example, who edited it, user name, user initials, org name, comp name, doc location, previous authors, revision logs (Word, Excel), version logs (Word), template file name (Word, PowerPoint), hidden text (Word, Excel), GUIDs. If the file was renamed and then reopened, it&rsquo;s seen as a new file and editing clocks ⏰ start over.</p>
<blockquote>
<p>🧹👣 There are certains anti-forensics techniques that allow cleansing the file&rsquo;s metadata.</p>
</blockquote>
<p>Do not forget about autosaved docs (<code>asd</code>). Also, sometimes the <em>Track Changes</em> feature was enabled.</p>
<h3 id="temp-file">Temp file</h3>
<p>Some of the programs keep tmp files. <em>Digital Archaeology</em>, page 173 (Kindle, Mining the Temporary Files) has a table of some temp files for different applications on a Windows machine. Some of them will be deleted on OS shutdown, but can also be carved before overwritten anyway.</p>
<h3 id="ads">ADS</h3>
<p>Alternate data streams, see more <a href="/docs/dfir/forensic-investigation/reference/windows/win-ads">here</a>. Are there such streams for other OS? If yes, how to make them and discover them?</p>
<p>To ensure compatability between NTFS and HFS. Allows hiding files.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="n">C:</span><span class="p">\</span><span class="nb">type </span><span class="n">C:</span><span class="p">\</span><span class="n">mal</span><span class="p">.</span><span class="n">exe</span> <span class="p">&gt;</span> <span class="n">C:</span><span class="p">\</span><span class="n">readme</span><span class="p">.</span><span class="n">txt</span><span class="err">:</span><span class="n">naughty</span><span class="p">.</span><span class="n">exe</span>
<span class="nb">start </span><span class="n">readme</span><span class="p">.</span><span class="n">txt</span><span class="err">:</span><span class="n">naughty</span><span class="p">.</span><span class="n">exe</span>
<span class="n">C:</span><span class="p">\</span><span class="n">mklink</span> <span class="n">innocent</span><span class="p">.</span><span class="n">exe</span> <span class="n">readme</span><span class="p">.</span><span class="n">txt</span><span class="err">:</span><span class="n">naughty</span><span class="p">.</span><span class="n">exe</span>

<span class="c"># to run</span>
<span class="n">innocent</span><span class="p">.</span><span class="n">exe</span>
</code></pre></div><p>But <code>dir /r</code> - will display <strong>all</strong> streams. LNS and Sfind will hunt down such files. Also, when you copy files from and to a FAT partition - all residual files will be deleted.</p>
<h2 id="mail">Mail</h2>
<h3 id="outlook">Outlook</h3>
<p>The main artifacts are stored in <code>C:\Users\%USERNAME%\AppData\Local\Microsoft\Outlook</code>. Get <code>OST</code> and <code>PST</code> files. Contains messages, contacts, calendars, notes. <code>PST</code> files are usually in <code>Documents and Settings</code> on Windows (personal folder files), but can defined by user as well.</p>
<p><strong>Tools</strong> 🛠: Intella.</p>
<h3 id="outlook-express">Outlook Express</h3>
<p>Dafault up to Vista. Address book is typicalluy <code>wab</code> and mail folders - <code>mbx</code> (messages), <code>idx</code> (index for <code>mbx</code>), <code>nch</code> (user-created folder structure). Later <code>dbx</code> (database) was used to store info. Starts with <code>0xcf 0xad 0x12 0xfe</code> followed by a class id (for file association in Windows). <code>inbox.dbx</code>, <code>sent items.dbx</code>, <code>drafts.dbx</code>, <code>offline.dbx</code> (doesn&rsquo;t exist when Webmail was not configured), <code>pop3uidl.dbx</code> (messages left on POP3 server), <code>&lt;generic_name&gt;.dbx</code> (user-created folders), <code>&lt;newsgroup_name&gt;.dbx</code> (if subsribed).</p>
<h3 id="thunderbird">Thunderbird</h3>
<p><code>C:\Users\%USERNAME%\AppData\Roaming\Thunderbird\Profiles</code>, or just use a forensic image.</p>
<p><strong>Tools</strong> 🛠: Autopsy, Email Parser plugin.</p>
<h3 id="webmail">Webmail</h3>
<p><strong>Tools</strong> 🛠: Magnet AXIOM, when there are no mail clients on the system.</p>
<p>To get this information, &ldquo;RAM-on-disk&rdquo; files are needed (for Windows <code>hiberfil.sys</code>, <code>swapfile.sys</code> and <code>pagefile.sys</code>).</p>
<h3 id="windows-10-mail">Windows 10 Mail</h3>
<p>Emails are stored in <code>txt</code> or <code>html</code>. Can have multiple accounts. The path to data is: <code>C:\Users\%Username%\AppData\Local\Comms</code>. There several subfolders:</p>
<ul>
<li><code>Temp</code></li>
<li><code>Unistore\data</code>. Contains lots of subfolders, <code>3</code> (mail) and <code>7</code> (attachments) are of particular interest.</li>
<li><code>UnistoreDB\store.vol\Contact</code>. Contains <code>Contacts.txt</code> and <code>Pcontacts.txt</code>.</li>
<li><code>UserDataTempFiles</code>. Emails that were not sent. This data is volatile.</li>
<li><code>Volatile</code></li>
</ul>
<h2 id="network-traffic">Network Traffic</h2>
<p>Most of the devices keep some sort of logs. As for the network related issues these are switches, routers, firewalls, IDS and IPS, web proxies, DC and authentication servers, DCHP server and application servers.</p>
<p>SIEMs are log aggregators. When configues correctly all logs and events from all systems in the enterprise flows to a cetralized repository where it can then be analysed. Sometimes these SIEM analyse what&rsquo;s normal and what&rsquo;s not. However, they are quite costy 💰.</p>
<p>There are several ways to capture the network traffic between machines.</p>
<p><strong>Network tap</strong> - a device that&rsquo;s place between other two or more devices on the network. I presume, hub can be considered a tap.</p>
<p><strong>SPAN port</strong> is another <a href="/docs/dfir/network/osi/network/attacks#span-port">option</a>.</p>
<p><strong>Packet sniffer</strong> (<code>tcpdump</code> or Wireshark 🦈) installed on the host.</p>
<p>Legal Considerations for log acquisition:</p>
<ol>
<li>There should be a logging policy and users should be well aware of it, what&rsquo;s being logged. Mind the privacy issues.</li>
<li>Logs should be close to the event, otherwise they migth be rejected in court.</li>
<li>There should be people, who know what devices keep what logs, what structure do they have. These people should also test the software from time to time to make sure the logs are reliable. They might be asked to testify in court.</li>
<li>It&rsquo;s also preferrable that the logs structure is consistent across the enterprise.</li>
<li>Prolonged failures of logging should be documented and the reason determined as well.</li>
<li>Keep in mind that in case a legal prosecution, these logs will be available to the opposing counsel.</li>
<li>The backups and copies should be kept until the court states that they are no longer needed. For some standards there might be determined periods for keeping the logs. For example, in case of PCI-DSS it&rsquo;s 1 year.</li>
</ol>
<p>Logs and pcap files acquired should be documented thoroughly to be admissable. Collect the evidence, send them to a USB drive immediately and then get the hash for each file. Then, for each log and pcap keep the following entry:</p>
<ol>
<li>File name</li>
<li>Description</li>
<li>Location</li>
<li>Date and time (mind the timezone)</li>
<li>Collected by</li>
<li>MD5 or SHA hash</li>
</ol>
<p>[<a href="">1</a>] Digital forensics and Incident Response, G. Johansen</p>
<h2 id="browser">Browser</h2>
<p>Many browsers are based on Chromium engine, that’s why they will have similar artifacts: Chrome, Opera, new Edge, Brave, Vivaldi. Also, there are lots of Electron applications that share some artifacts with them. Chrome is the point of convergence for all these application. On Magnet Summit it was suggested to explore and learn Chrome and it’s artifacts as well as OS common artifacts due to its popularity and reusing some of its components. Electron is a framework that is available for building applications, cross-platform. You’re creating a web-application that can be used as a desktop one (implementing both back- and frontend). Backend - node.js, and frontend - Chrome. So, a lot of artifacts can be shared with Chrome and buddies. It’s in wide use. For example, ⚠️ WhatsApp and Skype use it.</p>
<p>On Windows <code>hiberfil.sys</code>, <code>pagefile.sys</code> and <code>swapfile.sys</code> can also be used to retrieve this evidence from &ldquo;RAM-on-disk&rdquo;. Belkasoft EC can parse these files for browser artifacts.</p>
<h3 id="firefox">Firefox</h3>
<p>🛠 <strong>Tools</strong>: Web Historian (<code>dat</code>, cookies and tmp), Firefox Forensics (cookies, download list and history), NetAnalysis 💰 (history), CacheBack (cookies and history), Encase 💰 (cookies, history and bookmarks), FTK 💰(cookies, history and bookmarks), Autopsy (cookies, history and bookmarks).</p>
<p>Most information is stored here: <code>C:\Documents and Settings\%Username%\Application Data\Mozilla\Firefox</code> (Windows XP), <code>C:\Users\%Username%\AppData\Roaming\Mozilla\Forefox\Profiles\%Profile%.default</code> (Windows Vista+), <code>/Library/Application Support/Firefox/Profiles</code> (macOS), <code>.mozilla/firefox/</code> for Linux. Use any SQLite DB Viewer to examine <code>*.default</code> files or any forensic platform. These profiles contain user activity such as searches, bookmarks, tabs etc.</p>
<table>
<thead>
<tr>
<th>artifact</th>
<th>Information</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Localstore.rdf</code></td>
<td>No real value for the examiner here, since it contains customized data on the interface. Can be cleared in the GUI with “Reset toolbars and controls” option. [<a href="http://kb.mozillazine.org/Localstore.rdf">1</a>]</td>
</tr>
<tr>
<td><code>addons.json</code></td>
<td>I think, the file name speaks for itself. It contains all the data for installed addons.</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="chrome">Chrome</h3>
<p>Most information is stored here: <code>C:\Documents and Settings\%Username%\Local Setting\Application Data\Google\Chrome</code> (Windows XP), <code>C:\Users\%Username%\AppData\Local\Google\Chrome</code>. On Windows machine leveldb is stored here: <code>C:\%Username%\AppData\Local\Google\Chrome\User Data\Default\IndexedDB</code>. Contains multiple folders, one for each domain. Usually have the extension <code>leveldb</code>. The LevelDB store for a particular domain will be found in the IndexedDB folder with a name in the form: <code>[host with concurrent separators replaced an underscore]_[dbid].indexeddb.leveldb</code>. IndexedDB is just an API to use, while LevelDB is the artefact that’s creted when this API is used.</p>
<p><strong>Tools</strong> ⚒️: Magnet AXIOM 💰, Chrome Analyser (cookies, history, download list, bookmarks), NetAnalysis 💰 (history), CacheBack (cookies and history), Autopsy (cookies, history and bookmarks).</p>
<h3 id="edge">Edge</h3>
<p><strong>Tools</strong> 🛠: Belkasoft Evidence Center 💰</p>
<h3 id="ie">IE</h3>
<p><code>C:\Documents and Settings\%username%\Local Settings\Temporary Internet Files\Content.IE5</code>, <code>C:\Documents and Settings\%username%\Local Settings\History\History.IE5</code>, <code>C:\Documents and Settings\%username%\Cookies</code> for Windows 2000.</p>
<p>Since Windows 7 <code>C:\Users\%username%\AppData\Local\Microsoft\Windows\Temporary Internet Files\Content.IE5</code>. However, IE plugins can&rsquo;t access it and OS created virtual folders for cached data unaccessible to general user. Cookies: <code>C:\Users\%username%\AppData\Roaming\Microsoft\Windows\Cookies</code> and  <code>C:\Users\%username%\AppData\Roaming\Microsoft\Windows\Cookies\Low</code> for low-privileged access if <em>protected</em> mode is enabled.</p>
<p>There is also some data in registry for this browser: <code>HKEY_USERS\.Default\Software\Microsoft\Internet Explorer\TYPEDURLs</code> and <code>HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\TYPEDURLs</code> contains search terms. If autocomplete was used, the final search term will be recorded.</p>
<p><strong>Tools</strong> 🛠. There is a huge amount of sowtware capable of parsing and collecting this information. Probably all of the forensic platforms can do it. At least, Autopsy and Magnet can. Also, free NirSoft software for web browser history parsing is available. Also, Web Historian can be used. Pasco (<code>dat</code>), Web Historian (<code>dat</code>, cookies, temp), Magnet AXIOM 💰, Index.dat Analyser (<code>dat</code>), NetAnalysis 💰 (history), CacheBack (cookies and history), Encase💰 (cookies, history and bookmarks), FTK💰 (cookies, history and bookmarks), Autopsy (cookies, history and bookmarks).</p>
<h3 id="opera">Opera</h3>
<p><strong>Tools</strong> 🛠: Magnet AXIOM 💰❓, NetAnalysis 💰 (history), CacheBack (cookies and history), Encase💰 (cookies, history and bookmarks), FTK💰 (cookies, history and bookmarks), Autopsy (cookies, history and bookmarks)❓.</p>
<h2 id="messangers">Messangers</h2>
<p>Electron is a framework that is available for building applications, cross-platform. You’re creating a web-application that can be used as a desktop one (implementing both back- and frontend). Backend - node.js, and frontend - Chrome. So, a lot of artifacts can be shared with Chrome and buddies. It’s in wide use. For example, ⚠️ WhatsApp and Skype use it.</p>
<h3 id="skype">Skype</h3>
<p><strong>Tools</strong> 🛠: Belkasoft EC, <a href="https://www.nirsoft.net/utils/skype_log_view.html">SkypeLogView</a> (NirSoft)</p>
<p><code>C:\Users\%Username%\AppData\Roaming\Skype</code>.</p>
<h3 id="xbox">Xbox</h3>
<p>Windows: <code>C:\Users\%Username%\AppData\Local\LocalState\ModelManager\Messaging</code>.</p>
<h2 id="devices-attached">Devices Attached</h2>
<h3 id="windows-3">Windows</h3>
<p>Are we looking for USB storage media activity or all USB devices? Like, cameras 📸? Headphones 🎧? As for the timestamps, you&rsquo;ll usually have <strong>first</strong> (setupapi log) and <strong>last</strong> connected. There are also OS specific timestamps, like first or last install, first connect since reboot etc. <a href="/docs/dfir/host/windows/windows-artifacts#usb-devices">Windows</a> USB artifacts, <a href="/docs/dfir/host/apple/mac-artifacts#usb-devices">macOS</a>. See Event Manager&rsquo;s codes <a href="docs/dfir/host/windows/event-manager#20001">20001</a> and <a href="docs/dfir/host/windows/event-manager#20002">20002</a> for USB events for verification or if the registry was updated. Look at <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceClasses\</code> and <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USB\&lt;hardware id&gt;\&lt;instance id&gt;\Device Parameters</code>. <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/usbcon/usb-device-specific-registry-settings">More</a>.</p>
<blockquote>
<p>⚠️ On Windows, USB timestamps in registry will be updated when the registry itself gets update with a Windows update. Use Event Manager logs in these cases.</p>
</blockquote>
<h3 id="macos-3">macOS</h3>
<p>On a macOS - tracev3 log file contains this information. On macOS remember about <code>0x5ac</code> Vendor ID! Check for the USB info using its GUIDs: <a href="https://the-sz.com/products/usbid/">https://the-sz.com/products/usbid/</a>.</p>
<blockquote>
<p>⚠️ Keep in mind that a lot of cheap USB drives might have the SAME serial number!!!</p>
</blockquote>
<p>Also, FSEvents can give you a lot of information. <strong>Tools</strong> 🛠: FSEventsParser.</p>
<h2 id="notifications">Notifications</h2>
<h3 id="windows-4">Windows</h3>
<p>Toast notifications on Windows 10: <code>C:\Users\%Username%\AppData\Local\Microsoft\Windows\Notifications</code> contains <code>wpndatabase.db</code> and <code>appdb.dat</code>. Both can be opened with 🛠 SQLite Browser.</p>
<h2 id="voice-assistants">Voice Assistants</h2>
<h3 id="windows-5">Windows</h3>
<p>Cortana is a great source of information. <code>C:\Users\%Username%\AppData\Local\Packages\Microsoft.Windows.Cortana_xxxx\LocalState\ESEDatabase_CortanaCoreInstance\CortanaCoreDb.db</code> contains user locations, reminders etc. Use a 🛠 SQLite browser to see the contents, or export to <code>cvs</code> and work in Excel.</p>
<h2 id="cloud-storage">Cloud Storage</h2>
<h3 id="windows-6">Windows</h3>
<p>For OneDrive the most useful artifacts are stored locally. If you get access to the account online - may see the deleted items and their versions. <code>C:\Users\%Username%\AppData\Local\Microsoft\OneDrive\logs</code>. This folder contains <code>Personal</code> and <code>Common</code>. Neither has anything of particular interest, but may be an indicator, that the software was used.</p>
<blockquote>
<p>⚠️ Business version of OneDrive adds a few lines of code to the start of every doc, thus MD5 hashes will differ.</p>
</blockquote>
<p>DropBox is another tool for storing content online and sharing it: <code>C:\Users\%Username%\AppData\Local\Microsoft\Dropbox</code>. The most interesting files are <code>filecache.db</code> (not deleted files and folders, encrypted by default) and <code>sigstore.db</code> (how large the file is). Use 🛠 Magnet Dropbox Decryptor to get the contents of the <code>filecache.db</code>. It also uses <code>config.db</code> containing user email and the most recently changed files. Deleted files are not kept locally. For free accounts they are kept online for 30 days, for pros - forever.</p>
<h2 id="screen-recordings">Screen Recordings</h2>
<h3 id="windows-7">Windows</h3>
<p>Xbox on later versions is a built-in game center. However, one of the features is used beyond gaming: screen recordings. <code>C:\Users\%Username%\XboxApp\GameDVR\OnThisPC\Videos\Captures</code>.</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
