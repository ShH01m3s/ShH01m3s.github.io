<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â›…ï¸ AWS Evidence Collection - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.eeb61b3f25f73088eb3aeb02bc61f28d33975f447fc5649add3b83c10059c331.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/investigation/collection/"> Back to ğŸ—³ Evidence Collection And Preservation Section ğŸ‘ˆğŸ¼ </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#cloud-forensic-evironment">Cloud Forensic Evironment</a>
      <ul>
        <li><a href="#how-to-stream-logsdata-to-forensic-account">How to stream logs/data to forensic account?</a></li>
      </ul>
    </li>
    <li><a href="#evidence">Evidence</a>
      <ul>
        <li><a href="#ec2-instance-metadata">EC2 instance metadata</a></li>
        <li><a href="#amazon-ebs-disk-snapshots">Amazon EBS disk snapshots</a></li>
        <li><a href="#ebs-disks-streamed-to-s3">EBS disks streamed to S3</a></li>
        <li><a href="#memory-dumps">Memory dumps</a></li>
        <li><a href="#memory-hibernation">Memory hibernation</a></li>
        <li><a href="#cloudtrail-logs">CloudTrail logs</a></li>
        <li><a href="#aws-config-rule-findings">AWS Config rule findings</a></li>
        <li><a href="#amazon-route-53">Amazon Route 53</a></li>
        <li><a href="#dns-resolverquery-logs">DNS resolverÂ query logs</a></li>
        <li><a href="#vpc-flow-logs">VPC Flow Logs</a></li>
        <li><a href="#aws-security-hubfindings">AWS Security HubÂ findings</a></li>
        <li><a href="#elastic-load-balancing-access-logs">Elastic Load Balancing access logs</a></li>
        <li><a href="#aws-waf-logs">AWS WAF logs</a></li>
        <li><a href="#custom-application-logs">Custom application logs</a></li>
        <li><a href="#system-logs">System logs</a></li>
        <li><a href="#security-logs">Security logs</a></li>
        <li><a href="#any-third-party-logs">Any third-party logs</a></li>
      </ul>
    </li>
    <li><a href="#heading"></a></li>
    <li><a href="#confusing-terms">Confusing Terms</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">â›…ï¸ AWS Evidence Collection</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-search"></i>
              
          <a class="category-link" href="/domain/forensics">forensics</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <h2 id="cloud-forensic-evironment">Cloud Forensic Evironment</h2>
<p>First of all, data that is collected for analysis within the cloud needs to be handled properly as well. For this purpose a separate account is created. There are several roles there that all have different purpose and rights:</p>
<ul>
<li>
<p><input disabled="" type="checkbox"> <strong>Responder</strong> â€“ acquire evidence</p>
</li>
<li>
<p><input disabled="" type="checkbox"> <strong>Investigator</strong> â€“ analyze evidence</p>
</li>
<li>
<p><input disabled="" type="checkbox"> <strong>Data custodian</strong> â€“ manage (copy, move, delete, and expire) evidence</p>
</li>
<li>
<p><input disabled="" type="checkbox"> <strong>Analyst</strong> â€“ access forensics reports for analytics, trends, and forecasting (threat intelligence)</p>
</li>
</ul>
<p><strong>Below are the main considerations:</strong></p>
<ul>
<li><input disabled="" type="checkbox"> Granting access to either the account, or assuming the role needs to be approved by the owner of the IR plan. Preferably, there should be 2 approvers for this.</li>
<li><input disabled="" type="checkbox"> There should be no network traffic coming from or to this account. and therefore all S3 access must be done through anÂ <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-s3.html">S3 VPC endpoint</a>.Â </li>
<li><input disabled="" type="checkbox"> VPC flow logging should be enabled at the Amazon VPC level so that there are records of all network traffic.Â </li>
<li><input disabled="" type="checkbox"> <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html">Security groups</a>Â should be highly restrictive, and deny all ports that arenâ€™t related to the requirements of the forensic tools.</li>
<li><input disabled="" type="checkbox"> SSH and RDP access should be restricted and governed by auditable mechanisms such as aÂ <a href="https://aws.amazon.com/quickstart/architecture/linux-bastion/">bastion host</a>Â configured to log all connections and activity,Â <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html">AWS Systems Manager Session Manager</a>, or similar.</li>
<li><input disabled="" type="checkbox"> AMI chosen and pre-configured with industry-trusted tools. One of them would be</li>
</ul>
<h3 id="how-to-stream-logsdata-to-forensic-account">How to stream logs/data to forensic account?</h3>
<h2 id="evidence">Evidence</h2>
<h3 id="ec2-instance-metadata">EC2 instance metadata</h3>
<h3 id="amazon-ebs-disk-snapshots">Amazon EBS disk snapshots</h3>
<h3 id="ebs-disks-streamed-to-s3">EBS disks streamed to S3</h3>
<h3 id="memory-dumps">Memory dumps</h3>
<h3 id="memory-hibernation">Memory hibernation</h3>
<p>Memory hibernation captured through hibernation on the root EBS volume</p>
<h3 id="cloudtrail-logs">CloudTrail logs</h3>
<p>Stores most of the information about the things that happened in the Cloud (loggin, creating instances etc). Full logs are only seen in <code>json</code> format.</p>
<h3 id="aws-config-rule-findings">AWS Config rule findings</h3>
<h3 id="amazon-route-53">Amazon Route 53</h3>
<p><a href="https://aws.amazon.com/route53/">https://aws.amazon.com/route53/</a></p>
<h3 id="dns-resolverquery-logs">DNS resolverÂ query logs</h3>
<p><a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver-getting-started.html">https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver-getting-started.html</a></p>
<h3 id="vpc-flow-logs">VPC Flow Logs</h3>
<p><a href="https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html">https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html</a></p>
<h3 id="aws-security-hubfindings">AWS Security HubÂ findings</h3>
<p><a href="https://aws.amazon.com/security-hub/">https://aws.amazon.com/security-hub/</a></p>
<h3 id="elastic-load-balancing-access-logs">Elastic Load Balancing access logs</h3>
<p><a href="https://aws.amazon.com/elasticloadbalancing/">https://aws.amazon.com/elasticloadbalancing/</a></p>
<h3 id="aws-waf-logs">AWS WAF logs</h3>
<p><a href="https://aws.amazon.com/waf/">https://aws.amazon.com/waf/</a></p>
<h3 id="custom-application-logs">Custom application logs</h3>
<h3 id="system-logs">System logs</h3>
<h3 id="security-logs">Security logs</h3>
<h3 id="any-third-party-logs">Any third-party logs</h3>
<h2 id="heading"></h2>
<h2 id="confusing-terms">Confusing Terms</h2>
<p><strong>IAM</strong> - Identity Access Management. This is a service for creating users, groups, roles, permissions, policies.
Each individual using the AWS service needs to have a separate user in AWS associated with them. So, roughly speaking, user = person.
Each user can be in 1+ groups. Theoretically, a user can be not a part of any group, but when they are, itâ€™s easier to manage access and permissions.
Policies are a list of permissions that can be assigned to a group, user, role. Can be created via JSON (raw) or GUI.
Groups have the same permissions defined by purposes.
Roles are assigned to services within AWS. Something similar to groups?</p>
<h2 id="references">References</h2>
<p>[<a href="https://aws.amazon.com/blogs/security/forensic-investigation-environment-strategies-in-the-aws-cloud/">1</a>]] Forensic investigation environment strategies in the AWS Cloud</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
