<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Evidence Collection And Preservation Methodology - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.1af15d612be2936e296de738ed7062bbcecd3efedde8f895f919d76ce622691e.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-forensics 🔍 and incident response 🥷">
      <a href="/docs/dfir">
        <span>Forensics 🔍 and Incident Response 🥷</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting">
      <a href="/docs/thunting">
        <span>Threat Hunting</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-forensics 🔍 and incident response 🥷">
      <a href="/docs/dfir">
        <span>Forensics 🔍 and Incident Response 🥷</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting">
      <a href="/docs/thunting">
        <span>Threat Hunting</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/investigation/collection/"> Back to 🗳 Evidence Collection And Preservation Section 👈🏼 </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#evidence">Evidence</a></li>
    <li><a href="#toolkit-assembly-for-physical-acquisition">Toolkit Assembly For Physical Acquisition</a></li>
    <li><a href="#evidence-integrity">Evidence Integrity</a>
      <ul>
        <li><a href="#physical-integrity">Physical Integrity</a></li>
        <li><a href="#digital-integrity">Digital Integrity</a></li>
        <li><a href="#chain-of-custody">Chain Of Custody</a></li>
        <li><a href="#report">Report</a></li>
      </ul>
    </li>
    <li><a href="#acquisition">Acquisition</a></li>
    <li><a href="#-btfm">📘 BTFM</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Evidence Collection And Preservation Methodology</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-search"></i>
              
          <a class="category-link" href="/domain/forensics">forensics</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p>For each OS and system type there will be a separate section (see below). However, the main principles will remain the same.</p>
<p>There are two major types of acquisition: live 🍀 and dead ☠️. It&rsquo;s usually preferable to choose based on the initial state of the system in question. So, for example, if the system is turned on, perform live acquisition first, capturing all volatile data that will be deleted after reboot. Otherwise, jump right to the dead acquistion (if the system is shut down).</p>
<blockquote>
<p>⚠️ There are some caveats which need to be handled, though. For example, at the moment of this writing (📆 <code>11/07/2022</code>) macOS has introduces Share Disk mode for the newest M1 machines. Unlike the Target disk mode, which would treat the disk as external, making it possible to turn on the write blocker for it, this new mode is more like a network share and works over SMB (over the wire). This way that target disk won&rsquo;t show with <code>diskutil list</code> and thus all common procedures for write blocking won&rsquo;t work. I don&rsquo;t know yet if an ordinary physical write blocker will work since the mechanism is different. I have posted this question on <a href="https://www.forensicfocus.com/forums/general/apple-silicon-m1-chip-based-computers/">forensicfocus.com</a> but have not received any updates yet.</p>
</blockquote>
<h2 id="evidence">Evidence</h2>
<details>
    <summary>Expand &hellip;</summary>
    <blockquote>
<p>❗️Mind the scope when collecting the evidene. For example, you might not have permission to collect personal devices.</p>
</blockquote>
<p><strong>Obvious Physical Evidence</strong>. PC, cameras, flash drives, PDAs, removable media, mobile devices. Mind the chain of custody.</p>
<p><strong>Non-obvious Physical Evidence</strong>. Manuals for devices that were not found - look for these devices. Digital media taken with some device that was not found -look for this device. Sticky notes or liitle papers with scrambled notes.</p>
<p><strong>Cloud Evidence</strong>.</p>
<blockquote>
<p>⚠️ Do not forget the charger!</p>
</blockquote>

  </details>
<h2 id="toolkit-assembly-for-physical-acquisition">Toolkit Assembly For Physical Acquisition</h2>
<details>
    <summary>Expand &hellip;</summary>
    <ul>
<li>A PC technician&rsquo;s toolkit 🧰 (screwdrivers 🪛, squeezers, scissors✂️ , portable batteries 🔋and etc) to be able to remove HDD, lockdown cables etc) ✅.</li>
<li>Digital camera 📸  that embed timestamps on the photos. 📝 Take photos, the more the better!</li>
<li>Video camera 📹. 📝 Take a video, the longer the better.</li>
<li>For labeling and documenting (labels, markers, pens, 🖊, evidence tape 🚧).</li>
<li>Transporting and managing evidence 💼 (Faraday bag , Anti-static bag, evidence log, large envelopes ✉️,  gloves🧤, sanitizer, ).</li>
<li>Documents (chain of custody, notes 🗒, warrants/subpoenas).</li>
<li>Digital forensics specifics (forensics software, write blockers, laptop 💻, sterilize target media, flash drives for live/dead acquisition, bootable, Apple USB Type-C wires).</li>
</ul>

  </details>
<h2 id="evidence-integrity">Evidence Integrity</h2>
<p>One of the most important parts is to ensure evidence integrity. Hashing and Chain of Custody (CoC) exist for this purpose. You can always video record all you are doing on the screen as well, commenting every step. Evidence also need to be transported and stored in a safe way.</p>
<h3 id="physical-integrity">Physical Integrity</h3>
<p>Don’t contaminate the scene itself (try not to be tempted to eat buiscuits 🍪 and burgers 🍔 on the scene, however hard that might seem). This means, that you should also preserve the physical evidence as well. Don’t touch ANYTHING before the lead investigator says “OK” 👍. Always mind the scope and get it in writing even if it’s not a crimial case. Do fingerprints need to be collected? DNA?</p>
<p>Package the evidence for transport. Transport the evidence. Store the evidence while in possession. Use Faraday bags for avoiding remote tampering, anti-static and plastic bags as a protection from discharge and moisture. Tape and seal the bags with the evidence.</p>
<h3 id="digital-integrity">Digital Integrity</h3>
<p>For dead acquisition it&rsquo;s quite simple:</p>
<ul>
<li><input disabled="" type="checkbox"> you calculate the hash of the drive before imaging it</li>
<li><input disabled="" type="checkbox"> you image the drive</li>
<li><input disabled="" type="checkbox"> you get the hash of the image</li>
<li><input disabled="" type="checkbox"> whenever you copy this image, you get the copy&rsquo;s hash as well</li>
</ul>
<p>All of the steps are recorded in the report and the CoC.</p>
<p>For live acquisition it becomes trickier.</p>
<p>Live system is changing all the time. At all times keep in mind the <a href="https://www.sciencedirect.com/topics/social-sciences/exchange-principle#:~:text=Locard's%20Exchange%20Principle%20states%20that,pollen%2C%20paint%2C%20and%20soil." title="https://www.sciencedirect.com/topics/social-sciences/exchange-principle#:~:text=Locard's%20Exchange%20Principle%20states%20that,pollen%2C%20paint%2C%20and%20soil.">Locard&rsquo;s Exchange Principle</a>. It basically states, that when two entities get in contact, they leave the evidence on each other. For DF field that means that the investigator will leave traces of their activity when working with the system. This might even result in overwritting some information. That&rsquo;s why it&rsquo;s important to keep as low profile as you can. That&rsquo;s why you need to know, how &ldquo;noisy&rdquo; the tool is, how many files it writes to the disk, how much RAM space it needs. It&rsquo;s called footprint 🐾. To see how much data is being written to the disk or how much space is occupied in RAM (this overwriting some portion of this RAM), open Task Manager or Activity Monitor ot htop etc, whatever tool is working for this OS. Make note of the &ldquo;Memory&rdquo; and &ldquo;Disk&rdquo; columns, run the utility and see, how heavy the footprint is. For example, Belkasoft RAM Capturer for RAM acquisition has a ~4Mb footprint. Magnet RAM Capturer - huge footprint. Dumpit - the fastest, the smallest footprint. That&rsquo;s why tools need to be checked and tested on a regular basis before the investigation.</p>
<p>Block any network connection, Bluetooth and alike while on the scene to avoid remote wiping. Look for running wiping software or kill switches.</p>
<p>Use the latest industry acceptable hashing algorithms (at least SHA-256). Even though collisions might not be that probable, DF is usually about the court and if you use MD5, for example, this might be used in an attempt to discredit your work. The best practice is to use several hashing algorithms (especially, when automating the process). If there are any arguments around the one of the hashing algorithms that you&rsquo;ve been using, you&rsquo;d always have another one to backup your process sanity.</p>
<blockquote>
<p>❗️Sometimes a tool might produce different hash. It might be due to the bug in the code. That&rsquo;s why it&rsquo;s important to validate the tools. It&rsquo;s always better to use built-in Linux or macOS hashing tools (<code>shasum</code>, for example). For more examples see the Tools section.</p>
</blockquote>
<p>To prevent battery loss (in case we need the device to be on), keep the device connected to the power supply (for example, portable).</p>
<blockquote>
<p>⚠️ Turning off might trigger encryption!</p>
</blockquote>
<h3 id="chain-of-custody">Chain Of Custody</h3>
<details>
    <summary>Expand &hellip;</summary>
    <p>❓Where the evidence was found
❓Time and date the evidence was collected       <br>
❓Who found the evidence                      <br>
❓Description of the evidence<br>
❓Make, model, and S/N of device (if applicable)</p>
<blockquote>
<p>📝 I think, one of the best ways to keep Chain of Custody is on Google Drive or something alike. This way we have a histrory of changes and who has made them. Another way would be to use GitHub.</p>
</blockquote>
<h4 id="identify-the-evidence">Identify the evidence</h4>
<p>Assign IDs for each evidence. For example, for a flash drive it would look like this. FD (flash drive) + its <em>sequence number</em> within this case + case number. Subsequent images of these devices will have the same number + copy&rsquo;s sequence number.</p>
<p>Example: <em>A USB Flash drive was found on the scene during case study 0124. It was the first USB drive found yet. This device was assigned a number FD-01-0124. Then we made two bit-by-bit copies of this drive and these were assigned numbers FD-01-0124-01 and FD-01-0124-02 respectively.</em></p>

  </details>
<h3 id="report">Report</h3>
<details>
    <summary>Expand &hellip;</summary>
    <p>Keep track of all the steps taken, reason for these steps and the outcome. Document the physical condition (mouse to left or right as the owner is a lefty or a righty), applications running, keep audio notes. Make photos and videos, make notes. Maintain the Chain of Custody at all times.</p>
<p>Reports are often read by those who are not very techie. Besides, you would want your report to be usable at court, should the need arise.</p>
<p>This is also a crucial part to share the findings, IOCs and info about threat actors with the threat hunting team 🔪 .</p>
<p>The final report should contain the following:</p>
<ul>
<li>case summary (who requested, who&rsquo;s in charge, principles involved, when did the incident occur, when was this report filed, what allegedly happened, copies of all legal authorizations to proceed);</li>
<li>Authorizations (original request in writing, warrants, subpoenas, written permissions);</li>
<li>procedural docs (inventory of items examined and chain of custody for each, tools used, timeline of procedures, list of people performing these procedures, hashed before and after);</li>
<li>case notes (all logs extracted from the target system and from the forensic tools, a diagram of network where investigation occurred (sometimes));</li>
<li>what physical evidence were collected (videos, pics, copies of docs, interview transcripts);</li>
<li>conclusion (ties all together, supports or refuses the original claim, does NOT prove guilt/innocence).</li>
</ul>
<p>Make electronic copies of the report. An archive copy is maintained by the team. DVDs for distribution. Copies of written docs are filed. A summary report is provided along with timelines and written + electronic docs.</p>
<h4 id="photos-and-videos">Photos And Videos</h4>
<p>First, make sure that timestamps are configured on both devices. Take as many photos and videos as possible. Take overall and close-up photos. Make sure that all the connections between the devices are photographed clearly. Photograph the evidence in situ (if possible).</p>

  </details>
<h2 id="acquisition">Acquisition</h2>
<p><a href="http://www.cyber-forensics.ch/acquiring-data-with-dd-dcfldd-dc3dd/">http://www.cyber-forensics.ch/acquiring-data-with-dd-dcfldd-dc3dd/</a></p>
<h2 id="-btfm">📘 BTFM</h2>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
