<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏺 Credentials - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/artefacts/win/"> 👈🏼 Back to </br> 🪟 Windows Artefacts </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#-clear-text-creds">🗝️ Clear Text Creds</a>
      <ul>
        <li><a href="#-tspkg-and-wdigest">🏺 <code>TsPkg</code> and <code>Wdigest</code></a></li>
      </ul>
    </li>
    <li><a href="#-tokens">🗝️ Tokens</a></li>
    <li><a href="#-lm-and-nt-hashes">🗝️ LM and NT Hashes</a>
      <ul>
        <li><a href="#lm--deprecated">LM (⛔️ deprecated)</a></li>
        <li><a href="#ntlm">NTLM</a></li>
        <li><a href="#ntlmv2">NTLMv2</a></li>
      </ul>
    </li>
    <li><a href="#-tickets">🗝️ Tickets</a></li>
    <li><a href="#-attacks">⚔️ Attacks</a></li>
    <li><a href="#-detection-and--investigation">🔔 Detection and 🔎 Investigation</a></li>
    <li><a href="#-defense">🛡️ Defense</a>
      <ul>
        <li><a href="#important-security-patches">Important Security Patches</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">🏺 Credentials</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 09.06.2023
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p><em>This article is about credentials, the keys to the realm.</em></p>
<h2 id="-clear-text-creds">🗝️ Clear Text Creds</h2>
<p>Clear text creds are usually stored in memory. This memory usually belongs to some processes. For example, <code>lsass</code>, <code>tspkg</code>,<code> </code>wdigest`.</p>
<h3 id="-tspkg-and-wdigest">🏺 <code>TsPkg</code> and <code>Wdigest</code></h3>
<blockquote>
<p>❗️ <code>TsPkg</code> and <code>WDigest</code> can be decrypted to retrieve plaintext passwords.</p>
</blockquote>
<p><code>TsPkg</code> (Terminal Services Package): TsPkg is a security package used in Microsoft Windows operating systems. It is part of the authentication process for Remote Desktop Services (formerly known as Terminal Services). TsPkg is responsible for negotiating and exchanging credentials between the client and the server during the remote desktop session initiation.</p>
<p><code>Wdigest</code>: Wdigest is a Windows security package that handles storing and retrieving user credentials (such as usernames and passwords) for Windows authentication. It was primarily used in older versions of Windows, including Windows 7 and earlier. Wdigest stored user passwords in a less secure format than newer authentication protocols. As a result, it became a target for potential security vulnerabilities, leading to its deprecation in later versions of Windows. <code>WDigest.dll</code> was introduced in the Windows XP operating system The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges, as documented in RFCs <code>2617</code> and <code>2831</code>.”</p>
<p>To prevent WDigest credentials from being stored in memory, a Group Policy setting can be applied to the UseLogonCredential registry entry under the following subkey:</p>
<p><code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurityProviders\WDigest</code></p>
<ol>
<li>If the <code>UseLogonCredential</code> value is set to <code>0</code>, <code>WDigest</code> will not store credentials in memory.</li>
<li>If the <code>UseLogonCredential</code> value is set to <code>1</code>, <code>WDigest</code> will store credentials in memory.</li>
</ol>
<h2 id="-tokens">🗝️ Tokens</h2>
<p>With tokens, one can pretend to be someone else. This is how SSO works. These tokens have some attributes assigned to them. Some attributes, like  <code>SeImpersonate</code>, let one process access the context or tokens of another process.</p>
<p>Each logon and process in the system has a token. This token determines what privileges this fellow has. This token consists of:</p>
<ul>
<li>User SID</li>
<li>Group SID</li>
<li>Integrity level (mandatory label). Vista+/WinServer 2008+. This label determines the process&rsquo;s privileges based on the assigned accesses and groups.</li>
<li>Logon session SID</li>
<li>Token type (primary or impersonation)</li>
<li>Impersonation level</li>
<li>User privileges list</li>
<li>Other</li>
</ul>
<p>Checks:</p>
<ul>
<li><input disabled="" type="checkbox"> <em>What is your mandatory label❓</em>
<ul>
<li><input disabled="" type="checkbox"> Compare this label to the object&rsquo;s label.</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Take User and Group SIDs of the process and ACL of the object in question.</li>
</ul>
<p>📚 <a href="https://www.socinvestigation.com/how-to-detect-windows-sensitive-privilege-manipulation/">docs</a></p>
<p><code>SeDebugPrivilege</code> - allows one process to access the memory space of another process (for example, RAM dumpers need that privilege).
<code>SeDelegateSessionUserImpersonatePrivilege</code> - pretend to be others on the same system. Often used legitimately when a service acts from the user&rsquo;s behalf.</p>
<h2 id="-lm-and-nt-hashes">🗝️ LM and NT Hashes</h2>
<h3 id="lm--deprecated">LM (⛔️ deprecated)</h3>
<p>LM hashes were used a long time ago and were very weak. They used DES and the following algorithm to secure a password.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Step 0. The length is at most 14 characters long</span>
</span></span><span class="line"><span class="cl"><span class="n">password</span> <span class="o">=</span> <span class="n">password</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">14</span><span class="p">]</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 1. Convert all characters to uppercase</span>
</span></span><span class="line"><span class="cl"><span class="n">password</span> <span class="o">=</span> <span class="n">upper</span><span class="p">(</span><span class="n">password</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">pwd_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_caps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">hash</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_caps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 2. pad with 0s if the length is less than 14</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="o">-</span><span class="n">pwd_len</span><span class="p">):</span> <span class="nb">hash</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 3. Split the password into two strings, each consisting of seven characters, and encrypt both parts individually.</span>
</span></span><span class="line"><span class="cl"><span class="n">first_part</span> <span class="o">=</span> <span class="n">encrypt_des</span><span class="p">(</span><span class="nb">hash</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span> 
</span></span><span class="line"><span class="cl"><span class="n">second_part</span> <span class="o">=</span> <span class="n">encrypt_des</span><span class="p">(</span><span class="nb">hash</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">all_caps</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 4. Return a concatenated string.</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="n">first_part</span> <span class="o">+</span> <span class="n">second_part</span>
</span></span></code></pre></div><p>The root cause of the vulnerability in the LM hash is the practice of padding the password with a known value (<code>0</code>s) and encrypting the two parts separately. This vulnerability becomes evident when the password length is equal to or less than 7 characters. In such cases, the second part of the string will always be the same value: <code>AAD3B435B51404EE</code>. As a result, passwords with a length of 7 characters or less are easier to crack due to this predictable pattern. One would need a rainbow table to do that.</p>
<h3 id="ntlm">NTLM</h3>
<p>DES + MD4 until SP3</p>
<h3 id="ntlmv2">NTLMv2</h3>
<p>MD5 <code>[username][sids][LM][NTLM]</code></p>
<blockquote>
<p>❗️LM hash is not generated if the password length is less than 15.
❗️Passwords are not salted.</p>
</blockquote>
<blockquote>
<p>❗️It is advisable not to utilize CredSSP on machines running an operating system older than Windows 8 when using batch scripts, as CredSSP caches credentials on remote systems. Additionally, CredSSP sends credentials over the network, making it vulnerable to Man-in-the-Middle (MiM) attacks.</p>
</blockquote>
<p>Each process, file or any other object has a set of requirements. For some process to get access, it needs to fulfil these requirements. At the same time, these processes have passports or tickets 🎫 which they can use to get something or somewhere. Requirements are called <strong>security descriptors</strong>; these &ldquo;passports&rdquo; are called <strong>access tokens</strong>. More information about both can be found <a href="https://docs.microsoft.com/en-us/windows/win32/secauthz/access-tokens">here</a> and here.</p>
<p>Access tokens can have the following information (not limited):</p>
<ul>
<li>(SID) for the user&rsquo;s account or/and a group and their privileges</li>
<li>ID for current logon session - logon SID</li>
<li>Owner SID</li>
<li>The source of the access token</li>
<li>Primary or impersonalisation token?</li>
<li><strong>Integrity level</strong></li>
</ul>
<p>Security Descriptors also have a set of fields in it:</p>
<ul>
<li><strong>Integrity level</strong></li>
<li>SID of the owner or group</li>
<li>DACL (list of users allowed and what they can do)</li>
<li>SACL (list of access attempts that will generate alerts ⚠️)</li>
</ul>
<h2 id="-tickets">🗝️ Tickets</h2>
<p>Kerberos tickets are valid for 10 hours and stored in RAM. For more info on Kerberos and its abuse, see the article in attacks -&gt; protocols section.</p>
<p>🛠️ <code>Mimikatz</code>, 🛠️ <code>WCE</code>, 🛠️ <code>kerberoast</code></p>
<p><strong>📕 RTFM</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mimikatz &gt; privilege::debug
</span></span><span class="line"><span class="cl">mimikatz &gt; kerberos::ptt <span class="o">[</span>ticket<span class="o">]</span>
</span></span><span class="line"><span class="cl">mimikatz &gt; <span class="nb">exit</span>
</span></span><span class="line"><span class="cl">klist <span class="c1"># see the cache</span>
</span></span></code></pre></div><h2 id="-attacks">⚔️ Attacks</h2>
<blockquote>
<p>❗️Hashes are only present in RAM if the user is logged in <strong>interactively</strong> and is still logged in.</p>
</blockquote>
<ol>
<li><strong>Get the creds</strong> 🛠️ <code>fgdump</code>, c <code>AceHash</code>, 🛠️ <code>PWDumpX</code>, 🛠️ <code>creddump</code>,🛠️ <code>WCE</code>
<ol>
<li>Get from LSASS 🛠️ <code>Mimikatz</code> or <code>WCE</code> (Windows Credential Editor).</li>
<li>Dump LSASS for the offline attack.</li>
<li>Get from SAM hive in RAM or on disk 🛠️ <code>gsecdump</code> ❓ <code>gsecdump.exe -a &gt; file.txt</code></li>
<li>Get from the cache with 🛠️ <code>creddump</code>. One can get hashes, cached creds and LSA secrets from the hive.
<ol>
<li>📕 <code>pwdump.py SYSTEM SAM true</code> -&gt; local NT hashes.</li>
<li>📕 <code>cachedump.py SYSTEM SECURITY true</code> -&gt; Cached hashes.</li>
</ol>
</li>
<li>Get LSA secrets from</li>
</ol>
</li>
<li><strong>Crack the hash</strong> with the tools like 🛠️ <code>hashcat</code> or 🛠️ <code>John-the-Ripper</code>. LM hashes are very weak (see LM hash section). Both 🛠️ <code>John the ripper</code> and 🛠️ <code>hashcat</code> can crack hashes extracted from the cache, but the password needs to be very, very easy or in the wordlist. Otherwise - inefficient.</li>
<li><strong>Pass-the-hash</strong>. Use the hash in its original form. 🛠️ <code>Metasploit PsExec</code>, 🛠️ <code>WCE</code>, 🛠️ <code>SMBshell</code>. Limited to NTLM challenge-response protocol. Typically, use the SMB protocol to map file shares and perform PsExec-style remote execution or WMI. 📕 <code>sekurlsa::pth /user:someuser /domain:domaincontrollername /ntlm:hashstolen /run:&quot;.\psexec.exe -accepteula \\IP cmd.exe&quot;</code>.</li>
<li><strong>Escalate</strong>.
<ol>
<li><strong>Attribute change.</strong> With admin or <code>SYSTEM</code> privileges, one can add <code>SeImpersonate</code> attribute to a token to steal the tokens of another process and use them to access resources they could not access otherwise 🛠️ <code>Incognito</code>, 🛠️ <code>Metasploit</code>, 🛠️ <code>PowerShell</code>, 🛠️ <code>Mimikatz</code></li>
<li><strong>RID Hijacking</strong>. The system identifies users by their RIDs (the last portion of SID), not by username. What happens if we have manually changed the RID of the guest user? If we set it to <code>500</code>, the system would treat him as the default admin with all the corresponding rights.</li>
</ol>
</li>
<li><strong>Reset Password.</strong> There is also a technique that allows resetting local account passwords by clearing <code>lmpw_len</code> (LM password hash length) and <code>ntpw_len</code> (NTLM password hash length) at <code>0x2c</code> and <code>0x30</code>, respectively [<a href="http://www.ijfcc.org/vol5/455-F005.pdf">8</a>].</li>
</ol>
<p>📕 <strong>RTFM</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Changing TOKENS&#39; attributes</span>
</span></span><span class="line"><span class="cl">mimikatz &gt; privlege::debug <span class="c1"># attacker being authenticated as a local admin adds debug attribute to his token</span>
</span></span><span class="line"><span class="cl">token::whoami
</span></span><span class="line"><span class="cl">token::elevate /domainadmin <span class="c1"># mimikatz tool looks for the domain admin token in memory and retrieves it.</span>
</span></span></code></pre></div><h2 id="-detection-and--investigation">🔔 Detection and 🔎 Investigation</h2>
<p>🏺 <strong>Artefacts</strong></p>
<p>Event logs</p>
<p>🐾 <strong>Detection Patterns</strong></p>
<ol>
<li>New accounts created (Windows <code>4720</code>)</li>
<li>Anomalous logins (workstation to workstation, sensitive networks) - <code>4624</code>, <code>4776</code></li>
<li>After-hours logins</li>
<li>Unusual locations</li>
<li>Ex-employees</li>
<li>Privileged account usage (Windows <code>4672</code>)</li>
<li>Watch out for registry key 🔑<code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SecurityProviders\WDigest\UseLogonCredential</code> set <code>1</code>.</li>
</ol>
<p><strong>By login type</strong></p>
<ol>
<li>Console login, RunAs, PsExec alternate creds - look for logon type <code>2</code>.</li>
<li>Network use, PowerShell remoting (<code>Invoke-Command</code> and <code>Enter-PSSession</code>), PsExec alternate creds, PsExec w/o explicit creds and Remote registry - type <code>3</code>.</li>
<li>Remote Desktop - <code>10</code>.</li>
<li>Remote Scheduled tasks - <code>4</code> (password saved as LSA secret).</li>
<li>Run as Service - <code>5</code> (password saved as LSA secret).</li>
</ol>
<p>📚 <strong>Further reading</strong>: <a href="https://learn.microsoft.com/en-us/security/privileged-access-workstations/privileged-access-access-model">https://learn.microsoft.com/en-us/security/privileged-access-workstations/privileged-access-access-model</a></p>
<h2 id="-defense">🛡️ Defense</h2>
<p>PowerShell remoting is, so far, the most secure option. It enables Remote Credential Guard by default.</p>
<ol>
<li>UAC (MAC + least privilege).</li>
<li>A small number of apps should require admin privileges.</li>
<li>Managed Service accounts (good defence against Kerberos attacks): long complex passwords, frequent password changes. -&gt; Group Managed Service Accounts (flexible and admin-friendly).</li>
<li>Windows 8+
<ol>
<li>Doesn&rsquo;t cache credentials (even when using CredSSP), <code>TsPkg</code>, <code>Wdigest</code>.</li>
<li>New security groups were added. This restricted local admins from the network or remote interactive logons to domain-joint systems.</li>
<li>Some processes are marked as protected, and protected processes can&rsquo;t run unsigned code. LSASS process is one of the most important ones. This protection is off by default + one can sign the cred-dumping malware (like 🛠️ <code>Mimikatz</code>).</li>
<li>Remote Desktop with <code>/restrictedAdmin</code> switch -&gt; creds are not pushed to the remote system.</li>
<li>Domain Protected Users, security group. They can&rsquo;t use NTLM, CredSSP or Digest authentication mechanisms (protection against some of the 🛠️ <code>Mimikatz</code> techniques and pass-the-hash tools). Creds are not cached, nor are they delegated. Kerberos ticket 🎫 lives for 4 hours tops. RC4 encryption is off (too weak).</li>
<li>Group Managed Service accounts (gMSA). With GMSA, one can use the same account for several services and can be used on multiple computers within the same domain. MSA and gMSA automate password management for services (managed by AD), eliminate the need to hardcode the credentials, adhere to the least privilege principle, and isolate service accounts.</li>
</ol>
</li>
<li>Windows 10+
<ol>
<li>Remote Credential Guard. Protects all the accounts, not only admin.</li>
<li>Credential Guard. Uses machine virtualisation to isolate creds.</li>
<li>Device Guard. Can lock a system to prevent the use of untrusted code.</li>
</ol>
</li>
<li>User PowerShell</li>
<li>Don&rsquo;t interact logon to remote machines with an admin account (console, RDP and <code>runas</code>).</li>
<li>Terminate RDP sessions properly. The disconnect is NOT closed. You can set a timeout to terminate disconnected sessions. This can be set via Group Policy.</li>
<li>Assign <code>Account is Sensitive and Cannot be Delegated</code> attribute to prevent token delegation.</li>
<li>Limit the number of cached logon accounts in <code>SOFTWARE\Microsoft\Windows NT\Current Version\WInlogon</code>, <code>cachedlogonscount</code> value. Be careful, though, services need cached creds.</li>
<li>Complex passwords.</li>
<li>Add valuable users to the domain-protected users&rsquo; security group, not cache creds.</li>
</ol>
<p><strong>Built-in</strong>:</p>
<ol>
<li>can&rsquo;t remotely write to <code>C$</code> and <code>Admin$</code> shares</li>
<li>can&rsquo;t use some remote management tools like <code>schtasks</code>, <code>at</code>, <code>wmic</code> (if it&rsquo;s disabled).</li>
</ol>
<p><strong>Custom</strong>:</p>
<ol>
<li>Unique, strong passwords</li>
<li>No network logins for these accounts</li>
<li>2FA?</li>
</ol>
<h3 id="important-security-patches">Important Security Patches</h3>
<ol>
<li>KB2871997 - no clear text in LSASS, two security groups are created.</li>
<li>KB2928120 - The security update modifies the Group Policy Management Editor window of the Group Policy Management Console (GPMC) by removing the ability to configure and distribute passwords using the following Group Policy Preferences extensions.</li>
</ol>
<p>📚 <strong>Further reading</strong>: <a href="https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/the-importance-of-kb2871997-and-kb2928120-for-credential/ba-p/258478">https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/the-importance-of-kb2871997-and-kb2928120-for-credential/ba-p/258478</a></p>
<h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    <p>[<a href="https://www.youtube.com/watch?v=hilLHF37ng8">1</a>] RID Hijaking by Sergey Klevogin, LPT Mater</p>
<p>[<a href="http://www.ijfcc.org/vol5/455-F005.pdf">2</a>] Analysis the Structure of SAM and Cracking Password Base on Windows Operating System, by Jiang Du and Jiwei Li</p>
<p>[<a href="https://www.youtube.com/watch?v=2Aa9_yq4BX4&amp;t=1s">3</a>] Вниз по кроличьей норе как работает аутентификация LSA, или Под капотом системы безопасности Windows,  Артем Синицын</p>
<p>[<a href="https://www.youtube.com/watch?v=aCVdGUjP72Q">3</a>] Diving into Windows Logon Process</p>
<p>[<a href="https://docs.microsoft.com/en-us/windows-server/security/windows-authentication/credentials-processes-in-windows-authentication">4</a>]</p>
<p>[<a href="https://www.coursera.org/learn/cybersecurity-compliance-framework-system-administration/lecture/wHoeT/features-of-active-directory">1</a>] IBM Course on Coursera</p>

</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
