<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>RAM - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-dfir ğŸ”">
      <a href="/docs/dfir">
        <span>DFIR ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/artefacts/unix/"> ğŸ‘ˆğŸ¼ Back to </br> ğŸ ğŸ§ UNIX Artefacts </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#macos">macOS</a>
      <ul>
        <li><a href="#hibernation">hibernation</a></li>
        <li><a href="#swap">Swap</a></li>
        <li><a href="#vmem">VMEM</a>
          <ul>
            <li><a href="#parallels">Parallels</a></li>
            <li><a href="#vmware">VMware</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#linux">Linux</a>
      <ul>
        <li><a href="#rootkits">Rootkits</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">RAM</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 01.06.2023
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p><em>This is about &hellip; .</em></p>
<h2 id="macos">macOS</h2>
<p><em>On the forensicswiki [<a href="https://forensicswiki.xyz/wiki/index.php?title=Tools:Memory_Imaging">1</a>], there is a list of tools to be used for RAM acquisition. Iâ€™ve tried several of them and realised that the current problem in the forensic community is that the tools get old much faster than the information gets updatedâ€¦ Sadly.</em></p>
<p><code>OSXPmem</code></p>
<p>Itâ€™s the part of <code>rekall</code>, <a href="https://code.google.com/archive/p/pmem/wikis/OSXPmem.wiki">download</a>. There are a few complications, though.</p>
<blockquote>
<p>âš ï¸ SIP needs to be disabled. Freeboot &gt; CMD+R &gt; Terminal &gt; csrutil disable &gt; reboot). Otherwise, you might run into this issue: dump_memory(833): Failed to load kext (No such process) âš ï¸ USB &gt; Get Info &gt; unlock ğŸ”’ &gt; Ignore ownership on this volume (check). Otherwise, you might run into this issue: Canâ€™t load kext ./pmem.kext, as it is not owned by root: wheel. Just chowning didnâ€™t work for me. When I unchecked it, replugged the USB, and decompressed the archive, I managed to get the dump without this error. â—ï¸ Restart the Terminal for changes to take place!</p>
</blockquote>
<blockquote>
<p>&hellip; load a driver to virtually recreate the /dev/mem device found in other Unix-type hosts. Sheward, Mike. Hands-on Incident Response and Digital Forensics (p. 161). BCS Learning &amp; Development Limited. Kindle Edition. â—ï¸ Requires <code>root</code>.</p>
</blockquote>
<blockquote>
<p>Beginning with Mac OS X (the predecessor to macOS) version 10.9, Apple implemented compression for physical memory. The aim of this was to reduce the amount of swap space used, improving performance and battery. Sheward, Mike. Hands-on Incident Response and Digital Forensics (p. 161). BCS Learning &amp; Development Limited. Kindle Edition.</p>
</blockquote>
<p>On the forensicswiki [<a href="https://forensicswiki.xyz/wiki/index.php?title=Tools:Memory_Imaging">1</a>] there is the list of tools to be used for RAM acquisition. Iâ€™ve tried several of them and realised, that the current problem of the forensic community is that the tools get old much faster than the information gets updatedâ€¦ Sadly.</p>
<p><code>OSXPmem</code></p>
<p>Itâ€™s the part of <code>rekall</code>, <a href="https://code.google.com/archive/p/pmem/wikis/OSXPmem.wiki">download</a>. There a few complications though.</p>
<p>âš ï¸ SIP needs to be disabled. Freboot &gt; CMD+R &gt; Terminal &gt; csrutil disbale &gt; reboot). Otherwise, might run into this issue: dump_memory(833): Failed to load kext (No such process) âš ï¸ USB &gt; Get Info &gt; unlock ğŸ”’ &gt; Ignore ownership on this volume (check). Otherwise, might run into this issue: Canâ€™t load kext ./pmem.kext, as it is not owned by root:wheel. Just chowning didnâ€™t work for me. When I unchecked it, replugged the USB, and decompressed the archive, I managed to get the dump without this error. â—ï¸ Restart the Terminal in order to changes to take place!</p>
<h3 id="hibernation">hibernation</h3>
<p>Get the hibernation settings - <code>pmset -g | grep hibernatemode</code>:</p>
<ul>
<li><code>0</code> â€“ Old style sleep mode, with RAM powered on while sleeping, safe sleep disabled, and super-fast wake.</li>
<li><code>1</code> â€“ Hibernation mode, with RAM contents written to disk, system totally shut down while â€œsleeping,â€ and slower wake up, due to reading the contents of RAM off the hard drive.</li>
<li><code>3</code> â€“ The default mode on machines introduced since about fall 2005. RAM is powered on while sleeping, but RAM contents are also written to disk before sleeping. In the event of total power loss, the system enters hibernation mode automatically.</li>
<li><code>5</code> â€“ This is the same as mode <code>1</code>, but itâ€™s for those using secure virtual memory (in System Preferences -&gt; Security).</li>
<li><code>7</code> â€“ This is the same as mode <code>3</code>, but itâ€™s for those using secure virtual memory.</li>
</ul>
<p>To set the hibernation to the <code>0</code> mode - <code>sudo pmset -a hibernatemode 0</code>. To see the file - <code>ls -lh /private/var/vm/sleepimage</code>. On Mac with M1 hibernation was enabled only in 11.3 (<a href="https://apple.stackexchange.com/questions/416108/how-to-enable-hibernation-on-m1-mac">see</a>). On Intel MacBook the hibernate file&rsquo;s location can be retreived with <code>pmset -g | grep hibernate</code>. Default mode - <code>3</code>.</p>
<h3 id="swap">Swap</h3>
<p>The same purpose as <code>pagefile.sys</code> for Windows.</p>
<blockquote>
<p>Rather than a single file, macOS can generate up to 10 different swap files, depending on need. These swap files can be found in the â€˜/private/var/vmâ€™ directory. This directory also contains a â€˜sleepimageâ€™ file, which is used to dump a copy of the RAM contents if the computer is put to sleep: something to be aware of, since this could provide a source of otherwise volatile evidence.</p>
</blockquote>
<h3 id="vmem">VMEM</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="err">ğŸ“˜</span> <span class="n">python3</span> <span class="n">vol</span><span class="p">.</span><span class="n">py</span> <span class="o">-f</span> <span class="n">1</span><span class="p">.</span><span class="n">vmem</span> <span class="n">windows</span><span class="p">.</span><span class="n">vadinfo</span><span class="p">.</span><span class="n">VadInfo</span> <span class="c"># to view Virtual Address Descriptors ([VAD](https://resources.infosecinstitute.com/topic/finding-enumerating-processes-within-memory-part-2/)).</span>
</span></span></code></pre></div><p><code>python3 vol.py -f 1.vmem windows.vadinfo.VadInfo</code> to view Virtual Address Descriptors (<a href="https://resources.infosecinstitute.com/topic/finding-enumerating-processes-within-memory-part-2/">VAD</a>).</p>
<h4 id="parallels">Parallels</h4>
<blockquote>
<p>â—ï¸ Even when sharing with the host is off, sometimes there are host ğŸ‘£ footprints in UserAssist and other artefacts.</p>
</blockquote>
<p>ğŸ¾ <code>.mem</code> - ram memory image.</p>
<h4 id="vmware">VMware</h4>
<blockquote>
<p>â—ï¸ Uses a more complex format that needs prior parsing, ESX.</p>
</blockquote>
<p>Each snapshot has a separate <code>.vmem</code> file. These are not raw memory dumps but contain everything that was in RAM then.</p>
<p>ğŸ¾ <code>.vmem</code> - ram memory
ğŸ¾ <code>.vmss</code> - VMware saved state
ğŸ¾ <code>.vmsn</code> - VMware snapshot</p>
<p>ğŸ“‚ <code>/Users/uname/Documents/VirtualMachines.localized/</code> (Fusion)</p>
<h2 id="linux">Linux</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/dev/mem <span class="c1"># raw</span>
</span></span><span class="line"><span class="cl">/proc/kcore <span class="c1"># debugging format</span>
</span></span></code></pre></div><h3 id="rootkits">Rootkits</h3>
<p>On a live system:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo chkrootkit
</span></span></code></pre></div><h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    <ol>
<li>Magnet</li>
<li>SDF Memory Forensics</li>
<li>Sheward, Mike. Hands-on Incident Response and Digital Forensics (p. 141). BCS Learning &amp; Development Limited. Kindle Edition.</li>
</ol>

</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
