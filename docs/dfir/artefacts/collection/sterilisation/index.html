<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧼 Media Sterilisation - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/artefacts/collection/"> 👈🏼 Back to </br> 🗳 Evidence Collection And Preservation </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#process">Process</a>
      <ul>
        <li><a href="#killdisk">KillDisk</a></li>
        <li><a href="#diskutil">diskutil</a></li>
      </ul>
    </li>
    <li><a href="#tools">Tools</a>
      <ul>
        <li><a href="#methodology-for-testing">Methodology for testing</a></li>
        <li><a href="#active-killdisk">Active@ KillDisk</a></li>
        <li><a href="#diskutil-1">diskutil</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">🧼 Media Sterilisation</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      <div class="article-category">
          
            
              <i class="fab fa-windows"></i>          
            
            
            
            
            
            
          
          
            
            
            
              <i class="fab fa-apple"></i>
            
            
            
            
          
          
            
            
              <i class="fab fa-linux"></i>
            
            
            
            
            
          
          
      </div> <br />
      

      
      <div class="article-category">
        <i class="fas fa-tools"></i>
          
          
          <a class="platform-link" href="/tools/diskutil">diskutil</a> 
          
           , 
          <a class="platform-link" href="/tools/hxd">HxD</a> 
          
           , 
          <a class="platform-link" href="/tools/active-killdisk">Active@ KillDisk</a> 
          
      </div> <br />
      
      

      
      <div class="article-tag">
          <i class="fas fa-tag"></i>
          
          
          <a class="tag-link" href="/tags/checklist" rel="tag">checklist</a>
          
      </div> 
      
    </div>
    
    <b>Created:</b> 12.10.2020
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p>Before copying evidence or making a disk image, one needs to sterilise the target media to ensure that data on that disk before this operation would not meddle with the evidence data. Several rounds of writing <code>0</code>s are usually enough.</p>
<h2 id="process">Process</h2>
<p>Keep in mind that flash drives and SSD work in different manners, and that&rsquo;s why simple permanent deletion of a file might deem it to be unrecoverable. However, it&rsquo;s not always the case (due to some optimisations implemented in the controller), that&rsquo;s why for compliancy&rsquo;s sake, you might still want to follow the below procedures.</p>
<h3 id="killdisk">KillDisk</h3>
<p>On Windows/Linux/macOS, you can use a <code>KillDisk</code> utility to <em>erase</em> it (not wipe, since wipe clears the unused space only). The best practice is to use three-pass zeros, but it&rsquo;s not included in freeware. You can still run the same command three times. On Mac you can also use <code>diskutil zeroDisk</code> or <code>diskutil randomDisk</code>. The first will fill the disk with <code>0</code> and the second - with random symbols.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">diskutil list <span class="c1"># to list all the attached and internal devices. Note the drive file name; it looks like /dev/disk[X], where X is a number. If you want to zero out just a volume instead of the whole physical drive, add the second identifier, for example, /dev/disk[X]s[Y], where X is the number of the physical drive and Y is the volume number within this disk.</span>
</span></span><span class="line"><span class="cl">diskutil zeroDisk /dev/disk4 <span class="c1"># this might take a while. The larger the disk, the more time is required.</span>
</span></span></code></pre></div><p>To verify that the disk was indeed sterilised on Windows, run <code>Analysis -&gt; Checksums -&gt; Checksum 64</code> in <code>HxD</code> hex editor (with admin rights).</p>
<blockquote>
<p>📝 Note that you can&rsquo;t use any hash algorithm for this procedure. Checksum64 will be the same for 1, 2, 30, and 10000 zeros. However, the hash will be different for different sizes of input data.</p>
</blockquote>
<p>For Checksum64, any input size will return the same output as soon as the data is repeated.</p>
<p><img src="images/crc641.png" alt="crc641">
Checksum for 0s, 1440 bytes selected. The result is the same, 0000000000000000.
<img src="images/crc642.png" alt="crc642">
Checksum for 0s, 3119 bytes selected. The result is 0000000000000000.</p>
<p>For MD5 hash, however, that is not the case. Note, that the selected areas are different in size and the resulting hash value is different as well.
<img src="images/md51.png" alt="md51">
MD5 hash for the selected 1920 bytes.
<img src="images/md52.png" alt="md52">
MD5 hash for the selected 3600 bytes. The value is different.</p>
<p>In case if you are exceptionally paranoid or have to be, and it&rsquo;s an HDD, one additional step before zeroing out everything would be making the whole process better: overwriting the contents with random data (<code>diskutil randomDisk</code>). You might be interested in adding this step because there are technologies that allow extracting residual magnetic data from a disk.</p>
<blockquote>
<p>😡 Once again, whenever I am trying to follow some instructions from the courses or books, there is something that goes wrong. This time is no exception. On opening the erased disk <code>HxD</code> alerts &ldquo;Insufficient rights even for administrator&rdquo;. What the hell 😡? If I partition the drive, it becomes accessible, but it&rsquo;s not WIPED!</p>
<p>✍️ Looks like either the drive was very old (and it was), or it doesn&rsquo;t work on partitions (logical drives). I&rsquo;ve used a newer drive, and I erased the whole disk without making any partitions.</p>
</blockquote>
<h3 id="diskutil">diskutil</h3>
<p><code>diskutil</code>, comes with macOS.</p>
<h2 id="tools">Tools</h2>
<h3 id="methodology-for-testing">Methodology for testing</h3>
<ul>
<li><input disabled="" type="checkbox"> Write several files to a drive.</li>
<li><input disabled="" type="checkbox"> Run the tool once, user zeroing option (overwrite all with zeros).</li>
<li><input disabled="" type="checkbox"> Use HxD for Windows to calculate the Checksum64 for the entire physical drive (should be all zeroes).</li>
<li><input disabled="" type="checkbox"> Use HxD or Active@ DistEditor to see if there is some garbage left.</li>
</ul>
<h3 id="active-killdisk">Active@ KillDisk</h3>
<p>Last Tool check: 📆 <code>17/07/2022</code>:</p>
<ul>
<li>✅ Windows
<ul>
<li>Active@ KillDisk 10.2.8</li>
<li>macOS Monterey 12.3.1 (21E258) - host.</li>
<li>Parallels Desktop 17 for Mac, Windows 11 - guest</li>
</ul>
</li>
<li>➖ Active@ KillDisk for macOS, Freeware, Version 14.0.</li>
</ul>
<h3 id="diskutil-1">diskutil</h3>
<p>Last Tool check: 📆 <code>17/07/2022</code>:</p>
<ul>
<li>✅ macOS Monterey 12.3.1 (21E258)</li>
<li>tool version unknown.</li>
</ul>
<p>After 1 round of <code>diskutik zeroDisk</code> has all <code>0</code> Checksum64; therefore, the cleanup works as expected for 1 round (flash drive).</p>
<h2 id="references">References</h2>
<p>[<a href="http://killdisk.com/dod.htm">1</a>] Standard DoD 5220.22-M, US DoD 5220.22-M (ECE)
[<a href="https://www.sipicorp.com/wp-content/uploads/2019/09/NIST_vs_DoD_V3.pdf">2</a>] NIST 800-88 VS DoD 5220.22-M
[<a href="https://www.blancco.com/resources/blog-dod-5220-22-m-wiping-standard-method/">3</a>] What is the DoD Standard (DoD 5220.22-M)?</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
