<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Countering Evasion Techniques 🦑 - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.d4a1e993184205048ef544a3f1a19bba5c1ed504c576865f63d8f21c8b606a10.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-forensics 🔍 and incident response 🥷">
      <a href="/docs/dfir">
        <span>Forensics 🔍 and Incident Response 🥷</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-forensics 🔍 and incident response 🥷">
      <a href="/docs/dfir">
        <span>Forensics 🔍 and Incident Response 🥷</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/dfir/incident-detection/"> Back to Incident Detection 🗒 Section 👈🏼 </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#vpn">VPN</a></li>
    <li><a href="#ip-spoofing">IP spoofing</a></li>
    <li><a href="#source-routing">Source routing</a></li>
    <li><a href="#proxies--anonymizers">Proxies / Anonymizers</a></li>
    <li><a href="#tor">TOR</a></li>
    <li><a href="#tcp-fragmentation">TCP fragmentation</a></li>
    <li><a href="#alternative-data-stream">Alternative data stream</a></li>
    <li><a href="#registry">Registry</a></li>
    <li><a href="#attributes">Attributes</a></li>
    <li><a href="#steganography">Steganography</a></li>
    <li><a href="#documents-meta">Documents Meta</a></li>
    <li><a href="#logs">Logs</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Countering Evasion Techniques 🦑</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-archive"></i>
              
          <a class="category-link" href="/domain/general">general</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
                <i class="fa fa-graduation-cap"></i>
              
          <a class="platform-link" href="/doctype/article">article</a>
          
      </div> <br /><br/>
      
      
      
      

      
      <div class="article-category">
        <i class="fas fa-tools"></i>
          
          <a class="platform-link" href="/tools/nmap">nmap</a>
          
          <a class="platform-link" href="/tools/ads">ADS</a>
          
      </div> <br />
      
      

      
      <div class="article-tag">
          <i class="fas fa-tag"></i>
          
          
          <a class="tag-link" href="/tags/network" rel="tag">network</a>
          
           ,  
          <a class="tag-link" href="/tags/vpn" rel="tag">vpn</a>
          
           ,  
          <a class="tag-link" href="/tags/evasion" rel="tag">evasion</a>
          
      </div> 
      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p>Evasion techniques and what possible forensic footprints they are likely to leave?</p>
<h2 id="vpn">VPN</h2>
<p>Virtual private network. As an additional bonus - avoid bandwidth throttling (when ISP cuts your speed or bandwidth for certain resources like torrents).s</p>
<p>Also useful on public networks.</p>
<p>![photo_2021-02-16 11.54.36](images/photo_2021-02-16 11.54.36.jpeg)</p>
<h2 id="ip-spoofing">IP spoofing</h2>
<h2 id="source-routing">Source routing</h2>
<h2 id="proxies--anonymizers">Proxies / Anonymizers</h2>
<h2 id="tor">TOR</h2>
<h2 id="tcp-fragmentation">TCP fragmentation</h2>
<p>Will look like garbage for IDS:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">nmap -sS -A -f &lt;target_IP&gt;
</code></pre></div><h2 id="alternative-data-stream">Alternative data stream</h2>
<p>Alternate data streams. Specific for Windows. See more <a href="/docs/articles/forensics/analysis/materials/artifactsdb/windows/win-ads">here</a>. Are there such streams for other OS? If yes, how to make them and discover them?</p>
<p>To ensure compatability between NTFS and HFS. Allows hiding files.</p>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="n">C:</span><span class="p">\</span><span class="nb">type </span><span class="n">C:</span><span class="p">\</span><span class="n">mal</span><span class="p">.</span><span class="n">exe</span> <span class="p">&gt;</span> <span class="n">C:</span><span class="p">\</span><span class="n">readme</span><span class="p">.</span><span class="n">txt</span><span class="err">:</span><span class="n">naughty</span><span class="p">.</span><span class="n">exe</span>
<span class="nb">start </span><span class="n">readme</span><span class="p">.</span><span class="n">txt</span><span class="err">:</span><span class="n">naughty</span><span class="p">.</span><span class="n">exe</span>
<span class="n">C:</span><span class="p">\</span><span class="n">mklink</span> <span class="n">innocent</span><span class="p">.</span><span class="n">exe</span> <span class="n">readme</span><span class="p">.</span><span class="n">txt</span><span class="err">:</span><span class="n">naughty</span><span class="p">.</span><span class="n">exe</span>

<span class="c"># to run</span>
<span class="n">innocent</span><span class="p">.</span><span class="n">exe</span>
</code></pre></div><p>But <code>dir /r</code> - will display <strong>all</strong> streams. LNS and Sfind will hunt down such files. Also, when you copy files from and to a FAT partition - all residual files will be deleted.</p>
<h2 id="registry">Registry</h2>
<p>Specific for Windows. See more <a href="/docs/articles/forensics/analysis/materials/artifactsdb/windows/win-registry">here</a> or <a href="https://www.notion.so/Windows-Registry-05f763c061b94572838c6c99fdc3ffe0">here</a>.</p>
<p>As an example, see <code>HKEY_USERS/Software/Microsoft/Internet Explorer/Scripts/1</code>. Doesn&rsquo;t have anything. Add Multistring value, name &ldquo;Hidden data&rdquo;, click key and start with random data like <code>0x111110000</code> to make it look legitimate, press many spaces to hide it from preview. Add some secret data, ignoring warnings about empty strings. Now, it will be difficult to find this.</p>
<blockquote>
<p>💡 Interesting idea for security policies. Everyday automatically run RegShot upon system start and before turning off to see the changes everyday. In case of an incident, there might be very helpful. How costy would that tactics be?</p>
</blockquote>
<h2 id="attributes">Attributes</h2>
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="n">attrib</span> <span class="p">+</span><span class="nb">h
</span></code></pre></div><h2 id="steganography">Steganography</h2>
<h2 id="documents-meta">Documents Meta</h2>
<p>Possible for any OS. Examples for Windows might include macros. For Office doc - <code>File -&gt; Info -&gt; Comments</code>. Click file and properties -&gt; Details. Other fields can be used to store information. In case of Office docs, most of the data is not the contents, but formatting and metadata. When adding comments, file&rsquo;s last accessed and modified dates are updates and the file size is increased.</p>
<p><strong>Tools</strong> 🛠:</p>
<ul>
<li><a href="https://new.thepaynegroup.com/metadata-assistant">Metadata Assistant</a>. Commercial. Not too expensive. bulb 💡 <em>May be I should write a python tool that does the same?</em></li>
</ul>
<h2 id="logs">Logs</h2>
<p>Logs can be disabled, cleared or tamprered. The noisest is to diable them or clear. Although the evidence is deleted this way, this is a very strong indicator that the sysmtem <strong>was</strong> compromised.</p>
<ol>
<li>application <code>APPEVENT.EVT</code></li>
<li>system <code>SYSEVENT.EVT</code></li>
<li>security <code>SECEVENT.EVT</code></li>
</ol>
<p><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog</code> allows to change log location. By default, logs are here: <code>System32\Config</code>.</p>
<ul>
<li><code>MRU</code> - most recently used</li>
<li>cache</li>
<li>cookies</li>
<li>turnoff Autocomplete</li>
<li>clear Toolbar</li>
</ul>
<p><code>HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer</code></p>
<p><code>C:\auditpol \\targetIPaddress /disable</code> delete recent docs.</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
