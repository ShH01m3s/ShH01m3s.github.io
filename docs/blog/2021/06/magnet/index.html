<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>To Carry Out MockInv&#39;estigation. Part 2 - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.32b06cb74069d8b26d087fbfd2852fc54428a31ff14ddead5c220eddcb248b07.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-articles 🎓">
      <a href="/docs/articles">
        <span>Articles 🎓</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-achievements 🏅">
      <a href="/docs/achievements">
        <span>Achievements 🏅</span>
      </a>
    </li>
    
    <li class="menu-item-contacts ☎️">
      <a href="/docs/contact">
        <span>Contacts ☎️</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-articles 🎓">
      <a href="/docs/articles">
        <span>Articles 🎓</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-achievements 🏅">
      <a href="/docs/achievements">
        <span>Achievements 🏅</span>
      </a>
    </li>
    
    <li class="menu-item-contacts ☎️">
      <a href="/docs/contact">
        <span>Contacts ☎️</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
  <div class="docs-menu">
   </div> 



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">To Carry Out MockInv&#39;estigation. Part 2</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-archive"></i>
              
          <a class="category-link" href="/domain/general">general</a>
          
              
              <i class="fas fa-microchip"></i>
              
          <a class="category-link" href="/domain/reverse">reverse</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
          <a class="platform-link" href="/doctype/case">case</a>
          
      </div> <br /><br/>
      
      
      
      
      <div class="article-category">
          
            
            
            
            
            
          <a class="platform-link" href="/platforms/win">win</a>
          
      </div> <br />
      

      
      <div class="article-category">
        <i class="fas fa-tools"></i>
          
          <a class="platform-link" href="/tools/autopsy">autopsy</a>
          
      </div> <br />
      
      

      
      <div class="article-tag">
          <i class="fas fa-tag"></i>
          
          
          <a class="tag-link" href="/tags/mock" rel="tag">mock</a>
          
           ,  
          <a class="tag-link" href="/tags/investigation" rel="tag">investigation</a>
          
           ,  
          <a class="tag-link" href="/tags/forensics" rel="tag">forensics</a>
          
      </div> 
      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p>📆 <code>16/06/2021</code> , <em>Wednesday</em></p>
<p>🕰 <code>09:21 PM</code>.</p>
<p><em>I had a 7-day license of Magnet AXIOM and I&rsquo;ve decided to try this tool and compare it with others that I had. In 2021 May-June Magnet held a great event of a great value - Magnet SUMMIT with lots of very useful webinars and workshops. One of them was a case study using Magnet. I am going to follow these steps and study another way to solve a crime.</em></p>
<p>One of the first observation was how Apple specific this tools is. It has lots of Apple specific artifacts (MacOS 💻 and iOS 📱). This is a good starting point for me to learn more about what&rsquo;s important for the examiner.</p>
<p>While examining the UI, I&rsquo;ve intuitively opened CHAT 💬 Section and some iMessage thread revealed that the person whose device was acquired, intended to sell the information. The next random Facebook message revealed that this device was stolen. May be, that&rsquo;s the person who wanted to see financial information? Timestamps would help. These are just some unmethodical random clues, pivot point for further swinging around 📍:) Let&rsquo;s start with the video from Magnet and follow along.</p>
<p>The first step was opening  &ldquo;View evidence for this source only&rdquo; and choosing &ldquo;File System&rdquo; instead of &ldquo;Artifact&rdquo; selected by default to left-upper corner of the program (Screenshot). There I saw the evidence source - <code>MBA_Dante_April15_fv2.E01</code>. As was stated in the presentation - <code>fv2</code> means &ldquo;encrypted with FileVault2&rdquo;. <code>E01</code> - is the proprietary file format for disk images, produced by EnCase Forensics, one of the most commonly used, as I notice. The rest is the identifying information about the evidence. The file system detected is APFS. There are some pecularities about it, that I&rsquo;m collecting <a href="/docs/articles/fundamentals/memory/hdd/file-systems">here</a>. It also shows FreeQueue and Unallocated Space. Gib - 1024, Gb - 1000.</p>
<p>The next step is selecting &ldquo;Artifacts&rdquo; category back and choosing &ldquo;Operating system&rdquo; (evidence category on the left). There I saw a huge list 📚 of available information and evidence. While scrolling, a word &ldquo;SIM&rdquo; 📇 caught my eye. I am currently persuing some decent practical experience with SIM cards and mobile forensics, so this was an interesting point of future analysis.</p>
<p>But I&rsquo;ve got a little sidetracked. Let&rsquo;s get back on the track. I&rsquo;ve chosen &ldquo;File System Information&rdquo; from the same list. There  are five entries (raws) there. One of them, the first, is most likely a general, main container. The other 4 are volumes: MacHD, Preboot, Recovery, VM (standard, but MacHD is usually named Macintosh HD). The first one - container GUID. All the volumes have the same container GUID.</p>
<p>When examining a MacBook, you&rsquo;ll likely see two major types of users: nothing except of browsing and a sophisticated user. So, if you see something like volume renamed from its default value, you are probably dealing with the second type.</p>
<p>When we go to &ldquo;Artifacts -&gt; Operating System Information -&gt; File System Information (APFS)&rdquo;, select the main partition &ldquo;MacHD&rdquo; and see the detailed summary to the right - we may notice, that &ldquo;Volume Creator Program&rdquo; field has a value <code>hfs_convert</code>. This might indicate that the disk was fromated from HFS file system to APFS. Volume count shows how many volumes there are.</p>
<p>&ldquo;Artifacts -&gt; Operation System -&gt; Operating System Information&rdquo;. Local Host Name might be a useful piece of information.</p>
<p>&ldquo;Artifacts -&gt; Operation System -&gt; User Accounts&rdquo;. On MacOS User ID is something similar to Windows SIDs. User accs start from 501. 500 is probably root. Event if FileVault is not activated, you&rsquo;ll need a password for Keychain. Slated SHA-256 PBKDF2.</p>
<p>&ldquo;Artifacts -&gt; Operation System -&gt; Generic Passwords&rdquo; and &ldquo;Artifacts -&gt; Operation System -&gt; Internet Passwords&rdquo;. GUID\Library\Keychains\System.keychain - system keychain. Might be able to get info even if you don&rsquo;t know the password and FV2 is not activated. &ldquo;Process -&gt; Add new evidence&rdquo;. Magent Process is starting. Select Mac Artifact -&gt; Image -&gt; mach_image.E01. Deselect all, Volume1 -&gt; Users -&gt; grimessr -&gt; Library -&gt; Keychains (select). For the second user as well. Next, &ldquo;Computer artifacts&rdquo;, clear all. Go to &ldquo;OPERATING SYSTEM&rdquo; and find Apple Keychain. Click &ldquo;OPTIONS&rdquo; and enter the password for the user account to retreive the User Keychain. ❗️❗️ No trailing spaces❗️❗️unless that&rsquo;s what you want.</p>
<p>&ldquo;Artifacts -&gt; Operation System -&gt; Installed Applications&rdquo;. To see all third-party application, apply a negative filter for &ldquo;com.apple&rdquo; package name.</p>
<p>&ldquo;Artifacts -&gt; Operation System -&gt; Startup Items - macOS&rdquo;. We see OneDrive Daemon. They manage services and processes in UNIX. We know it&rsquo;s strating automatically and syncing.</p>
<p>&ldquo;Artifacts -&gt; Operation System -&gt; KnowledgeC Application Focus&rdquo;. It records how the user interacts with the device. Not much like Windows Prefetch.</p>
<p>&ldquo;Artifacts -&gt; Operation System -&gt; FinderMRU&rdquo;. Recent locations. Looks like the user has copy something to or from OneDrive. Let&rsquo;s go to &ldquo;File System -&gt; MacHD -&gt; Users -&gt; dantegrimes -&gt; One Drive&rdquo;. We see an Excel file, Employee CC_SN Information. Below that a file &ldquo;takeout_XXXX&rdquo;. Might be google take out. It also extracts meta data and shows where this file came from. For example, this takeout came from googleusercontent.</p>
<p>&ldquo;File System -&gt; MacHD -&gt; Users -&gt; dantegrimes -&gt; DropBox&rdquo;. Lots of pictures. Possible canabis photos. Screenshot from a mobile device as well. We also see Facebook-dantegrimes.zip. It&rsquo;s similar to google takeoout.</p>
<p>If FV2 is active, even if collected an unallocated space, how would you decrypt it? These block are dynamically allocated to different volumes. May be it didn&rsquo;t come from a FV2 volume. And how to define the right order for this addresses to decrypt the contents?</p>
<p>📆 <code>22/06/2021</code> , <em>Tuesday</em></p>
<p>🕰 <code>10:36 PM</code>.</p>
<p>It&rsquo;s time to make a <a href="https://www.notion.so/1a19f9521f1141e49a6e70539dffb536?v=16b5b539bf364348bc9086a6dbcbcbb6">timeline</a> to be able to visualise this case better.</p>
<p>Before starting digging into the system, one needs to know what question he or she needs to ask. I was not given any specific challenge, that&rsquo;s why I am going to see through some evidence and make it myself.</p>
<p>Let&rsquo;s assume that the owner of the PC is accused of drug dealing (I&rsquo;ve briefly notices canabis and cocaine photos). Now, what are the potential artifacts here? Is there a way to plant such evidence 💬? There are two ways of doing so, that I can think of:</p>
<ol>
<li><strong>Browsing history</strong>. Browse on another PC and then copy the browser files on the PC. Is this possible? What would be the indicators that these browser data was planted? Is there any metadata that cannot be tampered with?  🔬🧪 Research exclamation mark❗️❗️❗️</li>
<li><strong>Documents</strong>. How is it easy to tamper with the documents metadata? 🔬🧪 Research exclamation mark❗️❗️❗️</li>
<li><strong>Emails and chat messages</strong>. I need to make a backup of my iPhone (since all the chat messages were acquired from the iPhone backup) and try to edit some chat messages and see whether it is possible. 🔬🧪 Research exclamation mark❗️❗️❗️</li>
</ol>
<p>Since we have so many accounts (facebook, email, MacOS) with the same name, it is pretty save by now to asume that this PC was indeed owned by Dante Grimes, at least, for quite a time.</p>
<p>In the tokens and passwords section there are hashed and salted passwords for the both accounts on this PC. Let&rsquo;s try to crack them. The algoritm was defined as SHA-512 + PBKDF2 + salted. On a live system you can get them from here as well as some other user account information: <code>sudo plutil -p /var/db/dslocal/nodes/Default/users/&lt;usename&gt;.plist</code></p>
<p>But since I am using a dedicated tool that has acquired all itself, here are the hashes themselves:</p>
<p><code>$ml$49261$0a35842877f52fb195336a58f72b9db92ee056a40527290a599bcda908c16d15$5c5fd0083920004948b549641100a35ed614a1b64903c55cf40192c7ec33ee307e90071eb12873a40e0f8808f81673d2545d9eea2f506997df08a65ddaaf235e</code> and <code>$ml$91743$9dc0fe0ffdfe980ddf410bcb14e51d126d83154aff1474bdba04e9d0761a2349$05fe38bc2b0af26ff9a92ae3a86efb8fa89179f8c4330c4e26f3aa0dcf237c7ecc87fdc0011c4743b572c65aff41075c2c1d75c661b23020c46af9be25e91bce</code>.</p>
<p>I will install John the Ripper for that from <a href="https://download.openwall.net/pub/projects/john/contrib/macosx/">here</a> and hashcat with the following cmd: <code>brew install hashcat</code>.</p>
<p>Since it is not a real case, most probably the password is easily crackable. Well, &ldquo;crackable&rdquo; is a big word for this, since hashes are irreversable and the only way to get the plaintext in this case would be generate hashes with the most likely passwords using the same algorithm (SHA-512 + PBKDF2 + salted) and compare with the ones that we have. This is called rainbow 🌈 tables. Don&rsquo;t really get, why rainbow&hellip; What&rsquo;s so rainbowy about the hashes?</p>
<p>I&rsquo;ve decided not to use a rainbow table, leaving my mac deal with the problem on its own: <code>hashcat --attack-mode 3 --hash-type 7100 HASHES.txt WORDLIST.txt</code>. It&rsquo;s slow, but the meantime I can explore the system further.</p>
<p>🕰 <code>10:59 PM</code>.</p>
<p>I&rsquo;ve scrolled through the &ldquo;Artifacts&rdquo; section and an idea 💡 has striken me: the most interesting things are usually found in conversations, which take the form of chats and email on PCs. That&rsquo;s why I have started reading the acquired messages from FB, iMessage, SMS etc. Here are my findings (all put on the timeline, of course).</p>
<table>
<thead>
<tr>
<th>Date/time</th>
<th>event(message)</th>
</tr>
</thead>
<tbody>
<tr>
<td>📆 <code>9/28/2018</code> 🕰<code>12:52:21 PM</code></td>
<td>The user writes to some of his friends (Hoitz) that he has recently went out jail. He contacted him about money 💰 and weed 🪴. Hoitz gave him the nickname of a drug dealer: <code>camkins90</code>.</td>
</tr>
<tr>
<td>📆 <code>9/28/2018</code> 🕰<code>5:06:11 PM</code></td>
<td>Friends with some Cameron Jenkins on FB.</td>
</tr>
<tr>
<td>📆 <code>9/28/2018</code> 🕰<code>5:09:11 PM</code></td>
<td>The same day he contacted this <code>camkins90</code> guy.</td>
</tr>
<tr>
<td>📆 <code>9/28/2018</code> 🕰<code>5:16:47 PM</code></td>
<td>Cameron suggests some serious drugs from Mexico.</td>
</tr>
<tr>
<td>A year later</td>
<td></td>
</tr>
<tr>
<td>📆 <code>1/19/2019</code>🕰<code>11:28:06 PM</code></td>
<td>Message from Dante: &ldquo;<em>How was Amsterdam man? setting up my <strong>new laptop</strong>, man its sweet!</em>&rdquo;</td>
</tr>
<tr>
<td>📆 <code>3/15/2019</code> 🕰<code>1:25:00 PM</code></td>
<td>He writes to his buddy: &ldquo;<em>man I need to get over there. I got <strong>locked up</strong> last week&hellip; stupid warrants</em>&rdquo;.</td>
</tr>
<tr>
<td>📆<code>3/15/2019</code> 🕰 <code>1:47:47 PM</code></td>
<td>Writes to his buddy Cameron: &ldquo;<em>you got any phones you dont need/</em>&rdquo;. Cameron replys: &ldquo;<em>I’m low right now but expecting some to come in next week.</em>&rdquo;. Dante needed Android. Why?</td>
</tr>
<tr>
<td>📆 <code>3/19/2019</code> 🕰<code>1:45:09 PM</code></td>
<td>Some friend of Dante needed an Anroid. He was hiding from the police and was afraid to get caught. His name is Ross. Dante suggested to help.</td>
</tr>
<tr>
<td>📆<code>3/21/2019</code>🕰 <code>6:46:15 PM</code></td>
<td>Dante registers on Slack to talk to the drug dealer.</td>
</tr>
<tr>
<td>📆<code>3/21/2019</code>🕰<code>7:00:18 PM</code></td>
<td>Dante writes to the drug dealer: &ldquo;<em>Just messaged you on slack</em>&rdquo;.</td>
</tr>
<tr>
<td>📆<code>3/22/2019</code>🕰<code>6:03:47 PM</code></td>
<td>Dante and the running-from-the-police-Ross guy agreed to meet at Reston Town Center.</td>
</tr>
<tr>
<td>📆<code>3/26/2019</code>🕰<code>2:57:35 PM</code></td>
<td>Someone calls his Grimes (Cameron or Ross), meaning, that&rsquo;s probably the same person.</td>
</tr>
<tr>
<td>📆<code>4/15/2019</code>🕰<code>12:51:10 PM</code></td>
<td>iMessage to +15405398185 from Dante: &ldquo;<em>Never mind! Just got hired on with a finance company. Going to try and grab some info I can sell… as always. But finance stuff</em>&rdquo;.</td>
</tr>
<tr>
<td>📆<code>3/10/2019</code>🕰<code>10:01:44 PM</code></td>
<td>looks like recon of Apple. May be that the company?</td>
</tr>
<tr>
<td>📆<code>4/7/2019</code>🕰<code>2:42:55 PM</code></td>
<td>googles about APFS snapshots. Turned on or off?</td>
</tr>
</tbody>
</table>
<p>There are several conclusions and clues that I now have:</p>
<ol>
<li>This Dante guy is a convicted criminal who has recently went out of jail. However, he has not learned his lesson and carries on doing illegal stuff. It&rsquo;s mostly buying drugs (he is not a dealer, he is a user), stealing and selling what was stolen (phones, information) and his &ldquo;speciality&rdquo;, as it seems, to be some sort of a mediator. Probably people ask for stuff and he finds the way to get that stuff.</li>
<li>This MacBook was not originally Dante&rsquo;s. He claims have <em>found</em> it sometime around 📆 <code>1/19/2019</code> (see the first 2019-year-message). Good present for Xmas and the New Year. That means that evidence from the HDD <strong>before</strong> the first of January do not belong him. However, if the data source of the evidence is the mobile phone backup, then these evidence are his, since he had this phone before he had this MacBook.</li>
<li>I saw that around <code>4/15/2019</code>🕰<code>12:51:10 PM</code> Dante found a job in order to steal information and sell it. This is our pivot point of the investigation. Now I know what would be the most probable reason for acquiring this laptop. By some means the company has found out that the data was exfiltrated and wants to know how, who&rsquo;s responsible and was it already sold or sent anyone.</li>
</ol>
<p>We need to determine, what data was stolen and how much was already exfiltrated and to whom. Let&rsquo;s sort the most probable evidence by access date and look at only those evidence that were acquired <strong>after</strong> <code>04/15/2019</code>, the day when Dante started working. Documents, emails are of the main interest.</p>
<p>Why am I sorting by access dates? My reasoning is as follows. Date created is when the document was created, right? It might even be created on another PC. If Dante has stolen a document that was created years ago, I will not have it in my filter. Access date, however, is in my humble opinion a more reliable property. He might have opened, modified, downloaded a file. And this must have happened <strong>after</strong> he was hired (<code>04/15/2019</code>).</p>
<p>I&rsquo;ve looked through all the documents (numbers, pages, pdfs, txt, excel, word, rtf, images and videos). I have found nothing of interest in images or videos (apart from a screen recording, dated <code>12/14/2018</code>). <code>txt</code>, <code>rtf</code> and <code>pdf</code> were also of no use to the investigation. However, I have found something very interesting with</p>
<p>There are lots of PDFs of the previous user. They were created before 2019 (when <code>numbers</code>, <code>pages</code>, <code>excel</code> and <code>word</code>. First of all, his CV (I&rsquo;ve also notices him openening an indeed job opening which must correlated with this doc). This will help to determine how exactly did he gain access to the data and what else he could have accessed as well.</p>
<p>Test to open ABCDefg</p>
<p>1234</p>
<p>Some serial numbers found in docs section -</p>
<p>BYV3679172</p>
<p>183736GTT</p>
<p>Bkytownsjsk24563</p>
<p>I have also noticed a screen recording, dated 12/14/2018. That has made me think that Screeshots and screen recordings are very valuable peaces of information. I am going to export this video, may be I will find something useful there later.</p>
<p>The only question left: how he could have been hired for this position with such a past 🤨.</p>
<h2 id="references">References</h2>
<p>[<a href="https://apple.stackexchange.com/questions/220729/what-type-of-hash-are-a-macs-password-stored-in">1</a>] Working with Mac password hashes</p>
<p>[<a href="https://superuser.com/questions/197508/where-are-mac-user-account-passwords-stored">2</a>] Another answer about Mac passwords</p>
<p>[<a href="https://www.onlinehashcrack.com/how-to-extract-hashes-crack-mac-osx-passwords.php">3</a>] Where hashes are stored on different systems</p>
<p>[<a href="http://www.adeptus-mechanicus.com/codex/jtrhcmkv/jtrhcmkv.php">4</a>] Hashcat vs John the Ripper for password cracking</p>
<p>[<a href="https://resources.infosecinstitute.com/topic/hashcat-tutorial-beginners/">5</a>] How to use Hashcat</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
