<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I Got Started With ARM - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.f9f7cda90b4490a5a552158a718de9c4abd9dd115744de8d47655158cd53ec58.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
    <li class="menu-item-notes 📝">
      <a href="/docs/notes">
        <span>Notes 📝</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/blog/"> 👈🏼 Back to </br> Blog ✍️ </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">How I Got Started With ARM</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
              <i class="fas fa-microchip"></i>
              
          <a class="category-link" href="/domain/reverse">reverse</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
          <a class="platform-link" href="/doctype/diary">diary</a>
          
      </div> <br /><br/>
      
      
      
      
      <div class="article-category">
          
            
            
            
              <i class="fab fa-apple"></i>
            
            
            
          <a class="platform-link" href="/platforms/mac">mac</a>
          
            
            
            
            
              <i class="fas fa-mobile"></i>
            
            
          <a class="platform-link" href="/platforms/ios">ios</a>
          
            
            
            
            
              <i class="fas fa-mobile"></i>
            
            
          <a class="platform-link" href="/platforms/android">android</a>
          
      </div> <br />
      

      
      <div class="article-category">
        <i class="fas fa-tools"></i>
          
          <a class="platform-link" href="/tools/radare2">radare2</a>
          
          <a class="platform-link" href="/tools/rabin2">rabin2</a>
          
          <a class="platform-link" href="/tools/xcode">Xcode</a>
          
      </div> <br />
      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p>📆 <code>Friday, 12th of March, 202</code></p>
<p>⏰ <code>09:00</code></p>
<p>☀️ <em>It was a very deceptively sunny morning, children laughing and squeaking merrily. When I closed my eyes I could almoust believe it was late spring or summer&hellip;. And the soul was filling with joy and inspiration. But unfortunately the temperature was too low (-10 ❄️ ⛄️  if you believe Yandex) and going for a outside-working-day was impossible 😔.</em></p>
<p>I am finishing my cup of coffee ☕️ , my husband working in the adjacent room and my daughter playing with her new toys.</p>
<p>I should probably start with writing my own little application so that I have access to the source code which is utterly simple and I fully understand what my application can and cannot do. I am using basic <code>Hello World</code> application in Xcode project. It&rsquo;s main function is to print <code>Hello World</code> string on the screen. Nothing else. Since I want to practice reversing ARM, I am adding some more functionality using <code>SwiftUI</code> (I owe this part to my husband). Let&rsquo;s start&hellip; .</p>
<p>⏰ <code>09:14</code></p>
<p>This is what <code>ContentView</code> looks like now:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-swift" data-lang="swift"><span class="line"><span class="cl"><span class="kd">struct</span> <span class="nc">ContentView</span><span class="p">:</span> <span class="n">View</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">@</span><span class="n">State</span> <span class="kd">private</span> <span class="kd">var</span> <span class="nv">code</span><span class="p">:</span> <span class="nb">String</span> <span class="p">=</span> <span class="s">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nv">body</span><span class="p">:</span> <span class="n">some</span> <span class="n">View</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Text</span><span class="p">(</span><span class="s">&#34;Enter the code!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">.</span><span class="n">padding</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">Form</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="n">TextField</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;Code&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">text</span><span class="p">:</span> <span class="err">$</span><span class="n">code</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span> <span class="p">{</span> <span class="n">isEditing</span> <span class="k">in</span>
</span></span><span class="line"><span class="cl">                <span class="bp">print</span><span class="p">(</span><span class="n">isEditing</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">//                self.isEditing = isEditing</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="n">onCommit</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="bp">print</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">.</span><span class="n">autocapitalization</span><span class="p">(.</span><span class="kr">none</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">.</span><span class="n">disableAutocorrection</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">.</span><span class="n">border</span><span class="p">(</span><span class="n">Color</span><span class="p">(</span><span class="n">UIColor</span><span class="p">.</span><span class="n">separator</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">Button</span><span class="p">(</span><span class="n">action</span><span class="p">:</span> <span class="n">signIn</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Text</span><span class="p">(</span><span class="s">&#34;Sign In&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl"><span class="c1">//            Text(username)</span>
</span></span><span class="line"><span class="cl"><span class="c1">//                .foregroundColor(isEditing ? .red : .blue)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kd">func</span> <span class="nf">signIn</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">code</span> <span class="p">==</span> <span class="s">&#34;1234&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="bp">print</span><span class="p">(</span><span class="s">&#34;Good job 🤮&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="bp">print</span><span class="p">(</span><span class="s">&#34;Try again 🤬&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">struct</span> <span class="nc">ContentView_Previews</span><span class="p">:</span> <span class="n">PreviewProvider</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// something default here</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>And this is what my app&rsquo;s UI looks like at the moment:</p>
<p><img src="images/emulator1.png" alt="emulator1"></p>
<p>So, my application is just about checking what a user enters against some hardcoded value. I suppose that this value will be visible with both <code>rabin2 -zzz</code> and <code>r2</code>, <code>fs strings</code>, <code>f</code>. Let&rsquo;s check.</p>
<p>⏰ <code>09:17</code></p>
<p><img src="images/strings1.png" alt="strings1"></p>
<p>The only four strings that I have placed in my application are visible here: <code>str.Enter_the_code</code>, <code>str.1234</code>, <code>str.Try_again_</code> and <code>str.Good_job_</code>. Good job 👏 indeed. Another sip of coffee ☕️ .</p>
<p>Now, I would like to see the references to these strings (which function are using them) since I know, I would only need to patch the <code>sign_in</code> function in order to bypass my super-duper cool check. So, I first get to the <code>strings</code> section by <code>fs strings</code> and <code>f</code> and then running <code>axt @@ str.*</code> to see all the references. Well, that was the plan, but it didn&rsquo;t work:</p>
<p><img src="images/string2.png" alt="string2"></p>
<p>May be, <code>axt</code> is broken? 😡 Let&rsquo;s check with functions <code>fs functions</code> + <code>f</code> + <code>axt @@ *</code>. Hm&hellip; no functions at all!</p>
<p><img src="images/no-functions.png" alt="no-functions"></p>
<p>What am I doing wrong? &hellip; 😑 Mmmm, I guess the problem is that I haven&rsquo;t run <code>aa</code> upon opening the application (analysis of the binary). I could run just <code>af</code> to analyse functions only, but I prefer to get more information. Since my binary is too small to be analysed for a long time, there is nothing to loose.</p>
<p><img src="images/functions1.png" alt="functions1"></p>
<p>Now there are functions here, which is very good. I can now run <code>fs functions</code> and <code>f</code> and <code>axt @@ *</code> again:</p>
<p><img src="images/it-works.png" alt="it-works"></p>
<p>It now works. Let&rsquo;s try against strings again. Still nothing. Hm, let&rsquo;s run more analysis with <code>aaaa</code>. Voila! 🎉</p>
<p><img src="images/it-works2.png" alt="it-works2"></p>
<p>I can now go to the calling funtion and see, where my switch to turn off is.</p>
<blockquote>
<p>ARM uses a load-store model for memory access which means that only load/store (LDR and STR) instructions can access memory. While on x86 most instructions are allowed to directly operate on data in memory, on ARM data must be moved from memory into registers before being operated on. This means that incrementing a 32-bit value at a particular memory address on ARM would require three types of instructions (load, increment, and store) to first load the value at a particular address into a register, increment it within the register, and store it back to the memory from the register.</p>
</blockquote>
<p>Only now I realise that I don&rsquo;t see standard ARM registers like <code>r1</code> or <code>r2</code>, but instead some creepy <code>w0</code> or <code>x2</code> etc. Although the operations seem to be the same (like <code>tbnz</code> check-this-and-jump-here-if-not-zero operation) or <code>b</code>ranching. Anyway, this code is probably simple to patch. But I cannot check now and I cannot try re-building my project for iOS device instead of simulator since I don&rsquo;t have an appropriate USB wire to connect 😢. The one that I have doesn&rsquo;t work. So, it seems that I&rsquo;ve stumbled upon a problem that cannot solve immediately and I will have to wait for the USB wire.</p>
<p>Off for now, but I hope to be back soon 🚀.</p>
<h2 id="references">References</h2>
<p>[<a href="https://azeria-labs.com/memory-instructions-load-and-store-part-4/">1</a>] ARM quick guide</p>
<p>[<a href="https://www.megabeets.net/a-journey-into-radare-2-part-1/">2</a>] Megabeets radare2 quick guide</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
