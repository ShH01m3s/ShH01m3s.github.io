<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I Got Started With AWS - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-dfir 🔍">
      <a href="/docs/dfir">
        <span>DFIR 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-reverse 🔧">
      <a href="/docs/reverse">
        <span>Reverse 🔧</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit 🧰">
      <a href="/docs/toolkit">
        <span>Toolkit 🧰</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting 🪤">
      <a href="/docs/thunting">
        <span>Threat Hunting 🪤</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference 📚">
      <a href="/docs/reference">
        <span>Tech Reference 📚</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/blog/"> 👈🏼 Back to </br> Blog ✍️ </a>
  </p>
  <aside>
   <nav id="TableOfContents"></nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">How I Got Started With AWS</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      <div class="article-category">
          
            
            
            
              <i class="fab fa-apple"></i>
            
            
            
            
          
          
      </div> <br />
      

      
      <div class="article-category">
        <i class="fas fa-tools"></i>
          
          
          <a class="platform-link" href="/tools/aws">AWS</a> 
          
      </div> <br />
      
      

      
      <div class="article-tag">
          <i class="fas fa-tag"></i>
          
          
          <a class="tag-link" href="/tags/config" rel="tag">config</a>
          
      </div> 
      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p><em>In this blog post I am exploring AWS services (EC2). I am currently using a Free Tier license and I am trying to learn how to use. Why? Well, knowing AWS seems to be a very useful skill on the market. And the second reason for that is that I used to have different VMs that cosumed too much memory (HDD and RAM). Now I am also using M1 MacBook Pro and that&rsquo;s why having so many VMs locally is impossible since there are only some Linux and Windows 10 Machines available for ARM platform. Besides, I&rsquo;ve notices that I don&rsquo;t really use them much so having 60 GB of space occupied for occasional usage is weird. Everything speaks in the favour of AWS.</em></p>
<p>📆 <code>07/03/2021</code></p>
<p>⏰ <code>9:13 PM</code></p>
<p>This story began a while ago when I was reading <em>The Hacker Playbook 3</em> by Peter Kim and the author suggested using some cloud services for VMs instead of local ones. Getting a M1 MacBook forced me to reconsider my lab setup and I&rsquo;ve decided to give it a try. Anyway, since everything is in the cloud ☁️ now, it&rsquo;s an essential skill anyway. Also, such configuration doesn&rsquo;t require looking for images, keeping multiple VMs locally and lets running many VMs at once. I am only keeping a Parallels Win10 machine locally for some minor tasks. The prices for AWS EC2 are quite reasonable, given that I don&rsquo;t use VMs for a long time and everyday.</p>
<p>And so I got started with EC2. Amazon provides with a 12-month free tier offer which is a very good thing for someone like me, who&rsquo;s just getting started and doesn&rsquo;t require to much usage time and performance for her machines.</p>
<p>📆 <code>07/03/2021</code></p>
<p>⏰ <code>12:30 PM</code></p>
<p><strong>Step 1. Create AWS account</strong></p>
<p><strong>Step 2.</strong> <strong>Get you creds and configure</strong>. Click username in the upper-right corner, select <em>My Security Credentials</em> from the drop down list. On the page expand <em>Access keys (access key ID and secret access key)</em> and press <em>Create New Access Key</em> (if none were already created some time ago). You will be given a file to save containing ID and a private key. Keep them save. Submit it after running <code>aws configure</code> when promted for <code>AWS Access Key ID</code> and <code>AWS Secret Access Key</code>. For output leave json as default (unless you want something else), and enter <code>Default region name</code> for the nearest time zone.</p>
<p><strong>Step 3. Create trust policy and role policy files.</strong></p>
<p><strong>Step 4. Create a role in your account. ​</strong>❓ What&rsquo;s that and what&rsquo;s that for?</p>
<p><strong>Step 5. Create a role policy as well. ❓</strong> What&rsquo;s that and what&rsquo;s that for?</p>
<p><strong>Step 6. Image uploading.</strong> Upload ova/vhd/vmdk/raw image into the S3 bucket.</p>
<p><strong>Step 7. Image import</strong>. Import uploaded image to be converted to AMI (Amazon VM format).</p>
<p>AWS commands for uploading images and checking status:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># configure basic stuff like credentials, output format and region</span>
</span></span><span class="line"><span class="cl">aws configure 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># create a role on AWS</span>
</span></span><span class="line"><span class="cl">aws iam create-role --role-name vmimport --assume-role-policy-document <span class="s2">&#34;file:///full/path/to/trust-policy.json&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># create a policy</span>
</span></span><span class="line"><span class="cl">aws iam put-role-policy --role-name vmimport --policy-name vmimport --policy-document <span class="s2">&#34;file:///full/path/to/role-policy.json&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># import uploaded image to make an AMI file</span>
</span></span><span class="line"><span class="cl"><span class="c1"># for importinng OVA</span>
</span></span><span class="line"><span class="cl">aws ec2 import-image <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --disk-containers <span class="nv">Format</span><span class="o">=</span>ova,UserBucket<span class="o">=</span><span class="s2">&#34;{S3Bucket=bucketname,S3Key=path/to/image/in/the/bucket/image.ova}&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># for importinng VMDK</span>
</span></span><span class="line"><span class="cl">aws ec2 import-image <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --disk-containers <span class="nv">Format</span><span class="o">=</span>vmdk,UserBucket<span class="o">=</span><span class="s2">&#34;{S3Bucket=bucketname,S3Key=path/to/image/in/the/bucket/image.vmdk}&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># note the import-ami to use in the below command</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="c1"># check task status</span>
</span></span><span class="line"><span class="cl">aws ec2 describe-import-image-tasks --import-task-ids import-ami-XXXXXXXXXXXXXX
</span></span></code></pre></div><p>Failed to get any image that way, got kernel version error all the time 😢. Oh, kernel, what are you doing with me, babe.</p>
<p>So, I&rsquo;ve decided to use another way to get a SIFT workstation: get AWS Ubuntu 16.04 instance and install sift manually. Failed for the reason unknown. Then I&rsquo;ve tried with AWS Ubuntu 18.04. Still waiting.</p>
<p>I then opened the book again and notices, that not EC2 but some AWS Lightsail was recommended. So, I had to dig up ⛏️ the <a href="https://stackoverflow.com/questions/40927189/what-is-difference-between-lightsail-and-ec2">difference</a> between the two. I still don&rsquo;t know which is better for me at the moment, but I suppose I&rsquo;ll use EC2 for  the upcoming 12 months and learn the more complex solution. Moving to the Lightsail version (should the need arise) should be easier than vice versa .</p>
<p><a href="https://ubuntu.com/tutorials/ubuntu-desktop-aws#1-overview">https://ubuntu.com/tutorials/ubuntu-desktop-aws#1-overview</a></p>
<p><a href="https://aws.amazon.com/premiumsupport/knowledge-center/ec2-linux-2-install-gui/">https://aws.amazon.com/premiumsupport/knowledge-center/ec2-linux-2-install-gui/</a></p>
<p>To install SIFT manually:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">wget https://github.com/sans-dfir/sift-cli/releases/download/v1.9.2/sift-cli-linux
</span></span><span class="line"><span class="cl">wget https://github.com/sans-dfir/sift-cli/releases/download/v1.9.2/sift-cli-linux.sha256.asc
</span></span><span class="line"><span class="cl">gpg --keyserver hkp://pool.sks-keyservers.net:80 --recv-keys 22598A94
</span></span><span class="line"><span class="cl">gpg --verify sift-cli-linux.sha256.asc
</span></span><span class="line"><span class="cl">shasum -a <span class="m">256</span> -c sift-cli-linux.sha256.asc
</span></span><span class="line"><span class="cl">sudo mv sift-cli-linux /usr/local/bin/sift
</span></span><span class="line"><span class="cl">chmod <span class="m">755</span> /usr/local/bin/sift
</span></span><span class="line"><span class="cl">sudo sift install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sift install --mode<span class="o">=</span>server
</span></span></code></pre></div><p><a href="https://aws.amazon.com/premiumsupport/knowledge-center/ec2-instance-access-s3-bucket/">https://aws.amazon.com/premiumsupport/knowledge-center/ec2-instance-access-s3-bucket/</a></p>
<p>Managed to import Ubuntu 16.04, but failed to launch or connect over ssh.</p>
<p>After all this time I managed to find <a href="https://github.com/teamdfir/sift/issues/465">https://github.com/teamdfir/sift/issues/465</a>. Select us-west-2 region and search for <code>ami-0e18b3270d2ce667d</code>. Eligible for free tier use. So much time waisted, but there is a result <strong>finally</strong>. One thing to note - log in with <code>sansforensics</code> username. Also, install aws console to use s3 bucket.</p>
<p>Getting data from the bucket (<a href="https://aws.amazon.com/premiumsupport/knowledge-center/ec2-instance-access-s3-bucket/">install and configure</a>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">aws s3 cp s3://my_bucket/my_folder/my_file.ext my_copied_file.ext
</span></span><span class="line"><span class="cl">aws s3 --recursive cp s3://my_bucket/my_folderw .
</span></span><span class="line"><span class="cl"><span class="c1"># or</span>
</span></span><span class="line"><span class="cl">wget https://my_bucket.s3.amazonaws.com/path-to-file
</span></span></code></pre></div>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
