<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I Met Radare2 - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.f5ee5a6a50d29b6390e5652a9df2ffcaffd904244cc05d6f936d9e4feeb76a3d.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/blog/"> Back to Blog âœï¸ Section ğŸ‘ˆğŸ¼ </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#meet-radare-">Meet radare ğŸ‘‹</a></li>
    <li><a href="#meet-rabin-">Meet rabin ğŸ‘‹</a></li>
    <li><a href="#beware--appreciation-is-contagious">Beware â— Appreciation is contagious</a></li>
    <li><a href="#diving-deeper--">Diving deeper ğŸ¤¿ ğŸ </a></li>
    <li><a href="#getting-hands-dirty-">Getting hands dirty ğŸ§»</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">How I Met Radare2</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      <div class="article-category">domain: 
          
              
                <i class="fas fa-archive"></i>
              
          <a class="category-link" href="/domain/general">general</a>
          
              
              <i class="fas fa-microchip"></i>
              
          <a class="category-link" href="/domain/reverse">reverse</a>
          
      </div> <br />
      
      <div class="article-category">doctype:
          
            
              
          <a class="platform-link" href="/doctype/setup">setup</a>
          
             ,  
              
          <a class="platform-link" href="/doctype/diary">diary</a>
          
      </div> <br /><br/>
      
      
      
      
      <div class="article-category">
          
            
            
            
              <i class="fab fa-apple"></i>
            
            
            
          <a class="platform-link" href="/platforms/mac">mac</a>
          
      </div> <br />
      

      
      <div class="article-category">
        <i class="fas fa-tools"></i>
          
          <a class="platform-link" href="/tools/radare2">radare2</a>
          
          <a class="platform-link" href="/tools/frida">frida</a>
          
      </div> <br />
      
      

      
      <div class="article-tag">
          <i class="fas fa-tag"></i>
          
          
          <a class="tag-link" href="/tags/how-i..." rel="tag">how i...</a>
          
           ,  
          <a class="tag-link" href="/tags/reverse" rel="tag">reverse</a>
          
      </div> 
      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p>ğŸ“† <code>24/09/2020</code>, <em>Wednesday</em></p>
<p>ğŸ•° <code>7:00</code> <em>What a nice morning! And it&rsquo;s so great to be woken up by a high-pitched cry in the ear&hellip; Well, after giving my daughter her breakfast and doing all the neccessary hygine procedures for us both, I left her by my side on the development carpet, so that I could develop myself&hellip;</em></p>
<p>ğŸ›   <strong>Environment and Tools</strong>: macOS Catalina 10.15.6 (19G2021) + pyenv 1.2.20 + Python 3.8.5 + Visual Code Version: 1.49.1, VBox Version 6.1.12 r139181 (Qt5.6.3) + Kali Linux + radare2 4.6.0-git 25077 @ linux-x86-64 git.4.4.0-749-g2a0d8fbe5</p>
<p>For the purpose of iOS pentesting I faced the urge to learn the new tool <strong>radare2</strong>. Just for now I don&rsquo;t see the advantages over IDA, but OWASP is insisting on that tool rather than on IDA, so there must be an explanation. Besides, if I&rsquo;m serious about further developing my forensics skills, I need to know that tool quite well for it was developed specifically for the purpose of forensic investigation. Two possible advantages that I see so far is that it&rsquo;s completely free and that it supports many platfroms including mobile ones. Since I&rsquo;m turning my poor old iPad into a security assessment and investigation tool, I&rsquo;d better learn to use it.</p>
<h2 id="meet-radare-">Meet radare ğŸ‘‹</h2>
<p>ğŸ•° <code>10:47</code> I&rsquo;m using <a href="https://medium.com/@jacob16682/reverse-engineering-using-radare2-588775ea38d5">this</a> article to first dive into radar2. The installation steps for Mac seem to be the same as for Linux and rather straightforward.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/radare/radare2
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> radare2
</span></span><span class="line"><span class="cl">sudo sys/install.sh
</span></span></code></pre></div><p>Oops&hellip; lot&rsquo;s of warnings against running with root&hellip; Good. Let&rsquo;s also try them for iPad (after all, that was the main idea of using it in the first place). Uf&hellip; <code>You need GNU make to build me</code>. Then, I can download the binary for iOS from <a href="https://radare.mikelloc.com/list">here</a>, although the developers insist I compile it myself. But may be another time when I &ldquo;feel the flow&rdquo; with radare2.</p>
<p>ğŸ•° <code>11:00</code> That way it didn&rsquo;t work as well. Also, I&rsquo;ve noticed, that after executing it on iPad and getting <code>Killed: 9</code> error the iPad starts lagging and throws strange errors in Cydia. I don&rsquo;t know yet how these events might be interconnected&hellip; May be it&rsquo;s really better to compile it myself for iPad&hellip; I&rsquo;ve already had my coffee and I&rsquo;m just dying to have another one&hellip; . But I can&rsquo;t be distracted, I have to get to some logical point first.</p>
<p>When trying to find the sources and instructions, I&rsquo;ve run into <a href="https://github.com/radareorg/radare2/releases">this</a>. Using ssh I&rsquo;ve got my iPad&rsquo;s arch:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/usr/bin/arch
</span></span><span class="line"><span class="cl">&gt; arm64
</span></span></code></pre></div><p>So, I&rsquo;ve decided to give the easiest way another try ğŸ˜„. â€‹I must note that radare2 takes lot&rsquo;s of time to be downloaded. May be it&rsquo;s a good time to make a cup of â˜• or to read the article further and try to &ldquo;feel the flow&rdquo; with the radare2 on PC at last. (Running a CLI tool on touch screen is another challenging step, better be comfortable with the commands first). â€‹</p>
<p>ğŸ•° <code>11:08</code> Almost downloaded. Droping it via ssh to my mobile device&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">scp radare2-aarch64_4.5.1_iphoneos-arm.deb root@<span class="o">[</span>my_iPad_IPğŸ˜‰<span class="o">]</span>:~ <span class="c1"># drop the *.deb package on iDevice</span>
</span></span><span class="line"><span class="cl">ssh root@<span class="o">[</span>my_iPad_IPğŸ˜‰<span class="o">]</span>
</span></span><span class="line"><span class="cl">dpkg -i radare2-aarch64_4.5.1_iphoneos-arm.deb
</span></span><span class="line"><span class="cl">&gt; Selecting previously unselected package radare2.
</span></span><span class="line"><span class="cl">&gt; <span class="o">(</span>Reading database ... <span class="m">2480</span> files and directories currently installed.<span class="o">)</span>
</span></span><span class="line"><span class="cl">&gt; Preparing to unpack radare2-aarch64_4.5.1_iphoneos-arm.deb ...
</span></span><span class="line"><span class="cl">&gt; Unpacking radare2 <span class="o">(</span>4.5.1<span class="o">)</span> ...
</span></span><span class="line"><span class="cl">&gt; Setting up radare2 <span class="o">(</span>4.5.1<span class="o">)</span> ...
</span></span></code></pre></div><p>CLI tool for reverse engineering&hellip;. That&rsquo;s rather challenging. I remember when I used <strong>gdb</strong> for debugging an impressively huge executuable for Linux reversing and that was not a very sweet memory&hellip;. Well, one has to leave the comfort zone in order to evolve. So, let&rsquo;s evolve. Besides, I found Hiew to be exremely comfortable to use, so, may be I&rsquo;m not that a great stranger to unfriendly-UI-less tools.</p>
<h2 id="meet-rabin-">Meet rabin ğŸ‘‹</h2>
<p>Let&rsquo;s run <code>rabin2</code> against something simple:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rabin2 -I intro <span class="c1"># intro is the simple hello-world-executable that Jacob Pimental has kindly compiled and shared along with his article I&#39;m following</span>
</span></span><span class="line"><span class="cl">&gt; arch     x86
</span></span><span class="line"><span class="cl">&gt; baddr    0x0
</span></span><span class="line"><span class="cl">&gt; binsz    <span class="m">6485</span>
</span></span><span class="line"><span class="cl">&gt; bintype  elf
</span></span><span class="line"><span class="cl">&gt; bits     <span class="m">64</span>
</span></span><span class="line"><span class="cl">&gt; canary   <span class="nb">false</span>
</span></span><span class="line"><span class="cl">&gt; class    ELF64
</span></span><span class="line"><span class="cl">&gt; compiler GCC: <span class="o">(</span>GNU<span class="o">)</span> 7.2.0
</span></span><span class="line"><span class="cl">&gt; crypto   <span class="nb">false</span>
</span></span><span class="line"><span class="cl">&gt; endian   little
</span></span><span class="line"><span class="cl">&gt; havecode <span class="nb">true</span>
</span></span><span class="line"><span class="cl">&gt; intrp    /lib64/ld-linux-x86-64.so.2
</span></span><span class="line"><span class="cl">&gt; laddr    0x0
</span></span><span class="line"><span class="cl">&gt; lang     c
</span></span><span class="line"><span class="cl">&gt; linenum  <span class="nb">true</span>
</span></span><span class="line"><span class="cl">&gt; lsyms    <span class="nb">true</span>
</span></span><span class="line"><span class="cl">&gt; machine  AMD x86-64 architecture
</span></span><span class="line"><span class="cl">&gt; maxopsz  <span class="m">4</span>
</span></span><span class="line"><span class="cl">&gt; minopsz  <span class="m">4</span>
</span></span><span class="line"><span class="cl">&gt; nx       <span class="nb">true</span>
</span></span><span class="line"><span class="cl">&gt; os       linux
</span></span><span class="line"><span class="cl">&gt; pcalign  <span class="m">4</span>
</span></span><span class="line"><span class="cl">&gt; pic      <span class="nb">true</span>
</span></span><span class="line"><span class="cl">&gt; relocs   <span class="nb">true</span>
</span></span><span class="line"><span class="cl">&gt; relro    partial
</span></span><span class="line"><span class="cl">&gt; rpath    NONE
</span></span><span class="line"><span class="cl">&gt; sanitiz  <span class="nb">false</span>
</span></span><span class="line"><span class="cl">&gt; static   <span class="nb">false</span>
</span></span><span class="line"><span class="cl">&gt; stripped <span class="nb">false</span>
</span></span><span class="line"><span class="cl">&gt; subsys   linux
</span></span><span class="line"><span class="cl">&gt; va       <span class="nb">true</span>
</span></span></code></pre></div><p>Now getting the strings from data section along with that:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">rabin2 -z intro 
</span></span><span class="line"><span class="cl">&gt; <span class="o">[</span>Strings<span class="o">]</span>
</span></span><span class="line"><span class="cl">nth paddr      vaddr      len size section <span class="nb">type</span>  string
</span></span><span class="line"><span class="cl">â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•
</span></span><span class="line"><span class="cl"><span class="m">0</span>   0x000006e4 0x000006e4 <span class="m">11</span>  <span class="m">12</span>   .rodata ascii Hello World
</span></span></code></pre></div><p>But to be fare, if the executable is big enough, then there would be the hell of information in the console&hellip; Not very comfortable to overview. And calling <code>rabin2 -zz</code> would just kill me (shows ALL the strings from the binary). Even for that teeny-tiny executable there was a hell bunch of strings that would be rather demotivating even for a very enthusiastic person (which I couldn&rsquo;t call myself yet)&hellip; It&rsquo;s hard to imagine how to cope with a real-world binary. In the reverse engineering strings are little gods&hellip; The main source of hints.</p>
<h2 id="beware--appreciation-is-contagious">Beware â— Appreciation is contagious</h2>
<p>ğŸ•° <code>12:15 PM</code> Wow. I thought it&rsquo;s just a CLI tool, but it actually has a nice CLI-pdedoGUI interface. It&rsquo;s a hex editor as well and has some tools packed with it:</p>
<p><img src="images/cli_gui_r2.png" alt="cli_gui_r2"></p>
<p>ğŸ•° <code>1:52 PM</code> OMGâ— This tool is really amazing. I wouldn&rsquo;t even dare to call it &ldquo;a tool&rdquo; ğŸ”¨. It&rsquo;s more like a toolkit . While learning this tools with Jacob Pimental&rsquo;s crackme from the <a href="https://medium.com/@jacob16682/reverse-engineering-with-radare2-part-2-83b71df7ffe4">article</a>, I&rsquo;ve managed to reverse all the code and almost found the second and the third key. What was left was reverse <code>atoi(0x9)</code> and <code>atoi(0x539)</code>. I&rsquo;ve thought of writing my python script to undo the <code>atoi</code> operation at first, but in his article Jacob Pimental has mentioned another tool from this toolkit: <code>rax2</code>. So, converting the integer back to string was as simple as running <code>rax2 [my_integer]</code> from <strong>r2</strong> shell. I think, I&rsquo;m about to &ldquo;feel the flow&rdquo; ğŸŒŠ.</p>
<h2 id="diving-deeper--">Diving deeper ğŸ¤¿ ğŸ </h2>
<p><em><strong>Thursday</strong></em></p>
<p>ğŸ•° <code>11:47 AM</code> Yesterday evening just after my wushu training I got home with my mind fixed on the radare2. I was eager to learn to use it better and more than anything - to learn to use it on iPad. As far as I was too overwhelmed with that idea, I had to make my mind a treat and spent some time reading the <a href="https://www.megabeets.net/a-journey-into-radare-2-part-1/">article</a> and following the steps even though it was getting very late and I&rsquo;m waking up quite early now. Some of them appeared to be outdated, some - don&rsquo;t work correctly on iPad. For example, to go to a specific function using its shortcut (on the picture below <code>[;oa]</code>) one has to be in <code>VV</code> mode (Graph Mode), then press <code>o</code> to get the promt and then type the second letter (in the example below it&rsquo;s <code>a</code>). When the article was written, the command was <code>g</code> and not <code>o</code>.</p>
<p><img src="images/go_to_func_shortcut.png" alt="go_to_func_shortcut"></p>
<p>But these are just minor things. This article was written by a man who is very enthusiatic and impressed by the tool and that makes the article so interesting and useful to read. And I think he manages to &ldquo;infect&rdquo; the reader with his admiration of the tool. Thank you!</p>
<p>After reading the first half of the first part I was already quite familiar with the interface. But not yet. It&rsquo;s a long run, I feel.</p>
<h2 id="getting-hands-dirty-">Getting hands dirty ğŸ§»</h2>
<p>ğŸ•° <code>7:30 PM</code> Dear diary, I can finally get back to this task! I went so crazy, that I&rsquo;ve installed Kali on my Vbox to get the test vulnerable app running to learn some more tricks with <strong>radare2</strong>. I must say, I&rsquo;m starting to understand, in what way it&rsquo;s better than other tools. But some functionality impressed me so much that I could not resist the temptation to write about it. I understand that for gurus that must be funny to read and my amusement might be hilarious but I also presume that gurus won&rsquo;t read this article (why would they), so I&rsquo;m safe with my emotions.</p>
<p>The thing that amazed me so much was the way it can be used to smash the stack. So, the conclusion I&rsquo;ve made is that it&rsquo;s not just a disassembler, it&rsquo;s so much more&hellip; Thanks again to <a href="https://www.megabeets.net/a-journey-into-radare-2-part-1/">Megabeets</a> again! And also thanks to <a href="https://bananamafia.dev/post/rop-arm-1/">Bananamafia</a> for the formulation of his description of <code>wop</code> command that helped me understand how it works.</p>
<p>Basically, the idea is as follows (more detailed walkthrough&rsquo;s can be found in the articles mentioned above):</p>
<ol>
<li>find a vulnerable function (such that uses, for example, <code>puts</code> or <code>gets</code>)</li>
<li>pass this function a ridiculously huge garbage-string where symbols&rsquo; sequences do not repeat (smart people say <em>De Bruijn Pattern</em>) so that given 4 symbols it&rsquo;s can be easily and unambiguously located within that garbage string</li>
<li>this string will overwrite the stack and will most likely overwrite the return address. When the function get&rsquo;s the return address from the stack, it puts its value into <code>eip</code>. We get the <code>eip</code> value and ask <code>r2</code> with <code>wop0</code> command to locate the position of these symbols inside the garbage string</li>
<li>Now we now the exact amount of garbage to pass the program in order to overwrite the <code>ret addr</code>.</li>
</ol>
<p>ğŸ•° <code>7:55 PM</code> Thanks to Megabeet once again, I&rsquo;ve learned about <code>pwntools</code>. I like <code>Python</code>. <strong>7:56 PM</strong> OMG&hellip; It appears as I&rsquo;ve accidentally broken my <code>pyenv</code> config in <code>.zshrc</code>&hellip; Somehow it was completely overwritten with <code>oh my zsh</code> theme&hellip; Thanks to my poor understanding of all this stuff back then that led to dublications of configs across several files, including <code>bash_profile</code>. So, fixing it was just the matter of copy-pasting.</p>
<p>ğŸ•° <code>7:59 PM</code>. It worked :happy: <code>pyenv</code> works now and I can activate my python3 environment to install <code>pwntools</code>. I&rsquo;ll open <code>Visual Code</code> which is just perfect for coding simple programs and scripts.</p>
<p>ğŸ•° <code>8:09 PM</code> I&rsquo;ve copied the script and fixed a small <a href="https://reverseengineering.stackexchange.com/questions/19776/what-is-the-right-way-to-pack-a-payload-with-python3s-pwntools">bug</a> following the instructions. When I copied it to my Kali I&rsquo;ve run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo chmod +x exploit.py
</span></span><span class="line"><span class="cl">python3 exploit.py
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># and got this error:</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Starting <span class="nb">local</span> process <span class="s1">&#39;./megabeets_0x2&#39;</span>: pid <span class="m">1469</span>
</span></span><span class="line"><span class="cl">Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
</span></span><span class="line"><span class="cl">  File <span class="s2">&#34;exploit.py&#34;</span>, line 36, in &lt;module&gt;
</span></span><span class="line"><span class="cl">    main<span class="o">()</span>
</span></span><span class="line"><span class="cl">  File <span class="s2">&#34;exploit.py&#34;</span>, line 31, in main
</span></span><span class="line"><span class="cl">    <span class="nv">leak</span> <span class="o">=</span> u32<span class="o">(</span>leak<span class="o">)</span>
</span></span><span class="line"><span class="cl">  File <span class="s2">&#34;/usr/local/lib/python3.8/dist-packages/pwnlib/context/__init__.py&#34;</span>, line 1468, in setter
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">function</span><span class="o">(</span>*a, **kw<span class="o">)</span>
</span></span><span class="line"><span class="cl">  File <span class="s2">&#34;/usr/local/lib/python3.8/dist-packages/pwnlib/util/packing.py&#34;</span>, line 338, in routine
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="o">{(</span><span class="s2">&#34;little&#34;</span>, True  <span class="o">)</span>: ls,
</span></span><span class="line"><span class="cl">  File <span class="s2">&#34;/usr/local/lib/python3.8/dist-packages/pwnlib/util/packing.py&#34;</span>, line 306, in routine
</span></span><span class="line"><span class="cl">    <span class="k">return</span> ops<span class="o">[</span>op<span class="o">](</span>fmt,data<span class="o">)</span>
</span></span><span class="line"><span class="cl">  File <span class="s2">&#34;/usr/local/lib/python3.8/dist-packages/pwnlib/util/packing.py&#34;</span>, line 289, in &lt;lambda&gt;
</span></span><span class="line"><span class="cl">    <span class="nv">ops</span>   <span class="o">=</span> <span class="o">{</span><span class="s1">&#39;p&#39;</span>: struct.pack, <span class="s1">&#39;u&#39;</span>: lambda *a: struct.unpack<span class="o">(</span>*<span class="o">(</span>
</span></span><span class="line"><span class="cl">struct.error: unpack requires a buffer of <span class="m">4</span> bytes
</span></span></code></pre></div><p>I&rsquo;ve started googling it at first. But then I don&rsquo;t know why, I tried to run</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chmod -x exploit.py
</span></span><span class="line"><span class="cl">python3 exploit.py
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># and voila!</span>
</span></span><span class="line"><span class="cl">root@kali:/home/sherlock/Documents# python3 exploit.py 
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Starting <span class="nb">local</span> process <span class="s1">&#39;./megabeets_0x2&#39;</span>: pid <span class="m">1482</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> puts is at 0xf7d6a590
</span></span></code></pre></div><p>I don&rsquo;t know why on Earth would I chown this in the first place, but it&rsquo;s an interesting thing to note. But for today I guess that&rsquo;s it. It was a difficult and very efficient day and I&rsquo;ve deserved some rest ğŸº.</p>
<p>Off for now!</p>
<h2 id="references">References</h2>
<p>[<a href="">1</a>] Megabeets blog (part 1 and part 2)</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.bafc052229b4b40bf03c477d31c5cdd9352ece8afbadf35ab97ed14495098fc9.js"></script>
  

  
  
  
    
  


</body>

</html>
