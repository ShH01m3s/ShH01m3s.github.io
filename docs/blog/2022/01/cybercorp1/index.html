<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CyberCorp1 - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.9d91cbb32c96c334ae7b38c3d99d30727e0836e1182125cc5f007d215f0b9e59.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/blog/"> Back to Blog âœï¸ Section ğŸ‘ˆğŸ¼ </a>
  </p>
  <aside>
   <nav id="TableOfContents"></nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">CyberCorp1</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p>â›”ï¸  Spoiler alert!</p>
<p>So, there are not too much details on this one. But they have provided <em>some</em> artefacts from <em>one</em> machine. And they&rsquo;ve also mentioned that this machine is <em>likely</em> compromised.</p>
<p><strong>Artefacts in posession</strong>: memory dump, OS event logs, registry files, Prefetch files, $MFT file, ShimCache, AmCache, network traffic dumps. I&rsquo;ve decided to analyse each artefact, what can I get from it in this specific case and how. Then, I am going to outline my strategy in approaching this case.</p>
<p>We are looking for indicators of compromise.  There are no details as to what is the group and what was its aim. But itâ€™s known that there was abnormal traffic detected that has launched this IR process. So, at least, we must have some suspicious traffic, possibly open or terminated connections. These should have been launched by some process, so we are looking for malware. Also, since the attacker needed an account to get in, I will be looking for an account take over attempts and possibly, new account creation.</p>
<p><strong>Artefact</strong>: Memory Dump</p>
<p><strong>Information</strong>:</p>
<ol>
<li>Running processes (volatility + pslist)</li>
<li>Hidden processes (volatility + pslist + pscan)</li>
<li>Passwords (grep + regex)</li>
<li>Open connections (volatility + connections  + connscan + netscan)</li>
</ol>
<p>Cheat sheet:</p>
<p><a href="https://www.andreafortuna.org/2017/07/24/volatility-my-own-cheatsheet-part-5-networking/amp/">Volatility, my own cheatsheet (Part 5): Networking | Andrea Fortuna</a></p>
<p>Since we know that this machine was likely compromised, and we know there was abnormal traffic originating from this machine,  i would be focusing on network and malware artefacts first: rogue processes (like weird names, weird parents, weird children etc) and suspicious connections open and terminated (like processes on unusual ports, blacklisted IPs).</p>
<p><strong>Artefact</strong>: OS Event Logs</p>
<p><strong>Information</strong>:</p>
<ol>
<li>Open connections id</li>
<li>Failed authentication attempts, possible followed by successful login</li>
<li>New users created</li>
<li>Privilege elevated</li>
</ol>
<p>Since the pc was likely compromised, itâ€™s either the existing user was used or new user created. We need to check both. Also, the attacker would probably need elevated privileges. And since network traffic is suspicious - review ids for opening connections.</p>
<p><strong>Artefact</strong>: Registry</p>
<p><strong>Information:</strong></p>
<ol>
<li>Startup and auto runs</li>
<li>Recently run programs</li>
<li>Recently opened files</li>
<li>Users on the system</li>
<li>Security policies for network connections</li>
</ol>
<p>ğŸ“ There are some User registry hives, which include Crypto (empty) and Protect folders. The latter includes CREDHIST and SYNCHIST, and it&rsquo;s the first time I hear about these. A quick google search reveals that CREDHIST is a credential history for the given account.</p>
<p><strong>Artefact</strong>: Preferch</p>
<p><strong>Information</strong>:</p>
<ol>
<li>Less frequently and most recently run programs</li>
</ol>
<p><strong>Artefact</strong>: $MFT file</p>
<p><strong>Information</strong>:</p>
<ol>
<li>Files deleted</li>
<li>Hidden files</li>
<li>Orphan files</li>
</ol>
<p><strong>Artefact</strong>: ShimCache</p>
<p><strong>Information</strong>:</p>
<ol>
<li>Programs installed (and possibly deleted)</li>
<li>Their paths</li>
</ol>
<p><strong>Artefact</strong>: AmCache</p>
<p><strong>Information</strong>:</p>
<ol>
<li>Programs installed and executed</li>
<li>Contains install date and time, name, version, path to exe/dll, source info, path to uninstall, publisher name, volume GUIDs, container ID of the device from which the program was run</li>
</ol>
<p><strong>Artefact</strong>: network traffic dump</p>
<p><strong>Information</strong>:</p>
<ol>
<li>Suspicious DNS resolved</li>
<li>Suspicious traffic</li>
<li>Beacons like every constant period of time.</li>
</ol>
<p>So, I would first look at the open and terminated connections to get a list of the most suspicious IPs, ports and corresponding processes.</p>
<p>Based on the data acquired, I would then check the traffic dump to get more insight.</p>
<p>Also, based on the information from the network connections and adding frequency analysis as well as â€œfind evilâ€, I would analyse executed programs using ShimCache â†’ Prefetch â†’ AmCache. For data found I would the return to the memory dump at dig into processes deeper.</p>
<p>Finally, I would check OS logs for â€¦ .</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
