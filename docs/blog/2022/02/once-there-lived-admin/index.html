<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Once There Lived Admin - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.66ce8fff03ef375318be5d54765d5c0749bf4b361552834de057ae7105ddb079.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤ğŸ€">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤ğŸ€</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-forensics ğŸ” and incident response ğŸ¥·">
      <a href="/docs/dfir">
        <span>Forensics ğŸ” and Incident Response ğŸ¥·</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-reverse ğŸ”§">
      <a href="/docs/reverse">
        <span>Reverse ğŸ”§</span>
      </a>
    </li>
    
    <li class="menu-item-toolkit ğŸ§°">
      <a href="/docs/toolkit">
        <span>Toolkit ğŸ§°</span>
      </a>
    </li>
    
    <li class="menu-item-threat hunting ğŸª¤ğŸ€">
      <a href="/docs/thunting">
        <span>Threat Hunting ğŸª¤ğŸ€</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tech reference ğŸ“š">
      <a href="/docs/reference">
        <span>Tech Reference ğŸ“š</span>
      </a>
    </li>
    
    <li class="menu-item-notes ğŸ“">
      <a href="/docs/notes">
        <span>Notes ğŸ“</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/blog/"> Back to Blog âœï¸ Section ğŸ‘ˆğŸ¼ </a>
  </p>
  <aside>
   <nav id="TableOfContents"></nav>
 </aside>
 </div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Once There Lived Admin</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      
      

      
      

      
    </div>
  </header>


  <div class="content" itemprop="articleBody">
    <p><em>Hey, ps! Would like you to hear a fairy tale? I am sure that you do! It all happened not long long time ago and not in a galaxy far far away&hellip; . Let&rsquo;s imagine that in the J.Rowling&rsquo;s universe there were cybersecurity specialists as well and Hogwarts had a real website in the Internet. Funky idea! ğŸ’¡</em></p>
<p>A very hard-working girl, let&rsquo;s call her Rachel (yeah, Rachel ğŸ˜‰) was sitting at her table, working as usual when she suddenly saw her phone vibrating nearby. She picked up the phone, hoping that wasn&rsquo;t a spam. Indeed it wasn&rsquo;t. That was her colleague, asking if she is interested in a little side project.</p>
<p>&lsquo;- <em>What sort of project is that?</em> - the girl wondered.</p>
<p>&lsquo;- <em>A very easy one, near to boring. Some magic school has become covered with certain compliance issues and wanted to check their online business card. I am sure there is nothing big there. I&rsquo;ve checked, not even a login page or some payment on the website</em>, - he replied.</p>
<p>&lsquo;- <em>It doesn&rsquo;t sound motivating, man. But ok. I am not overwhelmed with any work at the moment</em>, - Rachel said, clicking on a red cross in the upper left corner of her browser, closing some online Sniper Rabbit game ğŸ° ğŸ”«. - <em>Let&rsquo;s give it a shot. May be they will be interested in something bigger later on!</em></p>
<p>Considering this oportunity an investment into her client network, Rachel tried to force herself with all her strength sit down, smile and admire the process. It was hard, but she has tought herself to work even when the things she did were not inspiring. After all, work, as well as life in general, is not all the candies and dances.</p>
<p>&lsquo;- <em>Ok</em>, - she said, - <em>What does this website even look like?</em></p>
<p>The website was not looking very simple though. There were indeed no login pages anywhere to be seen, but there were lot&rsquo;s of pages nevertheless. You can sometimes find gems inside JS code, or some commented lines in HTML. So, if there are a lot of pages, there is still quite an amount of work to do.</p>
<p>As she usually did and what&rsquo;s become the part of her daily routine thus almoust unconsciously, she opened Burp Suite Pro and redirected the browser requests through this intercepting proxy tool. Running several plugins like Backslash, Active Scanner, crawler was also almoust a habbit. Almoust unconsciously she launched <code>dirb</code> tool to see some directories or files accessible from the Internet. Not much hope there, but still. Who knows?</p>
<p>After several hours of clicking and scrolling, and looking through the frontend source code, she decided to check what might have been snared in her &ldquo;fishing net&rdquo; ğŸ£.</p>
<p>&lsquo;- Looks like there are not many things to enumerate let alone bruteforce. Indeed this might be a little boring&hellip; .</p>
<p><img src="https://media.giphy.com/media/xT5LMBstMsq1jVdkzK/giphy.gif" alt="img"></p>
<p>Rachel felt that her eyes needed a little relaxation and went to the kitchen to make herself a cup of tea. She liked tea a lot. No, she was not English ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿, but tea was her biggest addiction. She could not spend a single day without it. Besides, when the time was right, it might even have a blend of seducing and spurring effect.</p>
<p>Rachel took a couple of biscuits ğŸªğŸª, the cup ğŸµ and her motivation and got back to her work place.</p>
<p>&lsquo;- <em>Fine, fine fine&hellip;,</em> - she kept saying when she was trying to find at least something, at least slighlty more serious than an ordinary &ldquo;Information leak through error messages&rdquo;.  It&rsquo;s often like that. It&rsquo;s a common misconception that is putting too much pressure on people like Rachel. If you don&rsquo;t find bugs, people don&rsquo;t believe there are none of them, rather that you were not working hard enough.</p>
<p>And that&rsquo;s when it started happening&hellip;. Sometimes, there is this hunch that one needs to follow. It&rsquo;s comming from deep inside, our subconscious might find something worthy even before consciousness sees it. Jung called it <em>intuition</em>. It&rsquo;s really a powerfull thing that&rsquo;s needed so much in the work such as Rachel&rsquo;s. And that&rsquo;s the story where several hunched helped.</p>
<p>&lsquo;- <em>Ok</em>, - Racheled murmured under her nose, - <em>What if I check the requests and responses manually in Burp? The website is very small, there should not be too many requests there.</em></p>
<p>That was a fair shot, because indeed, the Burp logs were not extensive at all. She was scrolling down the requests and responses when suddenly something caught her eye ğŸ‘.</p>
<p>' - <em>OMG! Is this a password or something?</em> - she wondered. Indeed it was! - <em>But I don&rsquo;t remember entering anything&hellip; Wait, a password in the <strong>response</strong>? What&rsquo;s going on?</em></p>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="err">HTTP/</span><span class="mi">2</span> <span class="mi">200</span> <span class="err">OK</span>
<span class="err">Content-Type:</span> <span class="err">application/json;</span> <span class="err">charset=UTF</span><span class="mi">-8</span>
<span class="err">Server:</span> <span class="err">nginx</span>
<span class="err">Content-Length:</span> <span class="mi">174</span>
<span class="err">Connection:</span> <span class="err">close</span>
<span class="err">X-Powered-By:</span> <span class="err">PHP</span> <span class="mi">7</span>

<span class="p">{</span>
  <span class="nt">&#34;success&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nt">&#34;url&#34;</span><span class="p">:</span> <span class="s2">&#34;http://smski.co.co.uk/send_message?login=Hogwarts&amp;password=Bnh175Lkajnfnf9&amp;from=Hogwarts&amp;to=4409877890&amp;text=OTPis123456&#34;</span>
  
<span class="p">}</span>
</code></pre></div><p>&lsquo;- <em>Noway this could work!</em> - she exclaimed. However, she copied the URL and pressed Enter. And she <em>saw</em> the SMSki website. As a quick research revealed, it was used to send SMS messages in large quantities. There was also what looked like a login form in the corner. She typed <code>Hogwarts</code> as login and <code>Bnh175Lkajnfnf9</code> as password and&hellip; got inside the Hogwarts&rsquo; personal profile on this website. She was bewildered.</p>
<p>&lsquo;- <em>Oh my gosh&hellip; . That&rsquo;s a littly out of scope. I don&rsquo;t want to get myself into trouble. But I have to check it thoroughly. What can I do? Can I send messages? Read them? Do I need some additional authorisation to do so?</em></p>
<p>Long story short, no, she didn&rsquo;t. The website was surprisingly primitive in terms of security and looked like the one from the earliest days of the Web. She had figured this out when she saw the login request sent via GET. Cool! ğŸ˜</p>
<blockquote>
<p>âœï¸ GET requests have several &ldquo;features&rdquo; that&rsquo;s why they are not a wise choice when it comes to confidential information.</p>
</blockquote>
<p>There is something weird as well, that might have caugth your eye, my dear listener/reader. The <code>text</code> parameter of this GET request. What do you think this <code>OTPis123456</code> might mean?</p>
<p>Rachel saw this text and was shoked even more. She needed to know, which request did this response belonged to. After several minutes of checking and retrying she could confirm that this was triggered by phone number confirmation on this website. Looked like if someone needed a brochure which could reveal some information about the school and lurl people to them, they had to enter a valid phone number. May be they were too overloaded with this brochure requests and the magic wands ğŸª„ could not get too helpful there.</p>
<p>As a part of this verification process, Hogwarts website sent a SMS message to the user with a temp code in it. However, this was done via the user&rsquo;s browser. User receives this JSON thingy, client&rsquo;s browser uses the website&rsquo;s JS code and this URL with parameters to actually login to <code>smski</code> and send themselves an OTP generated prior on the server. How do you like such a procedure?</p>
<p>&lsquo;- <em>Ok, that&rsquo;s a bug for sure. And not a good one. I should probably inform them right away and not wait until the report is prepared</em>, - Rachel thought.</p>
<p>It was very hard to explain the problem to the non-muggles, but she did it and assured them there might actually be a problem later (of not already).</p>
<p>Rachel thought that there could be nothing of value other than here. She tried this and that, harassing this poor form as much as she cood staying withing the legal boundaries. In several hours she could confirm that there is definetely no low or medium hanging fruit ğŸ‰ there, and it&rsquo;s time let it go and move forward.</p>
<p>She opened the <code>dirb</code> results (directories and files enumeration) with a little hope to see something of value when a very juicy string has caugth her eye&hellip; and HTTP response code was 200! So, there was some <code>admin</code> page exposed to the wild. That&rsquo;s great! She immediately opened the URL and saw a login page.</p>
<p><img src="images/adminlogin.png" alt="adminlogin"></p>
<p>The first thing probably any attacker either real or ethical would do - type <em>admin</em> in the both fields. But as usually results in the same result: <em>Access Denied</em> â›”ï¸.  But in this case followed by &ldquo;<em>&hellip;for this IP</em>&rdquo;.</p>
<p><img src="images/adminlogin2.png" alt="adminlogin2"></p>
<p>&lsquo;- <em>What if I try to turn on the VPN in the browser</em>, - was a valid assumption, - <em>And this&hellip;this&hellip;. wait for it&hellip; doesn&rsquo;t work. Damn. I don&rsquo;t understand, how do they check my IP? Is it an HTTP header like X-Forwarded-From or something?</em></p>
<p>Rachel checked the HTTP headers of the request in Burp.</p>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="err">GET</span> <span class="err">/admin/sign/in</span>
<span class="err">Host:</span> <span class="err">hogwarts.co.uk</span>
<span class="err">Connection:</span> <span class="err">close</span>
<span class="err">...</span>
</code></pre></div><p>&lsquo;- <em>Don&rsquo;t see anything of that sort. That&rsquo;s so weird&hellip; .</em> - Rachel double-checked the request but got the same results. She even checked whether there is a <code>Referer</code> header that might be giving her out, but there wasn&rsquo;t. It started getting dark outside and she had already missed her chance to savour the last rays of the sun ğŸŒ. There was no point rushing out now. She decided to postpone the investigation of this picky behaviour for later and check the Burp&rsquo;s automated scan results. Nothing <em>severe</em>, <em>high</em> or even <em>medium</em> was found. But&hellip;</p>
<p>&lsquo;- <em>Wait, what is that?</em> - Rachel noticed that <a href="https://hogwarts.co.uk">https://hogwarts.co.uk</a> was not the only domain used by the website. Some pages belonged to the <a href="https://market.hogwarts.co.uk">https://market.hogwarts.co.uk</a>. It seemed that the crawler followed several links that lead to that domain or may be she clicked on those links herself. She checked the URLs for the subdomain and it turned out, that that was a page listing magic services provided to the muggles.</p>
<p>&lsquo;- <em>Here is a crazy thought&hellip; Does this subdomain has the admin page as well?</em> - Rachel wondered typing <a href="https://market.hogwarts.co.uk/admin/sign/in">https://market.hogwarts.co.uk/admin/sign/in</a> in the address bar and pressing Enter.</p>
<p>&lsquo;- <em>Ha!</em> - Rachel exclaimed outloud in a guine excitement and surprise. - <em>Look! This page is accessible on this domain as well! Great. What if I try to enter a password?</em></p>
<p><img src="images/adminlogin3.png" alt="adminlogin3"></p>
<p>Rachel typed the usual <em>admin/admin</em> that probably would make any site sigh of boredom ğŸ˜‘ should they be alive. This time she didn&rsquo;t get access to the admin page, however, there was no <em>&ldquo;IP denied&rdquo;</em> message this time! Just an ordinary <em>&ldquo;Wrong password&rdquo;</em>. She tried several other passwords from the most common passwords list and this time she stumbled upon the <em>&ldquo;Wait for 5 minutes&rdquo;</em> ğŸ•£ message.</p>
<p><img src="images/adminlogin4.png" alt="adminlogin4"></p>
<p><em>Ok</em>, -  thought Rachel. - <em>I will try in 5 minutes. If I don&rsquo;t get the correct password then, I will probably get a 10 min timeout. So, I need to choose wisely.</em></p>
<p>She scrolled down the list of the most common passwords, trying to put a score to the most likely options. Then, she had her list of the next 5 options to try. When the 5 minute timeout was over, she tried all of them. But what a surprise it was to get &hellip; a 5 minute timeout again!</p>
<p>&lsquo;- <em>Ha, that&rsquo;s going to make things easier,</em> - Rachel thought ğŸ’­ to herself.</p>
<p>Burp&rsquo;s Intruder didn&rsquo;t have an option to send 5 requests every 5 minutes, so she felt a need to write a custom script in Python.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># importing the requered librariess</span>
<span class="kn">import</span> <span class="nn">requests</span> 
<span class="kn">import</span> <span class="nn">time</span> 
<span class="kn">import</span> <span class="nn">warnings</span> 
<span class="kn">import</span> <span class="nn">sys</span>


<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&#34;ignore&#34;</span><span class="p">)</span>
<span class="n">delay_coeff</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://market.hogwarts.ru/admin/sign/in&#34;</span>
<span class="c1"># headers required for the POST request to the admin URL</span>
<span class="n">hdrs</span> <span class="o">=</span> <span class="p">{</span> 
    <span class="s2">&#34;Host&#34;</span><span class="p">:</span> <span class="s2">&#34;market.hogwarts.ru&#34;</span><span class="p">,</span>
    <span class="s2">&#34;Connection&#34;</span><span class="p">:</span> <span class="s2">&#34;close&#34;</span><span class="p">,</span>
    <span class="s2">&#34;Content-Length&#34;</span><span class="p">:</span> <span class="s2">&#34;162&#34;</span><span class="p">,</span>
    <span class="s2">&#34;Origin&#34;</span><span class="p">:</span> <span class="s2">&#34;https://market.hogwarts.ru&#34;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">passwords</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;/Users/rachelgreen/projects/hogwarts/oracle_passwords.txt&#34;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">attempts</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">passwords</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;====================================&#34;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;This is an attempt </span><span class="se">\033</span><span class="s2">[1;33;40m #&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">attempts</span><span class="p">))</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="c1"># after each 5th password entered, sleep for 310 seconds</span>
    <span class="k">if</span> <span class="n">attempts</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">310</span><span class="o">*</span><span class="n">delay_coeff</span><span class="p">)</span>
    <span class="c1"># min content length without the password and login fields</span>
    <span class="n">content_len</span> <span class="o">=</span> <span class="mi">148</span>
    <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&#34;LoginForm[username]&#34;</span> <span class="p">:</span> <span class="n">username</span><span class="p">,</span>
            <span class="s2">&#34;LoginForm[password]&#34;</span> <span class="p">:</span> <span class="n">password</span>
    <span class="p">}</span>
    <span class="c1"># add the size of the password and login to the Content Type</span>
    <span class="n">added_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">password</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
    <span class="n">content_len</span> <span class="o">+=</span> <span class="n">added_length</span>
    <span class="c1"># update the Content-Length header</span>
    <span class="n">hdrs</span><span class="p">[</span><span class="s2">&#34;Content-Length&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">content_len</span><span class="p">)</span>

    <span class="c1"># send the request</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">post_data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">hdrs</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
		<span class="c1"># In case she gets a &#34;Too many attempts error&#34;, she will have to extend the delay before the next 5 passwords are sent</span>
    <span class="k">if</span> <span class="s2">&#34;Too many&#34;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[1;35;40m The delay coefficient is too small&#34;</span><span class="p">)</span>
        <span class="n">delay_coeff</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="c1"># increment the coefficient in order to extend the sleep time</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># wait for 6 minutes just to be sure </span>
    <span class="k">elif</span> <span class="s2">&#34;Incorrect username or password.&#34;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[1;31;40m The username {} or password {} is wrong!&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">))</span>
        <span class="c1"># Since there are only two types of messages possible that Rachel has discovered, anything else can potentially be a success and will need to reviewed EVEN if it is not.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[1;32;40m Success! The login is: {}, and the password is: {}&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">))</span> 
        <span class="c1"># if something looks different from the above messages, that could be either a success or some other error that could give some insight into what&#39;s the password could be. That&#39;s why she&#39;s breaking the loop.</span>
        <span class="k">break</span>
    <span class="n">attempts</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div><p>Rachel looked from the window outside and the warm motherly breath of the spring gently petted her cheek. She took a deep breath, her lungs ğŸ« filled with fresh evening air and she felt some dizziness and composure raising inside.</p>
<p>&lsquo;- <em>I think, I need a short randevouz in the park</em>, - she said to herself. - <em>The list of passwords is huge and I don&rsquo;t have any reason to rush. Besides, it could do me good, would reload my brain ğŸ§ . I am sure I will sleep like a dog ğŸ•.</em></p>
<p>The lights went off, the door slammed behind her and the little MacBook and the python script went on in Alliance, on and on, until the last <em>if</em> clause broke the loop&hellip; . But what was it? Admin page? What were the login and password?</p>
<p>Rachel got back home 15 minutes ğŸ•’ later after the script had terminated. An almoust endless row of red <em>&ldquo;The username {} or password {} is wrong!&quot;</em> was diluted with a modest green success message. Rachel managed to get her mind off the project completely this evening and that is why she didn&rsquo;t notice.</p>
<p>The next morning Rachel started with a cup of green tea and a croissant. She was dreaming of a cupcake though. The croissant was old and dry, it was obvious that its best time was over, it had become just food. When she finished her breakfast, she remembered, that she forgot about the script running.</p>
<p>&lsquo;- <em>OMG! I hope, I have not broken anything!</em> - she exclaimed and rushed to the laptop. - <em>Could it be&hellip; really? Success? What was the password? Em&hellip; Wait, what?</em></p>
<p>She had been staring at the screen for several minutes. It did not make any sense. Both the login and password were <code>&lt;BLANK&gt;</code> (litterally). It seemed that in the list of passwords there were lots of this <code>&lt;BLANK&gt;</code>s either for a login or password or both. Of course, it was intended that the <code>&lt;BLANK&gt;</code>  is actually an empty string. But how are you going to put it in the document and keep the structure? She tried to use the above mentioned credentials to login and indeed, did not receive neither <em>&ldquo;Too many attempts&rdquo;</em>, nor <em>&ldquo;The password or login is wrong&rdquo;</em>. Instead, a blank page with a website header was there. No errors, but not an admin page either.</p>
<p>Rachel decided to remove the <code>&lt;BLANK&gt;</code>-<code>&lt;BLANK&gt;</code> credentials from the list and pressed the button, running the script once again. She decided to watch it work indtead this time, she still had her tea ğŸ«– and had a couple of hours to spare.</p>
<p>&lsquo;- <em>Aha&hellip; Another success. Is it success this time?</em> - she wondered. This time the credentials were <code>User</code> and <code>&lt;BLANK&gt;</code>. This time as well she got the same result. Then, out of the blue, coming from somewhere deep inside her shrewd subconscious, was this quite whisper: Try <code>admin</code> and <code>&lt;BLANK&gt;</code> together. And she tried. And it worked.</p>
<p>&lsquo;- <em>I don&rsquo;t understand, this doesn&rsquo;t make any sense. Who in their right mind would set a password to <code>&lt;BLANK&gt;</code>? What kind of perversion is that? Somewhere between drinking coffee with sugar and drinking tea without it?</em></p>
<p>She tried several other logins with the <code>&lt;BLANK&gt;</code> password and got the same result as before with an empty page. She then tried <code>admin</code> with <code>&lt;BLANK&gt;</code> again and was again redirected to the login panel. And then she felt this whisper again: <em>Try using <code>&lt;BLANK</code> instead. Who knows?</em></p>
<p>&lsquo;- <em>OMG, this also works!!!</em> - it was hard to keep the emotions inside. She started deleting characters from the end and kept getting the same results as before. A frivolous admin page was there again, heartily welcoming anyone even distantly familiar. At some point, Rachel was left with just a <code>&lt;</code> which also worked fine. <code>&gt;</code> on the other hand was not satisfying for the system.</p>
<p>&lsquo;- <em>Is it like a bookmark or a backdoor in the code?</em> - Rachel didn&rsquo;t see any other possible reasons other rather than similar to code below:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="o">...</span>
<span class="k">if</span> <span class="p">(</span><span class="n">login</span> <span class="o">==</span> <span class="s2">&#34;admin&#34;</span> <span class="ow">and</span> <span class="n">password</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;&lt;&#34;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">login</span> <span class="o">==</span> <span class="s2">&#34;admin&#34;</span> <span class="ow">and</span> <span class="n">password</span> <span class="o">==</span> <span class="s2">&#34;somerealpass&#34;</span><span class="p">:</span>
  <span class="k">return</span> <span class="n">adminpage</span>
<span class="k">else</span><span class="p">:</span>
  <span class="k">print</span><span class="p">(</span><span class="s2">&#34;Incorrect username or password.&#34;</span>
<span class="o">...</span>
</code></pre></div><p>She informed the client right away and out of pure curiosity asked for a code snippet that was responsible for authentication. Turned out that there indeed was something like the one above, some fired developer saught its final revenge. He could have uploaded a webshell using this admin control panel! May be he had&hellip; But that, dear readers, is whole other scope&hellip; .</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
