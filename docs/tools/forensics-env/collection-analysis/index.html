<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Collection and Analysis - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-ttp 🔍">
      <a href="/docs/ttp">
        <span>TTP 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db 🏺">
      <a href="/docs/artefacts">
        <span>Artefacts DB 🏺</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db ⚔️">
      <a href="/docs/attacks">
        <span>Attacks DB ⚔️</span>
      </a>
    </li>
    
    <li class="menu-item-tools db 🛠️">
      <a href="/docs/tools">
        <span>Tools DB 🛠️</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home 🏡">
      <a href="/">
        <span>Home 🏡</span>
      </a>
    </li>
    
    <li class="menu-item-blog ✍️">
      <a href="/docs/blog">
        <span>Blog ✍️</span>
      </a>
    </li>
    
    <li class="menu-item-ttp 🔍">
      <a href="/docs/ttp">
        <span>TTP 🔍</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db 🏺">
      <a href="/docs/artefacts">
        <span>Artefacts DB 🏺</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db ⚔️">
      <a href="/docs/attacks">
        <span>Attacks DB ⚔️</span>
      </a>
    </li>
    
    <li class="menu-item-tools db 🛠️">
      <a href="/docs/tools">
        <span>Tools DB 🛠️</span>
      </a>
    </li>
    
    <li class="menu-item-crypto 🗝️">
      <a href="/docs/cryptography">
        <span>Crypto 🗝️</span>
      </a>
    </li>
    
    <li class="menu-item-about me 🧝🏽‍♀️">
      <a href="/docs/about">
        <span>About me 🧝🏽‍♀️</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/tools/forensics-env/"> 👈🏼 Back to </br> Forensic Environment Setup </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#kansa">Kansa</a></li>
    <li><a href="#f-response">F-Response</a></li>
    <li><a href="#kape">KAPE</a></li>
    <li><a href="#velociraptor">Velociraptor</a></li>
    <li><a href="#edr">EDR</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Collection and Analysis</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      

      
    </div>
    
    <b>Created:</b> 09.06.2023
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p><em>There are numerous tools available for collecting and analysing artefacts and evidence. I will provide an overview, relevant links, or even comparison charts, depending on the tools.</em></p>
<h2 id="kansa">Kansa</h2>
<blockquote>
<p>❗️Windows only
❗️Not for forensic acquisition
✍🏻 IR and TH</p>
</blockquote>
<p>This tool is used primarily for artefact collection. However, it was improved over the years and can also help with initial triage. Also, it&rsquo;s been improved to allow scaling (distributed Kansa).</p>
<p>While Kansa heavily relies on PowerShell, its capabilities extend beyond PowerShell cmdlets. Kansa is a flexible and modular tool. <code>Modules</code> folder contains all the available modules that can be turned on and off in a <code>Modules.conf</code>.</p>
<h2 id="f-response">F-Response</h2>
<blockquote>
<p>❗️Doesn&rsquo;t scale well
✍🏻 Triage imaging, artefact post-processing</p>
</blockquote>
<p>Since it has access to raw data, file locking can be circumvented. People can work simultaneously. Supports Windows, Apple, some FreeBSD, Linux and even Android. The examiner needs to create an agent for the target system and deploy it. Then, connect to the machine via the forensics workstation.</p>
<h2 id="kape">KAPE</h2>
<blockquote>
<p>❗️Windows only</p>
</blockquote>
<p>KAPE is cool (Eric Z.); it preserves all metadata and even keeps audit logs - super forensically sound. Shadow copies and ADS are also supported. Removes duplicates based on the hash. Sends data over SFTP. Customisable and portable.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">kape</span><span class="p">.</span><span class="n">exe</span> <span class="p">-</span><span class="n">-tsource</span> <span class="n">F</span> <span class="p">-</span><span class="n">-target</span> <span class="n">configfile</span> <span class="p">-</span><span class="n">-tdest</span> <span class="p">\</span><span class="n">output</span><span class="p">\</span><span class="n">path</span> <span class="c"># vss for shadow copies, vhdx and vhd for virtual hard drive</span>
</span></span></code></pre></div><h2 id="velociraptor">Velociraptor</h2>
<blockquote>
<p>❗️Windows, macOS and Linux
❗️Updated often
✍🏻 Triage imaging, IR and TH</p>
</blockquote>
<p>It scales really well. You can run VQL queries. Deployment via WebUI, CLI or API. Can be used as a monitor or analysis tool. Consists of client and server parts. Velociraptor artefacts are preconfigured queries. Some examples of artefacts are Filesystem Timeline, MFT, $I30, Yara Scanning, Prefetch Timeline, Netstat, ARP, Processes, DLLs, Event logs, DNS queries. SRUM, BAM, UserAssist etc.</p>
<p>Hunts (active queries) for threat hunting live for 7 days.</p>
<h2 id="edr">EDR</h2>
<blockquote>
<p>❗️70% of breached originate on the endpoint.</p>
</blockquote>
<p>Threat Hunting (anomaly detection and manual) IR. Agents send data to a central repo. EDRs usually have direct access to RAM (like a rootkit).</p>
<blockquote>
<p>❗️One can circumvent the EDR when booting into safe mode.</p>
</blockquote>
<h2 id="references">References</h2>
<details>
    <summary>Expand&hellip;</summary>
    <a href="https://docs.velociraptor.app/">https://docs.velociraptor.app/</a>
</details>
  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
