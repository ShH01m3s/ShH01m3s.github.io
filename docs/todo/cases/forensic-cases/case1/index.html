<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A Study in Black - Analyst</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="https://bakerst221b.com/favicon.png">
  <link href="/css/style-classic.css"></link>
  
  
  <link rel="stylesheet" href="/css/style.min.564b5f4faf3af87992cb8ab298314448914c22dbdb3f2f9c584546b21b8d407c.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/tools">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/tools">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="https://bakerst221b.com"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    

    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home ğŸ¡">
      <a href="/">
        <span>Home ğŸ¡</span>
      </a>
    </li>
    
    <li class="menu-item-blog âœï¸">
      <a href="/docs/blog">
        <span>Blog âœï¸</span>
      </a>
    </li>
    
    <li class="menu-item-ttp ğŸ”">
      <a href="/docs/ttp">
        <span>TTP ğŸ”</span>
      </a>
    </li>
    
    <li class="menu-item-artefacts db ğŸº">
      <a href="/docs/tools">
        <span>Artefacts DB ğŸº</span>
      </a>
    </li>
    
    <li class="menu-item-attacks db âš”ï¸">
      <a href="/docs/tools">
        <span>Attacks DB âš”ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-tools db ğŸ› ï¸">
      <a href="/docs/tools">
        <span>Tools DB ğŸ› ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-crypto ğŸ—ï¸">
      <a href="/docs/cryptography">
        <span>Crypto ğŸ—ï¸</span>
      </a>
    </li>
    
    <li class="menu-item-about me ğŸ§ğŸ½â€â™€ï¸">
      <a href="/docs/about">
        <span>About me ğŸ§ğŸ½â€â™€ï¸</span>
      </a>
    </li>
    
  </ul>
</div>
    
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
    
    <div style="margin-left: 20pt;">
      <a href="/index.xml" type="application/rss+xml">
        <img src="/images/rss.png" alt="RSS Feed">
      </a>
    </div>
    
    <style>
      a[href="/index.xml"] {
        display: inline-block;
        vertical-align: middle;
        margin-right: 10px;
      }
    
      a[href="/index.xml"] img {
        height: 30px;
      }
    </style>
    
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <p>
   <a href="/docs/todo/cases/forensic-cases/"> ğŸ‘ˆğŸ¼ Back to </br> Forensic Cases ğŸ’¼ </a>
  </p>
  <aside>
   <nav id="TableOfContents">
  <ul>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
 </aside>
</div>



          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">A Study in Black</h1>
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="meta">
      
      

      
      <div class="article-category">
        <i class="fas fa-tools"></i>
          
          
          <a class="platform-link" href="/tools/filemost">filemost</a> 
          
           , 
          <a class="platform-link" href="/tools/volatility">Volatility</a> 
          
           , 
          <a class="platform-link" href="/tools/ddf">DDF</a> 
          
           , 
          <a class="platform-link" href="/tools/exiftool">exiftool</a> 
          
      </div> <br />
      
      

      
      <div class="article-tag">
          <i class="fas fa-tag"></i>
          
          
          <a class="tag-link" href="/tags/case-example" rel="tag">case-example</a>
          
      </div> 
      
    </div>
    
    <b>Created:</b> 20.09.2020
    <br />

    

  </header>


  <div class="content" itemprop="articleBody">
    <p>Someone has violated corporate policy by watching porn using the corp PC.</p>
<p>Do you have the authority?</p>
<p>What are the expected results?</p>
<p><strong>Some prohibited internet traffic</strong>. Check network logs of an application layer firewall ğŸ”¥ or content filter (any gateway between the suspect and the network), filter them out. But the user was smart enough to use VPN. What&rsquo;s then? Application layer firewall only sees application traffic, it is not aware of TCPs, Shudipis and etc. Read <a href="/docs/articles/fundamentals/network/osi/overview">this</a> article about TCP/IP stack to understand better why application layer firewalls won&rsquo;t see anything other than what&rsquo;s on top.</p>
<p><strong>Plan:</strong></p>
<p><strong>Step 1</strong>. Two bit-by-bit copy of the hard drive</p>
<p><strong>Step 2</strong>. Validate these copyies by comparing the hashes.</p>
<p><strong>Step 3</strong>. Enable write block (<code>DDF</code>- ?).</p>
<p><strong>Step 4</strong>. RAM (<code>vol.py</code>)</p>
<p><strong>Step 5</strong>. HDD/SDD (<code>DDF</code>)</p>
<p><strong>Step 6</strong>. Enumerate browser history (Autopsy/<code>vol.py</code>)</p>
<p><strong>Information leakage</strong>. If the suspect has leaked some information and the information is stored in the Cloud â˜ï¸ in this company, then check gateway&rsquo;s logs for any connections to the storage or use Cloud logs ğŸªµ.</p>
<p><strong>Harassment</strong>. Check social media (FB, Ok, LinkedIn, Vk etc). Collect all information that could be produced by the communication of the suspect and the victim.
Get the suspect&rsquo;s friends, neighbours and partners. They might have the evidence against them.</p>
<p><strong>Network breach.</strong> Possible indicators: security tools alarms/logs, unsual behaviour, unauthorised traffic, network performance changes, communication from the attacker or some event. Look at security tools&rsquo; logs. Useful to know how to grep, regex, python. If nothing is found in the logs, or it&rsquo;s still not clear, try doing port scanning for any unusual ports, or adding some triggers like bruting activity, malicious files, netflow baselines, general IPS signatures, honey ğŸ¯ pots. Scope, contain, remediate. Identify the attack and patch. Evaluate and upgrade the policy for a breach.</p>
<p><strong>Step 1</strong>. Copy evidence (logs and other files of interest).</p>
<p><strong>Step 2</strong>. Validate these copies (hash).</p>
<p><strong>Step 3</strong>. Chain of custody, recommendation for these evidence, signoff.</p>
<p><strong>HDD from eBay</strong>. What was installed on this device? Using OSINT (correlate, say, eBay and FB accs), determine the company the person is or was working for. The data might have been still on HDD.</p>
<p><strong>Plan:</strong></p>
<p><strong>Step 1</strong>. Two bit-by-bit copy of the hard drive</p>
<p><strong>Step 2</strong>. Validate these copyies by comparing the hashes.</p>
<p><strong>Step 3</strong>. Enable write block (<code>DDF</code>- ?).</p>
<p><strong>Step 4.</strong> File recovery (<code>filemost</code>).</p>
<p><strong>Step 5</strong>. Enumerate metadata (<code>exiftol</code>).</p>
<p><strong>Step 6</strong>. Investigate further if needed using the Internet and the recovered data.</p>
<p><strong>Example</strong>.</p>
<p>Scope of work (networks and technologies + users\things + billing structure + contacts during investigation + white/black/grey).</p>
<p>Step 1. Network and host logs.</p>
<p>Main idea - think, what data could have been produced and think of the ways and tools that could be useful. Keep in mind their cons and pros and theur digital footprints.</p>
<h2 id="references">References</h2>
<p>[<a href="https://www.ciscolive.com/c/dam/r/ciscolive/emea/docs/2017/pdf/BRKSEC-2908.pdf">1</a>] About forensic tools like DFF</p>
<p>[<a href="https://www.youtube.com/watch?v=QiDpGezol0o">2</a>] Another case study</p>

  </div>
</article>
</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
            </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.302a6fc365d5139fb98cf60bdb8f715d96257ea189161d36c190ccfa8182e569.js"></script>
  

  
  
  
    
  


</body>

</html>
